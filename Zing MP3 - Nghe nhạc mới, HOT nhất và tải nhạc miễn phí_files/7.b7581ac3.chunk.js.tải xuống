(this["webpackJsonp@zmedia/zmp3-desktop"]=this["webpackJsonp@zmedia/zmp3-desktop"]||[]).push([[7],{1563:function(e,t,r){var n=r(438),i=r(655),a=r(656),o=r(657),s=r(270),l=r(439),u=r(651),c=r(652),f=r(653),d=r(658),h=r(654),p=r(659);window,e.exports=function(e){function t(t){for(var r,i,a=t[0],o=t[1],s=0,u=[];s<a.length;s++)i=a[s],n[i]&&u.push(n[i][0]),n[i]=0;for(r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r]);for(l&&l(t);u.length;)u.shift()()}var r={},n={0:0};function i(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var a=new Promise((function(t,i){r=n[e]=[t,i]}));t.push(r[2]=a);var o,s=document.getElementsByTagName("head")[0],l=document.createElement("script");l.charset="utf-8",l.timeout=120,i.nc&&l.setAttribute("nonce",i.nc),l.src=function(e){return i.p+""+({}[e]||e)+".bundle.min.js"}(e),o=function(t){l.onerror=l.onload=null,clearTimeout(u);var r=n[e];if(0!==r){if(r){var i=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,o=new Error("Loading chunk "+e+" failed.\n("+i+": "+a+")");o.type=i,o.request=a,r[1](o)}n[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:l})}),12e4);l.onerror=l.onload=o,s.appendChild(l)}return Promise.all(t)},i.m=e,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="https://zjs-zcast.zingcdn.me/zplayer/releases/v1.1.14/",i.oe=function(e){throw console.error(e),e};var a=window.webpackJsonpzPlayer=window.webpackJsonpzPlayer||[],o=a.push.bind(a);a.push=t,a=a.slice();for(var s=0;s<a.length;s++)t(a[s]);var l=o;return i(i.s=61)}([function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r,n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var a=(r=i,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),o=i.sources.map((function(e){return"/*# sourceURL="+i.sourceRoot+e+" */"}));return[n].concat(o).concat([a]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(n[a]=!0)}for(i=0;i<e.length;i++){var o=e[i];"number"==typeof o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),t.push(o))}},t}},function(e,t,r){var n,i,a={},o=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===i&&(i=n.apply(this,arguments)),i}),s=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),l=null,u=0,c=[],f=r(17);function d(e,t){for(var r=0;r<e.length;r++){var n=e[r],i=a[n.id];if(i){i.refs++;for(var o=0;o<i.parts.length;o++)i.parts[o](n.parts[o]);for(;o<n.parts.length;o++)i.parts.push(m(n.parts[o],t))}else{var s=[];for(o=0;o<n.parts.length;o++)s.push(m(n.parts[o],t));a[n.id]={id:n.id,refs:1,parts:s}}}}function h(e,t){for(var r=[],n={},i=0;i<e.length;i++){var a=e[i],o=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):r.push(n[o]={id:o,parts:[s]})}return r}function p(e,t){var r=s(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=c[c.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),c.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=s(e.insertAt.before,r);r.insertBefore(t,i)}}function g(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=c.indexOf(e);t>=0&&c.splice(t,1)}function v(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=r.nc;n&&(e.attrs.nonce=n)}return y(t,e.attrs),p(e,t),t}function y(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function m(e,t){var r,n,i,a;if(t.transform&&e.css){if(!(a=t.transform(e.css)))return function(){};e.css=a}if(t.singleton){var o=u++;r=l||(l=v(t)),n=E.bind(null,r,o,!1),i=E.bind(null,r,o,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",y(t,e.attrs),p(e,t),t}(t),n=function(e,t,r){var n=r.css,i=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(n=f(n)),i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,r,t),i=function(){g(r),r.href&&URL.revokeObjectURL(r.href)}):(r=v(t),n=function(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){g(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=h(e,t);return d(r,t),function(e){for(var n=[],i=0;i<r.length;i++){var o=r[i];(s=a[o.id]).refs--,n.push(s)}for(e&&d(h(e,t),t),i=0;i<n.length;i++){var s;if(0===(s=n[i]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete a[s.id]}}}};var A,b=(A=[],function(e,t){return A[e]=t,A.filter(Boolean).join("\n")});function E(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=b(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n,i=function(){function e(e){return null==e?String(e):V[H.call(e)]||"object"}function t(t){return"function"==e(t)}function n(e){return null!=e&&e==e.window}function i(e){return null!=e&&e.nodeType==e.DOCUMENT_NODE}function a(t){return"object"==e(t)}function o(e){return a(e)&&!n(e)&&Object.getPrototypeOf(e)==Object.prototype}function s(e){return"number"==typeof e.length}function l(e){return e.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function u(e){return e in C?C[e]:C[e]=new RegExp("(^|\\s)"+e+"(\\s|$)")}function c(e,t){return"number"!=typeof t||D[l(e)]?t:t+"px"}function f(e){return"children"in e?P.call(e.children):E.map(e.childNodes,(function(e){return 1==e.nodeType?e:void 0}))}function d(e,t){var r,n=e?e.length:0;for(r=0;n>r;r++)this[r]=e[r];this.length=n,this.selector=t||""}function h(e,t,r){for(b in t)r&&(o(t[b])||q(t[b]))?(o(t[b])&&!o(e[b])&&(e[b]={}),q(t[b])&&!q(e[b])&&(e[b]=[]),h(e[b],t[b],r)):t[b]!==A&&(e[b]=t[b])}function p(e,t){return null==t?E(e):E(e).filter(t)}function g(e,r,n,i){return t(r)?r.call(e,n,i):r}function v(e,t,r){null==r?e.removeAttribute(t):e.setAttribute(t,r)}function y(e,t){var r=e.className||"",n=r&&r.baseVal!==A;return t===A?n?r.baseVal:r:void(n?r.baseVal=t:e.className=t)}function m(e){try{return e?"true"==e||"false"!=e&&("null"==e?null:+e+""==e?+e:/^[\[\{]/.test(e)?E.parseJSON(e):e):e}catch(t){return e}}var A,b,E,k,T,S,w=[],_=w.concat,L=w.filter,P=w.slice,I=window.document,R={},C={},D={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},O=/^\s*<(\w+|!)[^>]*>/,z=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,M=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,x=/^(?:body|html)$/i,B=/([A-Z])/g,F=["val","css","html","text","data","width","height","offset"],N=I.createElement("table"),U=I.createElement("tr"),j={tr:I.createElement("tbody"),tbody:N,thead:N,tfoot:N,td:U,th:U,"*":I.createElement("div")},G=/complete|loaded|interactive/,Y=/^[\w-]*$/,V={},H=V.toString,K={},Q=I.createElement("div"),W={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},q=Array.isArray||function(e){return e instanceof Array};return K.matches=function(e,t){if(!t||!e||1!==e.nodeType)return!1;var r=e.webkitMatchesSelector||e.mozMatchesSelector||e.oMatchesSelector||e.matchesSelector;if(r)return r.call(e,t);var n,i=e.parentNode,a=!i;return a&&(i=Q).appendChild(e),n=~K.qsa(i,t).indexOf(e),a&&Q.removeChild(e),n},T=function(e){return e.replace(/-+(.)?/g,(function(e,t){return t?t.toUpperCase():""}))},S=function(e){return L.call(e,(function(t,r){return e.indexOf(t)==r}))},K.fragment=function(e,t,r){var n,i,a;return z.test(e)&&(n=E(I.createElement(RegExp.$1))),n||(e.replace&&(e=e.replace(M,"<$1></$2>")),t===A&&(t=O.test(e)&&RegExp.$1),t in j||(t="*"),(a=j[t]).innerHTML=""+e,n=E.each(P.call(a.childNodes),(function(){a.removeChild(this)}))),o(r)&&(i=E(n),E.each(r,(function(e,t){F.indexOf(e)>-1?i[e](t):i.attr(e,t)}))),n},K.Z=function(e,t){return new d(e,t)},K.isZ=function(e){return e instanceof K.Z},K.init=function(e,r){var n;if(!e)return K.Z();if("string"==typeof e)if("<"==(e=e.trim())[0]&&O.test(e))n=K.fragment(e,RegExp.$1,r),e=null;else{if(r!==A)return E(r).find(e);n=K.qsa(I,e)}else{if(t(e))return E(I).ready(e);if(K.isZ(e))return e;if(q(e))n=function(e){return L.call(e,(function(e){return null!=e}))}(e);else if(a(e))n=[e],e=null;else if(O.test(e))n=K.fragment(e.trim(),RegExp.$1,r),e=null;else{if(r!==A)return E(r).find(e);n=K.qsa(I,e)}}return K.Z(n,e)},(E=function(e,t){return K.init(e,t)}).extend=function(e){var t,r=P.call(arguments,1);return"boolean"==typeof e&&(t=e,e=r.shift()),r.forEach((function(r){h(e,r,t)})),e},K.qsa=function(e,t){var r,n="#"==t[0],i=!n&&"."==t[0],a=n||i?t.slice(1):t,o=Y.test(a);return e.getElementById&&o&&n?(r=e.getElementById(a))?[r]:[]:1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType?[]:P.call(o&&!n&&e.getElementsByClassName?i?e.getElementsByClassName(a):e.getElementsByTagName(t):e.querySelectorAll(t))},E.contains=I.documentElement.contains?function(e,t){return e!==t&&e.contains(t)}:function(e,t){for(;t&&(t=t.parentNode);)if(t===e)return!0;return!1},E.type=e,E.isFunction=t,E.isWindow=n,E.isArray=q,E.isPlainObject=o,E.isEmptyObject=function(e){var t;for(t in e)return!1;return!0},E.inArray=function(e,t,r){return w.indexOf.call(t,e,r)},E.camelCase=T,E.trim=function(e){return null==e?"":String.prototype.trim.call(e)},E.uuid=0,E.support={},E.expr={},E.noop=function(){},E.map=function(e,t){var r,n,i,a=[];if(s(e))for(n=0;n<e.length;n++)null!=(r=t(e[n],n))&&a.push(r);else for(i in e)null!=(r=t(e[i],i))&&a.push(r);return function(e){return e.length>0?E.fn.concat.apply([],e):e}(a)},E.each=function(e,t){var r,n;if(s(e)){for(r=0;r<e.length;r++)if(!1===t.call(e[r],r,e[r]))return e}else for(n in e)if(!1===t.call(e[n],n,e[n]))return e;return e},E.grep=function(e,t){return L.call(e,t)},window.JSON&&(E.parseJSON=JSON.parse),E.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){V["[object "+t+"]"]=t.toLowerCase()})),E.fn={constructor:K.Z,length:0,forEach:w.forEach,reduce:w.reduce,push:w.push,sort:w.sort,splice:w.splice,indexOf:w.indexOf,concat:function(){var e,t,r=[];for(e=0;e<arguments.length;e++)t=arguments[e],r[e]=K.isZ(t)?t.toArray():t;return _.apply(K.isZ(this)?this.toArray():this,r)},map:function(e){return E(E.map(this,(function(t,r){return e.call(t,r,t)})))},slice:function(){return E(P.apply(this,arguments))},ready:function(e){return G.test(I.readyState)&&I.body?e(E):I.addEventListener("DOMContentLoaded",(function(){e(E)}),!1),this},get:function(e){return e===A?P.call(this):this[e>=0?e:e+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each((function(){null!=this.parentNode&&this.parentNode.removeChild(this)}))},each:function(e){return w.every.call(this,(function(t,r){return!1!==e.call(t,r,t)})),this},filter:function(e){return t(e)?this.not(this.not(e)):E(L.call(this,(function(t){return K.matches(t,e)})))},add:function(e,t){return E(S(this.concat(E(e,t))))},is:function(e){return this.length>0&&K.matches(this[0],e)},not:function(e){var r=[];if(t(e)&&e.call!==A)this.each((function(t){e.call(this,t)||r.push(this)}));else{var n="string"==typeof e?this.filter(e):s(e)&&t(e.item)?P.call(e):E(e);this.forEach((function(e){n.indexOf(e)<0&&r.push(e)}))}return E(r)},has:function(e){return this.filter((function(){return a(e)?E.contains(this,e):E(this).find(e).size()}))},eq:function(e){return-1===e?this.slice(e):this.slice(e,+e+1)},first:function(){var e=this[0];return e&&!a(e)?e:E(e)},last:function(){var e=this[this.length-1];return e&&!a(e)?e:E(e)},find:function(e){var t=this;return e?"object"==r(e)?E(e).filter((function(){var e=this;return w.some.call(t,(function(t){return E.contains(t,e)}))})):1==this.length?E(K.qsa(this[0],e)):this.map((function(){return K.qsa(this,e)})):E()},closest:function(e,t){var n=this[0],a=!1;for("object"==r(e)&&(a=E(e));n&&!(a?a.indexOf(n)>=0:K.matches(n,e));)n=n!==t&&!i(n)&&n.parentNode;return E(n)},parents:function(e){for(var t=[],r=this;r.length>0;)r=E.map(r,(function(e){return(e=e.parentNode)&&!i(e)&&t.indexOf(e)<0?(t.push(e),e):void 0}));return p(t,e)},parent:function(e){return p(S(this.pluck("parentNode")),e)},children:function(e){return p(this.map((function(){return f(this)})),e)},contents:function(){return this.map((function(){return this.contentDocument||P.call(this.childNodes)}))},siblings:function(e){return p(this.map((function(e,t){return L.call(f(t.parentNode),(function(e){return e!==t}))})),e)},empty:function(){return this.each((function(){this.innerHTML=""}))},pluck:function(e){return E.map(this,(function(t){return t[e]}))},show:function(){return this.each((function(){var e,t,r;"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=(e=this.nodeName,R[e]||(t=I.createElement(e),I.body.appendChild(t),r=getComputedStyle(t,"").getPropertyValue("display"),t.parentNode.removeChild(t),"none"==r&&(r="block"),R[e]=r),R[e]))}))},replaceWith:function(e){return this.before(e).remove()},wrap:function(e){var r=t(e);if(this[0]&&!r)var n=E(e).get(0),i=n.parentNode||this.length>1;return this.each((function(t){E(this).wrapAll(r?e.call(this,t):i?n.cloneNode(!0):n)}))},wrapAll:function(e){if(this[0]){E(this[0]).before(e=E(e));for(var t;(t=e.children()).length;)e=t.first();E(e).append(this)}return this},wrapInner:function(e){var r=t(e);return this.each((function(t){var n=E(this),i=n.contents(),a=r?e.call(this,t):e;i.length?i.wrapAll(a):n.append(a)}))},unwrap:function(){return this.parent().each((function(){E(this).replaceWith(E(this).children())})),this},clone:function(){return this.map((function(){return this.cloneNode(!0)}))},hide:function(){return this.css("display","none")},toggle:function(e){return this.each((function(){var t=E(this);(e===A?"none"==t.css("display"):e)?t.show():t.hide()}))},prev:function(e){return E(this.pluck("previousElementSibling")).filter(e||"*")},next:function(e){return E(this.pluck("nextElementSibling")).filter(e||"*")},html:function(e){return 0 in arguments?this.each((function(t){var r=this.innerHTML;E(this).empty().append(g(this,e,t,r))})):0 in this?this[0].innerHTML:null},text:function(e){return 0 in arguments?this.each((function(t){var r=g(this,e,t,this.textContent);this.textContent=null==r?"":""+r})):0 in this?this[0].textContent:null},attr:function(e,t){var r;return"string"!=typeof e||1 in arguments?this.each((function(r){if(1===this.nodeType)if(a(e))for(b in e)v(this,b,e[b]);else v(this,e,g(this,t,r,this.getAttribute(e)))})):this.length&&1===this[0].nodeType?!(r=this[0].getAttribute(e))&&e in this[0]?this[0][e]:r:A},removeAttr:function(e){return this.each((function(){1===this.nodeType&&e.split(" ").forEach((function(e){v(this,e)}),this)}))},prop:function(e,t){return e=W[e]||e,1 in arguments?this.each((function(r){this[e]=g(this,t,r,this[e])})):this[0]&&this[0][e]},data:function(e,t){var r="data-"+e.replace(B,"-$1").toLowerCase(),n=1 in arguments?this.attr(r,t):this.attr(r);return null!==n?m(n):A},val:function(e){return 0 in arguments?this.each((function(t){this.value=g(this,e,t,this.value)})):this[0]&&(this[0].multiple?E(this[0]).find("option").filter((function(){return this.selected})).pluck("value"):this[0].value)},offset:function(e){if(e)return this.each((function(t){var r=E(this),n=g(this,e,t,r.offset()),i=r.offsetParent().offset(),a={top:n.top-i.top,left:n.left-i.left};"static"==r.css("position")&&(a.position="relative"),r.css(a)}));if(!this.length)return null;if(!E.contains(I.documentElement,this[0]))return{top:0,left:0};var t=this[0].getBoundingClientRect();return{left:t.left+window.pageXOffset,top:t.top+window.pageYOffset,width:Math.round(t.width),height:Math.round(t.height)}},css:function(t,r){if(arguments.length<2){var n,i=this[0];if(!i)return;if(n=getComputedStyle(i,""),"string"==typeof t)return i.style[T(t)]||n.getPropertyValue(t);if(q(t)){var a={};return E.each(t,(function(e,t){a[t]=i.style[T(t)]||n.getPropertyValue(t)})),a}}var o="";if("string"==e(t))r||0===r?o=l(t)+":"+c(t,r):this.each((function(){this.style.removeProperty(l(t))}));else for(b in t)t[b]||0===t[b]?o+=l(b)+":"+c(b,t[b])+";":this.each((function(){this.style.removeProperty(l(b))}));return this.each((function(){this.style.cssText+=";"+o}))},index:function(e){return e?this.indexOf(E(e)[0]):this.parent().children().indexOf(this[0])},hasClass:function(e){return!!e&&w.some.call(this,(function(e){return this.test(y(e))}),u(e))},addClass:function(e){return e?this.each((function(t){if("className"in this){k=[];var r=y(this);g(this,e,t,r).split(/\s+/g).forEach((function(e){E(this).hasClass(e)||k.push(e)}),this),k.length&&y(this,r+(r?" ":"")+k.join(" "))}})):this},removeClass:function(e){return this.each((function(t){if("className"in this){if(e===A)return y(this,"");k=y(this),g(this,e,t,k).split(/\s+/g).forEach((function(e){k=k.replace(u(e)," ")})),y(this,k.trim())}}))},toggleClass:function(e,t){return e?this.each((function(r){var n=E(this);g(this,e,r,y(this)).split(/\s+/g).forEach((function(e){(t===A?!n.hasClass(e):t)?n.addClass(e):n.removeClass(e)}))})):this},scrollTop:function(e){if(this.length){var t="scrollTop"in this[0];return e===A?t?this[0].scrollTop:this[0].pageYOffset:this.each(t?function(){this.scrollTop=e}:function(){this.scrollTo(this.scrollX,e)})}},scrollLeft:function(e){if(this.length){var t="scrollLeft"in this[0];return e===A?t?this[0].scrollLeft:this[0].pageXOffset:this.each(t?function(){this.scrollLeft=e}:function(){this.scrollTo(e,this.scrollY)})}},position:function(){if(this.length){var e=this[0],t=this.offsetParent(),r=this.offset(),n=x.test(t[0].nodeName)?{top:0,left:0}:t.offset();return r.top-=parseFloat(E(e).css("margin-top"))||0,r.left-=parseFloat(E(e).css("margin-left"))||0,n.top+=parseFloat(E(t[0]).css("border-top-width"))||0,n.left+=parseFloat(E(t[0]).css("border-left-width"))||0,{top:r.top-n.top,left:r.left-n.left}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||I.body;e&&!x.test(e.nodeName)&&"static"==E(e).css("position");)e=e.offsetParent;return e}))}},E.fn.detach=E.fn.remove,["width","height"].forEach((function(e){var t=e.replace(/./,(function(e){return e[0].toUpperCase()}));E.fn[e]=function(r){var a,o=this[0];return r===A?n(o)?o["inner"+t]:i(o)?o.documentElement["scroll"+t]:(a=this.offset())&&a[e]:this.each((function(t){(o=E(this)).css(e,g(this,r,t,o[e]()))}))}})),["after","prepend","before","append"].forEach((function(t,r){var n=r%2;E.fn[t]=function(){var t,i,a=E.map(arguments,(function(r){return"object"==(t=e(r))||"array"==t||null==r?r:K.fragment(r)})),o=this.length>1;return a.length<1?this:this.each((function(e,t){i=n?t:t.parentNode,t=0==r?t.nextSibling:1==r?t.firstChild:2==r?t:null;var s=E.contains(I.documentElement,i);a.forEach((function(e){if(o)e=e.cloneNode(!0);else if(!i)return E(e).remove();i.insertBefore(e,t),s&&function e(t,r){r(t);for(var n=0,i=t.childNodes.length;i>n;n++)e(t.childNodes[n],r)}(e,(function(e){null==e.nodeName||"SCRIPT"!==e.nodeName.toUpperCase()||e.type&&"text/javascript"!==e.type||e.src||window.eval.call(window,e.innerHTML)}))}))}))},E.fn[n?t+"To":"insert"+(r?"Before":"After")]=function(e){return E(e)[t](this),this}})),K.Z.prototype=d.prototype=E.fn,K.uniq=S,K.deserializeValue=m,E.zepto=K,E}();window.Zepto=i,void 0===window.$&&(window.$=i),function(e){function t(e){return e._zid||(e._zid=f++)}function r(e,r,i,a){if((r=n(r)).ns)var o=function(e){return new RegExp("(?:^| )"+e.replace(" "," .* ?")+"(?: |$)")}(r.ns);return(g[t(e)]||[]).filter((function(e){return!(!e||r.e&&e.e!=r.e||r.ns&&!o.test(e.ns)||i&&t(e.fn)!==t(i)||a&&e.sel!=a)}))}function n(e){var t=(""+e).split(".");return{e:t[0],ns:t.slice(1).sort().join(" ")}}function i(e,t){return e.del&&!y&&e.e in m||!!t}function a(e){return A[e]||y&&m[e]||e}function o(r,o,s,u,f,d,h){var p=t(r),v=g[p]||(g[p]=[]);o.split(/\s/).forEach((function(t){if("ready"==t)return e(document).ready(s);var o=n(t);o.fn=s,o.sel=f,o.e in A&&(s=function(t){var r=t.relatedTarget;return!r||r!==this&&!e.contains(this,r)?o.fn.apply(this,arguments):void 0}),o.del=d;var p=d||s;o.proxy=function(e){if(!(e=l(e)).isImmediatePropagationStopped()){e.data=u;var t=p.apply(r,e._args==c?[e]:[e].concat(e._args));return!1===t&&(e.preventDefault(),e.stopPropagation()),t}},o.i=v.length,v.push(o),"addEventListener"in r&&r.addEventListener(a(o.e),o.proxy,i(o,h))}))}function s(e,n,o,s,l){var u=t(e);(n||"").split(/\s/).forEach((function(t){r(e,t,o,s).forEach((function(t){delete g[u][t.i],"removeEventListener"in e&&e.removeEventListener(a(t.e),t.proxy,i(t,l))}))}))}function l(t,r){return(r||!t.isDefaultPrevented)&&(r||(r=t),e.each(T,(function(e,n){var i=r[e];t[e]=function(){return this[n]=b,i&&i.apply(r,arguments)},t[n]=E})),(r.defaultPrevented!==c?r.defaultPrevented:"returnValue"in r?!1===r.returnValue:r.getPreventDefault&&r.getPreventDefault())&&(t.isDefaultPrevented=b)),t}function u(e){var t,r={originalEvent:e};for(t in e)k.test(t)||e[t]===c||(r[t]=e[t]);return l(r,e)}var c,f=1,d=Array.prototype.slice,h=e.isFunction,p=function(e){return"string"==typeof e},g={},v={},y="onfocusin"in window,m={focus:"focusin",blur:"focusout"},A={mouseenter:"mouseover",mouseleave:"mouseout"};v.click=v.mousedown=v.mouseup=v.mousemove="MouseEvents",e.event={add:o,remove:s},e.proxy=function(r,n){var i=2 in arguments&&d.call(arguments,2);if(h(r)){var a=function(){return r.apply(n,i?i.concat(d.call(arguments)):arguments)};return a._zid=t(r),a}if(p(n))return i?(i.unshift(r[n],r),e.proxy.apply(null,i)):e.proxy(r[n],r);throw new TypeError("expected function")},e.fn.bind=function(e,t,r){return this.on(e,t,r)},e.fn.unbind=function(e,t){return this.off(e,t)},e.fn.one=function(e,t,r,n){return this.on(e,t,r,n,1)};var b=function(){return!0},E=function(){return!1},k=/^([A-Z]|returnValue$|layer[XY]$)/,T={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};e.fn.delegate=function(e,t,r){return this.on(t,e,r)},e.fn.undelegate=function(e,t,r){return this.off(t,e,r)},e.fn.live=function(t,r){return e(document.body).delegate(this.selector,t,r),this},e.fn.die=function(t,r){return e(document.body).undelegate(this.selector,t,r),this},e.fn.on=function(t,r,n,i,a){var l,f,g=this;return t&&!p(t)?(e.each(t,(function(e,t){g.on(e,r,n,t,a)})),g):(p(r)||h(i)||!1===i||(i=n,n=r,r=c),(i===c||!1===n)&&(i=n,n=c),!1===i&&(i=E),g.each((function(c,h){a&&(l=function(e){return s(h,e.type,i),i.apply(this,arguments)}),r&&(f=function(t){var n,a=e(t.target).closest(r,h).get(0);return a&&a!==h?(n=e.extend(u(t),{currentTarget:a,liveFired:h}),(l||i).apply(a,[n].concat(d.call(arguments,1)))):void 0}),o(h,t,i,n,r,f||l)})))},e.fn.off=function(t,r,n){var i=this;return t&&!p(t)?(e.each(t,(function(e,t){i.off(e,r,t)})),i):(p(r)||h(n)||!1===n||(n=r,r=c),!1===n&&(n=E),i.each((function(){s(this,t,n,r)})))},e.fn.trigger=function(t,r){return(t=p(t)||e.isPlainObject(t)?e.Event(t):l(t))._args=r,this.each((function(){t.type in m&&"function"==typeof this[t.type]?this[t.type]():"dispatchEvent"in this?this.dispatchEvent(t):e(this).triggerHandler(t,r)}))},e.fn.triggerHandler=function(t,n){var i,a;return this.each((function(o,s){(i=u(p(t)?e.Event(t):t))._args=n,i.target=s,e.each(r(s,t.type||t),(function(e,t){return a=t.proxy(i),!i.isImmediatePropagationStopped()&&void 0}))})),a},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach((function(t){e.fn[t]=function(e){return 0 in arguments?this.bind(t,e):this.trigger(t)}})),e.Event=function(e,t){p(e)||(e=(t=e).type);var r=document.createEvent(v[e]||"Events"),n=!0;if(t)for(var i in t)"bubbles"==i?n=!!t[i]:r[i]=t[i];return r.initEvent(e,n,!0),l(r)}}(i),function(e){function t(t,r,n){var i=e.Event(r);return e(t).trigger(i,n),!i.isDefaultPrevented()}function r(e,r,n,i){return e.global?t(r||v,n,i):void 0}function n(t){t.global&&0==e.active++&&r(t,null,"ajaxStart")}function i(t){t.global&&!--e.active&&r(t,null,"ajaxStop")}function a(e,t){var n=t.context;return!1!==t.beforeSend.call(n,e,t)&&!1!==r(t,n,"ajaxBeforeSend",[e,t])&&void r(t,n,"ajaxSend",[e,t])}function o(e,t,n,i){var a=n.context,o="success";n.success.call(a,e,o,t),i&&i.resolveWith(a,[e,o,t]),r(n,a,"ajaxSuccess",[t,n,e]),l(o,t,n)}function s(e,t,n,i,a){var o=i.context;i.error.call(o,n,t,e),a&&a.rejectWith(o,[n,t,e]),r(i,o,"ajaxError",[n,i,e||t]),l(t,n,i)}function l(e,t,n){var a=n.context;n.complete.call(a,t,e),r(n,a,"ajaxComplete",[t,n]),i(n)}function u(){}function c(e){return e&&(e=e.split(";",2)[0]),e&&(e==E?"html":e==b?"json":m.test(e)?"script":A.test(e)&&"xml")||"text"}function f(e,t){return""==t?e:(e+"&"+t).replace(/[&?]{1,2}/,"?")}function d(t,r,n,i){return e.isFunction(r)&&(i=n,n=r,r=void 0),e.isFunction(n)||(i=n,n=void 0),{url:t,data:r,success:n,dataType:i}}var h,p,g=0,v=window.document,y=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,m=/^(?:text|application)\/javascript/i,A=/^(?:text|application)\/xml/i,b="application/json",E="text/html",k=/^\s*$/,T=v.createElement("a");T.href=window.location.href,e.active=0,e.ajaxJSONP=function(t,r){if(!("type"in t))return e.ajax(t);var n,i,l=t.jsonpCallback,u=(e.isFunction(l)?l():l)||"jsonp"+ ++g,c=v.createElement("script"),f=window[u],d=function(t){e(c).triggerHandler("error",t||"abort")},h={abort:d};return r&&r.promise(h),e(c).on("load error",(function(a,l){clearTimeout(i),e(c).off().remove(),"error"!=a.type&&n?o(n[0],h,t,r):s(null,l||"error",h,t,r),window[u]=f,n&&e.isFunction(f)&&f(n[0]),f=n=void 0})),!1===a(h,t)?(d("abort"),h):(window[u]=function(){n=arguments},c.src=t.url.replace(/\?(.+)=\?/,"?$1="+u),v.head.appendChild(c),t.timeout>0&&(i=setTimeout((function(){d("timeout")}),t.timeout)),h)},e.ajaxSettings={type:"GET",beforeSend:u,success:u,error:u,complete:u,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:b,xml:"application/xml, text/xml",html:E,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},e.ajax=function(t){var r,i,l=e.extend({},t||{}),d=e.Deferred&&e.Deferred();for(h in e.ajaxSettings)void 0===l[h]&&(l[h]=e.ajaxSettings[h]);n(l),l.crossDomain||((r=v.createElement("a")).href=l.url,r.href=r.href,l.crossDomain=T.protocol+"//"+T.host!=r.protocol+"//"+r.host),l.url||(l.url=window.location.toString()),(i=l.url.indexOf("#"))>-1&&(l.url=l.url.slice(0,i)),function(t){t.processData&&t.data&&"string"!=e.type(t.data)&&(t.data=e.param(t.data,t.traditional)),!t.data||t.type&&"GET"!=t.type.toUpperCase()||(t.url=f(t.url,t.data),t.data=void 0)}(l);var g=l.dataType,y=/\?.+=\?/.test(l.url);if(y&&(g="jsonp"),!1!==l.cache&&(t&&!0===t.cache||"script"!=g&&"jsonp"!=g)||(l.url=f(l.url,"_="+Date.now())),"jsonp"==g)return y||(l.url=f(l.url,l.jsonp?l.jsonp+"=?":!1===l.jsonp?"":"callback=?")),e.ajaxJSONP(l,d);var m,A=l.accepts[g],b={},E=function(e,t){b[e.toLowerCase()]=[e,t]},S=/^([\w-]+:)\/\//.test(l.url)?RegExp.$1:window.location.protocol,w=l.xhr(),_=w.setRequestHeader;if(d&&d.promise(w),l.crossDomain||E("X-Requested-With","XMLHttpRequest"),E("Accept",A||"*/*"),(A=l.mimeType||A)&&(A.indexOf(",")>-1&&(A=A.split(",",2)[0]),w.overrideMimeType&&w.overrideMimeType(A)),(l.contentType||!1!==l.contentType&&l.data&&"GET"!=l.type.toUpperCase())&&E("Content-Type",l.contentType||"application/x-www-form-urlencoded"),l.headers)for(p in l.headers)E(p,l.headers[p]);if(w.setRequestHeader=E,w.onreadystatechange=function(){if(4==w.readyState){w.onreadystatechange=u,clearTimeout(m);var t,r=!1;if(w.status>=200&&w.status<300||304==w.status||0==w.status&&"file:"==S){g=g||c(l.mimeType||w.getResponseHeader("content-type")),t=w.responseText;try{"script"==g?(0,eval)(t):"xml"==g?t=w.responseXML:"json"==g&&(t=k.test(t)?null:e.parseJSON(t))}catch(e){r=e}r?s(r,"parsererror",w,l,d):o(t,w,l,d)}else s(w.statusText||null,w.status?"error":"abort",w,l,d)}},!1===a(w,l))return w.abort(),s(null,"abort",w,l,d),w;if(l.xhrFields)for(p in l.xhrFields)w[p]=l.xhrFields[p];var L=!("async"in l)||l.async;for(p in w.open(l.type,l.url,L,l.username,l.password),b)_.apply(w,b[p]);return l.timeout>0&&(m=setTimeout((function(){w.onreadystatechange=u,w.abort(),s(null,"timeout",w,l,d)}),l.timeout)),w.send(l.data?l.data:null),w},e.get=function(){return e.ajax(d.apply(null,arguments))},e.post=function(){var t=d.apply(null,arguments);return t.type="POST",e.ajax(t)},e.getJSON=function(){var t=d.apply(null,arguments);return t.dataType="json",e.ajax(t)},e.fn.load=function(t,r,n){if(!this.length)return this;var i,a=this,o=t.split(/\s/),s=d(t,r,n),l=s.success;return o.length>1&&(s.url=o[0],i=o[1]),s.success=function(t){a.html(i?e("<div>").html(t.replace(y,"")).find(i):t),l&&l.apply(a,arguments)},e.ajax(s),this};var S=encodeURIComponent;e.param=function(t,r){var n=[];return n.add=function(t,r){e.isFunction(r)&&(r=r()),null==r&&(r=""),this.push(S(t)+"="+S(r))},function t(r,n,i,a){var o,s=e.isArray(n),l=e.isPlainObject(n);e.each(n,(function(n,u){o=e.type(u),a&&(n=i?a:a+"["+(l||"object"==o||"array"==o?n:"")+"]"),!a&&s?r.add(u.name,u.value):"array"==o||!i&&"object"==o?t(r,u,i,n):r.add(n,u)}))}(n,t,r),n.join("&").replace(/%20/g,"+")}}(i),(n=i).Callbacks=function(e){e=n.extend({},e);var t,r,i,a,o,s,l=[],u=!e.once&&[],c=function n(c){for(t=e.memory&&c,r=!0,s=a||0,a=0,o=l.length,i=!0;l&&o>s;++s)if(!1===l[s].apply(c[0],c[1])&&e.stopOnFalse){t=!1;break}i=!1,l&&(u?u.length&&n(u.shift()):t?l.length=0:f.disable())},f={add:function(){if(l){var r=l.length;(function t(r){n.each(r,(function(r,n){"function"==typeof n?e.unique&&f.has(n)||l.push(n):n&&n.length&&"string"!=typeof n&&t(n)}))})(arguments),i?o=l.length:t&&(a=r,c(t))}return this},remove:function(){return l&&n.each(arguments,(function(e,t){for(var r;(r=n.inArray(t,l,r))>-1;)l.splice(r,1),i&&(o>=r&&--o,s>=r&&--s)})),this},has:function(e){return!(!l||!(e?n.inArray(e,l)>-1:l.length))},empty:function(){return o=l.length=0,this},disable:function(){return l=u=t=void 0,this},disabled:function(){return!l},lock:function(){return u=void 0,t||f.disable(),this},locked:function(){return!u},fireWith:function(e,t){return!l||r&&!u||(t=[e,(t=t||[]).slice?t.slice():t],i?u.push(t):c(t)),this},fire:function(){return f.fireWith(this,arguments)},fired:function(){return!!r}};return f},function(e){function t(r){var n=[["resolve","done",e.Callbacks({once:1,memory:1}),"resolved"],["reject","fail",e.Callbacks({once:1,memory:1}),"rejected"],["notify","progress",e.Callbacks({memory:1})]],i="pending",a={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var r=arguments;return t((function(t){e.each(n,(function(n,i){var s=e.isFunction(r[n])&&r[n];o[i[1]]((function(){var r=s&&s.apply(this,arguments);if(r&&e.isFunction(r.promise))r.promise().done(t.resolve).fail(t.reject).progress(t.notify);else{var n=this===a?t.promise():this,o=s?[r]:arguments;t[i[0]+"With"](n,o)}}))})),r=null})).promise()},promise:function(t){return null!=t?e.extend(t,a):a}},o={};return e.each(n,(function(e,t){var r=t[2],s=t[3];a[t[1]]=r.add,s&&r.add((function(){i=s}),n[1^e][2].disable,n[2][2].lock),o[t[0]]=function(){return o[t[0]+"With"](this===o?a:this,arguments),this},o[t[0]+"With"]=r.fireWith})),a.promise(o),r&&r.call(o,o),o}var r=Array.prototype.slice;e.when=function(n){var i,a,o,s=r.call(arguments),l=s.length,u=0,c=1!==l||n&&e.isFunction(n.promise)?l:0,f=1===c?n:t(),d=function(e,t,n){return function(a){t[e]=this,n[e]=arguments.length>1?r.call(arguments):a,n===i?f.notifyWith(t,n):--c||f.resolveWith(t,n)}};if(l>1)for(i=new Array(l),a=new Array(l),o=new Array(l);l>u;++u)s[u]&&e.isFunction(s[u].promise)?s[u].promise().done(d(u,o,s)).fail(f.reject).progress(d(u,a,i)):--c;return c||f.resolveWith(o,s),f.promise()},e.Deferred=t}(i),function(e){function t(){u=null,f.last&&(f.el.trigger("longTap"),f={})}function r(){u&&clearTimeout(u),u=null}function n(){o&&clearTimeout(o),s&&clearTimeout(s),l&&clearTimeout(l),u&&clearTimeout(u),o=s=l=u=null,f={}}function i(e){return("touch"==e.pointerType||e.pointerType==e.MSPOINTER_TYPE_TOUCH)&&e.isPrimary}function a(e,t){return e.type=="pointer"+t||e.type.toLowerCase()=="mspointer"+t}var o,s,l,u,c,f={};e(document).ready((function(){var d,h,p,g,v=0,y=0;"MSGesture"in window&&((c=new MSGesture).target=document.body),e(document).bind("MSGestureEnd",(function(e){var t=e.velocityX>1?"Right":e.velocityX<-1?"Left":e.velocityY>1?"Down":e.velocityY<-1?"Up":null;t&&(f&&f.el&&f.el.trigger("swipe"),f&&f.el&&f.el.trigger("swipe"+t))})).on("touchstart MSPointerDown pointerdown",(function(r){(!(g=a(r,"down"))||i(r))&&(p=g?r:r.touches[0],r.touches&&1===r.touches.length&&f.x2&&(f.x2=void 0,f.y2=void 0),d=Date.now(),h=d-(f.last||d),f.el=e("tagName"in p.target?p.target:p.target.parentNode),o&&clearTimeout(o),f.x1=p.pageX,f.y1=p.pageY,h>0&&250>=h&&(f.isDoubleTap=!0),f.last=d,u=setTimeout(t,750),c&&g&&c.addPointer(r.pointerId))})).on("touchmove MSPointerMove pointermove",(function(e){(!(g=a(e,"move"))||i(e))&&(p=g?e:e.touches[0],r(),f.x2=p.pageX,f.y2=p.pageY,v+=Math.abs(f.x1-f.x2),y+=Math.abs(f.y1-f.y2))})).on("touchend MSPointerUp pointerup",(function(t){(!(g=a(t,"up"))||i(t))&&(r(),f.x2&&Math.abs(f.x1-f.x2)>30||f.y2&&Math.abs(f.y1-f.y2)>30?l=setTimeout((function(){f&&f.el&&f.el.trigger("swipe"),f&&f.el&&f.el.trigger("swipe"+function(e,t,r,n){return Math.abs(e-t)>=Math.abs(r-n)?e-t>0?"Left":"Right":r-n>0?"Up":"Down"}(f.x1,f.x2,f.y1,f.y2)),f={}}),0):"last"in f&&(30>v&&30>y?s=setTimeout((function(){var t=e.Event("tap");t.cancelTouch=n,f.el&&f.el.trigger(t),f.isDoubleTap?(f.el&&f.el.trigger("doubleTap"),f={}):o=setTimeout((function(){o=null,f.el&&f.el.trigger("singleTap"),f={}}),250)}),0):f={}),v=y=0)})).on("touchcancel MSPointerCancel pointercancel",n),e(window).on("scroll",n)})),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach((function(t){e.fn[t]=function(e){return this.on(t,e)}}))}(i),function(e){function t(t){return!(!(t=e(t)).width()&&!t.height())&&"none"!==t.css("display")}function r(e,t){e=e.replace(/=#\]/g,'="#"]');var r,n,i=s.exec(e);if(i&&i[2]in o&&(r=o[i[2]],n=i[3],e=i[1],n)){var a=Number(n);n=isNaN(a)?n.replace(/^["']|["']$/g,""):a}return t(e,r,n)}var n=e.zepto,i=n.qsa,a=n.matches,o=e.expr[":"]={visible:function(){return t(this)?this:void 0},hidden:function(){return t(this)?void 0:this},selected:function(){return this.selected?this:void 0},checked:function(){return this.checked?this:void 0},parent:function(){return this.parentNode},first:function(e){return 0===e?this:void 0},last:function(e,t){return e===t.length-1?this:void 0},eq:function(e,t,r){return e===r?this:void 0},contains:function(t,r,n){return e(this).text().indexOf(n)>-1?this:void 0},has:function(e,t,r){return n.qsa(this,r).length?this:void 0}},s=new RegExp("(.*):(\\w+)(?:\\(([^)]+)\\))?$\\s*"),l=/^\s*>/,u="Zepto"+ +new Date;n.qsa=function(t,a){return r(a,(function(r,o,s){try{var c;!r&&o?r="*":l.test(r)&&(c=e(t).addClass(u),r="."+u+" "+r);var f=i(t,r)}catch(e){throw console.error("error performing selector: %o",a),e}finally{c&&c.removeClass(u)}return o?n.uniq(e.map(f,(function(e,t){return o.call(e,t,f,s)}))):f}))},n.matches=function(e,t){return r(t,(function(t,r,n){return!(t&&!a(e,t)||r&&r.call(e,null,n)!==e)}))}}(i),function(){try{getComputedStyle(void 0)}catch(t){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(e){return null}}}}(),e.exports=i},function(e,t,r){"use strict";var n=r(8);function i(){}var a={},o=["REJECTED"],s=["FULFILLED"],l=["PENDING"];function u(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==i&&h(this,e)}function c(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(e,t,r){n((function(){var n;try{n=t(r)}catch(t){return a.reject(e,t)}n===e?a.reject(e,new TypeError("Cannot resolve promise with itself")):a.resolve(e,n)}))}function d(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function h(e,t){var r=!1;function n(t){r||(r=!0,a.reject(e,t))}function i(t){r||(r=!0,a.resolve(e,t))}var o=p((function(){t(i,n)}));"error"===o.status&&n(o.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}e.exports=u,u.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(r){return t.resolve(e()).then((function(){return r}))}),(function(r){return t.resolve(e()).then((function(){throw r}))}))},u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){if("function"!=typeof e&&this.state===s||"function"!=typeof t&&this.state===o)return this;var r=new this.constructor(i);return this.state!==l?f(r,this.state===s?e:t,this.outcome):this.queue.push(new c(r,e,t)),r},c.prototype.callFulfilled=function(e){a.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){a.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},a.resolve=function(e,t){var r=p(d,t);if("error"===r.status)return a.reject(e,r.value);var n=r.value;if(n)h(e,n);else{e.state=s,e.outcome=t;for(var i=-1,o=e.queue.length;++i<o;)e.queue[i].callFulfilled(t)}return e},a.reject=function(e,t){e.state=o,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},u.resolve=function(e){return e instanceof this?e:a.resolve(new this(i),e)},u.reject=function(e){var t=new this(i);return a.reject(t,e)},u.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,l=-1,u=new this(i);++l<r;)c(e[l],l);return u;function c(e,i){t.resolve(e).then((function(e){o[i]=e,++s!==r||n||(n=!0,a.resolve(u,o))}),(function(e){n||(n=!0,a.reject(u,e))}))}},u.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var t=e.length,r=!1;if(!t)return this.resolve([]);for(var n,o=-1,s=new this(i);++o<t;)n=e[o],this.resolve(n).then((function(e){r||(r=!0,a.resolve(s,e))}),(function(e){r||(r=!0,a.reject(s,e))}));return s}},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){window,e.exports=function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=20)}([function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",n=e[3];if(!n)return r;if(t&&"function"==typeof btoa){var i=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(n),a=n.sources.map((function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"}));return[r].concat(a).concat([i]).join("\n")}return[r].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+r+"}":r})).join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(n[a]=!0)}for(i=0;i<e.length;i++){var o=e[i];"number"==typeof o[0]&&n[o[0]]||(r&&!o[2]?o[2]=r:r&&(o[2]="("+o[2]+") and ("+r+")"),t.push(o))}},t}},function(e,t,r){var n={},i=function(e){var t;return function(){return void 0===t&&(t=function(){return window&&document&&document.all&&!window.atob}.apply(this,arguments)),t}}(),a=function(e){var t={};return function(e,r){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,r);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),o=null,s=0,l=[],u=r(58);function c(e,t){for(var r=0;r<e.length;r++){var i=e[r],a=n[i.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](i.parts[o]);for(;o<i.parts.length;o++)a.parts.push(v(i.parts[o],t))}else{var s=[];for(o=0;o<i.parts.length;o++)s.push(v(i.parts[o],t));n[i.id]={id:i.id,refs:1,parts:s}}}}function f(e,t){for(var r=[],n={},i=0;i<e.length;i++){var a=e[i],o=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};n[o]?n[o].parts.push(s):r.push(n[o]={id:o,parts:[s]})}return r}function d(e,t){var r=a(e.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===e.insertAt)n?n.nextSibling?r.insertBefore(t,n.nextSibling):r.appendChild(t):r.insertBefore(t,r.firstChild),l.push(t);else if("bottom"===e.insertAt)r.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=a(e.insertAt.before,r);r.insertBefore(t,i)}}function h(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function p(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var n=r.nc;n&&(e.attrs.nonce=n)}return g(t,e.attrs),d(e,t),t}function g(e,t){Object.keys(t).forEach((function(r){e.setAttribute(r,t[r])}))}function v(e,t){var r,n,i,a;if(t.transform&&e.css){if(!(a=t.transform(e.css)))return function(){};e.css=a}if(t.singleton){var l=s++;r=o||(o=p(t)),n=m.bind(null,r,l,!1),i=m.bind(null,r,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),d(e,t),t}(t),n=function(e,t,r){var n=r.css,i=r.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(n=u(n)),i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([n],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,r,t),i=function(){h(r),r.href&&URL.revokeObjectURL(r.href)}):(r=p(t),n=function(e,t){var r=t.css,n=t.media;if(n&&e.setAttribute("media",n),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){h(r)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var r=f(e,t);return c(r,t),function(e){for(var i=[],a=0;a<r.length;a++){var o=r[a];(s=n[o.id]).refs--,i.push(s)}for(e&&c(f(e,t),t),a=0;a<i.length;a++){var s;if(0===(s=i[a]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete n[s.id]}}}};var y=function(){var e=[];return function(t,r){return e[t]=r,e.filter(Boolean).join("\n")}}();function m(e,t,r,n){var i=r?"":n.css;if(e.styleSheet)e.styleSheet.cssText=y(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}},function(e,t){e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t||{}}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"name",get:function(){return this.constructor.name}},{key:"tagName",get:function(){return this.options.tagName||"div"}},{key:"attributes",get:function(){return{class:this.options.className}}},{key:"attr",value:function(e,t){if(void 0===t)return this.element.getAttribute(e);this.element.setAttribute(e,t)}},{key:"show",value:function(){this.removeClass("ad_runner_ui_hide")}},{key:"hide",value:function(){this.addClass("ad_runner_ui_hide")}},{key:"on",value:function(e,t){this.element.addEventListener(e,t)}},{key:"off",value:function(e,t){this.element.removeEventListener(e,t)}},{key:"html",value:function(e){this.element.innerHTML=e}},{key:"style",value:function(e,t){this.element.style[e]=t}},{key:"appendChild",value:function(e){this.element.appendChild(e.element||e)}},{key:"hasClass",value:function(e){return this.element.classList?this.element.classList.contains(e):new RegExp("(^|\\s)"+e+"($|\\s)").test(this.element.className)}},{key:"addClass",value:function(e){this.element.classList?this.element.classList.add(e):this.hasClass(this.element,e)||(this.element.className=(this.element.className+" "+e).trim())}},{key:"removeClass",value:function(e){this.element.classList?this.element.classList.remove(e):this.element.className=this.element.className.split(/\s+/).filter((function(t){return t!==e})).join(" ")}},{key:"render",value:function(){var e=this;this.element=this.options.element||document.createElement(this.tagName),Object.keys(this.attributes).forEach((function(t){var r=e.attributes[t];void 0!==r&&e.element.setAttribute(t,r)}))}},{key:"remove",value:function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element),this.element=null}}]),e}()},function(e,t,r){var n=r(5).DEFAULT_MAX_VOLUME;function i(e,t){return String(e).toUpperCase().indexOf(String(t).toUpperCase())>-1}function a(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}e.exports={contentVolumeToAdVolume:function(e){return e?e/100*n:0},convertToSecond:function(e){var t=isNaN(e)?e.split(":"):e;return 60*+t[0]*60+60*+t[1]+ +t[2]},isImaAd:function(e){return!i(e.system.name,"celtra")&&(i(e.system.name,"google")||i(e.system.version,"google")||i(e.system.name,"gamma"))},isFacebookAd:function(e){return i(e.system.name,"facebook")||i(e.system.version,"facebook")},isAsiaSmartAd:function(e){return e.vastAdTagURI&&i(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||i(e.system.name,"smart")||i(e.system.name,"wootag")},isYomediaAd:function(e){return i(e.system.name,"yomedia")},formatTime:function(e,t){if(!isFinite(e))return"--:--";e*=1e3;var r=(e=parseInt(e/1e3))%60,n=(e=parseInt(e/60))%60,i=(e=parseInt(e/60))%24,a=parseInt(e/24),o="";return a&&a>0&&(o+=a+":",i<1&&(o+="00:")),(i&&i>0||t)&&(o+=("0"+i).slice(-2)+":"),o+=("0"+n).slice(-2)+":",(o+=("0"+r).slice(-2)).trim()},createPromiseDefer:a,createTimeoutPromise:function(e){var t=a(),r=setTimeout(t.resolve,e);return t.promise.cancel=function(){return clearTimeout(r)},t.promise},isMobile:function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Opera Mini/i.test(navigator.userAgent)}}},function(e,t,r){"use strict";var n=["AdLoaded","AdStarted","AdStopped","AdSkipped","AdSkippableStateChange","AdSizeChange","AdLinearChange","AdDurationChange","AdExpandedChange","AdRemainingTimeChange","AdVolumeChange","AdImpression","AdViewableImpression","AdVideoStart","AdVideoFirstQuartile","AdVideoMidpoint","AdVideoThirdQuartile","AdVideoProgress","AdVideoComplete","AdClickThru","AdInteraction","AdUserAcceptInvitation","AdUserMinimize","AdUserClose","AdPaused","AdPlaying","AdLog","AdError","AdClickBackground","AdClickThruVpaid"];n.forEach((function(e){n[e]=e})),Object.freeze(n),e.exports=n},function(e,t){e.exports={AD_POSITION:{preroll:"pre-roll",midroll:"mid-roll",postroll:"post-roll"},AD_DONE_REASON:{timeout:"timeout",error:"error",ended:"ended",skipped:"skipped"},COUNT_DOWN_DURATION:5,PRELOAD_DURATION:7,DEFAULT_MIDROLL_START_TIME:10,DEFAULT_SKIP_TIMEOUT:3,DEFAULT_AD_START_TIMEOUT:10,DEFAULT_NON_LINEAR_DURATION:15,DEFAULT_MAX_VOLUME:.75}},function(e,t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(e){return"function"==typeof e}function a(e){return"object"===r(e)&&null!==e}function o(e){return void 0===e}n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,r,n,s,l,u;if(this._events||(this._events={}),"error"===e&&(!this._events.error||a(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}if(o(r=this._events[e]))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:s=Array.prototype.slice.call(arguments,1),r.apply(this,s)}else if(a(r))for(s=Array.prototype.slice.call(arguments,1),n=(u=r.slice()).length,l=0;l<n;l++)u[l].apply(this,s);return!0},n.prototype.addListener=function(e,t){var r;if(!i(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,i(t.listener)?t.listener:t),this._events[e]?a(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,a(this._events[e])&&!this._events[e].warned&&(r=o(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!i(t))throw TypeError("listener must be a function");var r=!1;function n(){this.removeListener(e,n),r||(r=!0,t.apply(this,arguments))}return n.listener=t,this.on(e,n),this},n.prototype.removeListener=function(e,t){var r,n,o,s;if(!i(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(o=(r=this._events[e]).length,n=-1,r===t||i(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(a(r)){for(s=o;s-- >0;)if(r[s]===t||r[s].listener&&r[s].listener===t){n=s;break}if(n<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(i(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?i(this._events[e])?[this._events[e]]:this._events[e].slice():[]},e.exports=n},function(e,t,r){e.exports={VastPlayer:r(22),VAST:r(8),EventEmitter:r(6)}},function(e,t,r){e.exports=r(23)},function(e,t,r){"use strict";var n=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"];n.forEach((function(e){this[e.toUpperCase()]=e}),n),Object.freeze(n),e.exports=n},function(e,t,r){"use strict";var n=r(15),i=document.createElement("video");r(14),t.isDesktop=!/Android|Silk|Mobile|PlayBook/.test(n.navigator.userAgent),t.canPlay=function(e){switch(i.canPlayType(e)){case"probably":return 2;case"maybe":return 1;default:return 0}},Object.freeze(t)},function(e,t,r){"use strict";function n(e,t,r){t.on(e,(function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];r.emit.apply(r,[e].concat(t))}))}function i(e,t,r){r.forEach((function(r){t.listeners(r).length>0&&n(r,e,t)})),t.on("newListener",(function(i){r.indexOf(i)>-1&&t.listeners(i).length<1&&n(i,e,t)}))}function a(e){this.events=e.slice(),this.__private__={target:null,source:null}}a.prototype.from=function(e){return this.__private__.source=e,this.__private__.target&&i(e,this.__private__.target,this.events),this},a.prototype.to=function(e){return this.__private__.target=e,this.__private__.source&&i(this.__private__.source,e,this.events),this},e.exports=a},function(e,t){e.exports=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.adContainerElement=t,this.videoContent=r,this.logger=n.logger,this.onAdStarted=n.onAdStarted,this.onAdStopped=n.onAdStopped,this.onAdLoaded=n.onAdLoaded,this.options=i,this.logger.debug(this.name,"initializing")}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!1}},{key:"viewDetailLink",get:function(){return""}},{key:"loadAd",value:function(e){throw new Error("this must be overridden")}},{key:"initUserAction",value:function(){throw new Error("this must be overridden")}},{key:"canRun",value:function(e){throw new Error("this must be overridden")}},{key:"start",value:function(){throw new Error("this must be overridden")}},{key:"stop",value:function(){throw new Error("this must be overridden")}},{key:"pause",value:function(){throw new Error("this must be overridden")}},{key:"resume",value:function(){throw new Error("this must be overridden")}},{key:"cancel",value:function(){throw new Error("this must be overridden")}},{key:"viewDetail",value:function(){throw new Error("this must be overridden")}},{key:"setVolume",value:function(e){throw new Error("this must be overridden")}},{key:"setAdData",value:function(e){this.adData=e}},{key:"getVolume",value:function(){throw new Error("this must be overridden")}},{key:"isPaused",value:function(){throw new Error("this must be overridden")}},{key:"getRemainingTime",value:function(){throw new Error("this must be overridden")}},{key:"getDuration",value:function(){throw new Error("this must be overridden")}},{key:"getSkipOffset",value:function(){throw new Error("this must be overridden")}},{key:"resize",value:function(e,t,r){}},{key:"destroy",value:function(){throw new Error("this must be overridden")}}]),e}()},function(e,t,r){"use strict";e.exports=function(){return Array.prototype.slice.call(arguments).reduce((function(e,t){return Object.keys(t||{}).reduce((function(e,r){return e[r]=t[r],e}),e)}),{})}},function(e,t){var r={JAVASCRIPT:"application/javascript",FLASH:"application/x-shockwave-flash"};Object.freeze(r),e.exports=r},function(e,t){e.exports=window},function(e,t,r){"use strict";var n=r(40),i=r(9);function a(e,t){var r=this;n.call(this,Math.floor(e.duration||0),t),this.video=e,[i.PLAYING,i.PAUSE,i.TIMEUPDATE].forEach((function(t){return e.addEventListener(t,(function(){return r.tick()}),!1)}))}a.prototype=Object.create(n.prototype),a.prototype._getState=function(){return{playing:!this.video.paused,currentTime:this.video.currentTime}},e.exports=a},function(e,t){e.exports={getVpaidVendor:function(e){return/moatads\.com/.test(e[0].uri)?"MOAT":/yomedia\.vn/.test(e[0].uri)?"YOMEDIA":null},getUrlParam:function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t||(t=window.location.href),e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var n="[\\".concat(r?"#":"?","&]").concat(e,"=([^&#]*)"),i=new RegExp(n).exec(t);return null==i?null:decodeURIComponent(i[1])},httpGet:function(e){return new Promise((function(t,r){var n=new XMLHttpRequest;n.open("GET",e,!0),n.withCredentials=!0,n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200===n.status?t(n.responseText):r(new Error("unexpected status code or empty body: ".concat(n.status))))},n.send()}))},isURL:function(e){return!!new RegExp("^(https?:\\/\\/)?","i").test(e)}}},function(e,t,r){var n=r(46),i=r(52),a=r(53),o=[n,i,a],s=function(){},l=function(){function e(t){var r=this,n=t.linearAdContainer,i=t.nonLinearAdContainer,l=t.contentPlayer,u=t.logger,c=t.onAdStarted,f=t.onAdStopped,d=t.onAdSkipped,h=t.onAdLoaded,p=t.onResetState,g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=u,this.props={onAdStarted:c,onAdStopped:f,onAdSkipped:d,onAdLoaded:h||s,onResetState:p||s},this.loadPromise=null,this.currentPlayer=null,this.adData=null,this.adStarted=!1,this.adCancelled=!1,this.adVolume=1,this.lastError=null,this.players=o.map((function(e){return new e(e===a?i:n,l,{logger:u,onAdStarted:r._onAdStarted.bind(r),onAdStopped:r._onAdStopped.bind(r),onAdSkipped:r._onAdSkipped.bind(r),onAdLoaded:r._onAdLoaded.bind(r)},g)}))}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"name",get:function(){return"Player"}},{key:"initUserAction",value:function(){this.players.forEach((function(e){return e.initUserAction()}))}},{key:"load",value:function(e){return this.adData=e,this.adCancelled=!1,this.adStarted=!1,this.lastError=null,this.loadPromise=this._loadAd(),this.loadPromise}},{key:"start",value:function(){this._playAd()}},{key:"stop",value:function(){this.currentPlayer.stop()}},{key:"skip",value:function(){this.currentPlayer.skip()}},{key:"cancel",value:function(){this.adCancelled=!0,this.currentPlayer&&this.currentPlayer.cancel()}},{key:"pause",value:function(){this.currentPlayer.pause()}},{key:"resume",value:function(){this.currentPlayer.resume()}},{key:"destroy",value:function(){this.players.forEach((function(e){return e.destroy()}))}},{key:"resize",value:function(e,t,r){this.players.forEach((function(n){return n.resize(e,t,r)}))}},{key:"setVolume",value:function(e){this.adVolume=e,this.currentPlayer&&this.currentPlayer.setVolume(e)}},{key:"getCurrentPlayer",value:function(){return this.currentPlayer}},{key:"isPlayingLinearAd",value:function(){return this.currentPlayer instanceof n?this.currentPlayer.currentAd&&this.currentPlayer.currentAd.isLinear():!(this.currentPlayer instanceof a)}},{key:"isGoogleNonLinearAd",value:function(){return this.currentPlayer instanceof n&&this.currentPlayer.currentAd&&!this.currentPlayer.currentAd.isLinear()}},{key:"_onAdStarted",value:function(){this.adStarted=!0,this.props.onAdStarted()}},{key:"_onAdStopped",value:function(e,t,r,n){var i=n||this.adData;this.adStarted||r?this.props.onAdStopped(e,t,i):(this.lastError=e,this._playAd(this.adIndex+1))}},{key:"_onAdSkipped",value:function(){this.props.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.props.onAdLoaded()}},{key:"_loadAd",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this.logger.debug(this.name,"_loadAd | adIndex",t," | adData",this.adData.ads),this.adCancelled)return Promise.resolve();var r=this.adData.ads[t];if(this.currentPlayer=null,!r)return t>0&&this.logger.debug(this.name,"no ad left to load"),Promise.resolve();this.logger.debug(this.name,"loading ad item ".concat(t+1,"/").concat(this.adData.ads.length),r);var n=this._getPlayerForAd(r);return n?n.loadAd(r,this.adData).then((function(){return e.logger.debug(e.name,"ad loaded"),{player:n,adIndex:t}})).catch((function(r){return e.logger.error(e.name,"error while loading ad, falling back to next item:",r),e._loadAd(t+1)})):(this.logger.debug(this.name,"no player to play this ad, trying next item",r),this._loadAd(t+1))}},{key:"_playAd",value:function(){var e,t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.adCancelled||(this.loadPromise?(e=this.loadPromise,delete this.loadPromise):e=this._loadAd(r),e.then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.player,n=e.adIndex;t.adCancelled||(r?(t.adIndex=n,t.currentPlayer=r,r.setAdData(t.adData),r.setVolume(t.adVolume),r.start()):t._onAdStopped(t.lastError||new Error("Cannot run ad"),null,!0))})))}},{key:"_getPlayerForAd",value:function(e){return this.players.filter((function(t){return t.canRun(e)}))[0]}}]),e}();e.exports=l},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=r(2),s=r(3).formatTime;r(62),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(r,o);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=a(e);if(t){var o=a(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(e){var n;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this,e)).render(),"string"!=typeof n.options.template)throw new Error("options.template is required");return n}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"attributes",get:function(){return{class:this.options.className||"ad_runner_ui_countdown"}}},{key:"update",value:function(e){this._setRemainingTime(e)}},{key:"_setRemainingTime",value:function(e){var t;t=this.options.formatTime?s(e):Math.round(e),this.element.textContent=this.options.template.replace("%s",t)}}]),r}()},function(e,t,r){e.exports={Runner:r(21),Player:r(18),VAST:r(7).VAST}},function(e,t,r){var n=r(7).VAST,i=r(18),a=r(60),o=r(61),s=r(87),l=r(3),u=l.contentVolumeToAdVolume,c=l.convertToSecond,f=l.createPromiseDefer,d=l.createTimeoutPromise,h=r(5),p=h.AD_POSITION,g=h.AD_DONE_REASON,v=h.DEFAULT_AD_START_TIMEOUT,y=h.DEFAULT_MIDROLL_START_TIME,m=1,A=2,b=3,E=4,k={startTimeout:v,skipTimeout:h.DEFAULT_SKIP_TIMEOUT,countdownPlay:!0,defaultMidrollStartTime:y,getPoster:function(){},showSlideBlack:!1,removeAdmarkOnError:!0,autoPlayAdBreaks:!0,autoPlay:!1,mute:!1},T=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.plugin=t,this.options=this._normalizeOption(r);var n=t.getAdContainers(),l=t.getContentPlayer();this.player=new i({linearAdContainer:n.linear,nonLinearAdContainer:n.nonLinear,contentPlayer:l,logger:this.logger,onAdStarted:this._onAdStarted.bind(this),onAdStopped:this._onAdStopped.bind(this),onAdSkipped:this._onAdSkipped.bind(this),onAdLoaded:this._onAdLoaded.bind(this),onResetState:this._onResetState.bind(this)},this.options),this.scheduler=new a({logger:this.logger,prepareAd:this._prepareAd.bind(this),beforePlayAd:this._beforePlayAd.bind(this),preloadAd:this._preloadAd.bind(this),loadAd:this._loadAd.bind(this),playAd:this._playAd.bind(this)}),this.adUi=new o(this.options,n),this.adMark=new s(n.adMark),this.state=m,this.adsLoaded=!1,this.adDeferred=null}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"name",get:function(){return"Runner"}},{key:"logger",get:function(){return this.plugin.getLogger()}},{key:"viewDetailLink",get:function(){var e=this.player.getCurrentPlayer();return e&&e.viewDetailLink}},{key:"onContentProgress",value:function(e){this.scheduler.onContentProgress(e)}},{key:"onContentEnded",value:function(){this.scheduler.onContentEnded(),this.adMark.removeMarkItems()}},{key:"onUserAction",value:function(){this.player.initUserAction()}},{key:"onAdsDataLoaded",value:function(e){var t=this;this.logger.debug(this.name,"onAdsDataLoaded",e),this._normalizeAdsData(e),this.scheduler.populateAdsData(e),this.plugin.getContentMetadata().then((function(e){t.scheduler&&t.scheduler.dataLoadingDeferred.promise.then((function(){t.adMark.render(e.duration,t.scheduler.midrollAds)}))}))}},{key:"destroy",value:function(){this.player.destroy(),this.player=null,this.scheduler=null,this.adUi.remove(),this.adMark.remove()}},{key:"resize",value:function(e,t,r){this.player.resize(e,t,r)}},{key:"pauseAd",value:function(){this.player.pause()}},{key:"resumeAd",value:function(){this.player.resume()}},{key:"stopAd",value:function(){this.player.stop()}},{key:"showPosterAndPlayIcon",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.adUi.skipButton,r=t.poster,n=t.playIcon;e?(t.loadPoster(),r.show(),n.show()):(r.hide(),n.hide())}},{key:"_onResetState",value:function(){this.state=m,this.adsLoaded=!1}},{key:"_preloadAd",value:function(e){this.adsLoaded||this._loadAd(e)}},{key:"_prepareAd",value:function(e,t){this.options.countdownPlay&&this.adsLoaded&&(this.adUi.countdownToPlay.show(),this.adUi.countdownToPlay.update(t))}},{key:"_beforePlayAd",value:function(e,t){var r=this;this.adUi.countdownToPlay.hide(),e||!this.adsLoaded?setTimeout((function(){r.adsLoaded&&(r.options.showSlideBlack?(r.plugin.pauseForAd(),r.logger.debug(r.name,"Showing black screen"),r.adUi.slideBlack.show(),r.adUi.slideBlack.fadeIn(),setTimeout((function(){t()}),2e3)):t())}),1e3):t()}},{key:"_loadAd",value:function(e){this.state===m&&(this.adsLoaded=!1,this.state=A,this.adDeferred=f(),this.logger.debug(this.name,"loading ad",e),this.player.load(e))}},{key:"_playAd",value:function(e,t){var r=this;return this._loadAd(e),this.logger.debug(this.name,"play ad",e),this.state=b,this.adMetadata=t,this.adUi.onAdWillStart(),this.plugin.onAdWillStart&&this.plugin.onAdWillStart(),this.adTimeoutPromise=d(1e3*this.options.startTimeout),this.adTimeoutPromise.then((function(){r.logger.debug(r.name,"cannot start ad within ".concat(r.options.startTimeout,"s, cancelling...")),r.player&&r.player.cancel(),r._onAdStopped(null,g.timeout,e)})),this.player.setVolume(u(this.plugin.getContentVolume())),this.player.start(),this.adDeferred.promise}},{key:"_onAdStarted",value:function(){var e=this;this._mayPauseContent();var t=this.player.getCurrentPlayer();this.state=E,this.adTimeoutPromise.cancel(),this.adUi.slideBlack.fadeOut(),setTimeout((function(){e.adUi.slideBlack.hide()}),400),this.adUi.setPlayer(t),this.adUi.onAdStarted(this.adMetadata),this.plugin.onAdStarted&&this.plugin.onAdStarted(),this.logger.debug(this.name,"ad started by player:",t.name),this.player.isPlayingLinearAd()||(this.state=m,this.adDeferred.resolve(),this._mayResumeContent())}},{key:"_onAdStopped",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g.ended,n=arguments.length>2?arguments[2]:void 0;e&&(r=g.error),this.player.isGoogleNonLinearAd()&&this.plugin.hideLinearAdContainer&&this.plugin.hideLinearAdContainer(),(!e||e&&this.options.removeAdmarkOnError)&&n._completeAd&&n._completeAd(),this.state,t.adTimeoutPromise.cancel(),t.adUi.onAdStopped(),t.plugin.onAdStopped&&t.plugin.onAdStopped(r),t._mayResumeContent(),t.logger.debug(t.name,"ad stopped:",r,e||""),t.adUi.slideBlack.hide(),this.state=m,this.adsLoaded=!1,this.adDeferred.resolve()}},{key:"_onAdSkipped",value:function(){this.plugin.onAdSkipped&&this.plugin.onAdSkipped()}},{key:"_onAdLoaded",value:function(){this.adsLoaded=!0}},{key:"_mayPauseContent",value:function(){this.player.isPlayingLinearAd()?this.plugin.pauseForAd():this.player.isGoogleNonLinearAd()&&(this.plugin.showLinearAdContainer&&this.plugin.showLinearAdContainer(),this.adUi.onAdStopped())}},{key:"_mayResumeContent",value:function(){this.adMetadata.order===this.adMetadata.total&&this.plugin.resumeAfterAd()}},{key:"_normalizeAdsData",value:function(e){var t=this;e.forEach((function(e){e.ads=n.pojoFromXML(e.server.tag).ads,delete e.server,Object.assign(e,t._buildAdOption(e))}))}},{key:"_buildAdOption",value:function(e){var t={position:e.position,skipoffset:e.skipoffset?c(e.skipoffset):-1,startTime:e.startTime?c(e.startTime):0};return t.position!==p.midroll||t.startTime||(this.logger.warn(this.name,"no startTime specified on mid-roll ad, will use default startTime:",this.options.defaultMidrollStartTime),t.startTime=this.options.defaultMidrollStartTime),t}},{key:"_normalizeOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign({},k,e,{getPoster:this.plugin.getPoster&&this.plugin.getPoster.bind(this.plugin)})}}]),e}();e.exports=T},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(6),a=r(8),o=r(37),s=r(41),l=r(4),u=r(11),c=r(44),f=r(45),d=r(10),h=r(17);function p(e){return e}function g(){return new Error("VASTPlayer not ready.")}function v(e){return function(){var t=this,r=this.__private__.player;return this.ready?r[e]?r[e].apply(r,arguments).then((function(){return t})):Promise.resolve().then((function(){return t})):Promise.reject(g())}}function y(e){return{get:function(){if(!this.ready)throw g();return this.__private__.player[e]},set:function(t){if(!this.ready)throw g();return this.__private__.player[e]=t}}}function m(e,t){return String(e).toUpperCase().indexOf(String(t).toUpperCase())>-1}function A(e,t){var r=this;i.call(this),this.__private__={container:e,config:function e(){var t,r,i,a,o={},s=arguments.length;for(t=0;t<s;t++)for(i in r=arguments[t]||{})a=r[i],void 0===o[i]&&(o[i]=a),"object"===n(a)&&(o[i]=e(o[i],a));return o}(t,{vast:{resolveWrappers:!0,maxRedirects:5},tracking:{mapper:p},width:480,height:270}),vast:null,ready:!1,player:null,isVPAID:!1,vpaidVendor:null,video:f()};var a=this;this.on(l.AdClickThru,(function(e,t,r){var n=e||a.viewDetailLink;r&&n&&(this.__private__.player.alreadyEmitViewable||(this.__private__.player.alreadyEmitViewable=!0,this.__private__.player.emit(l.AdViewableImpression)),window.open(n));var i=a.vast.get("ads[0].creatives[0].videoClicks.clickTrackings");i&&i.length>0&&i.map((function(e){var t=new XMLHttpRequest;t.open("GET",e,!0),t.send(null)}))})),this.on(l.AdClickBackground,(function(){var e=a.__private__.player;e.video&&d.isDesktop&&(e.video.paused?r.resumeAd():r.pauseAd())}))}r(15).console,A.prototype=Object.create(i.prototype),Object.defineProperties(A.prototype,{container:{get:function(){return this.__private__.container}},config:{get:function(){return this.__private__.config}},vast:{get:function(){return this.__private__.vast}},ready:{get:function(){return this.__private__.ready}},paused:{get:function(){return this.__private__.video.paused}},video:{set:function(e){return this.__private__.video=e}},isVPAID:{get:function(){return this.__private__.isVPAID}},isAsiaSmartAd:{get:function(){return(e=this.vast.ads[0]).vastAdTagURI&&m(e.vastAdTagURI,"adnetwork.adasiaholdings.com")||m(e.system.name,"smart")||m(e.system.name,"wootag");var e}},vpaidVendor:{get:function(){return this.__private__.vpaidVendor}},viewDetailLink:{get:function(){return this.vast&&this.vast.get("ads[0].creatives[0].videoClicks.clickThrough")}},adRemainingTime:y("adRemainingTime"),adDuration:y("adDuration"),adVolume:y("adVolume")}),A.prototype.load=function(e){var t=this,r=this.config.vast;return("string"==typeof e?a.fetch(e,r):new a(e).resolveWrappers()).then((function(e){var r=function(){var r=e.filter("ads[0].creatives[0].mediaFiles",o.canPlayMediaFile),n=e.filter("ads[0].creatives[0].mediaFiles",s.canPlayMediaFile);if(n.length>0)return t.__private__.isVPAID=!1,t.__private__.vpaidVendor=null,{player:new s(t.container,t.__private__.video,t.config),mediaFiles:n};if(r.length>0)return t.__private__.isVPAID=!0,t.__private__.vpaidVendor=h.getVpaidVendor(r),{player:new o(t.container,t.__private__.video,t.config,t),mediaFiles:r};throw new Error("There are no playable <MediaFile>s.")}(),n=r.player,i=r.mediaFiles,a={adParameters:e.get("ads[0].creatives[0].parameters"),progressEvents:e.get("ads[0].creatives[0].trackingEvents").filter((function(e){return"progress"==e.event}))},f=[].concat(e.map("ads[0].impressions",(function(e){return{event:"impression",uri:e.uri}})),e.map("ads[0].viewableImpressions",(function(e){return{event:"viewableImpression",uri:e.uri}})),e.map("ads[0].errors",(function(e){return{event:"error",uri:e}})),e.get("ads[0].creatives[0].trackingEvents"),e.map("ads[0].creatives[0].videoClicks.clickTrackings",(function(e){return{event:"clickThrough",uri:e}}))),d=new u(l),p=new c(f,t.config.tracking.mapper);if(d.from(n).to(t),t.__private__.vast=e,t.__private__.player=n,t.isAsiaSmartAd){var g=e.get("ads[0].creatives[0].duration");g&&(n.adDuration=g)}return n.load(i,a).then((function(){p.track(n)}))})).then((function(){return t.__private__.ready=!0,t.emit("ready"),t})).catch((function(e){throw t.emit("error",e),e}))},A.prototype.startAd=v("startAd"),A.prototype.stopAd=v("stopAd"),A.prototype.skipAd=v("skipAd"),A.prototype.pauseAd=v("pauseAd"),A.prototype.resumeAd=v("resumeAd"),A.prototype.playAd=v("playAd"),A.prototype.init=function(){var e=this.__private__.video,t=this.__private__.container;return e.init(t)},A.vpaidSWFLocation="https://ajax.cdnjs.com/ajax/libs/videojs-vast-vpaid/2.0.2/VPAIDFlash.swf",e.exports=A},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=r(24),a=r(25),o=r(26),s=r(13),l=r(27),u=Array.prototype.push,c=r(28),f={inline:function(e){o({description:null,survey:null},e)},wrapper:function(){}},d={linear:function(e){o({trackingEvents:[],parameters:null,videoClicks:null},e),(e.mediaFiles||[]).forEach((function(e){o({id:null,bitrate:null,scalable:null,maintainAspectRatio:null,apiFramework:null},e)}))},companions:function(e){e.companions.forEach((function(e){o({expandedWidth:null,expandedHeight:null,apiFramework:null,trackingEvents:[],clickThrough:null,altText:null,parameters:null},e)}))},nonLinear:function(e){o({trackingEvents:[]},e),e.ads.forEach((function(e){o({id:null,expandedWidth:null,expandedHeight:null,scalable:null,maintainAspectRatio:null,minSuggestedDuration:null,apiFramework:null,clickThrough:null,parameters:null},e)}))}},h=["ads.celtra.com"];function p(){}function g(e,t){var r=e.indexOf("redirectUrl=");if(r>-1&&h.some((function(t){return e.indexOf(t)>-1}))){var n=e.slice(r+"redirectUrl=".length);return e=e.slice(0,r),i.get(e,t).catch(p).then((function(){return i.get(n,t)}))}return i.get(e,t)}function v(e){a(e,this,!0),this.ads.forEach((function(e){o({system:{version:null},errors:[]},e),e.creatives.forEach((function(e){o({id:null,sequence:null,adID:null},e),d[e.type](e)})),f[e.type](e)})),this.__private__={wrappers:[],inlines:[]}}Object.defineProperties(v.prototype,{wrappers:{get:function(){var e=this.__private__.wrappers;return e.length=0,u.apply(e,this.filter("ads",(function(e){return"wrapper"===e.type}))),e}},inlines:{get:function(){var e=this.__private__.inlines;return e.length=0,u.apply(e,this.filter("ads",(function(e){return"inline"===e.type}))),e}}}),v.prototype.get=function(e){return((e||"").match(/[^\[\]\.]+/g)||[]).reduce((function(e,t){return e?e[t]:void 0}),this)},v.prototype.set=function(e,t){var r=function(){for(var t,r=/[^\[\]\.]+/g,n=[];t=r.exec(e);)n.push({token:t[0],type:a(t,t.index+t[0].length)});return n}(),n=r.pop(),i=r.reduce((function(e,t){return e[t.token]||(e[t.token]=new t.type)}),this);function a(e,t){switch(e.input.charAt(t)){case".":return Object;case"[":return Array;case"]":return a(e,t+1);default:return null}}if(!e)throw new Error("prop must be specified.");return i[n.token]=t},v.prototype.map=function(e,t){var r=this.get(e)||[],n=r.length,i=[];if(!(r instanceof Array))return i;for(var a=0;a<n;a++)i.push(t.call(this,r[a],a,r));return i},v.prototype.filter=function(e,t){var r=this.get(e)||[],n=r.length,i=[];if(!(r instanceof Array))return i;for(var a=0;a<n;a++)t.call(this,r[a],a,r)&&i.push(r[a]);return i},v.prototype.find=function(e,t){var r=this.get(e)||[],n=r.length;if(r instanceof Array)for(var i=0;i<n;i++)if(t.call(this,r[i],i,r))return r[i]},v.prototype.toPOJO=function(){var e=JSON.parse(JSON.stringify(this));return delete e.__private__,e},v.prototype.copy=function(){return new this.constructor(this.toPOJO())},v.prototype.resolveWrappers=function(){var e=isNaN(arguments[0])?1/0:arguments[0],t="function"==typeof arguments[0]?arguments[0]:arguments[1],r=this.constructor,n=this;return 0===e?Promise.reject(new Error("Too many redirects were made.")):l(Promise.all(this.map("wrappers",(function(e){return Promise.resolve(g(e.vastAdTagURI,{withCredentials:!0})).then((function(t){return{wrapper:e,response:r.pojoFromXML(t.data).ads}}))}))).then((function(e){var t=e.map((function(e){return e.wrapper})),i=e.map((function(e){return e.response}));return new r(s(n.toPOJO(),{ads:n.map("ads",(function(e){var r=t.indexOf(e),n=t[r],a=i[r];return a?a.map(function(e,t){var r=function(e){return{linear:e.filter(n("linear")),companions:e.filter(n("companions")),nonLinear:e.filter(n("nonLinear"))}}(e.creatives);function n(e){return function(t){return t.type===e}}return o(e.impressions,t.impressions),o(e.viewableImpressions,t.viewableImpressions),o(e.errors,t.errors),t.creatives.forEach((function(e){o(r[e.type].shift()||{},e)})),u.apply(t.creatives,"wrapper"!==t.type?[]:["linear","companions","nonLinear"].reduce((function(e,t){return e.concat(r[t])}),[])),t}.bind(null,n)):[e]})).reduce((function(e,t){return e.concat(t)}))}))})).then((function(t){return t.get("wrappers.length")>0?t.resolveWrappers(e-1):t})),t)},v.prototype.toXML=function(){var e=this.validate();if(!e.valid)throw new Error("VAST is invalid: "+e.reasons.join(", "));return c(this)},v.prototype.validate=function(){var e=this,t=[],r={inline:function(t){var r={linear:function(e){o(e,{exists:["duration"],atLeastOne:["mediaFiles"]})},companions:function(t){e.get(t("companions")).forEach((function(e,r){o((function(e){return t("companions["+r+"]."+e)}),{exists:[],atLeastOne:["resources"]})}))},nonLinear:function(t){e.get(t("ads")).forEach((function(e,r){o((function(e){return t("ads["+r+"]."+e)}),{exists:[],atLeastOne:["resources"]})}))}};o(t,{exists:["title"],atLeastOne:["creatives"]}),e.get(t("creatives")).forEach((function(e,n){function i(e){return t("creatives["+n+"]."+e)}o(i,{exists:["type"],atLeastOne:[]}),(r[e.type]||p)(i)}))},wrapper:function(e){o(e,{exists:["vastAdTagURI"],atLeastOne:[]})}};function n(e,r){e||t.push(r)}function i(t){n(e.get(t),t+" is required")}function a(t){n(e.get(t+".length")>0,t+" must contain at least one value")}function o(e,t){t.exists.map(e).forEach(i),t.atLeastOne.map(e).forEach(a)}return o((function(e){return e}),{exists:[],atLeastOne:["ads"]}),this.get("ads").forEach((function(e,t){function n(e){return"ads["+t+"]."+e}o(n,{exists:["type","system.name"],atLeastOne:["impressions"]}),(r[e.type]||p)(n)})),{valid:0===t.length,reasons:0===t.length?null:t}},v.pojoFromXML=r(31),v.fetch=function(e){var t="object"===n(arguments[1])&&arguments[1]||{},r="function"==typeof arguments[2]?arguments[2]:arguments[1],i=this;return l(Promise.resolve(g(e,{headers:t.headers||{}})).then((function(e){var r=new i(i.pojoFromXML(e.data));return t.resolveWrappers?r.resolveWrappers(t.maxRedirects):r})),r)},e.exports=v},function(e,t){e.exports={get:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.withCredentials,n=t.headers;return new Promise((function(t,i){var a=new XMLHttpRequest;a.open("GET",e),a.withCredentials=Boolean(r),a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&(200===a.status?t({data:a.responseText}):i(new Error("Unexpected status code:",a.status)))},n&&Object.keys(n).forEach((function(e){a.setRequestHeader(e,n[e])})),a.send()}))}}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=Array.prototype.push;e.exports=function e(t){var r="object"===n(arguments[1])?arguments[1]:null,a="boolean"==typeof arguments[1]?arguments[1]:arguments[2];return Object(t)!==t?t:t instanceof Array?function(t,r,n){var a=r||[];return i.apply(a,n?t.map((function(t){return e(t,null,!0)})):t),a}(t,r,a):function(t,r,n){return Object.keys(t).reduce((function(r,i){return r[i]=n?e(t[i],null,!0):t[i],r}),r||{})}(t,r,a)}},function(e,t,r){"use strict";var n=Array.prototype.push;function i(e){return Object(e)===e}function a(e){return e instanceof Array}e.exports=function e(t,r){return[t,r].every(a)?(n.apply(r,t.filter((function(e){return r.indexOf(e)<0}))),r):Object.keys(t).reduce((function(r,n){return[t[n],r[n]].every(i)&&e(t[n],r[n]),n in r||(r[n]=t[n]),r}),r)}},function(e,t,r){"use strict";e.exports=function(e,t){return"function"!=typeof t||e.then((function(e){t(null,e)}),(function(e){t(e)})),e}},function(e,t,r){"use strict";var n=r(29),i=r(30),a={linear:function(e){return{tag:"Linear",children:[{tag:"Duration",value:n(e.duration)},o(e.trackingEvents),l(e)].concat(e.videoClicks?[{tag:"VideoClicks",children:[{tag:"ClickThrough",value:e.videoClicks.clickThrough,cdata:!0}].concat(e.videoClicks.clickTrackings.map((function(e){return{tag:"ClickTracking",value:e,cdata:!0}})),e.videoClicks.customClicks.map((function(e){return{tag:"CustomClick",attributes:{id:e.id},value:e.uri,cdata:!0}})))}]:[],[{tag:"MediaFiles",children:e.mediaFiles.map((function(e){return{tag:"MediaFile",attributes:{id:e.id,width:e.width,height:e.height,bitrate:e.bitrate,type:e.type,delivery:e.delivery,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,apiFramework:e.apiFramework},value:e.uri,cdata:!0}}))}])}},companions:function(e){return{tag:"CompanionAds",children:e.companions.map((function(e){return{tag:"Companion",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,apiFramework:e.apiFramework},children:s(e.resources).concat([o(e.trackingEvents),{tag:"CompanionClickThrough",value:e.clickThrough,cdata:!0},{tag:"AltText",value:e.altText},l(e)])}}))}},nonLinear:function(e){return{tag:"NonLinearAds",children:e.ads.map((function(e){return{tag:"NonLinear",attributes:{id:e.id,width:e.width,height:e.height,expandedWidth:e.expandedWidth,expandedHeight:e.expandedHeight,scalable:e.scalable,maintainAspectRatio:e.maintainAspectRatio,minSuggestedDuration:n(e.minSuggestedDuration),apiFramework:e.apiFramework},children:s(e.resources).concat([{tag:"NonLinearClickThrough",value:e.clickThrough,cdata:!0},l(e)])}})).concat([o(e.trackingEvents)])}}};function o(e){return{tag:"TrackingEvents",children:e.map((function(e){return{tag:"Tracking",attributes:{event:e.event},value:e.uri,cdata:!0}}))}}function s(e){return e.map((function(e){return{tag:function(t){switch(e.type){case"static":return"StaticResource";case"iframe":return"IFrameResource";case"html":return"HTMLResource"}}(),attributes:{creativeType:e.creativeType},value:e.data,cdata:!0}}))}function l(e){return{tag:"AdParameters",value:e.parameters}}e.exports=function(e){return i({tag:"VAST",attributes:{version:e.get("version")},children:e.map("ads",(function(e){return{tag:"Ad",attributes:{id:e.id},children:[{tag:function(){switch(e.type){case"inline":return"InLine";case"wrapper":return"Wrapper"}}(),children:[{tag:"AdSystem",attributes:{version:e.system.version},value:e.system.name},{tag:"AdTitle",value:e.title},{tag:"Description",value:e.description},{tag:"Survey",value:e.survey,cdata:!0},{tag:"VASTAdTagURI",value:e.vastAdTagURI,cdata:!0}].concat(e.errors.map((function(e){return{tag:"Error",value:e,cdata:!0}})),e.impressions.map((function(e){return{tag:"Impression",value:e.uri,cdata:!0,attributes:{id:e.id}}})),[{tag:"ViewableImpression",children:e.viewableImpressions.map((function(e){return{tag:"Viewable",value:e.uri,cdata:!0,attributes:{id:e.id}}}))}],[{tag:"Creatives",children:e.creatives.map((function(e){return{tag:"Creative",attributes:{id:e.id,sequence:e.sequence,AdID:e.adID},children:[(t=e.type,a[t](e))]};var t})),required:!0}])}]}}))},!0)}},function(e,t,r){"use strict";function n(e){return(e>9?"":"0")+e.toString()}e.exports=function(e){return Number(e)!==e?null:[Math.floor(e/60/60),Math.floor(e/60%60),Math.floor(e%60%60)].map(n).join(":")}},function(e,t,r){"use strict";function n(e){return null!=e}function i(e){return void 0!==e?String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""}function a(e){return e.cdata?function(e){return(void 0!==e?function(e){for(var t,r,n=[],i=/]]>/g,a=0;t=i.exec(e);)r=t.index+2,n.push(t.input.substring(a,r)),a=r;return n.push(e.substring(a,e.length)),n}(String(e)):[""]).reduce((function(e,t){return e+"<![CDATA["+t+"]]>"}),"")}(e.value):i(e.value)}e.exports=function(e,t){return['<?xml version="1.0" encoding="UTF-8"?>'].concat(function e(t,r,o){var s=t.tag,l=t.attributes||{},u=Object.keys(l),c=t.children||[],f=t.value,d=c.length>0,h=u.every((function(e){return n(l[e])}))&&u.length>0,p=n(f)||d||h,g=function(e){for(var t="";e--;)t+=" ";return t}(r),v="<"+s+Object.keys(l).reduce((function(e,t){return o&&!n(l[t])?e:e+" "+t+'="'+i(l[t])+'"'}),"")+">",y="</"+s+">";return!o||p||t.required?d?[g+v].concat(t.children.reduce((function(t,n){return t.concat(e(n,r+4,o))}),[]),[g+y]):[g+v+a(t)+y]:[]}(e,0,t)).join("\n")}},function(e,t,r){"use strict";var n=r(32),i=r(33),a=r(34),o=r(13),s=r(35),l=r(36),u={linear:function(e){var t=f(e.find("Duration")),r=f(e.find("Linear")),n=e.find("Tracking"),o=f(e.find("AdParameters")),s=e.find("VideoClicks")[0],u=e.find("MediaFile");return{type:"linear",skipOffset:r.attributes.skipoffset,duration:i(t.value)||void 0,trackingEvents:n.map((function(e){var t={event:e.attributes.event,uri:e.value};return"progress"===e.attributes.event&&(t.offset=i(e.attributes.offset)),t})),parameters:o.value,videoClicks:s&&function(){var e=f(s.find("ClickThrough")),t=s.find("ClickTracking"),r=s.find("CustomClick");return{clickThrough:e.value,clickTrackings:t.map((function(e){return e.value})),customClicks:r.map((function(e){return{id:e.attributes.id,uri:e.value}}))}}(),mediaFiles:u.map((function(e){var t=e.attributes;return{id:t.id,delivery:t.delivery,type:t.type,uri:e.value,bitrate:l(t.bitrate),width:l(t.width),height:l(t.height),scalable:a(t.scalable),maintainAspectRatio:a(t.maintainAspectRatio),apiFramework:t.apiFramework}}))}},companions:function(e){return{type:"companions",companions:e.find("Companion").map((function(e){var t=e.find("Tracking"),r=f(e.find("CompanionClickThrough")),n=f(e.find("StaticResource")),i=f(e.find("AltText")),a=f(e.find("AdParameters"));return{id:e.attributes.id,width:l(e.attributes.width),height:l(e.attributes.height),expandedWidth:l(e.attributes.expandedWidth),expandedHeight:l(e.attributes.expandedHeight),apiFramework:e.attributes.apiFramework,resources:function(e){return e.find("URL").map((function(e){return{data:e.value}}))}(e),staticResource:n.value,trackingEvents:t.map((function(e){return{event:e.attributes.event,uri:e.value}})),clickThrough:r.value,altText:i.value,parameters:a.value}}))}},nonLinear:function(e){var t=e.find("NonLinear"),r=e.find("Tracking");return{type:"nonLinear",ads:t.map((function(e){var t=f(e.find("NonLinearClickThrough")),r=f(e.find("StaticResource")),n=f(e.find("AdParameters"));return{id:e.attributes.id,width:e.attributes.width,height:e.attributes.height,expandedWidth:l(e.attributes.expandedWidth),expandedHeight:l(e.attributes.expandedHeight),scalable:a(e.attributes.scalable),maintainAspectRatio:a(e.attributes.maintainAspectRatio),minSuggestedDuration:i(e.attributes.minSuggestedDuration)||void 0,apiFramework:e.attributes.apiFramework,resources:r.value,clickThrough:t.value,parameters:n.value}})),trackingEvents:r.map((function(e){return{event:e.attributes.event,uri:e.value}}))}}},c={inline:function(e){var t=f(e.find("AdTitle")),r=f(e.find("Description")),n=f(e.find("Survey"));return{type:"inline",title:t.value,description:r.value,survey:n.value}},wrapper:function(e){return{type:"wrapper",vastAdTagURI:f(e.find("VASTAdTagURI")).value}}};function f(e){return e[0]||{attributes:{}}}e.exports=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"VAST",r=n(e);if(!r(t)[0])throw new Error("["+e+"] is not a valid VAST document.");return s({version:f(r(t)).attributes.version,ads:r("Ad").map((function(e){var t=f(e.find("Wrapper,InLine")).tag.toLowerCase(),r=f(e.find("AdSystem")),n=f(e.find("AdTitle")),i=f(e.find("Description")),a=e.find("Error"),s=e.find("Impression"),d=e.find("ViewableImpression Viewable"),h=e.find("Creative").filter((function(e){return e.children().length}));return o({id:e.attributes.id,system:{name:r.value,version:r.attributes.version},advertiser:{title:n.value,description:i.value},errors:a.map((function(e){return e.value})),impressions:s.map((function(e){return{uri:e.value,id:e.attributes.id}})),viewableImpressions:d.map((function(e){return{uri:e.value,id:e.attributes.id}})),creatives:h.map((function(e){var t=function(){switch(f(e.find("Linear,CompanionAds,NonLinearAds")).tag){case"Linear":return"linear";case"CompanionAds":return"companions";case"NonLinearAds":return"nonLinear"}}();return o({id:e.attributes.id,sequence:l(e.attributes.sequence),adID:e.attributes.AdID},u[t](e))}))},c[t](e))}))},!0)}},function(e,t,r){"use strict";var n=Array.prototype.map,i=Array.prototype.filter,a=Array.prototype.reduce,o=new DOMParser;function s(e){var t=e.childElementCount>0;return{tag:e.tagName,value:t?null:e.textContent,attributes:a.call(e.attributes,(function(e,t){return e[t.name]=t.value,e}),{}),find:function(t){return l(e.querySelectorAll(t))},children:function(){return i.call(e.childNodes,(function(e){return e instanceof Element})).map(s)}}}function l(e){return n.call(e,s)}e.exports=function(e){var t=o.parseFromString(e,"application/xml");return function(e){return l(t.querySelectorAll(e))}}},function(e,t,r){"use strict";e.exports=function(e){var t=(e||"").match(/^(\d\d):(\d\d):(\d\d)$/);return t&&t.slice(1,4).map(parseFloat).reduce((function(e,t,r){return e+t*Math.pow(60,Math.abs(r-2))}),0)}},function(e,t,r){"use strict";e.exports=function(e){switch((e||"").toLowerCase()){case"true":return!0;case"false":return!1}}},function(e,t,r){"use strict";e.exports=function e(t,r){return Object(t)!==t?t:Object.keys(t).reduce((function(n,i){return r&&t[i]instanceof Array?n[i]=t[i].filter((function(e){return void 0!==e})).map((function(t){return e(t,!0)})):r&&t[i]instanceof Object?n[i]=e(t[i],!0):void 0!==t[i]&&(n[i]=t[i]),n}),{})}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){if(/string|number|boolean/.test(n(e)))return isNaN(e)?void 0:Number(e)}},function(e,t,r){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e,t,r,n){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,r,n){var i,a=l(e,t);if(a){if((i=Object.getOwnPropertyDescriptor(a,t)).set)return i.set.call(n,r),!0;if(!i.writable)return!1}if(i=Object.getOwnPropertyDescriptor(n,t)){if(!i.writable)return!1;i.value=r,Object.defineProperty(n,t,i)}else!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(n,t,r);return!0})(e,t,r,n)}function s(){return(s="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=l(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=u(e)););return e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=r(38),f=r(4),d=r(14),h=r(9),p=r(10).isDesktop,g=r(39),v=r(16),y=r(11),m=r(17),A=r(8);function b(e,t,r){return e.addEventListener(t,r,!1)}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,c);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=u(e);if(t){var a=u(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(e,n,i,a){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(o=t.call(this,e)).frame=null,o.video=n,o.config=i,o.parent=a,o}return function(e,t,r){t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"adVolume",get:function(){return s(u(r.prototype),"adVolume",this)},set:function(e){(function(e,t,r,n,i){if(!o(e,"adVolume",r,n||e))throw new Error("failed to set property")})(u(r.prototype),0,e,this),this.video.muted=0===e}},{key:"load",value:function(e,t){var r=this,n=e[0].uri,i=e[0].bitrate;return new Promise((function(e,a){var o=document.createElement("iframe"),s=document.createElement("script"),l=r.video,u=null;function c(e){r.container.removeChild(o),r.adVolume=0,r.video.clean&&r.video.clean(),r.video=null,r.frame=null,r.api=null,e&&a(e)}o.src="about:blank",o.setAttribute("scrolling","no"),o.style.width="100%",o.style.height="100%",o.style.display="block",o.style.opacity="0",o.style.border="none",r.container.appendChild(o),o.contentWindow.document.open(),o.contentWindow.document.close(),o.contentWindow.document.body.style.margin="0",r.frame=o,s.src=n,s.onload=function(){var s=o.contentWindow.getVPAIDAd(),u=o.contentWindow.document.body,d=r.vpaidVersion=new g(s.handshakeVersion("2.0"));if(d.major>2)return a(new Error("VPAID version "+d+" is not supported."));o.contentWindow.addEventListener("resize",(function(){var e=o.getBoundingClientRect();r.resizeAd(e.width,e.height,"normal")}),!1),f.forEach((function(e){if(r.parent.isAsiaSmartAd||e!==f.AdStarted)return s.subscribe((function(){for(var t=new Array(arguments.length),n=arguments.length;n--;)t[n]=arguments[n];return r.emit.apply(r,[e].concat(t))}),e)})),r.once(f.AdLoaded,(function(){o.style.opacity="1",r.api=s;var t=m.getUrlParam("vast",n);t&&m.isURL(t)&&function(e){return m.httpGet(e)}(t).then((function(e){var t=new A(A.pojoFromXML(e)).get("ads[0].creatives[0].videoClicks.clickThrough");r.api.clickThrough=t})),e(r)})),r.once(f.AdError,(function(e){c(new Error(e))})),r.once(f.AdStopped,c),r.parent.isAsiaSmartAd&&(r.once(f.AdStopped,(function(e){r.emit(f.AdSkipped)})),r.once(f.AdVideoStart,(function(e){var t=o.contentWindow.document.querySelector(".sas-container").querySelector("iframe").contentWindow.document.querySelector("video");r.video=t,r.parent.video=t}))),s.initAd(r.config.width,r.config.height,"normal",i,{AdParameters:t.adParameters},{slot:u,videoSlot:l,videoSlotCanAutoPlay:p})},s.onerror=function(){c(new Error("Failed to load MediaFile ["+n+"]."))},function(e,t,r){b(e,t,(function n(){return function(e,t,r){e.removeEventListener(t,r,!1)}(e,t,n),r.apply(this,arguments)}))}(l,h.PLAYING,(function(){r.emit(f.AdStarted)})),b(l,h.TIMEUPDATE,(function(){var e;!((e=r.container.getBoundingClientRect()).top||e.height/2<=window.innerHeight-e.top&&e.bottom>=e.height/2)||r.alreadyEmitViewable?u=null:(u||(u=l.currentTime),l.currentTime-u>=2&&(r.alreadyEmitViewable=!0,r.emit(f.AdViewableImpression)))})),b(l,h.LOADEDMETADATA,(function(){var e=new v(l,t.progressEvents);new y([f.AdVideoProgress]).from(e).to(r)})),o.contentWindow.document.body.appendChild(l),o.contentWindow.document.body.appendChild(s)}))}}],[{key:"canPlayMediaFile",value:function(e){return(e.type===d.JAVASCRIPT||"application/x-javascript"===e.type)&&"VPAID"===e.apiFramework}}]),r}();e.exports=E},function(e,t,r){"use strict";var n=r(6),i=r(4);function a(e,t){return function(){var r=arguments,n=this.api,i=this;function a(){return new Error("Ad has not been loaded.")}function o(){return n[e].apply(n,r)}if(!t){if(!n)throw a();return o()}return new Promise((function(e,r){return n?(i.once(t,(function(){e(i)})),o()):r(a())}))}}function o(e){n.call(this),this.container=e,this.api=null,this.vpaidVersion=null}o.prototype=Object.create(n.prototype),Object.defineProperties(o.prototype,{adLinear:{get:a("getAdLinear")},adWidth:{get:a("getAdWidth")},adHeight:{get:a("getAdHeight")},adExpanded:{get:a("getAdExpanded")},adSkippableState:{get:a("getAdSkippableState")},adRemainingTime:{get:a("getAdRemainingTime")},adDuration:{get:a("getAdDuration"),set:function(e){}},adVolume:{get:a("getAdVolume"),set:a("setAdVolume")},adCompanions:{get:a("getAdCompanions")},adIcons:{get:a("getAdIcons")}}),o.prototype.load=function(){throw new Error("VPAID subclass must implement load() method.")},o.prototype.resizeAd=a("resizeAd",i.AdSizeChange),o.prototype.startAd=a("startAd",i.AdStarted),o.prototype.stopAd=a("stopAd",i.AdStopped),o.prototype.pauseAd=a("pauseAd",i.AdPaused),o.prototype.resumeAd=a("resumeAd",i.AdPlaying),o.prototype.playAd=a("playAd",i.AdPlaying),o.prototype.expandAd=a("expandAd",i.AdExpandedChange),o.prototype.collapseAd=a("collapseAd",i.AdExpandedChange),o.prototype.skipAd=function(){a("skipAd",i.AdSkipped).call(this),this.stopAd()},e.exports=o},function(e,t,r){"use strict";function n(e){var t=e.split(".").map(parseFloat);this.string=e,this.major=t[0],this.minor=t[1],this.patch=t[2],Object.freeze(this)}n.prototype.toString=function(){return this.string},e.exports=n},function(e,t,r){"use strict";var n=r(6),i=r(4);function a(e,t,r){e!==i.AdVideoProgress?t.fired[e]||(t.emit(e),t.fired[e]=!0):t.emit(e,r)}function o(e,t){n.apply(this,arguments),this.duration=e,this.progressEvents=t.sort((function(e,t){return e.offset<t.offset})),this.seconds=Array.apply([],new Array(e)).map((function(){return!1})),this.fired=[i.AdVideoStart,i.AdVideoFirstQuartile,i.AdVideoMidpoint,i.AdVideoThirdQuartile,i.AdVideoComplete].reduce((function(e,t){return e[t]=!1,e}),{})}o.prototype=Object.create(n.prototype),o.prototype.tick=function(){var e=this,t=this.seconds,r=this._getState(),n=Math.round(r.currentTime)-1,o=[1,2,3,4].map((function(e){return Math.floor(this.duration/4*e)}),this);function s(e){var r=o[e-1];return!(!r||0==r)&&t.slice(0,r).every((function(e){return!0===e}))}r.playing&&(a(i.AdVideoStart,this),n>-1&&(this.seconds[n]=!0)),s(1)&&a(i.AdVideoFirstQuartile,this),s(2)&&a(i.AdVideoMidpoint,this),s(3)&&a(i.AdVideoThirdQuartile,this),s(4)&&a(i.AdVideoComplete,this),this.progressEvents.length&&this._popMatchProgressEvents(r.currentTime).forEach((function(t){return a(i.AdVideoProgress,e,t)}))},o.prototype._popMatchProgressEvents=function(e){for(var t=this.progressEvents,r=t.length-1;r>-1&&e>t[r].offset;)r-=1;return t.splice(r+1)},o.prototype._getState=function(){throw Error("this method must be overridden")},e.exports=o},function(e,t,r){"use strict";var n=r(6),i=r(10).canPlay,a=r(42),o=r(4),s=r(9),l=r(16),u=r(11);function c(e,t,r){return e.addEventListener(t,r,!1)}function f(e,t,r){return c(e,t,(function n(){return function(e,t,r){e.removeEventListener(t,r,!1)}(e,t,n),r.apply(this,arguments)}))}function d(e,t){function r(){return new Error("The <video> has not been loaded.")}return function(){if(!this.video){if(t)return Promise.reject(r());throw r()}return e.apply(this,arguments)}}function h(){return this.container.removeChild(this.video),this.video.clean(),this.video=null,this.alreadyEmitViewable=!1,Promise.resolve(this)}function p(e,t,r){n.call(this),this.container=e,this.video=t,this.config=r,this.__private__={hasPlayed:!1}}p.prototype=Object.create(n.prototype),Object.defineProperties(p.prototype,{adRemainingTime:{get:d((function(){return this.video.duration-this.video.currentTime}))},adDuration:{get:d((function(){return this.video.duration}))},adVolume:{get:d((function(){return this.video.volume})),set:d((function(e){this.video.muted=0===e,this.video.volume=e}))}}),p.prototype.load=function(e,t){var r=this;return new Promise((function(n,d){var h=r.video,p=function(e,t){var r=t.width,n=e.map((function(e){return{mediaFile:e,playability:"video/3gpp"!==e.type&&i(e.type)}})).filter((function(e){return e.playability>0})).sort(a("-playability","-mediaFile.bitrate")),o=n.map((function(e){return Math.abs(r-(e.mediaFile.width||0))})),s=n[o.indexOf(Math.min.apply(Math,o))];return s&&s.mediaFile&&(s.mediaFile.uri=s.mediaFile.uri.trim()),!s||s.playability<1?null:s.mediaFile}(e,{width:r.config.width,height:r.config.height}),g=null;if(!p)return d(new Error("There are no playable <MediaFile>s."));h.src=p.uri,f(h,s.LOADEDMETADATA,(function(){var e=new l(h,t.progressEvents);new u(o).from(e).to(r),n(r),r.emit(o.AdLoaded),c(h,s.DURATIONCHANGE,(function(){r.emit(o.AdDurationChange)})),c(h,s.VOLUMECHANGE,(function(){r.emit(o.AdVolumeChange)}))})),f(h,s.ERROR,(function(){var e=h.error;r.emit(o.AdError,e.message),d(e)})),f(h,s.PLAYING,(function(){r.__private__.hasPlayed=!0,r.emit(o.AdImpression)})),f(h,s.ENDED,(function(){r.stopAd()})),c(h,s.TIMEUPDATE,(function(){var e;!((e=r.container.getBoundingClientRect()).top||e.height/2<=window.innerHeight-e.top&&e.bottom>=e.height/2)||r.alreadyEmitViewable?g=null:(g||(g=h.currentTime),h.currentTime-g>=2&&(r.alreadyEmitViewable=!0,r.emit(o.AdViewableImpression)))})),c(h,"click",(function(){r.emit(o.AdClickBackground,null,null,!0)})),r.container.appendChild(h)}))},p.prototype.startAd=d((function(){var e=this,t=this.video;return this.__private__.hasPlayed?Promise.reject(new Error("The advertisement has already been started.")):new Promise((function(r,n){return f(t,s.PLAYING,(function(){r(e),e.alreadyPlayAd=!0,e.emit(o.AdStarted)})),t.play().catch(n)}))}),!0),p.prototype.stopAd=d((function(){return this.emit(o.AdStopped),h.call(this)}),!0),p.prototype.skipAd=d((function(){return this.emit(o.AdSkipped),h.call(this)}),!0),p.prototype.pauseAd=d((function(){var e=this,t=this.video;return this.video.paused?Promise.resolve(this):new Promise((function(r){return f(t,s.PAUSE,(function(){r(e),e.emit(o.AdPaused)})),t.pause()}))}),!0),p.prototype.resumeAd=d((function(){var e=this,t=this.video;return this.__private__.hasPlayed?this.video.paused?new Promise((function(r){return f(t,s.PLAY,(function(){r(e),e.emit(o.AdPlaying)})),t.play()})):Promise.resolve(this):Promise.reject(new Error("The ad has not been started yet."))}),!0),p.canPlayMediaFile=function(e){return Boolean(document.createElement("video").canPlayType(e.type))},e.exports=p},function(e,t,r){var n,i,a,o=r(43);a=function(e){return function(t){return typeof t===e}},i=function(e,t){var r=1,n=t||function(e,t){return t};return"-"===e[0]&&(r=-1,e=e.substr(1)),function(t,i){var a,s=n(e,o.get(t,e)),l=n(e,o.get(i,e));return s<l&&(a=-1),s>l&&(a=1),s===l&&(a=0),a*r}},n=function(){var e=Array.prototype.slice.call(arguments),t=e.filter(a("string")),r=e.filter(a("function"))[0];return function(e,n){for(var a=t.length,o=0,s=0;0===o&&s<a;)o=i(t[s],r)(e,n),s++;return o}},e.exports=n},function(e,t,r){var n,i,a;!function(r,o){"use strict";"object"==typeof e&&"object"==typeof e.exports?e.exports=o():(i=[],void 0===(a="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=a))}(0,(function(){"use strict";var e=Object.prototype.toString,t=Object.prototype.hasOwnProperty;function r(e){if(!e)return!0;if(o(e)&&0===e.length)return!0;for(var r in e)if(t.call(e,r))return!1;return!0}function n(t){return e.call(t)}function i(e){return"number"==typeof e||"[object Number]"===n(e)}function a(e){return"string"==typeof e||"[object String]"===n(e)}function o(e){return"object"==typeof e&&"number"==typeof e.length&&"[object Array]"===n(e)}function s(e){var t=parseInt(e);return t.toString()===e?t:e}function l(e,t,n,o){if(i(t)&&(t=[t]),r(t))return e;if(a(t))return l(e,t.split("."),n,o);var u=s(t[0]);if(1===t.length){var c=e[u];return void 0!==c&&o||(e[u]=n),c}return void 0===e[u]&&(i(u)?e[u]=[]:e[u]={}),l(e[u],t.slice(1),n,o)}var u={ensureExists:function(e,t,r){return l(e,t,r,!0)},set:function(e,t,r,n){return l(e,t,r,n)},insert:function(e,t,r,n){var i=u.get(e,t);n=~~n,o(i)||(i=[],u.set(e,t,i)),i.splice(n,0,r)},empty:function(e,t){if(r(t))return e;if(!r(e)){var s;if(!(s=u.get(e,t)))return e;if(a(s))return u.set(e,t,"");if(function(e){return"[object Boolean]"===n(e)}(s))return u.set(e,t,!1);if(i(s))return u.set(e,t,0);if(!o(s))return u.set(e,t,null);s.length=0}},push:function(e,t){var r=u.get(e,t);o(r)||(r=[],u.set(e,t,r)),r.push.apply(r,Array.prototype.slice.call(arguments,2))},coalesce:function(e,t,r){for(var n,i=0,a=t.length;i<a;i++)if(void 0!==(n=u.get(e,t[i])))return n;return r},get:function(e,t,n){if(i(t)&&(t=[t]),r(t))return e;if(r(e))return n;if(a(t))return u.get(e,t.split("."),n);var o=s(t[0]);return 1===t.length?void 0===e[o]?n:e[o]:u.get(e[o],t.slice(1),n)},del:function(e,t){return function e(t,n){if(i(n)&&(n=[n]),!r(t)){if(r(n))return t;if(a(n))return e(t,n.split("."));var l=s(n[0]),u=t[l];if(1===n.length)void 0!==u&&(o(t)?t.splice(l,1):delete t[l]);else if(void 0!==t[l])return e(t[l],n.slice(1));return t}}(e,t)}};return u}))},function(e,t,r){"use strict";var n=r(4);function i(e){return e}function a(e,t){(e||[]).forEach((function(e){(new Image).src=t(e)}))}function o(e,t){this.pixels=e.reduce((function(e,t){return t&&(e[t.event]||(e[t.event]=[])).push(t.uri),e}),{}),this.__private__={mapper:t||i}}o.prototype.track=function(e){var t=this.pixels,r=this.__private__.mapper,o=e.adVolume;function s(e,n,o){function s(e){return r((n||i)(e))}return function(){o&&!o()||a(t[e],s)}}e.on(n.AdSkipped,s("skip")),e.on(n.AdStarted,s("creativeView")),e.on(n.AdVolumeChange,s("unmute",null,(function(){return 0===o&&e.adVolume>0}))),e.on(n.AdVolumeChange,s("mute",null,(function(){return o>0&&0===e.adVolume}))),e.on(n.AdImpression,s("impression")),e.on(n.AdViewableImpression,(function(){s("viewableImpression"),s("impression")})),e.on(n.AdVideoStart,s("start")),e.on(n.AdVideoFirstQuartile,s("firstQuartile")),e.on(n.AdVideoMidpoint,s("midpoint")),e.on(n.AdVideoThirdQuartile,s("thirdQuartile")),e.on(n.AdVideoProgress,(function(e){a([e.uri],r||i)})),e.on(n.AdVideoComplete,s("complete")),e.on(n.AdUserAcceptInvitation,s("acceptInvitationLinear")),e.on(n.AdUserMinimize,s("collapse")),e.on(n.AdUserClose,s("closeLinear")),e.on(n.AdPaused,s("pause")),e.on(n.AdResumed,s("resume")),e.on(n.AdPlaying,s("resume")),e.on(n.AdError,s("error",(function(e){return e.replace(/\[ERRORCODE\]/g,901)}))),e.on(n.AdVolumeChange,(function(){o=e.adVolume}))},e.exports=o},function(e,t){e.exports=function(){var e=document.createElement("video"),t=[],r=!1,n=e.addEventListener,i=e.removeEventListener,a=e.play,o=Array.prototype.map.call(e.attributes,(function(e){return e.name}));return e.init=function(t){return r?Promise.resolve():(r=!0,e.parentNode||t.appendChild(e),Promise.resolve().then((function(){return e.load()})).catch((function(e){return console.log("Error while initializing video",e)})))},e.clean=function(){t.forEach((function(t){i.call(e,t.type,t.listener,t.options)})),t=[],e.load(),s()},e.addEventListener=function(r,i,a){return t.push({type:r,listener:i,options:a}),n.call(e,r,i,a)},e.removeEventListener=function(t,r,n){return i.call(e,t,r,n)},e.play=function(){return r=!0,a.call(e)},s(),e;function s(){Array.prototype.forEach.call(e.attributes,(function(t){-1===o.indexOf(t.name)&&e.removeAttribute(t.name)})),e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",""),e.setAttribute("preload","auto"),e.style.display="block",e.style.width="100%",e.style.height="100%",e.style.position="absolute",e.style.left="0px",e.style.top="0px",e.style.backgroundColor="#000",e.style.objectFit="contain"}}},function(e,t,r){e.exports=r(47)},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r(48),l=r(50),u=r(12),c=r(3),f=c.isImaAd,d=c.createPromiseDefer,h=r(51),p=r(5).DEFAULT_MAX_VOLUME;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(r,u);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var s=o(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,r)}}(r);function r(e,n,i,o){var l;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(l=t.call(this,e,n,i,o))._onAdsManagerLoaded=l._onAdsManagerLoaded.bind(a(l)),l._onAdEvent=l._onAdEvent.bind(a(l)),l._onAdErrorEvent=l._onAdErrorEvent.bind(a(l)),l.adDisplayContainer=null,l.adsLoader=null,l.adsManager=null,l.adOption=null,l.currentAd=null,l.volume=l.videoContent.muted?0:l.videoContent.volume*p,l.paused=!1,l.destroyed=!1,l.loadDeferred=null,l.startAdRequested=!1,l.cancelledAdRequested=!1,l.initUserActionHappened=!1,s.load().then((function(){return l._init()})).catch((function(e){l.destroyed||l.logger.error(l.name,"cannot load SDK",e)})),l}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"GoogleImaPlayer"}},{key:"videoContentWidth",get:function(){return this.videoContent.offsetWidth}},{key:"videoContentHeight",get:function(){return this.videoContent.offsetHeight}},{key:"videoContentVolume",get:function(){return this.videoContent.muted?0:this.videoContent.volume}},{key:"selfControl",get:function(){return!1}},{key:"canClickThrough",get:function(){return!0}},{key:"isGoogleImaAd",get:function(){return!0}},{key:"initUserAction",value:function(){!this.initUserActionHappened&&this.adDisplayContainer&&(this.initUserActionHappened=!0,this.adDisplayContainer.initialize(),this.adDisplayContainer.initialized=!0,this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){var r=this;this.logger.debug(this.name,"loadAd ad ",e),this.adOption=t,this.tracker=new l(e),this.tracker._trackEvent("requestVast"),this.loadDeferred=d();var n=e.vastAdTagURI;return s.isReady().then((function(){return r._requestAds(n)})).then((function(){return r.loadDeferred.promise}))}},{key:"canRun",value:function(e){return f(e)}},{key:"start",value:function(){return this.startAdRequested=!1,this.cancelledAdRequested=!1,this.paused=!1,this.destroyed?this._onAdStopped(new Error("cannot play ad since adsManager was destroyed")):this.adsManager?(this.initUserAction(),void this.adsManager.start()):(this.startAdRequested=!0,void this.logger.debug(this.name,"cannot play ad since adsManager is not loaded yet, try to play on load event"))}},{key:"stop",value:function(){this.adsManager&&this.adsManager.stop()}},{key:"skip",value:function(){this.stop()}},{key:"pause",value:function(){this.adsManager&&this.adsManager.pause()}},{key:"resume",value:function(){this.adsManager&&this.adsManager.resume()}},{key:"cancel",value:function(){this.adsManager?this.adsManager.stop():this.cancelledAdRequested=!0}},{key:"setVolume",value:function(e){this.logger.debug(this.name,"setVolume | volume ",e),this.volume=e,this.adsManager&&this.adsManager.setVolume(e)}},{key:"getVolume",value:function(){return this.volume}},{key:"isPaused",value:function(){return this.paused}},{key:"getRemainingTime",value:function(){return this.adsManager.getRemainingTime()}},{key:"getDuration",value:function(){return this.currentAd?this.currentAd.getDuration():0}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.currentAd&&this.currentAd.getSkipTimeOffset()),this.adOption?this.adOption.skipoffset:-1}},{key:"resize",value:function(){this.adsManager&&this.adsManager.resize(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL)}},{key:"destroy",value:function(){this.destroyed=!0,this._destroyAdsManager(),this._destroyAdDisplayContainer(),this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){this.destroyed||(this.element=document.createElement("div"),this.element.style.width="100%",this.element.style.height="100%",this.element.style.position="absolute",this.element.style.zIndex=1,this.element.style.backgroundColor="rgba(0, 0, 0, 0.8)",this.element.setAttribute("data-player",this.name),this.adContainerElement.appendChild(this.element),google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.INSECURE),google.ima.settings.setDisableCustomPlaybackForIOS10Plus(!0),google.ima.settings.setDisableFlashAds(!0),this.adDisplayContainer=new google.ima.AdDisplayContainer(this.element,this.videoContent),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer),this.adsLoader.getSettings().setPlayerType("zplayer-ima"),this.adsLoader.getSettings().setPlayerVersion(h.version),this.adsLoader.getSettings().setAutoPlayAdBreaks(this.options.autoPlayAdBreaks),this.adsLoader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,this._onAdsManagerLoaded,!1),this.adsLoader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1),this._hide())}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_requestAds",value:function(e){this.logger.debug(this.name,"_requestAds | adTagUrl",e);var t=new google.ima.AdsRequest;t.adTagUrl=e,t.linearAdSlotWidth=this.videoContentWidth,t.linearAdSlotHeight=this.videoContentHeight,t.nonLinearAdSlotWidth=this.videoContentWidth,t.nonLinearAdSlotHeight=this.videoContentHeight,t.forceNonLinearFullSlot=!0,t.setAdWillAutoPlay(this.options.autoPlay),t.setAdWillPlayMuted(this.options.mute),this.adsLoader.requestAds(t)}},{key:"_onAdsManagerLoaded",value:function(e){var t=new google.ima.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.enablePreloading=!0,this.adsManager=e.getAdsManager(this.videoContent,t),this.setVolume(this.volume),this.adsManager.init(this.videoContentWidth,this.videoContentHeight,google.ima.ViewMode.NORMAL),this._startAdsManager(this.adsManager)}},{key:"_startAdsManager",value:function(e){e.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,this._onAdErrorEvent,!1,this);var t=[google.ima.AdEvent.Type.LOADED,google.ima.AdEvent.Type.STARTED,google.ima.AdEvent.Type.IMPRESSION,google.ima.AdEvent.Type.FIRST_QUARTILE,google.ima.AdEvent.Type.MIDPOINT,google.ima.AdEvent.Type.THIRD_QUARTILE,google.ima.AdEvent.Type.COMPLETE,google.ima.AdEvent.Type.PAUSED,google.ima.AdEvent.Type.RESUMED,google.ima.AdEvent.Type.SKIPPED,google.ima.AdEvent.Type.CLICK,google.ima.AdEvent.Type.USER_CLOSE,google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,google.ima.AdEvent.Type.ALL_ADS_COMPLETED];for(var r in t)e.addEventListener(t[r],this._onAdEvent,!1,this);this.cancelledAdRequested?this.cancel():this.startAdRequested&&this.start()}},{key:"_onAdEvent",value:function(e){var t=this;this.logger.debug(this.name,"Ad event:",e.type),this.tracker.onAdEvent(e);var r=e.getAd();switch(e.type){case google.ima.AdEvent.Type.LOADED:this.onAdLoaded(),this.loadDeferred.resolve(),this.loadDeferred=null,r.isLinear()||(this.element.style.backgroundColor="transparent");break;case google.ima.AdEvent.Type.STARTED:if(this.currentAd=r,this._onAdStarted(),!r.isLinear()){var n=-1===r.g.duration?15:r.g.duration;setTimeout((function(){t.adsManager&&t.adsManager.stop(),t._onAdStopped()}),1e3*n)}break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:this._onAdStopped();break;case google.ima.AdEvent.Type.PAUSED:this._onAdPausedEvent();break;case google.ima.AdEvent.Type.RESUMED:this._onAdResumedEvent()}}},{key:"_onAdErrorEvent",value:function(e){var t=e.getError();this.loadDeferred?this.loadDeferred.reject(t):(this.logger.error(this.name,"Ad error:",t.toString()),this._onAdStopped(t))}},{key:"_onAdPausedEvent",value:function(){this.paused=!0}},{key:"_onAdResumedEvent",value:function(){this.paused=!1}},{key:"_onAdStarted",value:function(){this._show(),this.onAdStarted()}},{key:"_onAdStopped",value:function(e){this._hide(),this._destroyAdsManager(),this.onAdStopped(e)}},{key:"_destroyAdsManager",value:function(){this.adsManager&&(this.adsManager.destroy(),this.adsManager=null)}},{key:"_destroyAdDisplayContainer",value:function(){this.adDisplayContainer&&(this.adDisplayContainer.destroy(),this.adDisplayContainer=null)}}]),r}()},function(e,t,r){var n,i=r(49);e.exports={load:function(){return n||(n=new Promise((function(e,t){i((function(r){r?e():t(new Error("failed to load IMA SDK"))}),!0,6e3)}))),n},isReady:function(){return n}}},function(e,t){e.exports=function(e,t,r){var n=window,i=document,a=null,o=function(t){n.clearTimeout(a),"function"==typeof e&&e(t)};if(n.google&&n.google.ima)o(!0);else{var s=!0===t?"https:":"",l=i.getElementsByTagName("script")[0],u=i.createElement("script");u.src=s+"//imasdk.googleapis.com/js/sdkloader/ima3.js",u.async=!0,"function"==typeof e&&(u.onload=function(){o(!0)}),l.parentNode.insertBefore(u,l),r&&(a=n.setTimeout((function(){o(!1)}),r))}}},function(e,t){e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.impressionEvents=[].concat(t.impressions||[],t.viewableImpressions||[]),this.trackingEvents=t.creatives.lenght&&t.creatives[0].trackingEvents||[],t.creatives.lenght&&t.creatives[0].videoClicks&&(this.clickTrackingUri=t.creatives[0].videoClicks.clickTrackings[0])}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"onAdEvent",value:function(e){var t=this;switch(e.type){case google.ima.AdEvent.Type.IMPRESSION:this.impressionEvents.forEach((function(e){return t._fireEvent(e.uri)}));break;case google.ima.AdEvent.Type.STARTED:this._trackEvent("start"),this._trackEvent("creativeView");break;case google.ima.AdEvent.Type.FIRST_QUARTILE:this._trackEvent("firstQuartile");break;case google.ima.AdEvent.Type.MIDPOINT:this._trackEvent("midpoint");break;case google.ima.AdEvent.Type.THIRD_QUARTILE:this._trackEvent("thirdQuartile");break;case google.ima.AdEvent.Type.COMPLETE:this._trackEvent("complete");break;case google.ima.AdEvent.Type.PAUSED:this._trackEvent("pause");break;case google.ima.AdEvent.Type.RESUMED:this._trackEvent("resume");break;case google.ima.AdEvent.Type.SKIPPED:this._trackEvent("skip");break;case google.ima.AdEvent.Type.USER_CLOSE:this._trackEvent("close");break;case google.ima.AdEvent.Type.CLICK:this.clickTrackingUri&&this._fireEvent(this.clickTrackingUri)}}},{key:"_trackEvent",value:function(e){var t=this;this.trackingEvents.filter((function(t){return t.event===e})).forEach((function(e){return t._fireEvent(e.uri)}))}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),e}()},function(e){e.exports={name:"@zplayer/ad-runner",version:"1.0.36",description:"Generic ad runner library for media player",main:"dist/ad-runner.min.js",author:"ZTE folks",publishConfig:{registry:"https://nexus-repo.zapps.vn/repository/zjs-repo/"},scripts:{dev:"webpack-dev-server --progress --mode development --config webpack.config.js",watch:"webpack --progress --watch --mode development --output-filename=[name].min.js --config webpack.config.js",build:"webpack -p --progress --mode production --config webpack.config.js","build-demo":"webpack --progress --mode development --config webpack.config.js",lint:"eslint *.js src/"},devDependencies:{"@babel/core":"^7.1.2","@babel/preset-env":"^7.1.0","@zjs/vast-player":"1.3.70","babel-loader":"^8.0.4","clean-webpack-plugin":"0.1.19","css-loader":"1.0.0",eslint:"^5.4.0","eslint-plugin-import":"^2.15.0","generate-changelog":"^1.7.1","html-webpack-plugin":"3.2.0","node-sass":"4.13.0","sass-loader":"7.1.0","style-loader":"0.23.0",webpack:"4.17.2","webpack-cli":"3.1.0","webpack-dev-server":"3.1.8","webpack-merge":"4.1.4"}}},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r(7).VastPlayer,l=r(12),u=r(3),c=u.isImaAd,f=u.isFacebookAd,d=u.isAsiaSmartAd,h=u.isYomediaAd,p=r(5).AD_DONE_REASON;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var s=o(this).constructor;r=Reflect.construct(i,arguments,s)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,r)}}(r);function r(e,n,i,o){var s;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(s=t.call(this,e,n,i,o)).adOption=null,s.loadPromise=null,s.initUserActionHappened=!1,s.onAdSkipped=i.onAdSkipped,s._onAdError=s._onAdError.bind(a(s)),s._init(),s}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"VastLinearPlayer"}},{key:"canClickThrough",get:function(){return this.player.isVPAID&&"MOAT"!==this.player.vpaidVendor&&"YOMEDIA"!==this.player.vpaidVendor}},{key:"isFacebookAd",get:function(){return f(this.ad)}},{key:"isAsiaSmartAd",get:function(){return d(this.ad)}},{key:"isYomediaAd",get:function(){return h(this.ad)||!1}},{key:"viewDetailLink",get:function(){return this.player&&this.player.viewDetailLink}},{key:"canRun",value:function(e){return!c(e)&&"linear"===e.creatives[0].type}},{key:"initUserAction",value:function(){this.initUserActionHappened||(this.initUserActionHappened=!0,this.player.init(),this.logger.debug(this.name,"init user action done"))}},{key:"loadAd",value:function(e,t){return this.ad=e,this.adOption=t,this.loadPromise=this.player.load({ads:[e]}),this.loadPromise}},{key:"start",value:function(){var e=this;this.loadPromise.then((function(){return e.player.startAd()})).catch(this._onAdError)}},{key:"stop",value:function(){var e=this;this.loadPromise.then((function(){return e.player.stopAd()})).catch(this._onAdError)}},{key:"skip",value:function(){var e=this;this.loadPromise.then((function(){return e.player.skipAd()})).catch(this._onAdError)}},{key:"pause",value:function(){var e=this;return this.loadPromise.then((function(){return e.player.pauseAd()})).catch(this._onAdError)}},{key:"resume",value:function(){var e=this;return this.loadPromise.then((function(){e.isYomediaAd?e.player.playAd():e.player.resumeAd()})).catch(this._onAdError)}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){var e=this;this.loadPromise.then((function(){if(e.player.isVPAID)try{var t=e.player.__private__.player.api&&e.player.__private__.player.api.clickThrough;if(t)return void e.player.emit("AdClickThru",t,null,!0);e.player.__private__.video.click(),e.resume()}catch(t){e.logger.error(e.name,"error while simulate click on VPAID ad",t)}else e.player.emit("AdClickThru",null,null,!0)})).catch(this._onAdError)}},{key:"setVolume",value:function(e){var t=this;this.loadPromise.then((function(){t.player.adVolume=e}))}},{key:"getVolume",value:function(){return this.loadPromise?this.player.adVolume:0}},{key:"isPaused",value:function(){return this.player.paused}},{key:"getRemainingTime",value:function(){if(this.isAsiaSmartAd||this.isYomediaAd){var e=this.getDuration();return e>0?e-this.getAdCurrentTime():e}return this.player&&this.player.adRemainingTime}},{key:"getDuration",value:function(){return this.player&&this.player.adDuration}},{key:"getAdCurrentTime",value:function(){return Math.floor(this.player.__private__.video.currentTime)}},{key:"getSkipOffset",value:function(){return this.logger.debug(this.name,"skipTimeOffset",this.adOption.skipoffset),this.adOption?this.adOption.skipoffset:-1}},{key:"destroy",value:function(){this.loadPromise&&this.ad&&this.stop(),this.player=null,this.element&&(this.adContainerElement.removeChild(this.element),this.element=null),this.logger.debug(this.name,"destroyed")}},{key:"_init",value:function(){var e=this,t=document.createElement("div"),r=new s(t,{width:e.videoContent.offsetWidth,height:e.videoContent.offsetHeight});t.style.width="100%",t.style.height="100%",t.style.position="absolute",t.style.zIndex=1,t.setAttribute("data-player",this.name),r.on("AdStarted",(function(){return e._onAdStartedEvent()})),r.on("AdStopped",(function(){return e._onAdStoppedEvent()})),r.on("AdSkipped",(function(){return e._onAdSkippedEvent()})),r.on("AdLoaded",(function(){return e._onAdLoadedEvent()})),e.adContainerElement.appendChild(t),e.element=t,e.player=r,e._hide()}},{key:"_show",value:function(){this.element.style.display="block"}},{key:"_hide",value:function(){this.element.style.display="none"}},{key:"_onAdLoadedEvent",value:function(){this.onAdLoaded()}},{key:"_onAdStartedEvent",value:function(){if(this._show(),this.onAdStarted(),this.isFacebookAd)try{this.player.__private__.player.frame.contentDocument.querySelector("#an_skip_button").style.display="none"}catch(e){this.logger.warn(this.name,"failed to remove FB skip button",e)}}},{key:"_onAdStoppedEvent",value:function(e,t){this.loadPromise=null,this._hide(),this.onAdStopped(e,t)}},{key:"_onAdSkippedEvent",value:function(){this.onAdSkipped(),this._onAdStoppedEvent(null,p.skipped)}},{key:"_onAdError",value:function(e){this._onAdStoppedEvent(e)}}]),r}()},function(e,t,r){e.exports=r(54)},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e){return(a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var o=r(12),s=r(3).isImaAd,l=r(55),u=r(59),c=r(5).DEFAULT_NON_LINEAR_DURATION;e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(r,o);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=a(e);if(t){var o=a(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(e,n,i,a){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(o=t.call(this,e,n,i,a)).ad=null,o.adOption=null,o.imgUrl=null,o.adTimer=null,o}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"VastNonLinearPlayer"}},{key:"selfControl",get:function(){return!0}},{key:"viewDetailLink",get:function(){return this.ad.creatives[0].ads[0].clickThrough}},{key:"canRun",value:function(e){return!s(e)&&e.creatives.length&&"nonLinear"===e.creatives[0].type}},{key:"initUserAction",value:function(){}},{key:"loadAd",value:function(e,t){this.ad=e,this.adOption=t,this.imgUrl=null;var r=e.creatives[0].ads[0].resources;return r&&this._isValidImageAd(r)?(this.imgUrl=r,this.onAdLoaded(),Promise.resolve()):Promise.reject(new Error("no playable non-linear file"))}},{key:"start",value:function(){this.adTimer&&this.stop();var e=this.ad.creatives[0],t=parseInt(e.ads[0].width),r=parseInt(e.ads[0].height);return this.tracker=new u(this.ad),this.adUi=new l(this,this.videoContent.offsetWidth,this.videoContent.offsetHeight),this.adUi.setImage(this.imgUrl,t,r),this.adContainerElement.appendChild(this.adUi.element),this._onAdStartedEvent(),Promise.resolve()}},{key:"stop",value:function(){this._onAdStoppedEvent()}},{key:"cancel",value:function(){this.stop()}},{key:"viewDetail",value:function(){try{var e=this.viewDetailLink;e&&window.open(e,"_blank")}catch(e){this.logger.error(this.name,"error while showing detail of ad",e)}}},{key:"setVolume",value:function(){}},{key:"getRemainingTime",value:function(){}},{key:"getDuration",value:function(){}},{key:"destroy",value:function(){this._stopAdTimer(),this.adUi&&this.adUi.remove(),this.logger.debug(this.name,"destroyed")}},{key:"_isValidImageAd",value:function(e){return!/\.swf/.test(e)}},{key:"_startAdTimer",value:function(){var e=this;this.adTimer=setTimeout((function(){return e.stop()}),1e3*(this.adOption.duration||c))}},{key:"_stopAdTimer",value:function(){clearTimeout(this.adTimer),delete this.adTimer}},{key:"_onAdStartedEvent",value:function(){this._startAdTimer(),this.adUi.show(),this.tracker.onAdStarted(),this.onAdStarted()}},{key:"_onAdStoppedEvent",value:function(){this._stopAdTimer(),this.adUi.remove(),this.tracker.onAdStopped(),this.onAdStopped(null,null,!0,this.adData)}}]),r}()},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(56);var l=r(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var a=s(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,r)}}(r);function r(e,n,i){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(a=t.call(this,{className:"ad_runner_non_linear_ad_ui"})).player=e,a.maxWidth=n,a.maxHeight=i,a._onCloseButtonClickEvent=a._onCloseButtonClickEvent.bind(o(a)),a._onImageClickEvent=a._onImageClickEvent.bind(o(a)),a.render(),a._registerEvents(),a}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"render",value:function(){i(s(r.prototype),"render",this).call(this),this.closeButton=new l({tagName:"span"}),this.closeButton.render(),this.closeButton.html("[x]"),this.closeButton.attr("title","\u0110\xf3ng qu\u1ea3ng c\xe1o"),this.appendChild(this.closeButton),this.image=new l({tagName:"img"}),this.image.render(),this.appendChild(this.image)}},{key:"remove",value:function(){this._unregisterEvents(),i(s(r.prototype),"remove",this).call(this)}},{key:"setImage",value:function(e,t,r){(t>this.maxWidth||r>this.maxHeight)&&(this.image.attr("width","auto"),this.image.attr("height","auto"),t>r?this.image.style("max-width","".concat(this.maxWidth-40,"px")):this.image.style("max-height","".concat(this.maxHeight-40,"px"))),this.image.attr("src",e)}},{key:"_registerEvents",value:function(){this.closeButton.on("click",this._onCloseButtonClickEvent),this.image.on("click",this._onImageClickEvent)}},{key:"_unregisterEvents",value:function(){this.closeButton.off("click",this._onCloseButtonClickEvent),this.image.off("click",this._onImageClickEvent)}},{key:"_onCloseButtonClickEvent",value:function(e){e.stopPropagation(),this.player.stop()}},{key:"_onImageClickEvent",value:function(e){e.stopPropagation(),this.player.viewDetail()}}]),r}()},function(e,t,r){var n=r(57);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_non_linear_ad_ui span{position:absolute;top:0;right:0;color:#f9754d;cursor:pointer;padding:2px;font-weight:bold;background-color:white}.ad_runner_non_linear_ad_ui img{cursor:pointer}\n",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t){var r=["start","creativeView"],n=["close"];e.exports=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.impressionEvents=[].concat(t.impressions||[],t.viewableImpressions||[]),this.trackingEvents=t.creatives[0].trackingEvents}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"onAdStarted",value:function(){var e=this;this.impressionEvents.forEach((function(t){return e._fireEvent(t.uri)})),this._trackEvents(r)}},{key:"onAdStopped",value:function(){this._trackEvents(n)}},{key:"_trackEvents",value:function(e){var t=this;this.trackingEvents.filter((function(t){return e.indexOf(t.event)>-1})).forEach((function(e){return t._fireEvent(e.uri)}))}},{key:"_fireEvent",value:function(e){e&&((new Image).src=e)}}]),e}()},function(e,t,r){var n=r(5),i=n.AD_POSITION,a=n.PRELOAD_DURATION,o=n.COUNT_DOWN_DURATION,s=r(3).createPromiseDefer,l="midroll";function u(e){return e.ads[0]&&e.ads[0].creatives.length&&"nonLinear"!==e.ads[0].creatives[0].type}e.exports=function(){function e(t){var r=t.prepareAd,n=t.beforePlayAd,i=t.preloadAd,a=t.loadAd,o=t.playAd,l=t.logger;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.props={prepareAd:r,beforePlayAd:n,preloadAd:i,loadAd:a,playAd:o,logger:l},this._reset(),this.dataLoadingDeferred=s()}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(e,[{key:"name",get:function(){return"Scheduler"}},{key:"logger",get:function(){return this.props.logger}},{key:"populateAdsData",value:function(e){var t=this;e.forEach((function(e){return e.position===i.preroll?t.prerollAds.push(e):e.position===i.postroll?t.postrollAds.push(e):void t.midrollAds.push(e)})),this.midrollAds.sort((function(e,t){return t.startTime>e.startTime?1:-1})),this.prerollAds.length&&this.props.loadAd(this.prerollAds[0]),this.dataLoadingDeferred.resolve()}},{key:"onContentProgress",value:function(e){var t=this;if(this.ignoredFirstFrame){if(!this.state)return this._setState("preroll"),void this.dataLoadingDeferred.promise.then((function(){t._playAds(t.prerollAds).then((function(){t._setState(l)}))}));if(this.state===l){if(!this.midrollAds.length)return this._setState("postroll");var r=e.current<0?e.total:e.current,n=this._getAdsPriorTime(this.midrollAds,r),i=this._getAdsPriorTime(this.midrollAds,r+a);if(i.length&&this.props.preloadAd(i[0]),n.length)this.midrollAds.splice(this.midrollAds.length-n.length,n.length),this.props.beforePlayAd(u(n[0]),(function(){t._playAds(n)}));else{var s=this._getAdsPriorTime(this.midrollAds,r+o);if(s.length){var c=s[0].startTime-r;this.props.prepareAd(s[0],c)}}}}else this.ignoredFirstFrame=!0}},{key:"onContentEnded",value:function(){this.midrollAds.length&&this.logger.warn(this.name,"cannot play these mid-roll ads because start time is too late",this.midrollAds),this._playAds(this.postrollAds),this._reset()}},{key:"_reset",value:function(){this.ignoredFirstFrame=!1,this._setState(null),this.prerollAds=[],this.midrollAds=[],this.postrollAds=[]}},{key:"_setState",value:function(e){this.logger.info(this.name,"state changed from ".concat(this.state," to ").concat(e)),this.state=e}},{key:"_playAds",value:function(e){var t=this,r=[],n=[];return e.forEach((function(e){u(e)?r.push(e):n.push(e)})),this._playAd(r).then((function(){return t._playAd(n)}))}},{key:"_playAd",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=e[r];if(n){var i={order:r+1,total:e.length};return this.props.playAd(n,i).catch((function(e){t.logger.error(t.name,"error while playing ad",e)})).then((function(){return t._playAd(e,r+1)}))}return Promise.resolve()}},{key:"_getAdsPriorTime",value:function(e,t){for(var r=e.length-1;r>-1&&t>e[r].startTime;)--r;return e.slice(r+1).reverse()}}]),e}()},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r(2),u=r(19),c=r(64),f=r(3),d=r(79),h=r(82);r(85),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var a=s(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,r)}}(r);function r(e,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(i=t.call(this)).options=e,i.adContainers=n,i.$adContainer=new l({element:n.linear}),i.$adContainer.render(),i.adPlayer=null,i.adPaused=!1,i.adVolume=0,i.adVolumeCached=1,i.mouseEntered=!1,i._onClick=i._onClick.bind(o(i)),i._onMouseEnter=i._onMouseEnter.bind(o(i)),i._onMouseLeave=i._onMouseLeave.bind(o(i)),i._onSkipBtnClick=i._onSkipBtnClick.bind(o(i)),i._onViewDetailBtnClick=i._onViewDetailBtnClick.bind(o(i)),i.render(),i._registerEvents(),i.control.hide(),f.isMobile()&&(i.addClass("is_mobile"),i.$adContainer.off("mouseenter",i._onMouseEnter),i.$adContainer.off("mouseleave",i._onMouseLeave)),i}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){return i(s(r.prototype),"render",this).call(this),this.hide(),this.$uiLoading=new l({className:"ad_runner_ui_loading"}),this.$uiLoading.render(),this.$uiLoading.element.textContent="\u0110ang t\u1ea3i qu\u1ea3ng c\xe1o...",this.$uiLoading.hide(),this.$uiViewDetail=new l({className:"ad_runner_ui_viewdetail"}),this.$uiViewDetail.render(),this.$uiViewDetail.element.textContent="Xem chi ti\u1ebft qu\u1ea3ng c\xe1o",this.$uiAdIndex=new l({className:"ad_runner_ui_adindex"}),this.$uiAdIndex.render(),this.$uiAdIndex.hide(),this.countdownToPlay=new u({template:"Qu\u1ea3ng c\xe1o hi\u1ec3n th\u1ecb sau %ss",className:"ad_runner_ui_countdown_to_play"}),this.countdownToPlay.hide(),this.skipButton=new d({getPoster:this.options.getPoster}),this.control=new c(this),this.slideBlack=new h(this),this.appendChild(this.$uiViewDetail),this.appendChild(this.$uiAdIndex),this.appendChild(this.skipButton),this.appendChild(this.control),this.$adContainer.appendChild(this),this.adContainers.notification.appendChild(this.countdownToPlay.element),this.adContainers.notification.appendChild(this.$uiLoading.element),this.adContainers.notification.appendChild(this.slideBlack.element),this}},{key:"remove",value:function(){this._unregisterEvents(),this._stopSkipTimer(),this._stopProgressTimer(),this.skipButton.remove(),this.countdownToPlay.remove(),this.control.remove(),this.$uiLoading.remove(),this.slideBlack.remove(),i(s(r.prototype),"remove",this).call(this)}},{key:"setPlayer",value:function(e){this.adPlayer=e}},{key:"togglePlayPause",value:function(){this.adPlayer.isPaused()?(this.adPlayer.resume(),this._onPauseStateChanged(!1)):(this.adPlayer.pause(),this._onPauseStateChanged(!0))}},{key:"toggleMute",value:function(){var e=this.adPlayer.getVolume(),t=e?0:this.adVolumeCached;this.adPlayer.setVolume(t),this._onVolumeChanged(t),this.adVolumeCached=e}},{key:"onAdWillStart",value:function(){this.show(),this.$uiLoading.show(),this.$uiViewDetail.hide(),this.$uiAdIndex.hide(),this.skipButton.hide(),this.skipButton.loadPoster(),this.countdownToPlay.hide()}},{key:"onAdStarted",value:function(e){if(this.adPlayer.selfControl)return this.$uiLoading.hide(),void this.hide();this.adPlayer.canClickThrough?this.addClass("click-through"):this.removeClass("click-through"),this.adPlayer.isFacebookAd?this.addClass("facebook-ad"):this.removeClass("facebook-ad"),this.adPlayer.isGoogleImaAd?this.addClass("google-ima-ad"):this.removeClass("google-ima-ad"),this.$uiLoading.hide(),this.$uiViewDetail.show(),e&&e.total>1&&(this.$uiAdIndex.show(),this.$uiAdIndex.html("Qu\u1ea3ng c\xe1o ".concat(e.order," / ").concat(e.total))),this._startProgressTimer(),this.adPlayer.getSkipOffset()>-1&&(this.skipButton.show(),this.skipButton.update(this._getTimeToSkip()||5),this._startSkipTimer()),this._onVolumeChanged(this.adPlayer.getVolume())}},{key:"onAdStopped",value:function(){this._stopSkipTimer(),this._stopProgressTimer(),this.$uiLoading.hide(),this.hide()}},{key:"_registerEvents",value:function(){this.on("click",this._onClick),this.$adContainer.on("mouseenter",this._onMouseEnter),this.$adContainer.on("mouseleave",this._onMouseLeave),this.skipButton.on("click",this._onSkipBtnClick),this.$uiViewDetail.on("click",this._onViewDetailBtnClick)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClick),this.$adContainer.off("mouseenter",this._onMouseEnter),this.$adContainer.off("mouseleave",this._onMouseLeave),this.skipButton.off("click",this._onSkipBtnClick),this.$uiViewDetail.off("click",this._onViewDetailBtnClick)}},{key:"_startProgressTimer",value:function(){var e=this;this.progressTimer=setInterval((function(){var t={duration:e.adPlayer.getDuration(),remaining:e.adPlayer.getRemainingTime(),paused:e.adPlayer.isPaused()};e.control.onProgress(t);var r=e.adPlayer.getVolume();t.paused!==e.adPaused&&e._onPauseStateChanged(t.paused),r!==e.adVolume&&e._onVolumeChanged(r)}),1e3)}},{key:"_stopProgressTimer",value:function(){clearInterval(this.progressTimer),this.progressTimer=null}},{key:"_startSkipTimer",value:function(){var e=this;this._stopSkipTimer();var t=this._getTimeToSkip();this.skipTimer=setInterval((function(){var r=e._getTimeToSkip();e.adPlayer.isPaused()||(t-=1),r<=0||r-t>e.options.skipTimeout?(e.skipButton.skipOn(),e._stopSkipTimer()):e.skipButton.update(r)}),1e3)}},{key:"_stopSkipTimer",value:function(){this.skipTimer&&(clearInterval(this.skipTimer),this.skipTimer=null)}},{key:"_getTimeToSkip",value:function(){var e=this.adPlayer.getSkipOffset()+this.adPlayer.getRemainingTime()-this.adPlayer.getDuration();return e<0?5:e}},{key:"_onSkipBtnClick",value:function(e){var t=this;e.stopPropagation(),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2?arguments[2]:void 0;e.style.opacity||(e.style.opacity=1);var n=null;window.requestAnimationFrame((function i(a){var o=a-(n=n||a),s=parseFloat(1-o/t,2);e.style.opacity=s<0?0:s,o>t?"function"==typeof r&&r():window.requestAnimationFrame(i)}))}(this.adPlayer.element,300,(function(){t.adPlayer.skip(),t.adPlayer.element.style.opacity=null}))}},{key:"_onViewDetailBtnClick",value:function(e){e.stopPropagation(),this.adPlayer.viewDetail()}},{key:"_onClick",value:function(){this.togglePlayPause()}},{key:"_onMouseEnter",value:function(){this.mouseEntered=!0,!this.adPaused&&this.control.show()}},{key:"_onMouseLeave",value:function(){this.mouseEntered=!1,!this.adPaused&&this.control.hide()}},{key:"_onPauseStateChanged",value:function(e){this.adPaused=e,this.control.onPauseStateChanged(e,this.mouseEntered)}},{key:"_onVolumeChanged",value:function(e){this.adVolume=e,this.control.onMuteStateChanged(0===e)}}]),r}()},function(e,t,r){var n=r(63);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_countdown{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r(2),l=r(65),u=r(68),c=r(71),f=r(74);r(77),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var a=o(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this)).adUi=e,n.render(),n}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_control"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"show",value:function(){this.playpause.show(),this.volume.show(),this.timer.show(),this.removeClass("minimized"),this.adUi.addClass("has_control")}},{key:"hide",value:function(){this.playpause.hide(),this.volume.hide(),this.timer.hide(),this.addClass("minimized"),this.adUi.removeClass("has_control")}},{key:"remove",value:function(){this.timeline.remove(),this.playpause.remove(),this.volume.remove(),this.timer.remove(),i(o(r.prototype),"remove",this).call(this)}},{key:"render",value:function(){i(o(r.prototype),"render",this).call(this),this.timeline=new l,this.playpause=new u(this.adUi),this.timer=new f,this.volume=new c(this.adUi),this.appendChild(this.timeline),this.appendChild(this.playpause),this.appendChild(this.timer),this.appendChild(this.volume)}},{key:"onProgress",value:function(e){e.paused||(this.timeline.setPosition((e.duration-e.remaining)/e.duration*100),this.timer.update(e))}},{key:"onPauseStateChanged",value:function(e,t){e?this.show():t||this.hide(),this.playpause.onPauseStateChanged(e)}},{key:"onMuteStateChanged",value:function(e){this.volume.onMuteStateChanged(e)}}]),r}()},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r(2);r(66),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var a=o(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=t.call(this)).render(),e}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_timeline"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(o(r.prototype),"render",this).call(this),this.$uiProgress=new s,this.$uiProgress.render(),this.appendChild(this.$uiProgress)}},{key:"setPosition",value:function(e){e<=100&&this.$uiProgress.style("width","".concat(e,"%"))}}]),r}()},function(e,t,r){var n=r(67);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_timeline{bottom:0;height:4px;left:0;position:absolute;width:100%}.ad_runner_ui_timeline>div{-webkit-transition:width 1s linear;-moz-transition:width 1s linear;-o-transition:width 1s linear;transition:width 1s linear;background-color:#ffff00;height:100%;width:0%}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r(2);r(69);var u='<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 16,26 16,10 12,10 z M 21,26 25,26 25,10 21,10 z"></path></svg>';e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var a=s(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,r)}}(r);function r(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this)).adUi=e,n._onClickEvent=n._onClickEvent.bind(o(n)),n.render(),n._registerEvents(),n}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_playpause"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(s(r.prototype),"render",this).call(this),this.html(u)}},{key:"remove",value:function(){this._unregisterEvents(),i(s(r.prototype),"remove",this).call(this)}},{key:"onPauseStateChanged",value:function(e){e?this.html('<svg height="100%" version="1.1" viewBox="0 0 36 36" width="100%"><path d="M 12,26 18.5,22 18.5,14 12,10 z M 18.5,22 25,18 25,18 18.5,14 z"></path></svg>'):this.html(u)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.togglePlayPause()}}]),r}()},function(e,t,r){var n=r(70);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_playpause{width:35px;height:35px;float:left;margin-left:5px}.ad_runner_ui_playpause:hover{cursor:pointer}.ad_runner_ui_playpause>svg{fill:#f5f5f5}.ad_runner_ui_playpause:hover>svg,.ad_runner_ui_playpause:active>svg{fill:#ffffff}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r(2);r(72);var u='<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="M8,21 L12,21 L17,26 L17,10 L12,15 L8,15 L8,21 Z M19,14 L19,22 C20.48,21.32 21.5,19.77 21.5,18 C21.5,16.26 20.48,14.74 19,14 Z M19,11.29 C21.89,12.15 24,14.83 24,18 C24,21.17 21.89,23.85 19,24.71 L19,26.77 C23.01,25.86 26,22.28 26,18 C26,13.72 23.01,10.14 19,9.23 L19,11.29 Z"></path></svg>';e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var a=s(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,r)}}(r);function r(e){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this))._onClickEvent=n._onClickEvent.bind(o(n)),n.adUi=e,n.render(),n._registerEvents(),n}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_volume"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(s(r.prototype),"render",this).call(this),this.html(u)}},{key:"remove",value:function(){this._unregisterEvents(),i(s(r.prototype),"remove",this).call(this)}},{key:"onMuteStateChanged",value:function(e){e?this.html('<svg height="100%" viewBox="0 0 36 36" width="100%"><path d="m16.98686,9.984l0,4.219l-2.109,-2.109l2.109,-2.11zm-7.734,-0.984l16.734,16.734l-1.266,1.266l-2.063,-2.063c-1.078,0.844 -2.297,1.5 -3.656,1.828l0,-2.063c0.844,-0.234 1.594,-0.656 2.25,-1.172l-4.266,-4.266l0,6.75l-5.016,-5.016l-3.984,0l0,-6l4.734,0l-4.734,-4.734l1.267,-1.264zm14.718,9c0,-3.188 -2.063,-5.859 -4.969,-6.703l0,-2.063c4.031,0.891 6.984,4.5 6.984,8.766c0,1.5 -0.375,2.953 -1.031,4.172l-1.5,-1.547c0.328,-0.797 0.516,-1.688 0.516,-2.625zm-2.484,0c0,0.234 0,0.422 -0.047,0.609l-2.438,-2.438l0,-2.203c1.5,0.75 2.484,2.25 2.484,4.031l0.001,0.001z"></path></svg>'):this.html(u)}},{key:"_registerEvents",value:function(){this.on("click",this._onClickEvent)}},{key:"_unregisterEvents",value:function(){this.off("click",this._onClickEvent)}},{key:"_onClickEvent",value:function(e){e.stopPropagation(),this.adUi.toggleMute()}}]),r}()},function(e,t,r){var n=r(73);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_volume{width:35px;height:35px;float:right;margin-right:5px}.ad_runner_ui_volume:hover{cursor:pointer}.ad_runner_ui_volume>svg{fill:#f5f5f5}.ad_runner_ui_volume:hover>svg,.ad_runner_ui_volume:active>svg{fill:#ffffff}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r(2),l=r(3).formatTime;r(75),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var a=o(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=t.call(this)).render(),e}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"name",get:function(){return"ad_runner_ui_timer"}},{key:"attributes",get:function(){return{class:this.name}}},{key:"render",value:function(){i(o(r.prototype),"render",this).call(this),this.html("00:00 / 00:00")}},{key:"update",value:function(e){var t=l(e.duration-e.remaining),r=l(e.duration);this.html("".concat(t," / ").concat(r))}}]),r}()},function(e,t,r){var n=r(76);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_timer{color:#f5f5f5;float:left;margin-left:5px;height:35px;line-height:35px;font-size:12px}\n",""])},function(e,t,r){var n=r(78);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_control{-webkit-transition:height 100ms ease;-moz-transition:height 100ms ease;-o-transition:height 100ms ease;transition:height 100ms ease;background:linear-gradient(transparent, #000);bottom:0;height:40px;left:0;position:absolute;width:100%;pointer-events:none}.ad_runner_ui_control.minimized{background:none;height:5px}.ad_runner_ui_control>*{pointer-events:auto}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=r(2),u=r(19);r(80),e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var a=s(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return o(e)}(this,r)}}(r);function r(e){var n,i=e.getPoster;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(n=t.call(this))._onPosterLoad=n._onPosterLoad.bind(o(n)),n.render(),n._registerEvents(),n.getPoster=i,n}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"attributes",get:function(){return{class:"ad_runner_ui_skip_button"}}},{key:"render",value:function(){i(s(r.prototype),"render",this).call(this),this.countdown=new u({template:"B\u1ecf qua qu\u1ea3ng c\xe1o sau %ss",className:"countdown"}),this.countdown.render(),this.update=this.countdown.update.bind(this.countdown),this.skipText=new l({className:"skip_text"}),this.skipText.render(),this.skipText.element.textContent="B\u1ecf qua",this.poster=new l({tagName:"img"}),this.poster.render(),this.poster.hide(),this.playIcon=new l({className:"play_icon"}),this.playIcon.render(),this.playIcon.html('<svg viewBox="12 12 24 24"><style type="text/css"> .st1{fill:none;stroke:#f1f1f1;stroke-width:1;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:10;} </style><g><g><path class="st1" d="M21.88173,28.00095l6.30217-3.67922c0.24333-0.14206,0.24348-0.49362,0.00028-0.63589l-6.30217-3.68663 c-0.2455-0.14361-0.5542,0.03345-0.5542,0.31786v7.36585C21.32781,27.9672,21.63623,28.14428,21.88173,28.00095z"/><circle class="st1" cx="24" cy="24" r="11.1667"/></g></g></svg>'),this.appendChild(this.skipText),this.appendChild(this.countdown),this.appendChild(this.poster),this.appendChild(this.playIcon)}},{key:"show",value:function(){i(s(r.prototype),"show",this).call(this),this.skipText.hide(),this.countdown.show(),this.removeClass("skippable")}},{key:"hide",value:function(){i(s(r.prototype),"hide",this).call(this),this.poster.hide(),this.removeClass("has_poster")}},{key:"remove",value:function(){this._unregisterEvents(),this.countdown.remove(),this.poster.remove(),this.skipText.remove(),this.playIcon.remove(),i(s(r.prototype),"remove",this).call(this)}},{key:"loadPoster",value:function(){var e=this;this.getPoster&&this.getPoster().then((function(t){e.poster.attr("src",t)}))}},{key:"skipOn",value:function(){this.skipText.show(),this.countdown.hide(),this.addClass("skippable")}},{key:"_onPosterLoad",value:function(){this.poster.show(),this.addClass("has_poster")}},{key:"_registerEvents",value:function(){this.poster.on("load",this._onPosterLoad)}},{key:"_unregisterEvents",value:function(){this.poster.off("load",this._onPosterLoad)}}]),r}()},function(e,t,r){var n=r(81);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runner_ui_skip_button{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;-webkit-transition:bottom 100ms ease;-moz-transition:bottom 100ms ease;-o-transition:bottom 100ms ease;transition:bottom 100ms ease;background-color:#2b2a2a;align-items:center;border:1px solid rgba(72,72,72,0.4);bottom:35px;display:flex;height:42px;padding:0;pointer-events:none !important;right:0px;text-align:center}.ad_runner_ui_skip_button.skippable{pointer-events:auto !important;cursor:pointer}.ad_runner_ui_skip_button .countdown{padding:5px;max-width:100px}.ad_runner_ui_skip_button .skip_text{font-size:13px;width:100px}.ad_runner_ui_skip_button .play_icon{position:absolute;width:65px;height:30px;right:0;display:none}.ad_runner_ui_skip_button .play_icon svg{width:30px;height:30px}.ad_runner_ui_skip_button.skippable.has_poster .play_icon{display:block}.ad_runner_ui_skip_button img{height:38px;object-fit:cover;width:65px}.is_mobile .ad_runner_ui_skip_button{width:170px;justify-content:center}.is_mobile .ad_runner_ui_skip_button .countdown{max-width:120px}.ad_runner_ui.facebook-ad .ad_runner_ui_skip_button{background-color:#000}.ad_runner_ui.has_control .ad_runner_ui_skip_button{bottom:35px}\n",""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(){return(i="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function a(e,t){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(83);var s=r(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&a(e,t)}(r,s);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=o(e);if(t){var a=o(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(r);function r(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(e=t.call(this,{className:"ad_runners_ui_slide_black"})).render(),e}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"fadeIn",value:function(){this.addClass("ad_ui_slide_black_fade_in")}},{key:"fadeOut",value:function(){this.removeClass("ad_ui_slide_black_fade_in")}},{key:"render",value:function(){i(o(r.prototype),"render",this).call(this),this.html('<span class="ad_message_text">Video n\u1ed9i dung s\u1ebd ti\u1ebfp t\u1ee5c sau \u0111o\u1ea1n qu\u1ea3ng c\xe1o</span>'),this.hide()}}]),r}()},function(e,t,r){var n=r(84);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runners_ui_slide_black{position:absolute;top:0;left:0;z-index:1;width:100%;height:100%;background-color:#000;opacity:0;-webkit-transition:opacity .3s linear;-moz-transition:opacity .3s linear;-o-transition:opacity .3s linear;transition:opacity .3s linear}.ad_runners_ui_slide_black.ad_ui_slide_black_fade_in{opacity:1}.ad_runners_ui_slide_black .ad_message_text{color:#eee;font-size:13px;position:absolute;left:10px;bottom:10px}\n",""])},function(e,t,r){var n=r(86);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,'.ad_runner_ui{left:0px;position:absolute;top:0px;width:100%;height:100%;z-index:2}.ad_runner_ui.click-through{pointer-events:none}.ad_runner_ui.click-through>*{pointer-events:auto}.ad_runner_ui.click-through .ad_runner_ui_viewdetail{display:none}.ad_runner_ui .ad_runner_ui_viewdetail{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAA2ElEQVQ4ja2U0U3DMBRFz0MM0BkyQleo2CAVm7ACYoaOUDagjJBs0G6A6AaHjzhSVcXGDtw/289H9z1fGbVXv83rCKBuCzWqwwPwBmz4D92Qt433+iVnawz0wDEtr/N+Myx1cEjLE/C6CpZAn0wzPkXE0+15New3UDXsDjQC+1xh8TVTvuYcDmo+RiVYEwh4bGhtFxHXTN0z8LXoTO3Uc40j9SUb2gT9ALqSo6o2I2JUR6ZkV4MWYQm4V7sWEBRyFhGXFlARtkahnpmG/Ve9z/9S6aet0aB2P+baSzgLyi9XAAAAAElFTkSuQmCC");background-position-x:calc(100% - 5px);background-position-y:center;background-repeat:no-repeat;background-size:12px;cursor:pointer;padding-right:20px;right:10px;top:10px}.ad_runner_ui .ad_runner_ui_adindex{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;background-color:transparent;background-image:url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAjVJREFUOBHlVEFrU0EQ/mb35TVtqqRKq0LaXhRbxbMggh5UKioePQserEcP4smjoHjoTUERvAi9eCmC9A+UCqJQJIJ6KAhNqlBLNE3y8nb89iV5SbB66bEDYb/9ZufLzOy8BXadia84Wi/MOCezgE6rYoTkEEQy3Bu6hZxfScFxUSIH1YigSm6D+6Ix+jgz9u2NROWJ87Fziz5gp2aNuWCcczd3KtSJ91oGghMdorPa4bsIR5eQ2b8IM3itQ8OEZ8ktIBwrIsg/B8xo6ksAtdgb6WNt7hZsbhZxdR4arSDY+xASngbsOEWesIMNxL/mKH6Svvv9gtQKyOR6WZO9TKFlxL/nSFuE2Yuw2Stw0QeIySHavAONv/JOfkLsZG+oxzkKqhdNTYKjcLWF9j6GuhI8J1pJOHXfk9VtzacxXaCBHwc/Cl2Ly+zCnnQvxOrWeWqzxclga7UF/tF0eq4NnOFU1XtZx3JNeIqHp2AGZljWQbZtmSW/S47Z7FV2YgLhyEv28EFvqJ/QutRK4yU25EDqkTxv8hVMcCShtLmKxo8zxDEFHsEOtW5dXQXRxvWk391YKUt9rVDkxE+lZBtIcJwZnoMdvo1m5R5c9UXiEXuY47IP2lxhRlt9YfzCPgX8nj4zw78EtfkRMX8uesuS36eBGn/xyW5v1DIKebq9t8VqY4mg9r8jqc9rJY9DbW3ykoi7wUyPqSCfPA6QAdb078cBWk8eB+XjIFJUNc+yh1Zfp+q7B/wBa0XJ8tc9BKoAAAAASUVORK5CYII=");background-position-y:center;background-repeat:no-repeat;bottom:50px;left:15px;padding-left:25px;text-shadow:0 0 4px #000}.ad_runner_ui_countdown_to_play{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px;z-index:1}.ad_runner_ui_loading{background-color:rgba(0,0,0,0.4);color:#eee;font-size:12px;height:auto;line-height:18px;padding:5px;position:absolute;width:auto;top:10px;left:10px}.ad_runner_ui_hide{display:none !important}\n',""])},function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return(i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function a(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function o(){return(o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}}).apply(this,arguments)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}r(88);var l=r(2);e.exports=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&i(e,t)}(r,l);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,i=s(e);if(t){var o=s(this).constructor;r=Reflect.construct(i,arguments,o)}else r=i.apply(this,arguments);return function(e,t){if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)}(this,r)}}(r);function r(e){var n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),o((n=a(i=t.call(this,{className:"ad_runners_ui_ad_mark_container"})),s(r.prototype)),"render",n).call(n),i.containerElement=e,e&&e.appendChild(i.element),i}return function(e,t,r){t&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1})}(r,[{key:"render",value:function(e,t){var r=this;this.containerElement&&t.forEach((function(t){var n=100*t.startTime/e;if(0<=n&&n<=100){var i=r._createAdMarkItem(n);r.appendChild(i),t.adMarkItem=i,t._completeAd=function(){i.remove()}}}))}},{key:"removeMarkItems",value:function(){this.html("")}},{key:"setContainer",value:function(e){e.appendChild(this.element)}},{key:"_createAdMarkItem",value:function(e){var t=document.createElement("span");return t.setAttribute("class","ad_runners_ui_ad_mark_container_item"),t.style.left="".concat(e,"%"),t}}]),r}()},function(e,t,r){var n=r(89);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".ad_runners_ui_ad_mark_container{display:flex !important;width:100%;height:100%}.ad_runners_ui_ad_mark_container .ad_runners_ui_ad_mark_container_item{height:100%;width:5px;background-color:yellow;display:block;position:relative}\n",""])}])},function(e,t){e.exports="data:application/vnd.ms-fontobject;charset=utf-8;base64,WA0AALQMAAABAAIAAAAAAAAAAAAAAAAAAAABAJABAAAAAExQAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAoXVQmwAAAAAAAAAAAAAAAAAAAAAAAA4AcABsAC0AaQBjAG8AbgAAAA4AUgBlAGcAdQBsAGEAcgAAABYAVgBlAHIAcwBpAG8AbgAgADEALgAwAAAADgBwAGwALQBpAGMAbwBuAAAAAAAAAQAAAAsAgAADADBPUy8yDtEG1AAAALwAAABgY21hcBdW0psAAAEcAAAAVGdhc3AAAAAQAAABcAAAAAhnbHlmADY+2wAAAXgAAAiAaGVhZBkr5KEAAAn4AAAANmhoZWEJLQVEAAAKMAAAACRobXR4WcUPaQAAClQAAABkbG9jYRoQHFAAAAq4AAAANG1heHAAHgBcAAAK7AAAACBuYW1lFMWFdwAACwwAAAGGcG9zdAADAAAAAAyUAAAAIAADBBYBkAAFAAACmQLMAAAAjwKZAswAAAHrADMBCQAAAAAAAAAAAAAAAAAAAAEQAAAAAAAAAAAAAAAAAAAAAEAAAOkUBAAAAAAABAAAAAAAAAEAAAAAAAAAAAAAACAAAAAAAAMAAAADAAAAHAABAAMAAAAcAAMAAQAAABwABAA4AAAACgAIAAIAAgABACDpFP/9//8AAAAAACDpAP/9//8AAf/jFwQAAwABAAAAAAAAAAAAAAABAAH//wAPAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAMAgACqA4ADVgAXAC8APwAAATU0JisBIgYdARQWOwEyNj0BIxUjNTMVIzU0JisBIgYdARQWOwEyNj0BIxUjNTMVATIWFREUBiMhIiY1ETQ2MwMAGBKAEhoaEoASGEBWVuoaEoASGBgSgBIaQFZWAZQiNDMj/awkMjIkAiosEhgYEqwSGBgSLBaAFiwSGBgSrBIYGBIsFoAWASwzI/4AIjQzIwIAIjQAAAQA1gDWAyoDKgAFAAsAEQAXAAABMxUjNSMTNTMVIzUBNTMVIxUdATMVIzUCVtRUgIBU1P6A1ICA1AMq1ID+VIDUVAEs1FSArIBU1AAEAFYAVgOqA6oAAwAfADsAPwAAATUzFQMyNz4BNzY1NCcuAScmIyIHDgEHBhUUFx4BFxYTMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2ExEzEQHWVCpGPz5dGxsbG10+PkdGPz5dGxsbG10+PkdYTk5zIiEhInNOTVlYTk5zIiEhInNOTS9UAoBWVv4qGxtdPj5HRj8+XRsbGxtdPj5HRj8+XRsbAwAhInNOTVlYTk5zIiEhInNOTVlYTk5zIiH9gAEA/wAAAAIBAADWAwADKgADAAcAAAEzESMhETMRAlaqqv6qqgMq/awCVP2sAAABAVYA1gMqAyoAAgAACQIBVgHU/iwDKv7W/tYAAQCsAKoDVgNWADQAAAE3ESE3LgEjIgcOAQcGFRQXHgEXFjMyNz4BNzY3MwYHDgEHBiMiJy4BJyY1NDc+ATc2MzIWAvJk/tSKIl01NS8vRRQUFBRFLy81KiYnPxgXDVgOHx9XNTY8Rj4+XRobGxpdPj1HRn0C8mT+1IoiKhQURS8vNTUvL0UUFAwNLR8fJjcvL0UTExsbXT4+R0Y/Pl0bGzUAAAABAKoAgANWA9YALgAAATIXHgEXFhUUBw4BBwYjIicuAScmNTMUFx4BFxYzMjc+ATc2NTQnLgEnJiMVJzcCAEY/Pl0bGxsbXT4+R0Y/Pl0bG1YUFEUvLzU1Ly9FFBQUFEUvLzXW1gMqGxpdPj1HRj8+XRsbGxtdPj5HNS8vRRQUFBRFLy81NS8vRRQUrNbWAAACAGQAVgOcA6oACwBZAAABMjY1NCYjIgYVFBYlFx4BDwEOAS8BDgEPAQ4BKwEiJi8BLgEnBwYmLwEmNj8BLgE1PAE3Jy4BPwE+AR8BPgE/AT4BOwEyFh8BHgEXNzYWHwEWBg8BHgEVHAECAD1ZWD49WVgBfFoGAgRWBA4IahAkFBABCwisBwsCEBMkEWoHDgVWBAIGWgEBAloGAgRWBA4IahAkFBABCwisBwsCEBMkEWoHDgVWBAIGWgEBAWpYPj1ZWD49WWxGBBAIlAcEAyoMFghwBwsKCHAHFQ4qAwMIlAcQBUYKFQsKFQtGBBAIlAcEAyoMFghwBwsKCHAHFQ4qAwMIlAcQBUYKFQsKFQAAAAIA1gCqAxYDVgAFAAwAABMzNxEnIyUUBgcRHgHWqtbWqgJAPDAwPAKA1v1U1oA5WxgBWBhbAAAAAQEqAKoCqgNWAAUAAAEzNxEnIwEqrNTUrAKA1v1U1gADAIAAigOAA3YAHQAkACoAAAEWFx4BFxYVFAcOAQcGBzU2Nz4BNzY1NCcuAScmJxMUBgcRHgElMzcRJyMCVkA3N08XFhYXTzc2QS4nJzkPEBAPOScmL2o6MDA6/cCq1taqA3YOIyJjPj5ERD49YyMjDlgNHBtLLi4zMy4uSxsbDv7iOVsYAVgYW0fW/VTWAAAEANYA1gMqAyoABQALABEAFwAAATMVIzUzAzUzFSMVATUzFSM1ETUzFSM1AqqA1FRU1ID+rFTU1FQCqlTU/azUVIAB1IDUVP6sVNSAAAAAAAQAVgBWA6oDqgAbADcAOwA/AAAlMjc+ATc2NTQnLgEnJiMiBw4BBwYVFBceARcWEzIXHgEXFhUUBw4BBwYjIicuAScmNTQ3PgE3NhczESMVMxUjAgBGPz5dGxsbG10+PkdGPz5dGxsbG10+PkdYTk5zIiEhInNOTVlYTk5zIiEhInNOTS9UVFRUqhsbXT4+R0Y/Pl0bGxsbXT4+R0Y/Pl0bGwMAISJzTk1ZWE5OcyIhISJzTk1ZWE5OcyIh1P8AVlYAAAAEAIAAgAOAA4AAAgAUACoAMgAAARUnJwEHJw4BBzU+ATcnEScjETMnATQnLgEnJic1FhceARcWFRQGByc+ASccAQcnNR4BAgBa8ALKNlgiTiwbMBW21qrKygKqEA85JyYvQDc3TxcWFxVACgxqAmgwOgNWtFqE/TY2WBsoC1gHGhG2/uDWAQDK/rYzLi5LGxsOWA4jImM+PkQwWydCGTkeBw0GaF4YWwABAJIA1gOAAxIABQAACQEXASc3AYABxDz+AO46AUwBxjz+AO48AAAAAQEAAXYDAAKyAAUAAAEXNxcJAQE8xMQ8/wD/AAKyxMQ8/wABAAAAAAEBVgEWApIDFgAFAAABBwkBFwcCkjz/AAEAPMQBUjwBAAEAPMQAAAABAW4BCgKqAwoABQAAATcnNwkBAW7ExDwBAP8AAUbExDz/AP8AAAAAAQEAAW4DAAKqAAUAAAEnCQEHJwE8PAEAAQA8xAFuPAEA/wA8xAAAAAIAAAC4BJsDSAAPABMAAAEhIgYVERQWMyEyNjURNCYDIREhBBj8azZNTTYDlTZNTTb8awOVA0hNNv52Nk1NNgGKNk398wGKAAIAKwAOBSsD8gAQABQAAAEhIgYVERQWMyEyNjURNCYjESERIQSc/B07U1M7A+M7VFQ7/B0D4wPyVDr9ODpUVDoCyDpU/KoCyAAAAAABAAAAAQAAm1B1oV8PPPUACwQAAAAAANpxT9kAAAAA2nFP2QAAAAAFKwPyAAAACAACAAAAAAAAAAEAAAQAAAAAAAVVAAD/1QUrAAEAAAAAAAAAAAAAAAAAAAAZBAAAAAAAAAAAAAAAAAAAAAQAAIAEAADWBAAAVgQAAQAEAAFWBAAArAQAAKoEAABkBAAA1gQAASoEAACABAAA1gQAAFYEAACABAAAkgQAAQAEAAFWBAABbgQAAQAEcAAABVUAKwAAAAAACgAUAB4AcgCYAPwBEAEeAXABuAJAAlwCbAK0AtwDPgOSA6YDugPOA+ID9gQaBEAAAQAAABkAWgAEAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApHBsLWljb24AcABsAC0AaQBjAG8AblZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMHBsLWljb24AcABsAC0AaQBjAG8AbnBsLWljb24AcABsAC0AaQBjAG8AblJlZ3VsYXIAUgBlAGcAdQBsAGEAcnBsLWljb24AcABsAC0AaQBjAG8AbkZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="},function(e,t,r){"use strict";(function(e){"function"!=typeof e.Promise&&(e.Promise=r(3))}).call(this,r(4))},function(e,t,r){"use strict";(function(t){var r,n,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var a=0,o=new i(c),s=t.document.createTextNode("");o.observe(s,{characterData:!0}),r=function(){s.data=a=++a%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){c(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(c,0)};else{var l=new t.MessageChannel;l.port1.onmessage=c,r=function(){l.port2.postMessage(0)}}var u=[];function c(){var e,t;n=!0;for(var r=u.length;r;){for(t=u,u=[],e=-1;++e<r;)t[e]();r=u.length}n=!1}e.exports=function(e){1!==u.push(e)||n||r()}}).call(this,r(4))},function(e,t,r){var n=r(10);Object.getOwnPropertySymbols||(Object.getOwnPropertySymbols=n)},function(e,t,r){(function(t){!function(e,r){"use strict";if(!(r in e)){var n,i=typeof t==typeof i?window:t,a=0,o=""+Math.random(),s="__\x01symbol:",l=s.length,u="__\x01symbol@@"+o,c="defineProperty",f="defineProperties",d="getOwnPropertyNames",h="getOwnPropertyDescriptor",p="propertyIsEnumerable",g=e[d],v=e[h],y=e.create,m=e.keys,A=e.freeze||e,b=e[c],E=e[f],k=v(e,d),T=e.prototype,S=T.hasOwnProperty,w=T[p],_=T.toString,L=function(e,t,r){S.call(e,u)||b(e,u,{enumerable:!1,configurable:!1,writable:!1,value:{}}),e[u]["@@"+t]=r},P=function(){},I=function(e){return e!=u&&!S.call(z,e)},R=function(e){return e!=u&&S.call(z,e)},C=function(e){var t=""+e;return R(t)?S.call(this,t)&&this[u]["@@"+t]:w.call(this,e)},D=function(t){return b(T,t,{enumerable:!1,configurable:!0,get:P,set:function(e){n(this,t,{enumerable:!1,configurable:!0,writable:!0,value:e}),L(this,t,!0)}}),A(z[t]=b(e(t),"constructor",M))},O=function e(t){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return D(s.concat(t||"",o,++a))},z=y(null),M={value:O},x=function(e){return z[e]},B=function(e,t,r){var i=""+t;return R(i)?(n(e,i,r.enumerable?function(e){var t=y(e);return t.enumerable=!1,t}(r):r),L(e,i,!!r.enumerable)):b(e,t,r),e},F=function(e){return g(e).filter(R).map(x)};k.value=B,b(e,c,k),k.value=F,b(e,r,k),k.value=function(e){return g(e).filter(I)},b(e,d,k),k.value=function(e,t){var r=F(t);return r.length?m(t).concat(r).forEach((function(r){C.call(t,r)&&B(e,r,t[r])})):E(e,t),e},b(e,f,k),k.value=C,b(T,p,k),k.value=O,b(i,"Symbol",k),k.value=function(e){var t=s.concat(s,e,o);return t in T?z[t]:D(t)},b(O,"for",k),k.value=function(e){if(I(e))throw new TypeError(e+" is not a symbol");if(S.call(z,e)){var t=e.slice(l);if(t.slice(0,l)===s&&(t=t.slice(l))!==o)return(t=t.slice(0,t.length-o.length)).length>0?t:void 0}},b(O,"keyFor",k),k.value=function(e,t){var r=v(e,t);return r&&R(t)&&(r.enumerable=C.call(e,t)),r},b(e,h,k),k.value=function(e,t){return 1===arguments.length||void 0===t?y(e):function(e,t){var r=y(e);return g(t).forEach((function(e){C.call(t,e)&&B(r,e,t[e])})),r}(e,t)},b(e,"create",k),k.value=function(){var e=_.call(this);return"[object String]"===e&&R(this)?"[object Symbol]":e},b(T,"toString",k);try{if(!0!==y(b({},s,{get:function(){return b(this,s,{value:!0})[s]}}))[s])throw"IE11";n=b}catch(e){n=function(e,t,r){var n=v(T,t);delete T[t],b(e,t,r),b(T,t,n)}}}}(Object,"getOwnPropertySymbols"),function(e,t){"use strict";var r,n=e.defineProperty,i=e.prototype,a=i.toString,o="toStringTag";["iterator","match","replace","search","split","hasInstance","isConcatSpreadable","unscopables","species","toPrimitive",o].forEach((function(s){if(!(s in t))switch(n(t,s,{value:t(s)}),s){case o:(r=e.getOwnPropertyDescriptor(i,"toString")).value=function(){var e=a.call(this),r=null!=this?this[t.toStringTag]:this;return null==r?e:"[object "+r+"]"},n(i,"toString",r)}}))}(Object,Symbol),function(e,t,r){function n(){return this}t[e]||(t[e]=function(){var t=0,r=this,i={next:function(){var e=r.length<=t;return e?{done:e}:{done:e,value:r[t++]}}};return i[e]=n,i}),r[e]||(r[e]=function(){var t=String.fromCodePoint,r=this,i=0,a=r.length,o={next:function(){var e=a<=i,n=e?"":t(r.codePointAt(i));return i+=n.length,e?{done:e}:{done:e,value:n}}};return o[e]=n,o})}(Symbol.iterator,Array.prototype,String.prototype),e.exports=Object.getOwnPropertySymbols}).call(this,r(4))},function(e,t,r){var n=r(12);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){var n=r(13);(e.exports=r(0)(!1)).push([e.i,"@font-face{font-family:'pl-icon';src:url("+n(r(6))+");src:url("+n(r(6))+'#iefix) format("embedded-opentype"),url('+n(r(14))+') format("truetype"),url('+n(r(15))+') format("woff"),url('+n(r(16))+'#pl-icon) format("svg");font-weight:normal;font-style:normal;font-display:block}[class^="pl-ic-"],[class*=" pl-ic-"]{font-family:\'pl-icon\' !important;speak:none;font-style:normal;font-weight:normal;font-variant:normal;text-transform:none;line-height:1;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.pl-ic-theater-mini:before{content:"\\E913"}.pl-ic-theater:before{content:"\\E914"}.pl-ic-caption:before{content:"\\E900"}.pl-ic-fullscreen:before{content:"\\E901"}.pl-ic-info_outline:before{content:"\\E902"}.pl-ic-pause:before{content:"\\E903"}.pl-ic-play_arrow:before{content:"\\E904"}.pl-ic-refresh:before{content:"\\E905"}.pl-ic-replay:before{content:"\\E906"}.pl-ic-settings:before{content:"\\E907"}.pl-ic-volume_down:before{content:"\\E908"}.pl-ic-volume_mute:before{content:"\\E909"}.pl-ic-volume_up:before{content:"\\E90A"}.pl-ic-fullscreen_exit:before{content:"\\E90B"}.pl-ic-error_outline:before{content:"\\E90C"}.pl-ic-volume_off:before{content:"\\E90D"}.pl-ic-done:before{content:"\\E90E"}.pl-ic-keyboard_arrow_down:before{content:"\\E90F"}.pl-ic-keyboard_arrow_left:before{content:"\\E910"}.pl-ic-keyboard_arrow_right:before{content:"\\E911"}.pl-ic-keyboard_arrow_up:before{content:"\\E912"}.\\--z--player{height:343px;width:610px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-transition:transform 0.1s cubic-bezier(0, 0, 0.2, 1);-moz-transition:transform 0.1s cubic-bezier(0, 0, 0.2, 1);transition:transform 0.1s cubic-bezier(0, 0, 0.2, 1);-webkit-transition:opacity 0.1s cubic-bezier(0, 0, 0.2, 1);-moz-transition:opacity 0.1s cubic-bezier(0, 0, 0.2, 1);transition:opacity 0.1s cubic-bezier(0, 0, 0.2, 1);position:relative;font-size:10px;font-family:sans-serif;line-height:1.5;padding:0;font-weight:normal;box-sizing:border-box;outline:none;background-color:#000}.\\--z--player *:focus{outline:none}.\\--z--player *,.\\--z--player *:after,.\\--z--player *:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.\\--z--player ::-webkit-scrollbar{width:6px;height:6px}.\\--z--player ::-webkit-scrollbar-track{background:transparent;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.\\--z--player ::-webkit-scrollbar-thumb{background:#dbdbdb;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px}.\\--z--player ::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,0.75);background-color:rgba(255,255,255,0.75)}.\\--z--player button{border:0;cursor:pointer;background-color:transparent}.\\--z--player svg{position:relative}.\\--z--player a{text-decoration:none}.\\--z--player li,.\\--z--player ul,.\\--z--player ol{margin:0;padding:0;list-style:none}.\\--z--player video{height:100%;width:100%;object-fit:contain;position:absolute;top:0;left:0;pointer-events:none}.\\--z--player .\\--z--center{text-align:center}.\\--z--player .\\--z--hide{display:none !important}.\\--z--player .\\--z--fadeout{opacity:0 !important}.\\--z--player .\\--z--show{display:block !important}.\\--z--player .\\--z--visible{visibility:visible !important}.\\--z--player .\\--z--unvisible{visibility:hidden !important}.\\--z--player .\\--z--clearfix:after{content:" ";display:table;clear:both}.\\--z--player .\\--z--icon{color:#fff}.\\--z--player .\\--z--btn{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;background-color:transparent;padding:0;opacity:0.8;font-size:1em}.\\--z--player .\\--z--btn:active{-webkit-animation:z-control-click 0.5s;-moz-animation:z-control-click 0.5s;-o-animation:z-control-click 0.5s;animation:z-control-click 0.5s}.\\--z--player .\\--z--btn:hover,.\\--z--player .\\--z--btn.\\--z--active{opacity:1}.\\--z--player.\\--z--full-screen{width:100% !important;height:100% !important;background-color:#000;object-fit:contain;position:fixed;top:0;right:0;bottom:0;left:0;min-width:0;max-width:none;min-height:0;max-height:none;transform:none;margin:0;font-size:13px}.\\--z--player.\\--z--custom-ios-fullscreen{width:100% !important;height:100% !important;position:fixed !important;z-index:10000 !important;top:50% !important;left:50% !important;transform:translate(-50%, -50%) !important}.\\--z--player.\\--z--orient-lock-fullscreen{transform:rotate(90deg) !important;transform-origin:bottom left;width:100vh !important;height:100vw !important;margin-top:-100vw !important;object-fit:cover !important;z-index:4 !important;visibility:visible !important;top:0 !important;left:0 !important}.\\--z--player.is-portrait{width:calc(100vh - 70px) !important}.\\--z--player-backdrop{position:fixed;display:none;width:100%;height:100%;left:0;top:0;bottom:0;right:0;z-index:9999;background-color:#000}.\\--z--player-backdrop.\\--z--show{display:block}@-webkit-keyframes z-control-click{from{opacity:0.6}to{opacity:1}}@-moz-keyframes z-control-click{from{opacity:0.6}to{opacity:1}}@-o-keyframes z-control-click{from{opacity:0.6}to{opacity:1}}@keyframes z-control-click{from{opacity:0.6}to{opacity:1}}\n',""])},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t){e.exports="data:font/ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg7RBtQAAAC8AAAAYGNtYXAXVtKbAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgA2PtsAAAF4AAAIgGhlYWQZK+ShAAAJ+AAAADZoaGVhCS0FRAAACjAAAAAkaG10eFnFD2kAAApUAAAAZGxvY2EaEBxQAAAKuAAAADRtYXhwAB4AXAAACuwAAAAgbmFtZRTFhXcAAAsMAAABhnBvc3QAAwAAAAAMlAAAACAAAwQWAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpFAQAAAAAAAQAAAAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6RT//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAADAIAAqgOAA1YAFwAvAD8AAAE1NCYrASIGHQEUFjsBMjY9ASMVIzUzFSM1NCYrASIGHQEUFjsBMjY9ASMVIzUzFQEyFhURFAYjISImNRE0NjMDABgSgBIaGhKAEhhAVlbqGhKAEhgYEoASGkBWVgGUIjQzI/2sJDIyJAIqLBIYGBKsEhgYEiwWgBYsEhgYEqwSGBgSLBaAFgEsMyP+ACI0MyMCACI0AAAEANYA1gMqAyoABQALABEAFwAAATMVIzUjEzUzFSM1ATUzFSMVHQEzFSM1AlbUVICAVNT+gNSAgNQDKtSA/lSA1FQBLNRUgKyAVNQABABWAFYDqgOqAAMAHwA7AD8AAAE1MxUDMjc+ATc2NTQnLgEnJiMiBw4BBwYVFBceARcWEzIXHgEXFhUUBw4BBwYjIicuAScmNTQ3PgE3NhMRMxEB1lQqRj8+XRsbGxtdPj5HRj8+XRsbGxtdPj5HWE5OcyIhISJzTk1ZWE5OcyIhISJzTk0vVAKAVlb+KhsbXT4+R0Y/Pl0bGxsbXT4+R0Y/Pl0bGwMAISJzTk1ZWE5OcyIhISJzTk1ZWE5OcyIh/YABAP8AAAACAQAA1gMAAyoAAwAHAAABMxEjIREzEQJWqqr+qqoDKv2sAlT9rAAAAQFWANYDKgMqAAIAAAkCAVYB1P4sAyr+1v7WAAEArACqA1YDVgA0AAABNxEhNy4BIyIHDgEHBhUUFx4BFxYzMjc+ATc2NzMGBw4BBwYjIicuAScmNTQ3PgE3NjMyFgLyZP7UiiJdNTUvL0UUFBQURS8vNSomJz8YFw1YDh8fVzU2PEY+Pl0aGxsaXT49R0Z9AvJk/tSKIioUFEUvLzU1Ly9FFBQMDS0fHyY3Ly9FExMbG10+PkdGPz5dGxs1AAAAAQCqAIADVgPWAC4AAAEyFx4BFxYVFAcOAQcGIyInLgEnJjUzFBceARcWMzI3PgE3NjU0Jy4BJyYjFSc3AgBGPz5dGxsbG10+PkdGPz5dGxtWFBRFLy81NS8vRRQUFBRFLy811tYDKhsaXT49R0Y/Pl0bGxsbXT4+RzUvL0UUFBQURS8vNTUvL0UUFKzW1gAAAgBkAFYDnAOqAAsAWQAAATI2NTQmIyIGFRQWJRceAQ8BDgEvAQ4BDwEOASsBIiYvAS4BJwcGJi8BJjY/AS4BNTwBNycuAT8BPgEfAT4BPwE+ATsBMhYfAR4BFzc2Fh8BFgYPAR4BFRwBAgA9WVg+PVlYAXxaBgIEVgQOCGoQJBQQAQsIrAcLAhATJBFqBw4FVgQCBloBAQJaBgIEVgQOCGoQJBQQAQsIrAcLAhATJBFqBw4FVgQCBloBAQFqWD49WVg+PVlsRgQQCJQHBAMqDBYIcAcLCghwBxUOKgMDCJQHEAVGChULChULRgQQCJQHBAMqDBYIcAcLCghwBxUOKgMDCJQHEAVGChULChUAAAACANYAqgMWA1YABQAMAAATMzcRJyMlFAYHER4B1qrW1qoCQDwwMDwCgNb9VNaAOVsYAVgYWwAAAAEBKgCqAqoDVgAFAAABMzcRJyMBKqzU1KwCgNb9VNYAAwCAAIoDgAN2AB0AJAAqAAABFhceARcWFRQHDgEHBgc1Njc+ATc2NTQnLgEnJicTFAYHER4BJTM3EScjAlZANzdPFxYWF083NkEuJyc5DxAQDzknJi9qOjAwOv3AqtbWqgN2DiMiYz4+REQ+PWMjIw5YDRwbSy4uMzMuLksbGw7+4jlbGAFYGFtH1v1U1gAABADWANYDKgMqAAUACwARABcAAAEzFSM1MwM1MxUjFQE1MxUjNRE1MxUjNQKqgNRUVNSA/qxU1NRUAqpU1P2s1FSAAdSA1FT+rFTUgAAAAAAEAFYAVgOqA6oAGwA3ADsAPwAAJTI3PgE3NjU0Jy4BJyYjIgcOAQcGFRQXHgEXFhMyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYXMxEjFTMVIwIARj8+XRsbGxtdPj5HRj8+XRsbGxtdPj5HWE5OcyIhISJzTk1ZWE5OcyIhISJzTk0vVFRUVKobG10+PkdGPz5dGxsbG10+PkdGPz5dGxsDACEic05NWVhOTnMiISEic05NWVhOTnMiIdT/AFZWAAAABACAAIADgAOAAAIAFAAqADIAAAEVJycBBycOAQc1PgE3JxEnIxEzJwE0Jy4BJyYnNRYXHgEXFhUUBgcnPgEnHAEHJzUeAQIAWvACyjZYIk4sGzAVttaqysoCqhAPOScmL0A3N08XFhcVQAoMagJoMDoDVrRahP02NlgbKAtYBxoRtv7g1gEAyv62My4uSxsbDlgOIyJjPj5EMFsnQhk5HgcNBmheGFsAAQCSANYDgAMSAAUAAAkBFwEnNwGAAcQ8/gDuOgFMAcY8/gDuPAAAAAEBAAF2AwACsgAFAAABFzcXCQEBPMTEPP8A/wACssTEPP8AAQAAAAABAVYBFgKSAxYABQAAAQcJARcHApI8/wABADzEAVI8AQABADzEAAAAAQFuAQoCqgMKAAUAAAE3JzcJAQFuxMQ8AQD/AAFGxMQ8/wD/AAAAAAEBAAFuAwACqgAFAAABJwkBBycBPDwBAAEAPMQBbjwBAP8APMQAAAACAAAAuASbA0gADwATAAABISIGFREUFjMhMjY1ETQmAyERIQQY/Gs2TU02A5U2TU02/GsDlQNITTb+djZNTTYBijZN/fMBigACACsADgUrA/IAEAAUAAABISIGFREUFjMhMjY1ETQmIxEhESEEnPwdO1NTOwPjO1RUO/wdA+MD8lQ6/Tg6VFQ6Asg6VPyqAsgAAAAAAQAAAAEAAJtQdaFfDzz1AAsEAAAAAADacU/ZAAAAANpxT9kAAAAABSsD8gAAAAgAAgAAAAAAAAABAAAEAAAAAAAFVQAA/9UFKwABAAAAAAAAAAAAAAAAAAAAGQQAAAAAAAAAAAAAAAAAAAAEAACABAAA1gQAAFYEAAEABAABVgQAAKwEAACqBAAAZAQAANYEAAEqBAAAgAQAANYEAABWBAAAgAQAAJIEAAEABAABVgQAAW4EAAEABHAAAAVVACsAAAAAAAoAFAAeAHIAmAD8ARABHgFwAbgCQAJcAmwCtALcAz4DkgOmA7oDzgPiA/YEGgRAAAEAAAAZAFoABAAAAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAOAK4AAQAAAAAAAQAHAAAAAQAAAAAAAgAHAGAAAQAAAAAAAwAHADYAAQAAAAAABAAHAHUAAQAAAAAABQALABUAAQAAAAAABgAHAEsAAQAAAAAACgAaAIoAAwABBAkAAQAOAAcAAwABBAkAAgAOAGcAAwABBAkAAwAOAD0AAwABBAkABAAOAHwAAwABBAkABQAWACAAAwABBAkABgAOAFIAAwABBAkACgA0AKRwbC1pY29uAHAAbAAtAGkAYwBvAG5WZXJzaW9uIDEuMABWAGUAcgBzAGkAbwBuACAAMQAuADBwbC1pY29uAHAAbAAtAGkAYwBvAG5wbC1pY29uAHAAbAAtAGkAYwBvAG5SZWd1bGFyAFIAZQBnAHUAbABhAHJwbC1pY29uAHAAbAAtAGkAYwBvAG5Gb250IGdlbmVyYXRlZCBieSBJY29Nb29uLgBGAG8AbgB0ACAAZwBlAG4AZQByAGEAdABlAGQAIABiAHkAIABJAGMAbwBNAG8AbwBuAC4AAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"},function(e,t){e.exports="data:font/woff;charset=utf-8;base64,d09GRgABAAAAAA0AAAsAAAAADLQAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAABPUy8yAAABCAAAAGAAAABgDtEG1GNtYXAAAAFoAAAAVAAAAFQXVtKbZ2FzcAAAAbwAAAAIAAAACAAAABBnbHlmAAABxAAACIAAAAiAADY+22hlYWQAAApEAAAANgAAADYZK+ShaGhlYQAACnwAAAAkAAAAJAktBURobXR4AAAKoAAAAGQAAABkWcUPaWxvY2EAAAsEAAAANAAAADQaEBxQbWF4cAAACzgAAAAgAAAAIAAeAFxuYW1lAAALWAAAAYYAAAGGFMWFd3Bvc3QAAAzgAAAAIAAAACAAAwAAAAMEFgGQAAUAAAKZAswAAACPApkCzAAAAesAMwEJAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAAAAAAAAAQAAA6RQEAAAAAAAEAAAAAAAAAQAAAAAAAAAAAAAAIAAAAAAAAwAAAAMAAAAcAAEAAwAAABwAAwABAAAAHAAEADgAAAAKAAgAAgACAAEAIOkU//3//wAAAAAAIOkA//3//wAB/+MXBAADAAEAAAAAAAAAAAAAAAEAAf//AA8AAQAAAAAAAAAAAAIAADc5AQAAAAABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAwCAAKoDgANWABcALwA/AAABNTQmKwEiBh0BFBY7ATI2PQEjFSM1MxUjNTQmKwEiBh0BFBY7ATI2PQEjFSM1MxUBMhYVERQGIyEiJjURNDYzAwAYEoASGhoSgBIYQFZW6hoSgBIYGBKAEhpAVlYBlCI0MyP9rCQyMiQCKiwSGBgSrBIYGBIsFoAWLBIYGBKsEhgYEiwWgBYBLDMj/gAiNDMjAgAiNAAABADWANYDKgMqAAUACwARABcAAAEzFSM1IxM1MxUjNQE1MxUjFR0BMxUjNQJW1FSAgFTU/oDUgIDUAyrUgP5UgNRUASzUVICsgFTUAAQAVgBWA6oDqgADAB8AOwA/AAABNTMVAzI3PgE3NjU0Jy4BJyYjIgcOAQcGFRQXHgEXFhMyFx4BFxYVFAcOAQcGIyInLgEnJjU0Nz4BNzYTETMRAdZUKkY/Pl0bGxsbXT4+R0Y/Pl0bGxsbXT4+R1hOTnMiISEic05NWVhOTnMiISEic05NL1QCgFZW/iobG10+PkdGPz5dGxsbG10+PkdGPz5dGxsDACEic05NWVhOTnMiISEic05NWVhOTnMiIf2AAQD/AAAAAgEAANYDAAMqAAMABwAAATMRIyERMxECVqqq/qqqAyr9rAJU/awAAAEBVgDWAyoDKgACAAAJAgFWAdT+LAMq/tb+1gABAKwAqgNWA1YANAAAATcRITcuASMiBw4BBwYVFBceARcWMzI3PgE3NjczBgcOAQcGIyInLgEnJjU0Nz4BNzYzMhYC8mT+1IoiXTU1Ly9FFBQUFEUvLzUqJic/GBcNWA4fH1c1NjxGPj5dGhsbGl0+PUdGfQLyZP7UiiIqFBRFLy81NS8vRRQUDA0tHx8mNy8vRRMTGxtdPj5HRj8+XRsbNQAAAAEAqgCAA1YD1gAuAAABMhceARcWFRQHDgEHBiMiJy4BJyY1MxQXHgEXFjMyNz4BNzY1NCcuAScmIxUnNwIARj8+XRsbGxtdPj5HRj8+XRsbVhQURS8vNTUvL0UUFBQURS8vNdbWAyobGl0+PUdGPz5dGxsbG10+Pkc1Ly9FFBQUFEUvLzU1Ly9FFBSs1tYAAAIAZABWA5wDqgALAFkAAAEyNjU0JiMiBhUUFiUXHgEPAQ4BLwEOAQ8BDgErASImLwEuAScHBiYvASY2PwEuATU8ATcnLgE/AT4BHwE+AT8BPgE7ATIWHwEeARc3NhYfARYGDwEeARUcAQIAPVlYPj1ZWAF8WgYCBFYEDghqECQUEAELCKwHCwIQEyQRagcOBVYEAgZaAQECWgYCBFYEDghqECQUEAELCKwHCwIQEyQRagcOBVYEAgZaAQEBalg+PVlYPj1ZbEYEEAiUBwQDKgwWCHAHCwoIcAcVDioDAwiUBxAFRgoVCwoVC0YEEAiUBwQDKgwWCHAHCwoIcAcVDioDAwiUBxAFRgoVCwoVAAAAAgDWAKoDFgNWAAUADAAAEzM3EScjJRQGBxEeAdaq1taqAkA8MDA8AoDW/VTWgDlbGAFYGFsAAAABASoAqgKqA1YABQAAATM3EScjASqs1NSsAoDW/VTWAAMAgACKA4ADdgAdACQAKgAAARYXHgEXFhUUBw4BBwYHNTY3PgE3NjU0Jy4BJyYnExQGBxEeASUzNxEnIwJWQDc3TxcWFhdPNzZBLicnOQ8QEA85JyYvajowMDr9wKrW1qoDdg4jImM+PkREPj1jIyMOWA0cG0suLjMzLi5LGxsO/uI5WxgBWBhbR9b9VNYAAAQA1gDWAyoDKgAFAAsAEQAXAAABMxUjNTMDNTMVIxUBNTMVIzURNTMVIzUCqoDUVFTUgP6sVNTUVAKqVNT9rNRUgAHUgNRU/qxU1IAAAAAABABWAFYDqgOqABsANwA7AD8AACUyNz4BNzY1NCcuAScmIyIHDgEHBhUUFx4BFxYTMhceARcWFRQHDgEHBiMiJy4BJyY1NDc+ATc2FzMRIxUzFSMCAEY/Pl0bGxsbXT4+R0Y/Pl0bGxsbXT4+R1hOTnMiISEic05NWVhOTnMiISEic05NL1RUVFSqGxtdPj5HRj8+XRsbGxtdPj5HRj8+XRsbAwAhInNOTVlYTk5zIiEhInNOTVlYTk5zIiHU/wBWVgAAAAQAgACAA4ADgAACABQAKgAyAAABFScnAQcnDgEHNT4BNycRJyMRMycBNCcuAScmJzUWFx4BFxYVFAYHJz4BJxwBByc1HgECAFrwAso2WCJOLBswFbbWqsrKAqoQDzknJi9ANzdPFxYXFUAKDGoCaDA6A1a0WoT9NjZYGygLWAcaEbb+4NYBAMr+tjMuLksbGw5YDiMiYz4+RDBbJ0IZOR4HDQZoXhhbAAEAkgDWA4ADEgAFAAAJARcBJzcBgAHEPP4A7joBTAHGPP4A7jwAAAABAQABdgMAArIABQAAARc3FwkBATzExDz/AP8AArLExDz/AAEAAAAAAQFWARYCkgMWAAUAAAEHCQEXBwKSPP8AAQA8xAFSPAEAAQA8xAAAAAEBbgEKAqoDCgAFAAABNyc3CQEBbsTEPAEA/wABRsTEPP8A/wAAAAABAQABbgMAAqoABQAAAScJAQcnATw8AQABADzEAW48AQD/ADzEAAAAAgAAALgEmwNIAA8AEwAAASEiBhURFBYzITI2NRE0JgMhESEEGPxrNk1NNgOVNk1NNvxrA5UDSE02/nY2TU02AYo2Tf3zAYoAAgArAA4FKwPyABAAFAAAASEiBhURFBYzITI2NRE0JiMRIREhBJz8HTtTUzsD4ztUVDv8HQPjA/JUOv04OlRUOgLIOlT8qgLIAAAAAAEAAAABAACbUHWhXw889QALBAAAAAAA2nFP2QAAAADacU/ZAAAAAAUrA/IAAAAIAAIAAAAAAAAAAQAABAAAAAAABVUAAP/VBSsAAQAAAAAAAAAAAAAAAAAAABkEAAAAAAAAAAAAAAAAAAAABAAAgAQAANYEAABWBAABAAQAAVYEAACsBAAAqgQAAGQEAADWBAABKgQAAIAEAADWBAAAVgQAAIAEAACSBAABAAQAAVYEAAFuBAABAARwAAAFVQArAAAAAAAKABQAHgByAJgA/AEQAR4BcAG4AkACXAJsArQC3AM+A5IDpgO6A84D4gP2BBoEQAABAAAAGQBaAAQAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAADgCuAAEAAAAAAAEABwAAAAEAAAAAAAIABwBgAAEAAAAAAAMABwA2AAEAAAAAAAQABwB1AAEAAAAAAAUACwAVAAEAAAAAAAYABwBLAAEAAAAAAAoAGgCKAAMAAQQJAAEADgAHAAMAAQQJAAIADgBnAAMAAQQJAAMADgA9AAMAAQQJAAQADgB8AAMAAQQJAAUAFgAgAAMAAQQJAAYADgBSAAMAAQQJAAoANACkcGwtaWNvbgBwAGwALQBpAGMAbwBuVmVyc2lvbiAxLjAAVgBlAHIAcwBpAG8AbgAgADEALgAwcGwtaWNvbgBwAGwALQBpAGMAbwBucGwtaWNvbgBwAGwALQBpAGMAbwBuUmVndWxhcgBSAGUAZwB1AGwAYQBycGwtaWNvbgBwAGwALQBpAGMAbwBuRm9udCBnZW5lcmF0ZWQgYnkgSWNvTW9vbi4ARgBvAG4AdAAgAGcAZQBuAGUAcgBhAHQAZQBkACAAYgB5ACAASQBjAG8ATQBvAG8AbgAuAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="},function(e,t){e.exports="data:image/svg+xml;charset=utf-8;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBzdGFuZGFsb25lPSJubyI/Pgo8IURPQ1RZUEUgc3ZnIFBVQkxJQyAiLS8vVzNDLy9EVEQgU1ZHIDEuMS8vRU4iICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiID4KPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPgo8bWV0YWRhdGE+R2VuZXJhdGVkIGJ5IEljb01vb248L21ldGFkYXRhPgo8ZGVmcz4KPGZvbnQgaWQ9InBsLWljb24iIGhvcml6LWFkdi14PSIxMDI0Ij4KPGZvbnQtZmFjZSB1bml0cy1wZXItZW09IjEwMjQiIGFzY2VudD0iMTAyNCIgZGVzY2VudD0iMCIgLz4KPG1pc3NpbmctZ2x5cGggaG9yaXotYWR2LXg9IjEwMjQiIC8+CjxnbHlwaCB1bmljb2RlPSImI3gyMDsiIGhvcml6LWFkdi14PSIwIiBkPSIiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTAwOyIgZ2x5cGgtbmFtZT0iY2FwdGlvbiIgZD0iTTc2OCA1NTR2NDRjMCAyNC0xOCA0Mi00MiA0MmgtMTI4Yy0yNCAwLTQ0LTE4LTQ0LTQydi0xNzJjMC0yNCAyMC00MiA0NC00MmgxMjhjMjQgMCA0MiAxOCA0MiA0MnY0NGgtNjR2LTIyaC04NnYxMjhoODZ2LTIyaDY0ek00NzAgNTU0djQ0YzAgMjQtMjAgNDItNDQgNDJoLTEyOGMtMjQgMC00Mi0xOC00Mi00MnYtMTcyYzAtMjQgMTgtNDIgNDItNDJoMTI4YzI0IDAgNDQgMTggNDQgNDJ2NDRoLTY0di0yMmgtODZ2MTI4aDg2di0yMmg2NHpNODEwIDg1NGM0NiAwIDg2LTQwIDg2LTg2di01MTJjMC00Ni00MC04Ni04Ni04NmgtNTk2Yy00OCAwLTg2IDQwLTg2IDg2djUxMmMwIDQ2IDM4IDg2IDg2IDg2aDU5NnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTAxOyIgZ2x5cGgtbmFtZT0iZnVsbHNjcmVlbiIgZD0iTTU5OCA4MTBoMjEydi0yMTJoLTg0djEyOGgtMTI4djg0ek03MjYgMjk4djEyOGg4NHYtMjEyaC0yMTJ2ODRoMTI4ek0yMTQgNTk4djIxMmgyMTJ2LTg0aC0xMjh2LTEyOGgtODR6TTI5OCA0MjZ2LTEyOGgxMjh2LTg0aC0yMTJ2MjEyaDg0eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MDI7IiBnbHlwaC1uYW1lPSJpbmZvX291dGxpbmUiIGQ9Ik00NzAgNjQwdjg2aDg0di04NmgtODR6TTUxMiAxNzBjMTg4IDAgMzQyIDE1NCAzNDIgMzQycy0xNTQgMzQyLTM0MiAzNDItMzQyLTE1NC0zNDItMzQyIDE1NC0zNDIgMzQyLTM0MnpNNTEyIDkzOGMyMzYgMCA0MjYtMTkwIDQyNi00MjZzLTE5MC00MjYtNDI2LTQyNi00MjYgMTkwLTQyNiA0MjYgMTkwIDQyNiA0MjYgNDI2ek00NzAgMjk4djI1Nmg4NHYtMjU2aC04NHoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTAzOyIgZ2x5cGgtbmFtZT0icGF1c2UiIGQ9Ik01OTggODEwaDE3MHYtNTk2aC0xNzB2NTk2ek0yNTYgMjE0djU5NmgxNzB2LTU5NmgtMTcweiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MDQ7IiBnbHlwaC1uYW1lPSJwbGF5X2Fycm93IiBkPSJNMzQyIDgxMGw0NjgtMjk4LTQ2OC0yOTh2NTk2eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MDU7IiBnbHlwaC1uYW1lPSJyZWZyZXNoIiBkPSJNNzU0IDc1NGwxMDAgMTAwdi0zMDBoLTMwMGwxMzggMTM4Yy00NiA0Ni0xMTAgNzYtMTgwIDc2LTE0MiAwLTI1Ni0xMTQtMjU2LTI1NnMxMTQtMjU2IDI1Ni0yNTZjMTEyIDAgMjA4IDcwIDI0MiAxNzBoODhjLTM4LTE0OC0xNzAtMjU2LTMzMC0yNTYtMTg4IDAtMzQwIDE1NC0zNDAgMzQyczE1MiAzNDIgMzQwIDM0MmM5NCAwIDE4MC0zOCAyNDItMTAweiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MDY7IiBnbHlwaC1uYW1lPSJyZXBsYXkiIGQ9Ik01MTIgODEwYzE4OCAwIDM0Mi0xNTIgMzQyLTM0MHMtMTU0LTM0Mi0zNDItMzQyLTM0MiAxNTQtMzQyIDM0Mmg4NmMwLTE0MiAxMTQtMjU2IDI1Ni0yNTZzMjU2IDExNCAyNTYgMjU2LTExNCAyNTYtMjU2IDI1NnYtMTcybC0yMTQgMjE0IDIxNCAyMTR2LTE3MnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTA3OyIgZ2x5cGgtbmFtZT0ic2V0dGluZ3MiIGQ9Ik01MTIgMzYyYzgyIDAgMTUwIDY4IDE1MCAxNTBzLTY4IDE1MC0xNTAgMTUwLTE1MC02OC0xNTAtMTUwIDY4LTE1MCAxNTAtMTUwek04MzAgNDcwbDkwLTcwYzgtNiAxMC0xOCA0LTI4bC04Ni0xNDhjLTYtMTAtMTYtMTItMjYtOGwtMTA2IDQyYy0yMi0xNi00Ni0zMi03Mi00MmwtMTYtMTEyYy0yLTEwLTEwLTE4LTIwLTE4aC0xNzJjLTEwIDAtMTggOC0yMCAxOGwtMTYgMTEyYy0yNiAxMC01MCAyNC03MiA0MmwtMTA2LTQyYy0xMC00LTIwLTItMjYgOGwtODYgMTQ4Yy02IDEwLTQgMjIgNCAyOGw5MCA3MGMtMiAxNC0yIDI4LTIgNDJzMCAyOCAyIDQybC05MCA3MGMtOCA2LTEwIDE4LTQgMjhsODYgMTQ4YzYgMTAgMTYgMTIgMjYgOGwxMDYtNDJjMjIgMTYgNDYgMzIgNzIgNDJsMTYgMTEyYzIgMTAgMTAgMTggMjAgMThoMTcyYzEwIDAgMTgtOCAyMC0xOGwxNi0xMTJjMjYtMTAgNTAtMjQgNzItNDJsMTA2IDQyYzEwIDQgMjAgMiAyNi04bDg2LTE0OGM2LTEwIDQtMjItNC0yOGwtOTAtNzBjMi0xNCAyLTI4IDItNDJzMC0yOC0yLTQyeiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MDg7IiBnbHlwaC1uYW1lPSJ2b2x1bWVfZG93biIgZD0iTTIxNCA2NDBoMTcwbDIxNCAyMTR2LTY4NGwtMjE0IDIxNGgtMTcwdjI1NnpNNzkwIDUxMmMwLTc2LTQ0LTE0MC0xMDgtMTcydjM0NGM2NC0zMiAxMDgtOTYgMTA4LTE3MnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTA5OyIgZ2x5cGgtbmFtZT0idm9sdW1lX211dGUiIGQ9Ik0yOTggNjQwaDE3MmwyMTIgMjE0di02ODRsLTIxMiAyMTRoLTE3MnYyNTZ6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTkwYTsiIGdseXBoLW5hbWU9InZvbHVtZV91cCIgZD0iTTU5OCA4ODZjMTcyLTM4IDI5OC0xOTIgMjk4LTM3NHMtMTI2LTMzNi0yOTgtMzc0djg4YzEyNCAzNiAyMTIgMTUwIDIxMiAyODZzLTg4IDI1MC0yMTIgMjg2djg4ek03MDQgNTEyYzAtNzYtNDItMTQwLTEwNi0xNzJ2MzQ0YzY0LTMyIDEwNi05NiAxMDYtMTcyek0xMjggNjQwaDE3MGwyMTQgMjE0di02ODRsLTIxNCAyMTRoLTE3MHYyNTZ6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTkwYjsiIGdseXBoLW5hbWU9ImZ1bGxzY3JlZW5fZXhpdCIgZD0iTTY4MiA2ODJoMTI4di04NGgtMjEydjIxMmg4NHYtMTI4ek01OTggMjE0djIxMmgyMTJ2LTg0aC0xMjh2LTEyOGgtODR6TTM0MiA2ODJ2MTI4aDg0di0yMTJoLTIxMnY4NGgxMjh6TTIxNCAzNDJ2ODRoMjEydi0yMTJoLTg0djEyOGgtMTI4eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MGM7IiBnbHlwaC1uYW1lPSJlcnJvcl9vdXRsaW5lIiBkPSJNNTEyIDE3MGMxODggMCAzNDIgMTU0IDM0MiAzNDJzLTE1NCAzNDItMzQyIDM0Mi0zNDItMTU0LTM0Mi0zNDIgMTU0LTM0MiAzNDItMzQyek01MTIgOTM4YzIzNiAwIDQyNi0xOTAgNDI2LTQyNnMtMTkwLTQyNi00MjYtNDI2LTQyNiAxOTAtNDI2IDQyNiAxOTAgNDI2IDQyNiA0MjZ6TTQ3MCA3MjZoODR2LTI1NmgtODR2MjU2ek00NzAgMzg0aDg0di04NmgtODR2ODZ6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTkwZDsiIGdseXBoLW5hbWU9InZvbHVtZV9vZmYiIGQ9Ik01MTIgODU0di0xODBsLTkwIDkwek0xODIgODk2bDcxNC03MTQtNTQtNTQtODggODhjLTQ2LTM2LTk4LTY0LTE1Ni03OHY4OGMzNiAxMCA2OCAyOCA5NiA1MGwtMTgyIDE4MnYtMjg4bC0yMTQgMjE0aC0xNzB2MjU2aDIwMmwtMjAyIDIwMnpNODEwIDUxMmMwIDEzNi04OCAyNTAtMjEyIDI4NnY4OGMxNzItMzggMjk4LTE5MiAyOTgtMzc0IDAtNjQtMTYtMTI2LTQ0LTE3OGwtNjQgNjZjMTQgMzQgMjIgNzIgMjIgMTEyek03MDQgNTEyYzAtMTAgMC0xOC0yLTI2bC0xMDQgMTA0djk0YzY0LTMyIDEwNi05NiAxMDYtMTcyeiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MGU7IiBnbHlwaC1uYW1lPSJkb25lIiBkPSJNMzg0IDMzMmw0NTIgNDU0IDYwLTYwLTUxMi01MTItMjM4IDIzOCA1OCA2MHoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTBmOyIgZ2x5cGgtbmFtZT0ia2V5Ym9hcmRfYXJyb3dfZG93biIgZD0iTTMxNiA2OTBsMTk2LTE5NiAxOTYgMTk2IDYwLTYwLTI1Ni0yNTYtMjU2IDI1NnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTEwOyIgZ2x5cGgtbmFtZT0ia2V5Ym9hcmRfYXJyb3dfbGVmdCIgZD0iTTY1OCAzMzhsLTYwLTYwLTI1NiAyNTYgMjU2IDI1NiA2MC02MC0xOTYtMTk2eiIgLz4KPGdseXBoIHVuaWNvZGU9IiYjeGU5MTE7IiBnbHlwaC1uYW1lPSJrZXlib2FyZF9hcnJvd19yaWdodCIgZD0iTTM2NiAzMjZsMTk2IDE5Ni0xOTYgMTk2IDYwIDYwIDI1Ni0yNTYtMjU2LTI1NnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTEyOyIgZ2x5cGgtbmFtZT0ia2V5Ym9hcmRfYXJyb3dfdXAiIGQ9Ik0zMTYgMzY2bC02MCA2MCAyNTYgMjU2IDI1Ni0yNTYtNjAtNjAtMTk2IDE5NnoiIC8+CjxnbHlwaCB1bmljb2RlPSImI3hlOTEzOyIgZ2x5cGgtbmFtZT0idGhlYXRlci1taW5pIiBob3Jpei1hZHYteD0iMTEzNiIgZD0iTTEwNDguMDQyIDgzOS41MTJoLTkxNy4wMzdjLTcyLjA1MiAwLTEzMS4wMDUtNTguOTUzLTEzMS4wMDUtMTMxLjAwNXYtMzkzLjAxNWMwLTcyLjA1MiA1OC45NTMtMTMxLjAwNSAxMzEuMDA1LTEzMS4wMDVoOTE3LjAzN2M3Mi4wNTIgMCAxMzEuMDA1IDU4Ljk1MyAxMzEuMDA1IDEzMS4wMDV2MzkzLjAxNWMwIDcyLjA1Mi01OC45NTMgMTMxLjAwNS0xMzEuMDA1IDEzMS4wMDV6TTEwNDguMDQyIDMxNS40OWgtOTE3LjAzN3YzOTMuMDE1aDkxNy4wMzd2LTM5My4wMTV6IiAvPgo8Z2x5cGggdW5pY29kZT0iJiN4ZTkxNDsiIGdseXBoLW5hbWU9InRoZWF0ZXIiIGhvcml6LWFkdi14PSIxMzY1IiBkPSJNMTE4MC40NDQgMTAwOS43NzhoLTk5NS41NTZjLTc4LjIyMiAwLTE0Mi4yMjItNjQtMTQyLjIyMi0xNDIuMjIydi03MTEuMTExYzAtNzguMjIyIDY0LTE0Mi4yMjIgMTQyLjIyMi0xNDIuMjIyaDk5NS41NTZjNzguMjIyIDAgMTQyLjIyMiA2NCAxNDIuMjIyIDE0Mi4yMjJ2NzExLjExMWMwIDc4LjIyMi02NCAxNDIuMjIyLTE0Mi4yMjIgMTQyLjIyMnpNMTE4MC40NDQgMTU2LjQ0NGgtOTk1LjU1NnY3MTEuMTExaDk5NS41NTZ2LTcxMS4xMTF6IiAvPgo8L2ZvbnQ+PC9kZWZzPjwvc3ZnPg=="},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var r=t.protocol+"//"+t.host,n=r+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(e,t){var i,a=t.trim().replace(/^"(.*)"$/,(function(e,t){return t})).replace(/^'(.*)'$/,(function(e,t){return t}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?r+a:n+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")}))}},function(e,t,r){var n=r(19);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,"[data-no-op]{position:absolute;height:100%;width:100%;text-align:center;background-color:#777;z-index:100}[data-no-op] p[data-no-op-msg]{position:absolute;text-align:center;font-size:2.5em;left:0;right:0;color:white;padding:1em;top:50%;transform:translateY(-50%);max-height:100%;overflow:auto}\n",""])},function(e,t,r){var n=r(21);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--control-left{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;flex-grow:1}.\\--z--player .\\--z--control-right{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;align-items:center;margin-right:1em}.\\--z--player .\\--z--control-right.\\--z--only-right-control{justify-content:flex-end;flex:1;padding:0.9em 0 0.4em}.\\--z--player .\\--z--controls-wrapper{position:absolute;width:100%;bottom:0;height:6em;background-image:linear-gradient(to bottom, transparent, rgba(0,0,0,0.8))}.\\--z--player .\\--z--controls-wrapper.\\--z--bg-gradient,.\\--z--player .\\--z--controls-wrapper.\\--z--full-width{background-image:none}.\\--z--player .\\--z--controls{-webkit-transition:opacity 0.3s ease-out;-moz-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;position:absolute;bottom:0;left:2em;width:calc(100% - 2em * 2);text-shadow:0 0 2px #000;flex-wrap:wrap;justify-content:center;align-items:center;opacity:1;padding:0.5em 0}.\\--z--player .\\--z--controls.\\--z--full-width{left:0;width:100%;background-color:rgba(0,0,0,0.5)}.\\--z--player .\\--z--controls.\\--z--full-width .\\--z--progress-bar .\\--z--bar-bg{background-color:#fff}.\\--z--player .\\--z--controls.\\--z--full-width.\\--z--bg-transparent{background-color:transparent}.\\--z--player .\\--z--controls.\\--z--full-width.\\--z--bg-gradient{padding-top:2em;background-image:linear-gradient(to bottom, transparent, rgba(0,0,0,0.8));background-color:transparent}.\\--z--player .\\--z--controls.\\--z--full-width.\\--z--bg-gradient.\\--z--to-top{background-image:linear-gradient(to top, transparent, rgba(0,0,0,0.8))}.\\--z--player .\\--z--controls.\\--z--full-width.\\--z--bg-gradient .\\--z--progress-bar{position:relative;bottom:-0.3em}.\\--z--player .\\--z--controls .\\--z--control{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;justify-content:center;align-items:center;padding:0}.\\--z--player .\\--z--controls .\\--z--control .\\--z--icon{font-size:3em}.\\--z--player .\\--z--controls .\\--z--control-play,.\\--z--player .\\--z--controls .\\--z--control-next,.\\--z--player .\\--z--controls .\\--z--control-settings,.\\--z--player .\\--z--controls .\\--z--control-caption,.\\--z--player .\\--z--controls .\\--z--control-full-screen{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex}.\\--z--player .\\--z--controls .\\--z--control-play{margin-left:1em;margin-right:.2em}.\\--z--player .\\--z--controls .\\--z--control-settings,.\\--z--player .\\--z--controls .\\--z--control-caption,.\\--z--player .\\--z--controls .\\--z--control-full-screen{padding:0 0.7em}.\\--z--player .\\--z--controls .\\--z--control-settings .\\--z--icon,.\\--z--player .\\--z--controls .\\--z--control-caption .\\--z--icon,.\\--z--player .\\--z--controls .\\--z--control-full-screen .\\--z--icon{font-size:2.2em}.\\--z--player .\\--z--controls .\\--z--control-full-screen{padding:0.2em}.\\--z--player .\\--z--controls .\\--z--control-full-screen .\\--z--icon{font-size:2.7em}.\\--z--player .\\--z--controls .\\--z--control-volume .\\--z--btn .\\--z--icon{font-size:2.5em}.\\--z--player .\\--z--controls .\\--z--control-caption.\\--z--active .\\--z--icon{color:#27baf4}.\\--z--player .\\--z--controls .\\--z--control-theater-mode .\\--z--icon.pl-ic-theater{font-size:1.6em}.\\--z--player .\\--z--controls .\\--z--control-theater-mode .\\--z--icon.pl-ic-theater-mini{font-size:2em}\n",""])},function(e,t,r){var n=r(23);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,"",""])},function(e,t,r){var n=r(25);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--progress-bar{position:absolute;bottom:3.2em;width:100%;height:2em;cursor:pointer}.\\--z--player .\\--z--controls .\\--z--progress-bar .\\--z--bar{-webkit-transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;-moz-transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;height:0.3em;top:0.9em}.\\--z--player .\\--z--controls .\\--z--progress-bar .\\--z--bar .\\--z--bullet{-webkit-transition:all 0.2s,width 0s;-moz-transition:all 0.2s,width 0s;transition:all 0.2s,width 0s;height:0;width:0;top:0}.\\--z--player .\\--z--controls .\\--z--progress-bar.active .\\--z--bar,.\\--z--player .\\--z--controls .\\--z--progress-bar:hover .\\--z--bar{height:0.5em;top:0.8em}.\\--z--player .\\--z--controls .\\--z--progress-bar.active .\\--z--bar .\\--z--bullet,.\\--z--player .\\--z--controls .\\--z--progress-bar:hover .\\--z--bar .\\--z--bullet{height:1.2em;width:1.2em;top:-0.4em}.\\--z--player .\\--z--controls .\\--z--progress-bar .\\--z--seek-time{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;color:#f7f7f7;background-color:rgba(0,0,0,0.6);padding:0.2em 0.5em;font-size:1.1em;position:absolute;white-space:nowrap;top:-1.9em;left:0}.\\--z--player .\\--z--controls .\\--z--progress-bar .\\--z--seek-time::before{border-left:0.4em solid transparent;border-right:0.4em solid transparent;border-top:0.4em solid rgba(0,0,0,0.6);content:'';transform:translateX(-50%);position:absolute;bottom:-0.4em;left:50%}\n",""])},function(e,t,r){var n=r(27);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--bar-fill-recent{width:0;background-color:#27baf4}.\\--z--player .\\--z--controls .\\--z--bar-fill-recent .\\--z--bullet{height:1.4em;width:1.4em;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;display:inline-block;background-color:#f7f7f7;box-shadow:0 0 1px #f7f7f7;position:absolute;top:-0.6em;right:-0.6em}\n",""])},function(e,t,r){var n=r(29);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--bar-fill-load{width:0;background-color:#c2c2c2}\n",""])},function(e,t,r){var n=r(31);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--bar{-webkit-border-radius:.15em;-moz-border-radius:.15em;border-radius:.15em;cursor:pointer;height:.3em;position:absolute;display:inline-block;top:1.4em;left:0}.\\--z--player .\\--z--controls .\\--z--bar-bg{width:100%;background-color:rgba(255,255,255,0.5)}\n",""])},function(e,t,r){var n=r(33);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--control-time{line-height:4em;padding:0;display:flex;align-items:center;margin-left:0.7em;margin-right:0.7em;font-size:1.1em;color:#fff}.\\--z--player .\\--z--controls .\\--z--control-time>span{font-weight:500;line-height:2em;color:#f7f7f7;display:inline-block;font-size:1.2em}.\\--z--player .\\--z--controls .\\--z--control-time>span:first-child{padding-right:0.5em}.\\--z--player .\\--z--controls .\\--z--control-time>span:last-child{padding-left:0.5em}\n",""])},function(e,t,r){var n=r(35);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--control-volume{margin-left:0.7em;margin-right:0.7em}.\\--z--player .\\--z--controls .\\--z--control-volume.\\--z--hide-animation .\\--z--volume-bar{width:0;opacity:0;margin:0;overflow:hidden;will-change:width, opacity, margin-left;-webkit-transition:width 0.2s,opacity 0.2s,margin-left 0.2s;-moz-transition:width 0.2s,opacity 0.2s,margin-left 0.2s;transition:width 0.2s,opacity 0.2s,margin-left 0.2s}.\\--z--player .\\--z--controls .\\--z--control-volume.\\--z--hide-animation:hover .\\--z--volume-bar{width:7em;opacity:1;margin-left:1.3em;margin-right:0.8em;overflow:visible}\n",""])},function(e,t,r){var n=r(37);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--control-volume .\\--z--volume-icon{vertical-align:top}\n",""])},function(e,t,r){var n=r(39);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--controls .\\--z--control-volume .\\--z--volume-bar{width:7em;height:3em;display:inline-block;position:relative;vertical-align:top;margin-left:1.3em;margin-right:.8em}@media (max-width: 768px){.\\--z--player .\\--z--controls .\\--z--control-volume .\\--z--volume-bar{display:none}}\n",""])},function(e,t,r){var n=r(41);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,"",""])},function(e,t,r){var n=r(43);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,'.\\--z--player .\\--z--btn-settings{position:relative}.\\--z--player .\\--z--btn-settings .\\--z--badge{-webkit-border-radius:.1em;-moz-border-radius:.1em;border-radius:.1em;position:absolute;right:-0.5em;top:0;display:inline-block;padding:0 0.2em;font-size:0.8em;font-weight:900;color:#fff;background-color:#f00}.\\--z--player .\\--z--zpl-settings-menu{position:absolute;bottom:5em;right:2em;border-radius:0.2em;background-color:rgba(0,0,0,0.8);text-shadow:0 0 2px rgba(0,0,0,0.5);overflow:hidden;display:none;z-index:1}.\\--z--player .\\--z--zpl-settings-menu .\\--z--panel-scroll-wrapper{max-height:15.2em;max-height:attr(height);overflow-y:auto;overflow-x:hidden}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel{position:relative;bottom:0;right:0;overflow-y:auto;overflow-x:hidden}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .hd{color:#27baf4;text-transform:uppercase;margin-left:0.3em;font-weight:500}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-menu-item{display:table-row;cursor:default;outline:none;height:2.8em;white-space:nowrap}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-menu-item:not([aria-disabled=true]){cursor:pointer}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-menu-item .\\--z--zpl-item-label,.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-menu-item .\\--z--zpl-item-content{display:table-cell;vertical-align:middle;padding:0 1em;white-space:nowrap}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-menu-item:hover{background-color:rgba(255,255,255,0.1)}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header{border-bottom:0.1em solid rgba(255,255,255,0.2);line-height:inherit;height:2.8em;white-space:nowrap;display:flex;align-items:center}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header+.\\--z--panel-scroll-wrapper{max-height:18em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header .\\--z--panel-title{font-size:1.2em;color:#eee;float:left;padding:0 1em 0 0.5em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header .\\--z--zpl-options{color:#fff;font-size:1.1em;float:right;text-decoration:underline;padding:0 1em 0 0;cursor:pointer}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header [class^="pl-ic-"],.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-header [class*=" pl-ic-"]{font-size:1.8em;color:#fff;vertical-align:middle}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu{padding:.6em 0;display:table;width:100%;color:#eee;box-sizing:border-box}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item .\\--z--zpl-item-label{border-bottom:none;text-align:right;font-size:1.2em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item .\\--z--zpl-item-label [class^="pl-ic-"],.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item .\\--z--zpl-item-label [class*=" pl-ic-"]{font-size:1.3em;color:#fff}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item .\\--z--zpl-item-label i{float:left;position:relative;top:0.1em;visibility:hidden}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item .\\--z--zpl-item-label .txt{padding-left:2em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-menu .\\--z--zpl-menu-item[aria-checked="true"] .\\--z--zpl-item-label i{visibility:visible}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner{padding:.6em 0;display:table;width:100%;height:100%;color:#eee;box-sizing:border-box}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-menu-item{line-height:normal}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-menu-item[aria-checked="true"] .\\--z--zpl-toggle-checkbox{background-color:#f00}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-menu-item[aria-checked="true"] .\\--z--zpl-toggle-checkbox::after{background-color:#fff;-moz-transform:translateX(1.3em);-o-transform:translateX(1.3em);-ms-transform:translateX(1.3em);-webkit-transform:translateX(1.3em);transform:translateX(1.3em)}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-label{color:#fff;font-size:1.3em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content{text-align:right;font-size:1.1em}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content .\\--z--zpl-toggle-checkbox{height:1.2em;width:3em;float:right;position:relative;border-radius:1.4em;background:rgba(255,255,255,0.3);-moz-transform:scale(1);-o-transform:scale(1);-ms-transform:scale(1);-webkit-transform:scale(1);transform:scale(1);-webkit-transition:all 0.08s cubic-bezier(0.4, 0, 1, 1);-moz-transition:all 0.08s cubic-bezier(0.4, 0, 1, 1);transition:all 0.08s cubic-bezier(0.4, 0, 1, 1)}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content .\\--z--zpl-toggle-checkbox::after{content:\'\';position:absolute;top:0;left:0;height:1.8em;width:1.8em;border-radius:50%;margin-top:-0.3em;background-color:#bdbdbd;box-shadow:0 1px 5px 0 rgba(0,0,0,0.6);-webkit-transition:all 0.08s cubic-bezier(0.4, 0, 1, 1);-moz-transition:all 0.08s cubic-bezier(0.4, 0, 1, 1);transition:all 0.08s cubic-bezier(0.4, 0, 1, 1)}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content .\\--z--zpl-has-expand{display:flex;justify-content:flex-end;align-items:center}.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content .\\--z--zpl-has-expand [class^="pl-ic-"],.\\--z--player .\\--z--zpl-settings-menu .\\--z--zpl-panel .\\--z--zpl-panel-inner .\\--z--zpl-item-content .\\--z--zpl-has-expand [class*=" pl-ic-"]{font-size:1.3em;color:#fff;margin-left:0.3em}\n',""])},function(e,t,r){var n={"./blue.scss":[62,1],"./green.scss":[63,2],"./light_blue.scss":[64,3],"./purple.scss":[65,4],"./red.scss":[66,5]};function i(e){var t=n[e];return t?r.e(t[1]).then((function(){var e=t[0];return r.t(e,7)})):Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}i.keys=function(){return Object.keys(n)},i.id=44,e.exports=i},function(e,t,r){var n=r(46);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--player-poster{position:absolute;height:100%;top:0;left:0;right:0;bottom:0;margin:0;padding:0;display:inline-block;vertical-align:middle;background-repeat:no-repeat;background-position:50% 50%;background-size:cover;background-color:#000;cursor:pointer}\n",""])},function(e,t,r){var n=r(48);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--loading-wrapper{-moz-transform:translate(-50%, -50%);-o-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);position:absolute;z-index:999;right:auto;top:50%;left:50%;padding:0;display:none}.\\--z--player .\\--z--loading-wrapper.\\--z--active{display:block}.\\--z--player .\\--z--pie-wrapper{height:6em;width:6em;line-height:6em;position:relative}.\\--z--player .\\--z--pie-wrapper .\\--z--pie{clip:rect(0, 6em, 6em, 3em);position:absolute;top:0;left:0;height:100%;width:100%}.\\--z--player .\\--z--pie-wrapper .\\--z--pie .\\--z--half-circle{height:100%;width:100%;border:0.4em solid #fff;border-radius:50%;clip:rect(0, 3em, 6em, 0);left:0;position:absolute;top:0}.\\--z--player .\\--z--pie-wrapper .\\--z--label{background:transparent;color:#fff;cursor:default;display:block;font-size:1.6em;font-weight:500;position:absolute;bottom:0;right:0;left:0;top:0;text-align:center;border-radius:50%;background-color:rgba(0,0,0,0.5)}.\\--z--player .\\--z--pie-wrapper .\\--z--shadow{height:100%;width:100%;border:0.4em solid rgba(255,255,255,0.5);border-radius:50%}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-1 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-1 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-1 .\\--z--pie .\\--z--left-side{transform:rotate(3.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-2 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-2 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-2 .\\--z--pie .\\--z--left-side{transform:rotate(7.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-3 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-3 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-3 .\\--z--pie .\\--z--left-side{transform:rotate(10.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-4 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-4 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-4 .\\--z--pie .\\--z--left-side{transform:rotate(14.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-5 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-5 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-5 .\\--z--pie .\\--z--left-side{transform:rotate(18deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-6 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-6 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-6 .\\--z--pie .\\--z--left-side{transform:rotate(21.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-7 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-7 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-7 .\\--z--pie .\\--z--left-side{transform:rotate(25.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-8 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-8 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-8 .\\--z--pie .\\--z--left-side{transform:rotate(28.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-9 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-9 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-9 .\\--z--pie .\\--z--left-side{transform:rotate(32.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-10 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-10 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-10 .\\--z--pie .\\--z--left-side{transform:rotate(36deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-11 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-11 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-11 .\\--z--pie .\\--z--left-side{transform:rotate(39.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-12 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-12 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-12 .\\--z--pie .\\--z--left-side{transform:rotate(43.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-13 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-13 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-13 .\\--z--pie .\\--z--left-side{transform:rotate(46.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-14 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-14 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-14 .\\--z--pie .\\--z--left-side{transform:rotate(50.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-15 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-15 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-15 .\\--z--pie .\\--z--left-side{transform:rotate(54deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-16 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-16 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-16 .\\--z--pie .\\--z--left-side{transform:rotate(57.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-17 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-17 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-17 .\\--z--pie .\\--z--left-side{transform:rotate(61.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-18 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-18 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-18 .\\--z--pie .\\--z--left-side{transform:rotate(64.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-19 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-19 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-19 .\\--z--pie .\\--z--left-side{transform:rotate(68.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-20 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-20 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-20 .\\--z--pie .\\--z--left-side{transform:rotate(72deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-21 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-21 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-21 .\\--z--pie .\\--z--left-side{transform:rotate(75.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-22 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-22 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-22 .\\--z--pie .\\--z--left-side{transform:rotate(79.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-23 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-23 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-23 .\\--z--pie .\\--z--left-side{transform:rotate(82.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-24 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-24 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-24 .\\--z--pie .\\--z--left-side{transform:rotate(86.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-25 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-25 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-25 .\\--z--pie .\\--z--left-side{transform:rotate(90deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-26 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-26 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-26 .\\--z--pie .\\--z--left-side{transform:rotate(93.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-27 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-27 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-27 .\\--z--pie .\\--z--left-side{transform:rotate(97.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-28 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-28 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-28 .\\--z--pie .\\--z--left-side{transform:rotate(100.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-29 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-29 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-29 .\\--z--pie .\\--z--left-side{transform:rotate(104.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-30 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-30 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-30 .\\--z--pie .\\--z--left-side{transform:rotate(108deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-31 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-31 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-31 .\\--z--pie .\\--z--left-side{transform:rotate(111.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-32 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-32 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-32 .\\--z--pie .\\--z--left-side{transform:rotate(115.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-33 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-33 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-33 .\\--z--pie .\\--z--left-side{transform:rotate(118.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-34 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-34 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-34 .\\--z--pie .\\--z--left-side{transform:rotate(122.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-35 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-35 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-35 .\\--z--pie .\\--z--left-side{transform:rotate(126deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-36 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-36 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-36 .\\--z--pie .\\--z--left-side{transform:rotate(129.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-37 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-37 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-37 .\\--z--pie .\\--z--left-side{transform:rotate(133.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-38 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-38 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-38 .\\--z--pie .\\--z--left-side{transform:rotate(136.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-39 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-39 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-39 .\\--z--pie .\\--z--left-side{transform:rotate(140.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-40 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-40 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-40 .\\--z--pie .\\--z--left-side{transform:rotate(144deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-41 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-41 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-41 .\\--z--pie .\\--z--left-side{transform:rotate(147.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-42 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-42 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-42 .\\--z--pie .\\--z--left-side{transform:rotate(151.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-43 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-43 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-43 .\\--z--pie .\\--z--left-side{transform:rotate(154.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-44 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-44 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-44 .\\--z--pie .\\--z--left-side{transform:rotate(158.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-45 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-45 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-45 .\\--z--pie .\\--z--left-side{transform:rotate(162deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-46 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-46 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-46 .\\--z--pie .\\--z--left-side{transform:rotate(165.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-47 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-47 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-47 .\\--z--pie .\\--z--left-side{transform:rotate(169.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-48 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-48 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-48 .\\--z--pie .\\--z--left-side{transform:rotate(172.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-49 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-49 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-49 .\\--z--pie .\\--z--left-side{transform:rotate(176.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-50 .\\--z--pie .\\--z--right-side{display:none}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-50 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-50 .\\--z--pie .\\--z--left-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-51 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-51 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-51 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-51 .\\--z--pie .\\--z--left-side{transform:rotate(183.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-52 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-52 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-52 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-52 .\\--z--pie .\\--z--left-side{transform:rotate(187.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-53 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-53 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-53 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-53 .\\--z--pie .\\--z--left-side{transform:rotate(190.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-54 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-54 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-54 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-54 .\\--z--pie .\\--z--left-side{transform:rotate(194.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-55 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-55 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-55 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-55 .\\--z--pie .\\--z--left-side{transform:rotate(198deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-56 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-56 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-56 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-56 .\\--z--pie .\\--z--left-side{transform:rotate(201.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-57 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-57 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-57 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-57 .\\--z--pie .\\--z--left-side{transform:rotate(205.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-58 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-58 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-58 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-58 .\\--z--pie .\\--z--left-side{transform:rotate(208.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-59 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-59 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-59 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-59 .\\--z--pie .\\--z--left-side{transform:rotate(212.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-60 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-60 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-60 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-60 .\\--z--pie .\\--z--left-side{transform:rotate(216deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-61 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-61 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-61 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-61 .\\--z--pie .\\--z--left-side{transform:rotate(219.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-62 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-62 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-62 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-62 .\\--z--pie .\\--z--left-side{transform:rotate(223.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-63 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-63 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-63 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-63 .\\--z--pie .\\--z--left-side{transform:rotate(226.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-64 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-64 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-64 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-64 .\\--z--pie .\\--z--left-side{transform:rotate(230.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-65 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-65 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-65 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-65 .\\--z--pie .\\--z--left-side{transform:rotate(234deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-66 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-66 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-66 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-66 .\\--z--pie .\\--z--left-side{transform:rotate(237.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-67 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-67 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-67 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-67 .\\--z--pie .\\--z--left-side{transform:rotate(241.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-68 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-68 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-68 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-68 .\\--z--pie .\\--z--left-side{transform:rotate(244.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-69 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-69 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-69 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-69 .\\--z--pie .\\--z--left-side{transform:rotate(248.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-70 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-70 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-70 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-70 .\\--z--pie .\\--z--left-side{transform:rotate(252deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-71 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-71 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-71 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-71 .\\--z--pie .\\--z--left-side{transform:rotate(255.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-72 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-72 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-72 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-72 .\\--z--pie .\\--z--left-side{transform:rotate(259.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-73 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-73 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-73 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-73 .\\--z--pie .\\--z--left-side{transform:rotate(262.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-74 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-74 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-74 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-74 .\\--z--pie .\\--z--left-side{transform:rotate(266.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-75 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-75 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-75 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-75 .\\--z--pie .\\--z--left-side{transform:rotate(270deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-76 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-76 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-76 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-76 .\\--z--pie .\\--z--left-side{transform:rotate(273.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-77 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-77 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-77 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-77 .\\--z--pie .\\--z--left-side{transform:rotate(277.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-78 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-78 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-78 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-78 .\\--z--pie .\\--z--left-side{transform:rotate(280.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-79 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-79 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-79 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-79 .\\--z--pie .\\--z--left-side{transform:rotate(284.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-80 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-80 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-80 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-80 .\\--z--pie .\\--z--left-side{transform:rotate(288deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-81 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-81 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-81 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-81 .\\--z--pie .\\--z--left-side{transform:rotate(291.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-82 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-82 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-82 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-82 .\\--z--pie .\\--z--left-side{transform:rotate(295.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-83 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-83 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-83 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-83 .\\--z--pie .\\--z--left-side{transform:rotate(298.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-84 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-84 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-84 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-84 .\\--z--pie .\\--z--left-side{transform:rotate(302.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-85 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-85 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-85 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-85 .\\--z--pie .\\--z--left-side{transform:rotate(306deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-86 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-86 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-86 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-86 .\\--z--pie .\\--z--left-side{transform:rotate(309.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-87 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-87 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-87 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-87 .\\--z--pie .\\--z--left-side{transform:rotate(313.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-88 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-88 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-88 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-88 .\\--z--pie .\\--z--left-side{transform:rotate(316.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-89 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-89 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-89 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-89 .\\--z--pie .\\--z--left-side{transform:rotate(320.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-90 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-90 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-90 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-90 .\\--z--pie .\\--z--left-side{transform:rotate(324deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-91 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-91 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-91 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-91 .\\--z--pie .\\--z--left-side{transform:rotate(327.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-92 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-92 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-92 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-92 .\\--z--pie .\\--z--left-side{transform:rotate(331.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-93 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-93 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-93 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-93 .\\--z--pie .\\--z--left-side{transform:rotate(334.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-94 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-94 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-94 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-94 .\\--z--pie .\\--z--left-side{transform:rotate(338.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-95 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-95 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-95 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-95 .\\--z--pie .\\--z--left-side{transform:rotate(342deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-96 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-96 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-96 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-96 .\\--z--pie .\\--z--left-side{transform:rotate(345.6deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-97 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-97 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-97 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-97 .\\--z--pie .\\--z--left-side{transform:rotate(349.2deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-98 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-98 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-98 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-98 .\\--z--pie .\\--z--left-side{transform:rotate(352.8deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-99 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-99 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-99 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-99 .\\--z--pie .\\--z--left-side{transform:rotate(356.4deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-100 .\\--z--pie{clip:rect(auto, auto, auto, auto)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-100 .\\--z--pie .\\--z--right-side{transform:rotate(180deg)}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-100 .\\--z--pie .\\--z--half-circle{border-color:#fff}.\\--z--player .\\--z--pie-wrapper.\\--z--progress-100 .\\--z--pie .\\--z--left-side{transform:rotate(360deg)}.\\--z--player .\\--z--loader{height:7em;width:7em;border:0.4em solid rgba(255,255,255,0.5);border-radius:50%;border-top:0.4em solid #fff;-webkit-animation:spin .8s linear infinite;animation:spin .8s linear infinite}@-webkit-keyframes spin{0%{-webkit-transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg)}}@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}\n",""])},function(e,t,r){var n=r(50);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,"div.player-error-screen{color:#CCCACA;position:absolute;top:0;height:100%;width:100%;background-color:rgba(0,0,0,0.7);z-index:2000;display:flex;flex-direction:column;justify-content:center}div.player-error-screen__content[data-error-screen]{font-size:1.4em;color:#CCCACA;margin:0 auto}div.player-error-screen__title[data-error-screen]{font-weight:bold;font-size:1.8em;margin-bottom:0.5em}div.player-error-screen__message[data-error-screen]{margin:0 auto}div.player-error-screen__code[data-error-screen]{font-size:1.3em}div.player-error-screen__reload{cursor:pointer;width:3em;margin:1.5em auto 0}div.player-error-screen__reload .icon{color:#fff;font-size:3em}\n",""])},function(e,t,r){var n=r(52);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .AdsPlugin{position:absolute;z-index:1;width:100%;height:100%;left:0;top:0}.\\--z--player .AdsPlugin iframe{background:none !important}.\\--z--player .AdsPlugin .ad_runner_ui_control svg{width:100%;height:100%}.\\--z--player .ad_runners_ui_ad_mark_container{-webkit-transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;-moz-transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;transition:height 0.2s,transform 0.2s cubic-bezier(0, 0, 0.2, 1),top 0.2s;position:absolute;height:0.3em !important;top:0.9em}.\\--z--player .\\--z--controls .\\--z--progress-bar:hover .ad_runners_ui_ad_mark_container{height:0.5em !important;top:0.8em}.\\--z--player .AdsPluginNonLinear{bottom:0;left:50%;margin-bottom:5em;position:absolute;transform:translateX(-50%)}.\\--z--player .ad_runners_ui_slide_black .ad_message_text,.\\--z--player .ad_runner_ui_loading,.\\--z--player .ad_runner_ui_countdown_to_play{top:initial;left:0.5em;bottom:0.5em;font-size:1.2em}.\\--z--player .ad_runners_ui_slide_black .ad_message_text.has_controls_bar,.\\--z--player .ad_runner_ui_loading.has_controls_bar,.\\--z--player .ad_runner_ui_countdown_to_play.has_controls_bar{bottom:4em}.\\--z--player .ad_runner_ui_skip_button{height:42px}.\\--z--player .ad_runners_ui_slide_black .ad_message_text{padding:0.5em;color:#eee}.\\--z--full-screen .ad_runner_ui_skip_button .countdown{max-width:170px}\n",""])},function(e,t,r){var n=r(54);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--big-play-button{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;-moz-transform:translate(-50%, -50%);-o-transform:translate(-50%, -50%);-ms-transform:translate(-50%, -50%);-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);height:7em;width:7em;font-size:1em;align-items:center;justify-content:center;position:absolute;top:50%;left:50%;bottom:auto;right:auto;padding:0;cursor:pointer;opacity:1;border:0.4em solid #fff;background-color:transparent;border-radius:50%}.\\--z--player .\\--z--big-play-button .\\--z--icon{font-size:5em}\n",""])},function(e,t,r){var n=r(56);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--playpause-fadeout{height:1.5em;width:1.5em;-webkit-animation:zp-bezel-fadeout 0.5s linear 1 normal forwards;-moz-animation:zp-bezel-fadeout 0.5s linear 1 normal forwards;-o-animation:zp-bezel-fadeout 0.5s linear 1 normal forwards;animation:zp-bezel-fadeout 0.5s linear 1 normal forwards;margin-left:-.75em;margin-top:-.75em;align-items:center;justify-content:center;position:absolute;top:50%;left:50%;bottom:auto;right:auto;padding:0;opacity:1;font-size:3em;border-radius:50%;border:0;background-color:rgba(0,0,0,0.5);color:#fff;pointer-events:none;display:none}@-webkit-keyframes zp-bezel-fadeout{0%{opacity:1}to{opacity:0;transform:scale(1.8)}}@-moz-keyframes zp-bezel-fadeout{0%{opacity:1}to{opacity:0;transform:scale(1.8)}}@-o-keyframes zp-bezel-fadeout{0%{opacity:1}to{opacity:0;transform:scale(1.8)}}@keyframes zp-bezel-fadeout{0%{opacity:1}to{opacity:0;transform:scale(1.8)}}\n",""])},function(e,t,r){var n=r(58);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--player .\\--z--unmute-box{display:-webkit-box;display:-moz-box;display:box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex;-webkit-animation:decrease-width-button 0.25s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;-moz-animation:decrease-width-button 0.25s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;-o-animation:decrease-width-button 0.25s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;animation:decrease-width-button 0.25s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;align-items:center;position:absolute;top:1em;left:1em;padding:.4em .5em .3em;width:18em;border-radius:.2em;background-color:rgba(0,0,0,0.8);cursor:pointer}.\\--z--player .\\--z--unmute-box span{-webkit-animation:decrease-opacity 0s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;-moz-animation:decrease-opacity 0s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;-o-animation:decrease-opacity 0s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;animation:decrease-opacity 0s cubic-bezier(0.4, 0, 1, 1) 5.4s forwards;font-size:1.2em;font-weight:500;text-transform:uppercase;display:inline-block;white-space:nowrap;color:#fff}.\\--z--player .\\--z--unmute-box .\\--z--btn-unmute{margin-left:0;font-size:1.6em;color:#fff;border-radius:.1em;padding:0 .4em}.\\--z--player .\\--z--unmute-box .\\--z--btn-unmute .\\--z--icon{font-size:1.4em;margin-right:.15em;color:inherit;position:relative;top:.06em}@-webkit-keyframes decrease-width-button{0%{width:18em}100%{width:4.5em}}@-moz-keyframes decrease-width-button{0%{width:18em}100%{width:4.5em}}@-o-keyframes decrease-width-button{0%{width:18em}100%{width:4.5em}}@keyframes decrease-width-button{0%{width:18em}100%{width:4.5em}}@-webkit-keyframes decrease-opacity{0%{opacity:1}100%{opacity:0}}@-moz-keyframes decrease-opacity{0%{opacity:1}100%{opacity:0}}@-o-keyframes decrease-opacity{0%{opacity:1}100%{opacity:0}}@keyframes decrease-opacity{0%{opacity:1}100%{opacity:0}}\n",""])},function(e,t,r){var n=r(60);"string"==typeof n&&(n=[[e.i,n,""]]),r(1)(n,{hmr:!0,transform:void 0,insertInto:void 0}),n.locals&&(e.exports=n.locals)},function(e,t,r){(e.exports=r(0)(!1)).push([e.i,".\\--z--control-dvr{margin-left:1.5em}.\\--z--control-dvr span.icon-live{border:4px solid red;border-radius:4px}.\\--z--control-dvr span.text{color:#fff;margin-left:5px}\n",""])},function(e,t,r){"use strict";var g;r.r(t);var v={};r.r(v),r.d(v,"cloneDeep",(function(){return re})),r.d(v,"getDeep",(function(){return ne})),r.d(v,"each",(function(){return ie})),r.d(v,"extend",(function(){return ae})),r.d(v,"objValuesToArray",(function(){return oe}));var y={};r.r(y),r.d(y,"hasClass",(function(){return ve})),r.d(y,"addClass",(function(){return ye})),r.d(y,"removeClass",(function(){return me})),r.d(y,"toggleClass",(function(){return Ae})),r.d(y,"setClass",(function(){return be})),r.d(y,"setStyles",(function(){return Ee})),r.d(y,"isEl",(function(){return ke})),r.d(y,"isTextNode",(function(){return Te})),r.d(y,"emptyEl",(function(){return Se})),r.d(y,"normalizeContent",(function(){return we})),r.d(y,"appendContent",(function(){return _e})),r.d(y,"insertContent",(function(){return Le})),r.d(y,"textContent",(function(){return Pe})),r.d(y,"createEl",(function(){return Ie})),r.d(y,"createElFromHTML",(function(){return Re})),r.d(y,"getAttribute",(function(){return Ce})),r.d(y,"setAttribute",(function(){return De})),r.d(y,"removeAttribute",(function(){return Oe})),r.d(y,"findPosition",(function(){return ze})),r.d(y,"isOnViewport",(function(){return Me})),r.d(y,"getPointerPosition",(function(){return xe})),r.d(y,"isSingleLeftClick",(function(){return Be})),r.d(y,"removeFromDom",(function(){return Fe}));var m={};r.r(m),r.d(m,"IS_IPAD",(function(){return ct})),r.d(m,"IS_IPHONE",(function(){return ft})),r.d(m,"IS_IPOD",(function(){return dt})),r.d(m,"IS_IOS",(function(){return ht})),r.d(m,"IOS_VERSION",(function(){return pt})),r.d(m,"IS_ANDROID",(function(){return gt})),r.d(m,"ANDROID_VERSION",(function(){return vt})),r.d(m,"IS_NATIVE_ANDROID",(function(){return yt})),r.d(m,"IS_FIREFOX",(function(){return mt})),r.d(m,"IS_EDGE",(function(){return At})),r.d(m,"IS_CHROME",(function(){return bt})),r.d(m,"CHROME_VERSION",(function(){return Et})),r.d(m,"IE_VERSION",(function(){return kt})),r.d(m,"IS_SAFARI",(function(){return Tt})),r.d(m,"IS_ANY_SAFARI",(function(){return St})),r.d(m,"IS_MOBILE",(function(){return wt}));var A={};r.r(A),r.d(A,"createPromiseDefer",(function(){return _t}));var b={};r.r(b),r.d(b,"orderBy",(function(){return Vt})),r.d(b,"whereBy",(function(){return Ht})),r.d(b,"average",(function(){return Kt})),r.d(b,"findWithAttr",(function(){return Qt}));var E={};r.r(E),r.d(E,"getHours",(function(){return xd})),r.d(E,"getMinutes",(function(){return Bd})),r.d(E,"getSeconds",(function(){return Fd})),r.d(E,"getCurrentTimeSeconds",(function(){return Nd})),r.d(E,"formatTime",(function(){return Ud}));var k={};r.r(k),r.d(k,"format",(function(){return Gp})),r.d(k,"escapeHtml",(function(){return Yp})),r.d(k,"trimHtml",(function(){return Vp})),r.d(k,"trimAccents",(function(){return Hp})),r.d(k,"startsWith",(function(){return Kp})),r.d(k,"endsWith",(function(){return Qp})),r.d(k,"generateId",(function(){return Wp})),r.d(k,"getPercentage",(function(){return qp})),r.d(k,"replaceAll",(function(){return Xp})),r.d(k,"toTitleCase",(function(){return Jp})),r.d(k,"toPascalCase",(function(){return Zp})),r.d(k,"toCamelCase",(function(){return $p})),r.d(k,"stripHTML",(function(){return eg})),r.d(k,"getHTML",(function(){return tg}));var T={};r.r(T),r.d(T,"checkAdBlocker",(function(){return Kg}));var S={};r.r(S),r.d(S,"fetchUrl",(function(){return Qg}));var w={};r.r(w),r.d(w,"fadeOut",(function(){return my})),r.d(w,"fadeIn",(function(){return Ay})),r(7),r(9);var _={};function L(e){return _[e]||(_[e]=0),e+ ++_[e]}var P="font-weight: bold; font-size: 13px;",I="color: #ff8000;"+P,R="color: #ff0000;"+P,C=["color: #0000ff;font-weight: bold; font-size: 13px;","color: #006600;font-weight: bold; font-size: 13px;",I,R,R],D=["debug","info","warn","error","disabled"],O=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=t,this.offLevel=r}var t;return(t=[{key:"debug",value:function(e){this.log(e,0,Array.prototype.slice.call(arguments,1))}},{key:"info",value:function(e){this.log(e,1,Array.prototype.slice.call(arguments,1))}},{key:"warn",value:function(e){this.log(e,2,Array.prototype.slice.call(arguments,1))}},{key:"error",value:function(e){this.log(e,3,Array.prototype.slice.call(arguments,1))}},{key:"onOff",value:function(){this.level===this.offLevel?this.level=this.previousLevel:(this.previousLevel=this.level,this.level=this.offLevel),window.console&&window.console.log&&window.console.log("%c[Zplayer.Log] set log level to "+D[this.level],I)}},{key:"level",value:function(e){this.level=e}},{key:"log",value:function(e,t,r){if(!(t<this.level)){r||(r=e,e=null);var n=C[t],i="";e&&(i="["+e+"]"),window.console&&window.console.log&&window.console.log.apply(console,["%c["+D[t]+"]"+i,n].concat(r))}}}])&&function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(e.prototype,t),e}();function z(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}O.LEVEL_DEBUG=0,O.LEVEL_INFO=1,O.LEVEL_WARN=2,O.LEVEL_ERROR=3,O.LEVEL_DISABLED=4,O.getInstance=function(){return void 0===this._instance&&(this._instance=new this,this._instance.previousLevel=this._instance.level,this._instance.level=this._instance.offLevel),this._instance},O.setLevel=function(e){this.getInstance().level=e},O.debug=function(){this.getInstance().debug.apply(this.getInstance(),arguments)},O.info=function(){this.getInstance().info.apply(this.getInstance(),arguments)},O.warn=function(){this.getInstance().warn.apply(this.getInstance(),arguments)},O.error=function(){this.getInstance().error.apply(this.getInstance(),arguments)};var x=Array.prototype.slice,B=/\s+/,F=function(e,t,r,n){if(!r)return!0;if("object"===M(r)){for(var i in r)e[t].apply(e,[i,r[i]].concat(n));return!1}if(B.test(r)){for(var a=r.split(B),o=0,s=a.length;o<s;o++)e[t].apply(e,[a[o]].concat(n));return!1}return!0},N=function(e,t,r,n){var i,a=-1,o=e.length,s=t[0],l=t[1],u=t[2];!function c(){try{switch(t.length){case 0:for(;++a<o;)(i=e[a]).callback.call(i.ctx);return;case 1:for(;++a<o;)(i=e[a]).callback.call(i.ctx,s);return;case 2:for(;++a<o;)(i=e[a]).callback.call(i.ctx,s,l);return;case 3:for(;++a<o;)(i=e[a]).callback.call(i.ctx,s,l,u);return;default:for(;++a<o;)(i=e[a]).callback.apply(i.ctx,t);return}}catch(e){O.error.apply(O,[r,"error on event",n,"trigger","-",e]),c()}}()},U=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n;return t=e,n=[{key:"register",value:function(t){e.Custom||(e.Custom={});var r="string"==typeof t&&t.toUpperCase().trim();r&&!e.Custom[r]?e.Custom[r]=r.toLowerCase().split("_").map((function(e,t){return 0===t?e:e=e[0].toUpperCase()+e.slice(1)})).join(""):O.error("Events","Error when register event: "+t)}}],(r=[{key:"on",value:function(e,t,r){if(!F(this,"on",e,[t,r])||!t)return this;this._events||(this._events={});var n=this._events[e]||(this._events[e]=[]);return n?(n.push({callback:t,context:r,ctx:r||this}),this):this}},{key:"once",value:function(e,t,r){var n,i=this;return F(this,"once",e,[t,r])&&t?(n=function(){i.off(e,n),t.apply(this,arguments)},this.on(e,n,r)):this}},{key:"off",value:function(e,t,r){var n,i,a,o,s,l,u,c;if(!this._events||!F(this,"off",e,[t,r]))return this;if(!e&&!t&&!r)return this._events=void 0,this;for(s=0,l=(o=e?[e]:Object.keys(this._events)).length;s<l&&(e=o[s],a=this._events[e])&&(this._events[e]=n=[],t||r);s++){for(u=0,c=a.length;u<c;u++)i=a[u],(t&&t!==i.callback&&t!==i.callback._callback||r&&r!==i.context)&&n.push(i);n.length||delete this._events[e]}return this}},{key:"trigger",value:function(e){var t=this.name||this.constructor.name;if(!e)return O.warn.apply(O,[t,"trying to trigger undefined event, ignored"]),this;if(!this._events)return this;var r=x.call(arguments,1);if(!F(this,"trigger",e,r))return this;var n=this._events[e],i=this._events.all;return n&&N(n,r,t,e),i&&N(i,arguments,t,e),this}},{key:"stopListening",value:function(e,t,r){var n=this._listeningTo;if(!n)return this;var i=!t&&!r;for(var a in r||"object"!==M(t)||(r=this),e&&((n={})[e._listenId]=e),n)(e=n[a]).off(t,r,this),(i||0===Object.keys(e._events).length)&&delete this._listeningTo[a];return this}}])&&z(t.prototype,r),n&&z(t,n),e}(),j={listenTo:"on",listenToOnce:"once"};function G(e){return(G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Object.keys(j).forEach((function(e){U.prototype[e]=function(t,r,n){return(this._listeningTo||(this._listeningTo={}))[t._listenId||(t._listenId=L("l"))]=t,n||"object"!==M(r)||(n=this),t[j[e]](r,n,this),this}})),["PLAYER_PLAY","PLAYER_PLAY_INTENT","PLAYER_PAUSE","PLAYER_STOP","PLAYER_ENDED","PLAYER_SEEK","PLAYER_SEEKED","PLAYER_SEEKING","PLAYER_ERROR","PLAYER_TIMEUPDATE","PLAYER_PROGRESS","PLAYER_FULLSCREEN","PLAYER_READY","PLAYER_BUFFERING","PLAYER_BUFFERING_CHANGE","PLAYER_BUFFERFULL","PLAYER_PRESS_PLAY","PLAYER_VOLUMEUPDATE","PLAYER_LOADEDMETADATA","PLAYER_CLICK","PLAYER_DBLCLICK","PLAYER_KEYDOWN","PLAYER_MOUSE_ENTER","PLAYER_MOUSE_LEAVE","PLAYER_MOUSE_MOVE","PLAYER_CONTEXTMENU","PLAYER_LEVELS_AVAILABEL","PLAYER_LEVEL_SWITCHED","PLAYER_SETTINGS_MENU_HIDE","PLAYER_QUALITY_LEVELS_SELECTED","PLAYER_UPDATE_SIZE","PLAYER_CANPLAYTHROUGH","PLAYER_WAITING","PLAYER_ORIENTATION_CHANGE","PLAYER_AD_PAUSE_REQUEST","PLAYER_AD_RESUME_REQUEST","PLAYER_AD_WILL_START","PLAYER_AD_STARTED","PLAYER_AD_STOPPED","PLAYER_AD_SKIPPED","PLAYER_AD_LOAD_TIMEOUT","PLAYER_MEDIACONTROL_DISABLE","PLAYER_MEDIACONTROL_ENABLE","PLAYER_MEDIACONTROL_SHOW","PLAYER_MEDIACONTROL_HIDE","PLAYER_MEDIACONTROL_READY","PLAYER_MEDIACONTROL_CLICK","PLAYER_MEDIACONTROL_DBLCLICK","PLAYER_DVRSTATECHANGED","PLAYER_THEATER_MODE_CHANGE","PLAYBACK_PROGRESS","PLAYBACK_TIMEUPDATE","PLAYBACK_BUFFERING","PLAYBACK_BUFFERING_CHANGE","PLAYBACK_BUFFERFULL","PLAYBACK_SETTINGSUPDATE","PLAYBACK_LOADEDMETADATA","PLAYBACK_VOLUMEUPDATE","PLAYBACK_HIGHDEFINITIONUPDATE","PLAYBACK_BITRATE","PLAYBACK_LEVELS_AVAILABLE","PLAYBACK_LEVEL_SWITCH_START","PLAYBACK_LEVEL_SWITCH_END","PLAYBACK_PLAYBACKSTATE","PLAYBACK_DVR","PLAYBACK_DVRSTATECHANGED","PLAYBACK_MEDIACONTROL_DISABLE","PLAYBACK_MEDIACONTROL_ENABLE","PLAYBACK_ENDED","PLAYBACK_PLAY_INTENT","PLAYBACK_PLAY","PLAYBACK_PAUSE","PLAYBACK_SEEKING","PLAYBACK_WAITING","PLAYBACK_SEEKED","PLAYBACK_STOP","PLAYBACK_ERROR","PLAYBACK_STATS_ADD","PLAYBACK_FRAGMENT_LOADED","PLAYBACK_LEVEL_SWITCHED","PLAYBACK_SUBTITLE_AVAILABLE","PLAYBACK_SUBTITLE_CHANGED","PLAYBACK_FULLSCREEN_IOS","PLAYBACK_CANPLAYTHROUGH","MEDIACONTROL_HIDE","MEDIACONTROL_SHOW","LOADING_SPINNER_HIDE","LOADING_SPINNER_SHOW","MEDIACONTROL_MOUSEMOVE_SEEKBAR","MEDIACONTROL_MOUSELEAVE_SEEKBAR"].forEach((function(e){U[e]=e}));var K=function(e){var t,r,n;function i(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),e&&(t=e.options),(r=function(e,t){return!t||"object"!==G(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Y(i).call(this))).player=e,r._options=t,r.uniqueId=L("o"),r._nameEvents={},r.constructor.NAME_EVENTS.forEach((function(e){U[e]=e,r._nameEvents[e]=e})),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(i,U),t=i,n=[{key:"NAME_EVENTS",get:function(){return[]}}],(r=[{key:"bindEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach((function(r){r.once?e.listenToOnce(r.target||t||e,r.name,r.handler):e.listenTo(r.target||t||e,r.name,r.handler)}))}},{key:"unbindEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.player;this.listenEvents.forEach((function(r){r.once?e.stopListening(r.target||t||e,r.name):e.stopListening(r.target||t||e,r.name,r.handler)}))}},{key:"options",get:function(){return this._options}},{key:"listenEvents",get:function(){return[]}}])&&V(t.prototype,r),n&&V(t,n),i}(),Q=function(e){return null!=e?e.constructor:null},W=function(e,t){return Boolean(e&&t&&e instanceof t)},q=function(e){return null==e},X=function(e){return Q(e)===Object},J=function(e){return Q(e)===String},Z=function(e){return Array.isArray(e)},$=function(e){return W(e,NodeList)},ee=function(e){return q(e)||(J(e)||Z(e)||$(e))&&!e.length||X(e)&&!Object.keys(e).length},te={nullOrUndefined:q,object:X,number:function(e){return Q(e)===Number&&!Number.isNaN(e)},string:J,boolean:function(e){return Q(e)===Boolean},function:function(e){return Q(e)===Function},array:Z,weakMap:function(e){return W(e,WeakMap)},nodeList:$,element:function(e){return W(e,Element)},textNode:function(e){return Q(e)===Text},event:function(e){return W(e,Event)},cue:function(e){return W(e,window.TextTrackCue)||W(e,window.VTTCue)},track:function(e){return W(e,TextTrack)||!q(e)&&J(e.kind)},url:function(e){if(W(e,window.URL))return!0;var t=e;e.startsWith("http://")&&e.startsWith("https://")||(t="http://".concat(e));try{return!ee(new URL(t).hostname)}catch(e){return!1}},empty:ee};function re(e){return JSON.parse(JSON.stringify(e))}function ne(e,t){return t.split(".").reduce((function(e,t){return e&&e[t]}),e)}function ie(e,t){(function(e){return te.object(e)?Object.keys(e):[]})(e).forEach((function(r){return t(e[r],r)}))}function ae(e){e=e||{};for(var t=1,r=arguments.length;t<r;++t){var n=arguments[t];if(n)for(var i in n)n.hasOwnProperty(i)&&("[object Object]"!==Object.prototype.toString.call(n[i])?e[i]=n[i]:e[i]=ae(e[i],n[i]))}return e}function oe(e){return Object.values&&Object.values(e)||Object.keys(e).map((function(t){return e[t]}))}function se(e){return(se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function le(e){return(le=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ce(e,t,r){return t&&ue(e.prototype,t),r&&ue(e,r),e}function fe(e,t){return(fe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var de=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==se(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,le(t).call(this,e))).pluginOptions=r.getPluginOptions(),r.enabled=!0,r.pluginOptions.disabled&&r.disable(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fe(e,t)}(t,K),ce(t,[{key:"defaultOptions",get:function(){return{}}}]),ce(t,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then((function(){return e.setUp()})).then((function(){return e.enabled&&e.bindEvents()}))}},{key:"getPluginOptions",value:function(){return ae(this.defaultOptions,ne(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.enabled=!0,O.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.enabled=!1,O.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.player.removePlugin(this.name)}}]),t}(),he=r(2),pe=r.n(he);function ge(e){if(/\s/.test(e))throw new Error("class has illegal whitespace characters")}function ve(e,t){return ge(t),e.classList?e.classList.contains(t):(r=t,new RegExp("(^|\\s)"+r+"($|\\s)")).test(e.className);var r}function ye(e,t){return e.classList?e.classList.add(t):ve(e,t)||(e.className=(e.className+" "+t).trim()),e}function me(e,t){return e.classList?e.classList.remove(t):(ge(t),e.className=e.className.split(/\s+/).filter((function(e){return e!==t})).join(" ")),e}function Ae(e,t,r){if(e.classList)return void 0===r?e.classList.toggle(t):e.classList.toggle(t,r);var n=ve(e,t);return"function"==typeof r&&(r=r(e,t)),"boolean"!=typeof r&&(r=!n),r!==n?(r?ye(e,t):me(e,t),e):void 0}function be(e,t){return e.className=t,e}function Ee(e,t){for(var r in t)if(null===t[r]){var n=r.split(/(?=[A-Z])/).map((function(e){return e.toLowerCase()})).join("-");e.style.removeProperty(n)}else e.style[r]=t[r];return e}function ke(e){return te.object(e)&&1===e.nodeType}function Te(e){return te.object(e)&&3===e.nodeType}function Se(e){for(;e.firstChild;)e.removeChild(e.firstChild);return e}function we(e){return"function"==typeof e&&(e=e()),(Array.isArray(e)?e:[e]).map((function(e){return"function"==typeof e&&(e=e()),ke(e)||Te(e)?e:"string"==typeof e&&/\S/.test(e)?document.createTextNode(e):void 0})).filter((function(e){return e}))}function _e(e,t){return we(t).forEach((function(t){return e.appendChild(t)})),e}function Le(e,t){return _e(Se(e),t)}function Pe(e,t){return void 0===e.textContent?e.innerText=t:e.textContent=t,e}function Ie(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"div",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0,i=document.createElement(e);return Object.getOwnPropertyNames(t).forEach((function(e){var r=t[e];-1!==e.indexOf("aria-")||"role"===e||"type"===e?i.setAttribute(e,r):i[e]=r})),Object.getOwnPropertyNames(r).forEach((function(e){i.setAttribute(e,r[e])})),n&&_e(i,n),i}function Re(e){var t=document.createElement("div");return t.innerHTML=e,t.firstChild}function Ce(e,t){return e.getAttribute(t)}function De(e,t,r){e.setAttribute(t,r)}function Oe(e,t){e.removeAttribute(t)}function ze(e){var t;if(e.getBoundingClientRect&&e.parentNode&&(t=e.getBoundingClientRect()),!t)return{left:0,top:0};var r=document.documentElement,n=document.body,i=r.clientLeft||n.clientLeft||0,a=window.pageXOffset||n.scrollLeft,o=t.left+a-i,s=r.clientTop||n.clientTop||0,l=window.pageYOffset||n.scrollTop,u=t.top+l-s;return{left:Math.round(o),top:Math.round(u)}}function Me(e){if(e){var t=e.getBoundingClientRect();return t.height/2<=window.innerHeight-t.top&&t.bottom>=t.height/2}}function xe(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n={},i=ze(e),a=r?e.offsetHeight:e.offsetWidth,o=r?e.offsetWidth:e.offsetHeight,s=i.top,l=i.left,u=t.pageY,c=t.pageX;return t.changedTouches&&(c=t.changedTouches[0].pageX,u=t.changedTouches[0].pageY),n.y=Math.max(0,Math.min(1,(s-u+o)/o)),n.x=Math.max(0,Math.min(1,(c-l)/a)),n}function Be(e){return void 0===e.button&&void 0===e.buttons||0===e.button&&void 0===e.buttons||0===e.button&&1===e.buttons}function Fe(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function Ne(e){return(Ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function je(e){return(je=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ge(e,t){return(Ge=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ye=/^(\S+)\s*(.*)$/,Ve=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==Ne(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,je(t).call(this,e,r))).cid=L("c"),n.buildElement(),n.delegateEvents(),n}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ge(e,t)}(t,K),r=t,i=[{key:"tagName",get:function(){return"div"}},{key:"events",get:function(){return{}}},{key:"attributes",get:function(){return{}}}],(n=[{key:"$",value:function(e){return this.$el.find(e)}},{key:"setElement",value:function(e){return this.$el=pe.a.zepto.isZ(e)?e:pe()(e),this.el=this.$el[0],this}},{key:"buildElement",value:function(){if(this.el)this.setElement(this.el,!1);else{var e=ae({},this.attributes);this.id&&(e.id=this.id);var t=ae({},this.properties),r=Ie(this.tagName,t,e);this.setElement(r,!1)}}},{key:"delegateEvents",value:function(e){if(!e&&!(e=this.events))return this;for(var t in e){var r=e[t];if(r&&r.constructor!==Function&&(r=this[e[t]]),r){var n=t.match(Ye),i=n[1],a=n[2];i+=".delegateEvents"+this.cid,""===a?this.$el.on(i,r.bind(this)):this.$el.on(i,a,r.bind(this))}}}},{key:"undelegateEvents",value:function(){return this.$el.off(".delegateEvents"+this.cid),this}},{key:"render",value:function(){return this}},{key:"remove",value:function(){return this.$el.remove(),this.unbindEvents(),this.undelegateEvents(),this}},{key:"getAttribute",value:function(e){return Ce(this.el,e)}},{key:"setAttribute",value:function(e,t){De(this.el,e,t)}},{key:"removeAttribute",value:function(e){Oe(this.el,e)}},{key:"setStyles",value:function(e){Ee(this.el,e)}},{key:"hasClass",value:function(e){return ve(this.el,e)}},{key:"addClass",value:function(e){ye(this.el,e)}},{key:"removeClass",value:function(e){me(this.el,e)}},{key:"toggleClass",value:function(e,t){Ae(this.el,e,t)}},{key:"show",value:function(){this.removeClass("--z--hide")}},{key:"hide",value:function(){this.addClass("--z--hide")}},{key:"properties",get:function(){return{}}}])&&Ue(r.prototype,n),i&&Ue(r,i),t}();function He(e){return(He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Qe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function We(e,t,r){return t&&Qe(e.prototype,t),r&&Qe(e,r),e}function qe(e,t){return(qe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Xe=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==He(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Ke(t).call(this,e))).pluginOptions=r.getPluginOptions(),r.enabled=!0,r.pluginOptions.disabled&&r.disable(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qe(e,t)}(t,Ve),We(t,[{key:"defaultOptions",get:function(){return{}}}]),We(t,[{key:"initialize",value:function(){var e=this;return Promise.resolve().then((function(){return e.setUp()})).then((function(){return e.render()})).then((function(){return e.enabled&&e.bindEvents()}))}},{key:"getPluginOptions",value:function(){return ae(this.defaultOptions,ne(this._options,"pluginsOptions.".concat(this.name))||this.defaultOptions)}},{key:"setUp",value:function(){}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0,O.debug(this.name,"enabled"))}},{key:"disable",value:function(){this.enabled&&(this.unbindEvents(),this.hide(),this.enabled=!1,O.debug(this.name,"disabled"))}},{key:"destroy",value:function(){this.disable(),this.remove(),this.player.removePlugin(this.name)}}]),t}();function Je(e){return(Je="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function $e(e){return($e=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function et(e,t){return(et=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(11);var tt=function(e){function t(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){return!t||"object"!==Je(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,$e(t).call(this,null,e))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&et(e,t)}(t,Ve),r=t,(n=[{key:"play",value:function(){throw new Error("this must be implemented")}},{key:"pause",value:function(){throw new Error("this must be implemented")}},{key:"stop",value:function(){}},{key:"seek",value:function(){}},{key:"seekPercentage",value:function(){}},{key:"getDuration",value:function(){return 0}},{key:"isPlaying",value:function(){return!1}},{key:"isReady",value:function(){throw new Error("this must be implemented")}},{key:"getPlaybackType",value:function(){return t.NO_OP}},{key:"isHighDefinitionInUse",value:function(){return!1}},{key:"volume",value:function(){}},{key:"getVolume",value:function(){return 0}},{key:"isHlsPlayback",value:function(){return!1}},{key:"isMp4Playback",value:function(){return!1}},{key:"destroy",value:function(){this.remove()}}])&&Ze(r.prototype,n),t}();tt.canPlay=function(){return!1},tt.VOD="vod",tt.AOD="aod",tt.LIVE="live",tt.LIVE_END="live_end",tt.NO_OP="no_op",tt.type="playback";var rt,nt,it,at,ot=tt,st=window.navigator&&window.navigator.userAgent||"",lt=/AppleWebKit\/([\d.]+)/i.exec(st),ut=lt?parseFloat(lt.pop()):null,ct=/iPad/i.test(st),ft=/iPhone/i.test(st)&&!ct,dt=/iPod/i.test(st),ht=ft||ct||dt,pt=(rt=st.match(/OS (\d+)_/i))&&rt[1]?rt[1]:null,gt=/Android/i.test(st),vt=function(){var e=st.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),r=e[2]&&parseFloat(e[2]);return t&&r?parseFloat(e[1]+"."+e[2]):t||null}(),yt=gt&&vt<5&&ut<537,mt=/Firefox/i.test(st),At=/Edge/i.test(st),bt=!At&&(/Chrome/i.test(st)||/CriOS/i.test(st)),Et=(at=st.match(/(Chrome|CriOS)\/(\d+)/))&&at[2]?parseFloat(at[2]):null,kt=(!(it=(nt=/MSIE\s(\d+)\.\d/.exec(st))&&parseFloat(nt[1]))&&/Trident\/7.0/i.test(st)&&/rv:11.0/.test(st)&&(it=11),it),Tt=/Safari/i.test(st)&&!bt&&!gt&&!At,St=(Tt||ht)&&!bt,wt=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone|IEMobile|Mobile Safari|Opera Mini/i.test(st);function _t(){var e={};return e.promise=new Promise((function(t,r){e.resolve=t,e.reject=r})),e}function Lt(e){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pt(e,t){return!t||"object"!==Lt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function It(e,t,r){return(It="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Rt(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Rt(e){return(Rt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dt(e,t,r){return t&&Ct(e.prototype,t),r&&Ct(e,r),e}function Ot(e,t){return(Ot=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var Mt={wav:["audio/wav"],mp3:["audio/mp3",'audio/mpeg;codecs="mp3"'],aac:['audio/mp4;codecs="mp4a.40.5"'],oga:["audio/ogg"]},xt=Object.keys(Mt).reduce((function(e,t){return[].concat(zt(e),zt(Mt[t]))}),[]),Bt=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];(r=Pt(this,(e=Rt(t)).call.apply(e,[this].concat(i))))._readyDeferred=_t(),r._destroyed=!1,r._loadStarted=!1,r._playheadMoving=!1,r._playheadMovingTimer=null,r._stopped=!1,r.isHlsPlayback()||r.setupSource(r.options.src),r.options.playback||(r.options.playback=r.options||{});var o=r.options.playback.preload||(Tt?"auto":r.options.preload);return ae(r.el,{muted:r.options.mute,loop:r.options.loop,preload:o,autoPlay:r.options.autoPlay||!1}),r.options.playInline&&(r.setAttribute("webkit-playsinline",""),r.setAttribute("playsinline","")),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ot(e,t)}(t,ot),Dt(t,[{key:"isAudioOnly",get:function(){var e=this.options.src,r=t._mimeTypesForUrl(e,Mt,this.options.mimeType);return this.options.playback&&this.options.playback.audioOnly||this.options.audioOnly||xt.indexOf(r[0])>=0}},{key:"events",get:function(){return{canplay:"_onCanPlay",canplaythrough:"_onCanplaythrough",error:"_onError",loadeddata:"_onLoadedData",loadedmetadata:"_onLoadedMetadata",stalled:"_onStalled",timeupdate:"_onTimeUpdate",waiting:"_onWaiting",pause:"_onPause",playing:"_onPlaying",progress:"_onProgress",seeking:"_onSeeking",seeked:"_onSeeked",ended:"_onEnded",webkitbeginfullscreen:"_onBeginFullScreen",webkitendfullscreen:"_onEndFullScreen"}}},{key:"ended",get:function(){return this.el.ended}},{key:"buffering",get:function(){return this._isBuffering}}]),Dt(t,[{key:"setupSource",value:function(e){te.empty(e)||(this._src=e,this.el.src=e)}},{key:"getSource",value:function(){return this._src}},{key:"render",value:function(){return this._readyDeferred.resolve(),this}},{key:"isPlaying",value:function(){return!this.el.paused&&!this.el.ended}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"play",value:function(){return this._stopped=!1,this._handleBufferingEvents(),this.playPromise=this.el.play(),O.debug(this.name,"PLAY_PROMISE",this.playPromise),this.playPromise}},{key:"pause",value:function(){var e=this;this.playPromise?this.playPromise.then((function(){return e.el.pause()})):this.el.pause()}},{key:"stop",value:function(){this.pause(),this._stopped=!0,this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(U.PLAYBACK_STOP)}},{key:"volume",value:function(e){e<0||e>100||(0===e?this.mute():this.unmute(),this.el.volume=e/100,this.trigger(U.PLAYBACK_VOLUMEUPDATE,e))}},{key:"getVolume",value:function(){return this.el.volume}},{key:"mute",value:function(){this.$el.attr({muted:"true"}),this.el.muted=!0}},{key:"unmute",value:function(){this.$el.attr({muted:null}),this.el.muted=!1}},{key:"isMuted",value:function(){return this.el.muted}},{key:"seek",value:function(e){te.number(e)&&(this.el.currentTime=e)}},{key:"seekPercentage",value:function(e){var t=this.el.duration*(e/100);this.seek(t)}},{key:"getCurrentTime",value:function(){this.el.currentTime}},{key:"getDuration",value:function(){return this.el.duration}},{key:"setPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.el.playbackRate=e}},{key:"setPreload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"metadata";return this.el.preload=e,this}},{key:"destroy",value:function(){this._destroyed=!0,It(Rt(t.prototype),"destroy",this).call(this),this.el.removeAttribute("src"),this._src=null}},{key:"_now",value:function(){return Date.now()}},{key:"_onCanPlay",value:function(){this._handleBufferingEvents()}},{key:"_onCanplaythrough",value:function(e){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_CANPLAYTHROUGH,{time:this._now(),data:e})}},{key:"_onError",value:function(){var e=this.el.error;if(e){var t={code:e.code,description:e.message,raw:e};this.trigger(U.PLAYBACK_ERROR,t)}else O.warn(this.name,"HTML5 media unknown error")}},{key:"_onWaiting",value:function(e){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_WAITING,{time:this._now(),data:e}),this._loadStarted=!0}},{key:"_onLoadedData",value:function(){this._loadStarted=!0,this._handleBufferingEvents()}},{key:"_onLoadedMetadata",value:function(e){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_LOADEDMETADATA,{duration:e.target.duration,data:e})}},{key:"_onStalled",value:function(){this._handleBufferingEvents()}},{key:"_onTimeUpdate",value:function(){this.trigger(U.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onProgress",value:function(){if(this.el.buffered.length){for(var e=this.el.buffered.length,t=[],r=0,n=0;n<e;n++)t=[].concat(zt(t),[{start:this.el.buffered.start(n),end:this.el.buffered.end(n)}]),this.el.currentTime>=t[n].start&&this.el.currentTime<=t[n].end&&(r=n);var i={start:t[r].start,current:t[r].end,total:this.el.duration};this.trigger(U.PLAYBACK_PROGRESS,i,t)}}},{key:"_onPause",value:function(){this._stopPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(U.PLAYBACK_PAUSE)}},{key:"_onPlaying",value:function(){this._startPlayheadMovingChecks(),this._handleBufferingEvents(),this.trigger(U.PLAYBACK_PLAY)}},{key:"_onSeeking",value:function(e){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_SEEKING,{time:this._now(),data:e})}},{key:"_onSeeked",value:function(){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_SEEKED)}},{key:"_onEnded",value:function(){this._handleBufferingEvents(),this.trigger(U.PLAYBACK_ENDED,this.name)}},{key:"_handleBufferingPercent",value:function(){if("html5_video"===this.name&&(1===this.el.networkState||2===this.el.networkState)){for(var e,t=this.el.buffered.length,r=this.el.currentTime,n=0,i=0;i<t;i++){var a=this.el.buffered.end(i);(a<=r&&a>n||this.el.buffered.start(i)<=r&&a>=r)&&(n=a)}e=100/6*(6-(r+3-n)),this.trigger(U.PLAYBACK_BUFFERING_CHANGE,e)}}},{key:"_handleBufferingEvents",value:function(){this._handleBufferingPercent();var e=!this.el.ended&&!this.el.paused,t=this._loadStarted&&!this.el.ended&&!this._stopped&&(e&&!this._playheadMoving||this.el.readyState<this.el.HAVE_FUTURE_DATA);this._isBuffering!=t&&(this._isBuffering=t,t?this.trigger(U.PLAYBACK_BUFFERING,this.name):this.trigger(U.PLAYBACK_BUFFERFULL,this.name))}},{key:"_startPlayheadMovingChecks",value:function(){null===this._playheadMovingTimer&&(this._playheadMovingTimeOnCheck=null,this._determineIfPlayheadMoving(),this._playheadMovingTimer=setInterval(this._determineIfPlayheadMoving.bind(this),500))}},{key:"_stopPlayheadMovingChecks",value:function(){null!==this._playheadMovingTimer&&(clearInterval(this._playheadMovingTimer),this._playheadMovingTimer=null,this._playheadMoving=!1)}},{key:"_determineIfPlayheadMoving",value:function(){var e=this._playheadMovingTimeOnCheck,t=this.el.currentTime;this._playheadMoving=e!==t,this._playheadMovingTimeOnCheck=t,this._handleBufferingEvents()}},{key:"_onBeginFullScreen",value:function(){this.trigger(U.PLAYBACK_FULLSCREEN_IOS,!0)}},{key:"_onEndFullScreen",value:function(){this.trigger(U.PLAYBACK_FULLSCREEN_IOS,!1)}},{key:"getPlaybackType",value:function(){throw new Error("this must be implemented")}}]),t}();function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ut(e,t){return!t||"object"!==Ft(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function jt(e){return(jt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gt(e,t){return(Gt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}Bt._mimeTypesForUrl=function(e,t,r){var n=(e.split("?")[0].match(/.*\.(.*)$/)||[])[1],i=r||n&&t[n.toLowerCase()]||[];return i.constructor===Array?i:[i]},Bt._canPlay=function(e,t,r,n){var i=Bt._mimeTypesForUrl(r,t,n),a=document.createElement(e);return!!i.filter((function(e){return!!a.canPlayType(e).replace(/no/,"")}))[0]};var Yt=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ut(this,jt(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gt(e,t)}(t,Bt),r=t,(n=[{key:"getPlaybackType",value:function(){var e=ot.VOD;return[0,void 0,1/0].indexOf(this.el.duration)>=0?ot.LIVE:e}},{key:"isMp4Playback",value:function(){return!0}},{key:"name",get:function(){return"html5_video"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"attributes",get:function(){return{"data-html5-video":""}}}])&&Nt(r.prototype,n),t}();function Vt(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(te.array(e)&&t)return e.sort((function(e,n){return r?e[t]-n[t]:n[t]-e[t]}))}function Ht(e,t,r){if(te.array(e))return e.filter((function(e){return e[t]===r})).shift()}function Kt(e){return e.length?e.reduce((function(e,t){return e+t}),0)/e.length:0}function Qt(e,t,r){for(var n=e.length,i=0;i<n;i++)if(e[i][t]===r)return i;return-1}Yt.canPlay=function(e,t){var r={mp4:["avc1.42E01E","avc1.58A01E","avc1.4D401E","avc1.64001E","mp4v.20.8","mp4v.20.240","mp4a.40.2"].map((function(e){return'video/mp4; codecs="'+e+', mp4a.40.2"'})),ogg:['video/ogg; codecs="theora, vorbis"','video/ogg; codecs="dirac"','video/ogg; codecs="theora, speex"'],"3gpp":['video/3gpp; codecs="mp4v.20.8, samr"'],webm:['video/webm; codecs="vp8, vorbis"'],mkv:['video/x-matroska; codecs="theora, vorbis"'],m3u8:["application/x-mpegurl"]};return r.ogv=r.ogg,r["3gp"]=r["3gpp"],Bt._canPlay("video",r,e,t)};var Wt=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},qt=Number.isSafeInteger||function(e){return"number"==typeof e&&Math.abs(e)<=Xt},Xt=Number.MAX_SAFE_INTEGER||9007199254740991,Jt=function(e){return e.NETWORK_ERROR="networkError",e.MEDIA_ERROR="mediaError",e.KEY_SYSTEM_ERROR="keySystemError",e.MUX_ERROR="muxError",e.OTHER_ERROR="otherError",e}({}),Zt=function(e){return e.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",e.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",e.KEY_SYSTEM_NO_SESSION="keySystemNoSession",e.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",e.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",e.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",e.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",e.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",e.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",e.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",e.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",e.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",e.MANIFEST_LOAD_ERROR="manifestLoadError",e.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",e.MANIFEST_PARSING_ERROR="manifestParsingError",e.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",e.LEVEL_EMPTY_ERROR="levelEmptyError",e.LEVEL_LOAD_ERROR="levelLoadError",e.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",e.LEVEL_PARSING_ERROR="levelParsingError",e.LEVEL_SWITCH_ERROR="levelSwitchError",e.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",e.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",e.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",e.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",e.FRAG_LOAD_ERROR="fragLoadError",e.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",e.FRAG_DECRYPT_ERROR="fragDecryptError",e.FRAG_PARSING_ERROR="fragParsingError",e.FRAG_GAP="fragGap",e.REMUX_ALLOC_ERROR="remuxAllocError",e.KEY_LOAD_ERROR="keyLoadError",e.KEY_LOAD_TIMEOUT="keyLoadTimeOut",e.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",e.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",e.BUFFER_APPEND_ERROR="bufferAppendError",e.BUFFER_APPENDING_ERROR="bufferAppendingError",e.BUFFER_STALLED_ERROR="bufferStalledError",e.BUFFER_FULL_ERROR="bufferFullError",e.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",e.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",e.ASSET_LIST_LOAD_ERROR="assetListLoadError",e.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",e.ASSET_LIST_PARSING_ERROR="assetListParsingError",e.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",e.INTERNAL_EXCEPTION="internalException",e.INTERNAL_ABORTED="aborted",e.ATTACH_MEDIA_ERROR="attachMediaError",e.UNKNOWN="unknown",e}({}),$t=function(e){return e.MEDIA_ATTACHING="hlsMediaAttaching",e.MEDIA_ATTACHED="hlsMediaAttached",e.MEDIA_DETACHING="hlsMediaDetaching",e.MEDIA_DETACHED="hlsMediaDetached",e.MEDIA_ENDED="hlsMediaEnded",e.STALL_RESOLVED="hlsStallResolved",e.BUFFER_RESET="hlsBufferReset",e.BUFFER_CODECS="hlsBufferCodecs",e.BUFFER_CREATED="hlsBufferCreated",e.BUFFER_APPENDING="hlsBufferAppending",e.BUFFER_APPENDED="hlsBufferAppended",e.BUFFER_EOS="hlsBufferEos",e.BUFFERED_TO_END="hlsBufferedToEnd",e.BUFFER_FLUSHING="hlsBufferFlushing",e.BUFFER_FLUSHED="hlsBufferFlushed",e.MANIFEST_LOADING="hlsManifestLoading",e.MANIFEST_LOADED="hlsManifestLoaded",e.MANIFEST_PARSED="hlsManifestParsed",e.LEVEL_SWITCHING="hlsLevelSwitching",e.LEVEL_SWITCHED="hlsLevelSwitched",e.LEVEL_LOADING="hlsLevelLoading",e.LEVEL_LOADED="hlsLevelLoaded",e.LEVEL_UPDATED="hlsLevelUpdated",e.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",e.LEVELS_UPDATED="hlsLevelsUpdated",e.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",e.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",e.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",e.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",e.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",e.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",e.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",e.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",e.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",e.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",e.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",e.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",e.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",e.CUES_PARSED="hlsCuesParsed",e.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",e.INIT_PTS_FOUND="hlsInitPtsFound",e.FRAG_LOADING="hlsFragLoading",e.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",e.FRAG_LOADED="hlsFragLoaded",e.FRAG_DECRYPTED="hlsFragDecrypted",e.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",e.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",e.FRAG_PARSING_METADATA="hlsFragParsingMetadata",e.FRAG_PARSED="hlsFragParsed",e.FRAG_BUFFERED="hlsFragBuffered",e.FRAG_CHANGED="hlsFragChanged",e.FPS_DROP="hlsFpsDrop",e.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",e.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",e.ERROR="hlsError",e.DESTROYING="hlsDestroying",e.KEY_LOADING="hlsKeyLoading",e.KEY_LOADED="hlsKeyLoaded",e.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",e.BACK_BUFFER_REACHED="hlsBackBufferReached",e.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",e.ASSET_LIST_LOADING="hlsAssetListLoading",e.ASSET_LIST_LOADED="hlsAssetListLoaded",e.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",e.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",e.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",e.INTERSTITIAL_STARTED="hlsInterstitialStarted",e.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",e.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",e.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",e.INTERSTITIAL_ENDED="hlsInterstitialEnded",e.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",e.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",e.EVENT_CUE_ENTER="hlsEventCueEnter",e}({}),er="manifest",tr="level",rr="audioTrack",nr="subtitleTrack",ir="main",ar="audio",or="subtitle",sr=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;h(this,e),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=r,this.totalWeight_=n}return p(e,[{key:"sample",value:function(e,t){var r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}},{key:"getTotalWeight",value:function(){return this.totalWeight_}},{key:"getEstimate",value:function(){if(this.alpha_){var e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}]),e}(),lr=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;h(this,e),this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=n,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new sr(t),this.fast_=new sr(r),this.defaultTTFB_=i,this.ttfb_=new sr(t)}return p(e,[{key:"update",value:function(e,t){var r=this.slow_,n=this.fast_,i=this.ttfb_;r.halfLife!==e&&(this.slow_=new sr(e,r.getEstimate(),r.getTotalWeight())),n.halfLife!==t&&(this.fast_=new sr(t,n.getEstimate(),n.getTotalWeight())),i.halfLife!==e&&(this.ttfb_=new sr(e,i.getEstimate(),i.getTotalWeight()))}},{key:"sample",value:function(e,t){var r=(e=Math.max(e,this.minDelayMs_))/1e3,n=8*t/r;this.fast_.sample(r,n),this.slow_.sample(r,n)}},{key:"sampleTTFB",value:function(e){var t=e/1e3,r=Math.sqrt(2)*Math.exp(-Math.pow(t,2)/2);this.ttfb_.sample(r,Math.max(e,5))}},{key:"canEstimate",value:function(){return this.fast_.getTotalWeight()>=this.minWeight_}},{key:"getEstimate",value:function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}},{key:"getEstimateTTFB",value:function(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}},{key:"destroy",value:function(){}},{key:"defaultEstimate",get:function(){return this.defaultEstimate_}}]),e}();function ur(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t);if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cr(){return(cr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(null,arguments)}function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(r),!0).forEach((function(t){ur(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var hr=function e(t,r){h(this,e),this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;var n="[".concat(t,"]:");this.trace=pr,this.debug=r.debug.bind(null,n),this.log=r.log.bind(null,n),this.warn=r.warn.bind(null,n),this.info=r.info.bind(null,n),this.error=r.error.bind(null,n)},pr=function(){},gr={trace:pr,debug:pr,log:pr,warn:pr,info:pr,error:pr};function vr(){return cr({},gr)}function yr(e,t,r){return t[e]?t[e].bind(t):function(e,t){var r=self.console[e];return r?r.bind(self.console,"".concat(t?"["+t+"] ":"","[").concat(e,"] >")):pr}(e,r)}var mr=vr(),Ar=mr;function br(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("undefined"!=typeof self)return(e||!self.MediaSource)&&self.ManagedMediaSource||self.MediaSource||self.WebKitMediaSource}function Er(e,t){var r=Object.keys(e),n=Object.keys(t),i=r.length,a=n.length;return!i||!a||i===a&&!r.some((function(e){return-1===n.indexOf(e)}))}function kr(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("undefined"!=typeof TextDecoder){var r=new TextDecoder("utf-8").decode(e);if(t){var n=r.indexOf("\0");return-1!==n?r.substring(0,n):r}return r.replace(/\0/g,"")}for(var i,a,o,s=e.length,l="",u=0;u<s;){if(0===(i=e[u++])&&t)return l;if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:l+=String.fromCharCode(i);break;case 12:case 13:a=e[u++],l+=String.fromCharCode((31&i)<<6|63&a);break;case 14:a=e[u++],o=e[u++],l+=String.fromCharCode((15&i)<<12|(63&a)<<6|(63&o)<<0)}}return l}function Tr(e){for(var t="",r=0;r<e.length;r++){var n=e[r].toString(16);n.length<2&&(n="0"+n),t+=n}return t}function Sr(e){return Uint8Array.from(e.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var wr,_r,Lr,Pr,Ir,Rr,Cr={exports:{}},Dr=(wr||(wr=1,_r=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,Lr=/^(?=([^\/?#]*))\1([^]*)$/,Pr=/(?:\/|^)\.(?=\/)/g,Ir=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,Rr={buildAbsoluteURL:function(e,t,r){if(r=r||{},e=e.trim(),!(t=t.trim())){if(!r.alwaysNormalize)return e;var n=Rr.parseURL(e);if(!n)throw new Error("Error trying to parse base URL.");return n.path=Rr.normalizePath(n.path),Rr.buildURLFromParts(n)}var i=Rr.parseURL(t);if(!i)throw new Error("Error trying to parse relative URL.");if(i.scheme)return r.alwaysNormalize?(i.path=Rr.normalizePath(i.path),Rr.buildURLFromParts(i)):t;var a=Rr.parseURL(e);if(!a)throw new Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var o=Lr.exec(a.path);a.netLoc=o[1],a.path=o[2]}a.netLoc&&!a.path&&(a.path="/");var s={scheme:a.scheme,netLoc:i.netLoc,path:null,params:i.params,query:i.query,fragment:i.fragment};if(!i.netLoc&&(s.netLoc=a.netLoc,"/"!==i.path[0]))if(i.path){var l=a.path,u=l.substring(0,l.lastIndexOf("/")+1)+i.path;s.path=Rr.normalizePath(u)}else s.path=a.path,i.params||(s.params=a.params,i.query||(s.query=a.query));return null===s.path&&(s.path=r.alwaysNormalize?Rr.normalizePath(i.path):i.path),Rr.buildURLFromParts(s)},parseURL:function(e){var t=_r.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(Pr,"");e.length!==(e=e.replace(Ir,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},Cr.exports=Rr),Cr.exports),Or=function e(){h(this,e),this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}},zr="audio",Mr="video",xr="audiovideo",Br=function(){function e(t){h(this,e),this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,"string"==typeof t&&(t={url:t}),this.base=t,function(e,t){var r=function e(t,r){var n=Object.getPrototypeOf(t);if(n)return Object.getOwnPropertyDescriptor(n,r)||e(n,r)}(e,t);r&&(r.enumerable=!0,Object.defineProperty(e,t,r))}(this,"stats")}return p(e,[{key:"setByteRange",value:function(e,t){var r,n=e.split("@",2);r=1===n.length?(null==t?void 0:t.byteRangeEndOffset)||0:parseInt(n[1]),this._byteRange=[r,parseInt(n[0])+r]}},{key:"clearElementaryStreamInfo",value:function(){var e=this.elementaryStreams;e[zr]=null,e[Mr]=null,e[xr]=null}},{key:"baseurl",get:function(){return this.base.url}},{key:"byteRange",get:function(){return null===this._byteRange?[]:this._byteRange}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"elementaryStreams",get:function(){var e;return null===this._streams&&(this._streams=(d(e={},zr,null),d(e,Mr,null),d(e,xr,null),e)),this._streams},set:function(e){this._streams=e}},{key:"hasStats",get:function(){return null!==this._stats}},{key:"hasStreams",get:function(){return null!==this._streams}},{key:"stats",get:function(){return null===this._stats&&(this._stats=new Or),this._stats},set:function(e){this._stats=e}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Dr.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(e){this._url=e}}]),e}();function Fr(e){return"initSegment"!==e.sn}var Nr=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,n))._decryptdata=null,i._programDateTime=null,i._ref=null,i._bitrate=void 0,i.rawProgramDateTime=null,i.tagList=[],i.duration=0,i.sn=0,i.levelkeys=void 0,i.type=void 0,i.loader=null,i.keyLoader=null,i.level=-1,i.cc=0,i.startPTS=void 0,i.endPTS=void 0,i.startDTS=void 0,i.endDTS=void 0,i.start=0,i.playlistOffset=0,i.deltaPTS=void 0,i.maxStartPTS=void 0,i.minEndPTS=void 0,i.data=void 0,i.bitrateTest=!1,i.title=null,i.initSegment=null,i.endList=void 0,i.gap=void 0,i.urlId=0,i.type=e,i}return p(r,[{key:"addStart",value:function(e){this.setStart(this.start+e)}},{key:"setStart",value:function(e){this.start=e,this._ref&&(this._ref.start=e)}},{key:"setDuration",value:function(e){this.duration=e,this._ref&&(this._ref.duration=e)}},{key:"setKeyFormat",value:function(e){var t=this.levelkeys;if(t){var r,n=t[e];!n||null!=(r=this._decryptdata)&&r.keyId||(this._decryptdata=n.getDecryptData(this.sn,t))}}},{key:"abortRequests",value:function(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}},{key:"setElementaryStreamInfo",value:function(e,t,r,n,i){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=this.elementaryStreams,s=o[e];s?(s.startPTS=Math.min(s.startPTS,t),s.endPTS=Math.max(s.endPTS,r),s.startDTS=Math.min(s.startDTS,n),s.endDTS=Math.max(s.endDTS,i)):o[e]={startPTS:t,endPTS:r,startDTS:n,endDTS:i,partial:a}}},{key:"byteLength",get:function(){if(this.hasStats){var e=this.stats.total;if(e)return e}if(this.byteRange.length){var t=this.byteRange[0],r=this.byteRange[1];if(Wt(t)&&Wt(r))return r-t}return null}},{key:"bitrate",get:function(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null},set:function(e){this._bitrate=e}},{key:"decryptdata",get:function(){var e,t=this.levelkeys;if(!t||t.NONE)return null;if(t.identity)this._decryptdata||(this._decryptdata=t.identity.getDecryptData(this.sn));else if(null==(e=this._decryptdata)||!e.keyId){var r=Object.keys(t);if(1===r.length){var n=this._decryptdata=t[r[0]]||null;n&&(this._decryptdata=n.getDecryptData(this.sn,t))}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;var e=Wt(this.duration)?this.duration:0;return this.programDateTime+1e3*e}},{key:"encrypted",get:function(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){var t,r=Object.keys(this.levelkeys),n=r.length;if(n>1||1===n&&null!=(t=this.levelkeys[r[0]])&&t.encrypted)return!0}return!1}},{key:"programDateTime",get:function(){return null===this._programDateTime&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime},set:function(e){Wt(e)?this._programDateTime=e:this._programDateTime=this.rawProgramDateTime=null}},{key:"ref",get:function(){return Fr(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}}]),r}(Br),Ur=function(e){c(r,e);var t=f(r);function r(e,n,i,a,o){var s;h(this,r),(s=t.call(this,i)).fragOffset=0,s.duration=0,s.gap=!1,s.independent=!1,s.relurl=void 0,s.fragment=void 0,s.index=void 0,s.duration=e.decimalFloatingPoint("DURATION"),s.gap=e.bool("GAP"),s.independent=e.bool("INDEPENDENT"),s.relurl=e.enumeratedString("URI"),s.fragment=n,s.index=a;var l=e.enumeratedString("BYTERANGE");return l&&s.setByteRange(l,o),o&&(s.fragOffset=o.fragOffset+o.duration),s}return p(r,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var e=this.elementaryStreams;return!!(e.audio||e.video||e.audiovideo)}}]),r}(Br),jr=Math.pow(2,32)-1,Gr=[].push,Yr={video:1,audio:2,id3:3,text:4};function Vr(e){return String.fromCharCode.apply(null,e)}function Hr(e,t){var r=e[t]<<8|e[t+1];return r<0?65536+r:r}function Kr(e,t){var r=Wr(e,t);return r<0?4294967296+r:r}function Qr(e,t){var r=Kr(e,t);return(r*=Math.pow(2,32))+Kr(e,t+4)}function Wr(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function qr(e,t){var r=[];if(!t.length)return r;for(var n=e.byteLength,i=0;i<n;){var a=Kr(e,i),o=a>1?i+a:n;if(Vr(e.subarray(i+4,i+8))===t[0])if(1===t.length)r.push(e.subarray(i+8,o));else{var s=qr(e.subarray(i+8,o),t.slice(1));s.length&&Gr.apply(r,s)}i=o}return r}function Xr(e){var t=[],r=e[0],n=8,i=Kr(e,n);n+=4;var a=0,o=0;0===r?(a=Kr(e,n),o=Kr(e,n+4),n+=8):(a=Qr(e,n),o=Qr(e,n+8),n+=16),n+=2;var s=e.length+o,l=Hr(e,n);n+=2;for(var u=0;u<l;u++){var c=n,f=Kr(e,c);c+=4;var d=2147483647&f;if(1===(2147483648&f)>>>31)return Ar.warn("SIDX has hierarchical references (not supported)"),null;var h=Kr(e,c);c+=4,t.push({referenceSize:d,subsegmentDuration:h,info:{duration:h/i,start:s,end:s+d-1}}),s+=d,n=c+=4}return{earliestPresentationTime:a,timescale:i,version:r,referencesCount:l,references:t}}function Jr(e){for(var t=[],r=qr(e,["moov","trak"]),n=0;n<r.length;n++){var i=r[n],a=qr(i,["tkhd"])[0];if(a){var o=a[0],s=Kr(a,0===o?12:20),l=qr(i,["mdia","mdhd"])[0];if(l){var u=Kr(l,0===(o=l[0])?12:20),c=qr(i,["mdia","hdlr"])[0];if(c){var f=Vr(c.subarray(8,12)),d={soun:zr,vide:Mr}[f],h=Zr(qr(i,["mdia","minf","stbl","stsd"])[0]);d?(t[s]={timescale:u,type:d,stsd:h},t[d]=dr({timescale:u,id:s},h)):t[s]={timescale:u,type:f,stsd:h}}}}}return qr(e,["moov","mvex","trex"]).forEach((function(e){var r=Kr(e,4),n=t[r];n&&(n.default={duration:Kr(e,12),flags:Kr(e,20)})})),t}function Zr(e){var t,r=e.subarray(8),n=r.subarray(86),i=Vr(r.subarray(4,8)),a=i,o="enca"===i||"encv"===i;if(o){var s=qr(r,[i])[0];qr(s.subarray("enca"===i?28:78),["sinf"]).forEach((function(e){var t=qr(e,["schm"])[0];if(t){var r=Vr(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var n=qr(e,["frma"])[0];n&&(a=Vr(n))}}}))}var l=a;switch(a){case"avc1":case"avc2":case"avc3":case"avc4":var u=qr(n,["avcC"])[0];u&&u.length>3&&(a+="."+tn(u[1])+tn(u[2])+tn(u[3]),t=$r("avc1"===l?"dva1":"dvav",n));break;case"mp4a":var c=qr(r,[i])[0],f=qr(c.subarray(28),["esds"])[0];if(f&&f.length>7){var d=4;if(3!==f[d++])break;d=en(f,d),d+=2;var h=f[d++];if(128&h&&(d+=2),64&h&&(d+=f[d++]),4!==f[d++])break;d=en(f,d);var p=f[d++];if(64!==p)break;if(a+="."+tn(p),d+=12,5!==f[d++])break;d=en(f,d);var g=f[d++],v=(248&g)>>3;31===v&&(v+=1+((7&g)<<3)+((224&f[d])>>5)),a+="."+v}break;case"hvc1":case"hev1":var y=qr(n,["hvcC"])[0];if(y&&y.length>12){var m=y[1],A=["","A","B","C"][m>>6],b=31&m,E=Kr(y,2),k=(32&m)>>5?"H":"L",T=y[12],S=y.subarray(6,12);a+="."+A+b,a+="."+function(e){for(var t=0,r=0;r<32;r++)t|=(e>>r&1)<<31-r;return t>>>0}(E).toString(16).toUpperCase(),a+="."+k+T;for(var w="",_=S.length;_--;){var L=S[_];(L||w)&&(w="."+L.toString(16).toUpperCase()+w)}a+=w}t=$r("hev1"==l?"dvhe":"dvh1",n);break;case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":a=$r(a,n)||a;break;case"vp09":var P=qr(n,["vpcC"])[0];if(P&&P.length>6){var I=P[4],R=P[5],C=P[6]>>4&15;a+="."+rn(I)+"."+rn(R)+"."+rn(C)}break;case"av01":var D=qr(n,["av1C"])[0];if(D&&D.length>2){var O=D[1]>>>5,z=31&D[1],M=D[2]>>>7?"H":"M",x=(64&D[2])>>6,B=(32&D[2])>>5,F=2===O&&x?B?12:10:x?10:8,N=(16&D[2])>>4,U=(8&D[2])>>3,j=(4&D[2])>>2,G=3&D[2];a+="."+O+"."+rn(z)+M+"."+rn(F)+"."+N+"."+U+j+G+"."+rn(1)+"."+rn(1)+"."+rn(1)+".0",t=$r("dav1",n)}}return{codec:a,encrypted:o,supplemental:t}}function $r(e,t){var r=qr(t,["dvvC"]),n=r.length?r[0]:qr(t,["dvcC"])[0];if(n){var i=n[2]>>1&127,a=n[2]<<5&32|n[3]>>3&31;return e+"."+rn(i)+"."+rn(a)}}function en(e,t){for(var r=t+5;128&e[t++]&&t<r;);return t}function tn(e){return("0"+e.toString(16).toUpperCase()).slice(-2)}function rn(e){return(e<10?"0":"")+e}function nn(e,t){qr(e,["moov","trak"]).forEach((function(e){var r=qr(e,["mdia","minf","stbl","stsd"])[0];if(r){var n=r.subarray(8),i=qr(n,["enca"]),a=i.length>0;a||(i=qr(n,["encv"])),i.forEach((function(e){qr(a?e.subarray(28):e.subarray(78),["sinf"]).forEach((function(e){var r=an(e);r&&t(r,a)}))}))}}))}function an(e){var t=qr(e,["schm"])[0];if(t){var r=Vr(t.subarray(4,8));if("cbcs"===r||"cenc"===r){var n=qr(e,["schi","tenc"])[0];if(n)return n}}}function on(e,t){var r=new Uint8Array(e.length+t.length);return r.set(e),r.set(t,e.length),r}function sn(e,t){var r=[],n=t.samples,i=t.timescale,a=t.id,o=!1;return qr(n,["moof"]).map((function(s){var l=s.byteOffset-8;qr(s,["traf"]).map((function(s){var u=qr(s,["tfdt"]).map((function(e){var t=e[0],r=Kr(e,4);return 1===t&&(r*=Math.pow(2,32),r+=Kr(e,8)),r/i}))[0];return void 0!==u&&(e=u),qr(s,["tfhd"]).map((function(u){var c=Kr(u,4),f=16777215&Kr(u,0),d=0,h=0!=(16&f),p=0,g=0!=(32&f),v=8;c===a&&(0!=(1&f)&&(v+=8),0!=(2&f)&&(v+=4),0!=(8&f)&&(d=Kr(u,v),v+=4),h&&(p=Kr(u,v),v+=4),g&&(v+=4),"video"===t.type&&(o=ln(t.codec)),qr(s,["trun"]).map((function(a){var s=a[0],u=16777215&Kr(a,0),c=0!=(1&u),f=0,h=0!=(4&u),g=0!=(256&u),v=0,y=0!=(512&u),m=0,A=0!=(1024&u),b=0!=(2048&u),E=0,k=Kr(a,4),T=8;c&&(f=Kr(a,T),T+=4),h&&(T+=4);for(var S=f+l,w=0;w<k;w++){if(g?(v=Kr(a,T),T+=4):v=d,y?(m=Kr(a,T),T+=4):m=p,A&&(T+=4),b&&(E=0===s?Kr(a,T):Wr(a,T),T+=4),t.type===Mr)for(var _=0;_<m;){var L=Kr(n,S);un(o,n[S+=4])&&cn(n.subarray(S,S+L),o?2:1,e+E/i,r),S+=L,_+=L+4}e+=v/i}})))}))}))})),r}function ln(e){if(!e)return!1;var t=e.substring(0,4);return"hvc1"===t||"hev1"===t||"dvh1"===t||"dvhe"===t}function un(e,t){if(e){var r=t>>1&63;return 39===r||40===r}return 6===(31&t)}function cn(e,t,r,n){var i=fn(e),a=0;a+=t;for(var o=0,s=0,l=0;a<i.length;){o=0;do{if(a>=i.length)break;o+=l=i[a++]}while(255===l);s=0;do{if(a>=i.length)break;s+=l=i[a++]}while(255===l);var u=i.length-a,c=a;if(s<u)a+=s;else if(s>u){Ar.error("Malformed SEI payload. ".concat(s," is too small, only ").concat(u," bytes left to parse."));break}if(4===o){if(181===i[c++]){var f=Hr(i,c);if(c+=2,49===f){var d=Kr(i,c);if(c+=4,1195456820===d){var h=i[c++];if(3===h){var p=i[c++],g=64&p,v=g?2+3*(31&p):0,y=new Uint8Array(v);if(g){y[0]=p;for(var m=1;m<v;m++)y[m]=i[c++]}n.push({type:h,payloadType:o,pts:r,bytes:y})}}}}}else if(5===o&&s>16){for(var A=[],b=0;b<16;b++){var E=i[c++].toString(16);A.push(1==E.length?"0"+E:E),3!==b&&5!==b&&7!==b&&9!==b||A.push("-")}for(var k=s-16,T=new Uint8Array(k),S=0;S<k;S++)T[S]=i[c++];n.push({payloadType:o,pts:r,uuid:A.join(""),userData:kr(T),userDataBytes:T})}}}function fn(e){for(var t=e.byteLength,r=[],n=1;n<t-2;)0===e[n]&&0===e[n+1]&&3===e[n+2]?(r.push(n+2),n+=2):n++;if(0===r.length)return e;var i=t-r.length,a=new Uint8Array(i),o=0;for(n=0;n<i;o++,n++)o===r[0]&&(o++,r.shift()),a[n]=e[o];return a}function dn(e){var t=e.getUint32(0),r=e.byteOffset,n=e.byteLength;if(n<t)return{offset:r,size:n};if(1886614376!==e.getUint32(4))return{offset:r,size:t};var i=e.getUint32(8)>>>24;if(0!==i&&1!==i)return{offset:r,size:t};var a=e.buffer,o=Tr(new Uint8Array(a,r+12,16)),s=null,l=0;if(0===i)l=28;else{var u=e.getUint32(28);if(!u||n<32+16*u)return{offset:r,size:t};s=[];for(var c=0;c<u;c++)s.push(new Uint8Array(a,r+32+16*c,16));l=32+16*u}if(!l)return{offset:r,size:t};var f=e.getUint32(l);return t-32<f?{offset:r,size:t}:{version:i,systemId:o,kids:s,data:new Uint8Array(a,r+l+4,f),offset:r,size:t}}var hn=function(){return/\(Windows.+Firefox\//i.test(navigator.userAgent)},pn={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function gn(e,t){var r=pn[t];return!!r&&!!r[e.slice(0,4)]}function vn(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!e.split(",").some((function(e){return!yn(e,t,r)}))}function yn(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=br(n);return null!=(r=null==i?void 0:i.isTypeSupported(mn(e,t)))&&r}function mn(e,t){return"".concat(t,"/mp4;codecs=").concat(e)}function An(e){if(e){var t=e.substring(0,4);return pn.video[t]}return 2}function bn(e){var t=hn();return e.split(",").reduce((function(e,r){var n=t&&ln(r)?9:pn.video[r];return n?(2*n+e)/(e?3:2):(pn.audio[r]+e)/(e?2:1)}),0)}var En={},kn=/flac|opus|mp4a\.40\.34/i;function Tn(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e.replace(kn,(function(e){return function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(En[e])return En[e];for(var r={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[e],n=0;n<r.length;n++){var i;if(yn(r[n],"audio",t))return En[e]=r[n],r[n];if("mp3"===r[n]&&null!=(i=br(t))&&i.isTypeSupported("audio/mpeg"))return""}return e}(e.toLowerCase(),t)}))}function Sn(e,t){if(e&&(e.length>4||-1!==["ac-3","ec-3","alac","fLaC","Opus"].indexOf(e))&&(wn(e,"audio")||wn(e,"video")))return e;if(t){var r=t.split(",");if(r.length>1){if(e)for(var n=r.length;n--;)if(r[n].substring(0,4)===e.substring(0,4))return r[n];return r[0]}}return t||e}function wn(e,t){return gn(e,t)&&yn(e,t)}function _n(e){if(e.startsWith("av01.")){for(var t=e.split("."),r=["0","111","01","01","01","0"],n=t.length;n>4&&n<10;n++)t[n]=r[n-4];return t.join(".")}return e}function Ln(e){var t=br(e)||{isTypeSupported:function(){return!1}};return{mpeg:t.isTypeSupported("audio/mpeg"),mp3:t.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:t.isTypeSupported('audio/mp4; codecs="ac-3"')}}function Pn(e){return e.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}var In={supported:!1,smooth:!1,powerEfficient:!1},Rn={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Cn(e,t){return{supported:!1,configurations:t,decodingInfoResults:[In],error:e}}function Dn(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.videoCodec;if(!i&&!e.audioCodec||!r)return Promise.resolve(Rn);for(var a=[],o=function(e){var t,r=null==(t=e.videoCodec)?void 0:t.split(","),n=zn(e),i=e.width||640,a=e.height||480,o=e.frameRate||30,s=e.videoRange.toLowerCase();return r?r.map((function(e){var t={contentType:mn(_n(e),"video"),width:i,height:a,bitrate:n,framerate:o};return"sdr"!==s&&(t.transferFunction=s),t})):[]}(e),s=o.length,l=function(e,t,r){var n,i=null==(n=e.audioCodec)?void 0:n.split(","),a=zn(e);return i&&e.audioGroups?e.audioGroups.reduce((function(e,n){var o,s=n?null==(o=t.groups[n])?void 0:o.tracks:null;return s?s.reduce((function(e,t){if(t.groupId===n){var o=parseFloat(t.channels||"");i.forEach((function(t){var n={contentType:mn(t,"audio"),bitrate:r?On(t,a):a};o&&(n.channels=""+o),e.push(n)}))}return e}),e):e}),[]):[]}(e,t,s>0),u=l.length,c=s||1*u||1;c--;){var f={type:"media-source"};if(s&&(f.video=o[c%s]),u){f.audio=l[c%u];var d=f.audio.bitrate;f.video&&d&&(f.video.bitrate-=d)}a.push(f)}if(i){var h=navigator.userAgent;if(i.split(",").some((function(e){return ln(e)}))&&hn())return Promise.resolve(Cn(new Error("Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (".concat(h,")")),a))}return Promise.all(a.map((function(e){var t=function(e){var t="",r=e.audio,n=e.video;if(n){var i=Pn(n.contentType);t+="".concat(i,"_r").concat(n.height,"x").concat(n.width,"f").concat(Math.ceil(n.framerate)).concat(n.transferFunction||"sd","_").concat(Math.ceil(n.bitrate/1e5))}if(r){var a=Pn(r.contentType);t+="".concat(n?"_":"").concat(a,"_c").concat(r.channels)}return t}(e);return n[t]||(n[t]=r.decodingInfo(e))}))).then((function(e){return{supported:!e.some((function(e){return!e.supported})),configurations:a,decodingInfoResults:e}})).catch((function(e){return{supported:!1,configurations:a,decodingInfoResults:[],error:e}}))}function On(e,t){if(t<=1)return 1;var r=128e3;return"ec-3"===e?r=768e3:"ac-3"===e&&(r=64e4),Math.min(t/2,r)}function zn(e){return 1e3*Math.ceil(Math.max(.9*e.bitrate,e.averageBitrate)/1e3)||1}var Mn=["NONE","TYPE-0","TYPE-1",null],xn=["SDR","PQ","HLG"],Bn="",Fn="YES",Nn="v2";function Un(e){var t=e.canSkipUntil,r=e.canSkipDateRanges,n=e.age;return t&&n<t/2?r?Nn:Fn:Bn}var jn=function(){function e(t,r,n){h(this,e),this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=t,this.part=r,this.skip=n}return p(e,[{key:"addDirectives",value:function(e){var t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}]),e}(),Gn=function(){function e(t){if(h(this,e),this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[t.url],this._attrs=[t.attrs],this.bitrate=t.bitrate,t.details&&(this.details=t.details),this.id=t.id||0,this.name=t.name,this.width=t.width||0,this.height=t.height||0,this.frameRate=t.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=t.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=t.audioCodec,this.videoCodec=t.videoCodec,this.codecSet=[t.videoCodec,t.audioCodec].filter((function(e){return!!e})).map((function(e){return e.substring(0,4)})).join(","),"supplemental"in t){var r;this.supplemental=t.supplemental;var n=null==(r=t.supplemental)?void 0:r.videoCodec;n&&n!==t.videoCodec&&(this.codecSet+=",".concat(n.substring(0,4)))}this.addGroupId("audio",t.attrs.AUDIO),this.addGroupId("text",t.attrs.SUBTITLES)}return p(e,[{key:"hasAudioGroup",value:function(e){return Yn(this._audioGroups,e)}},{key:"hasSubtitleGroup",value:function(e){return Yn(this._subtitleGroups,e)}},{key:"addGroupId",value:function(e,t){if(t)if("audio"===e){var r=this._audioGroups;r||(r=this._audioGroups=[]),-1===r.indexOf(t)&&r.push(t)}else if("text"===e){var n=this._subtitleGroups;n||(n=this._subtitleGroups=[]),-1===n.indexOf(t)&&n.push(t)}}},{key:"addFallback",value:function(){}},{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"averageBitrate",get:function(){return this._avgBitrate||this.realBitrate||this.bitrate}},{key:"attrs",get:function(){return this._attrs[0]}},{key:"codecs",get:function(){return this.attrs.CODECS||""}},{key:"pathwayId",get:function(){return this.attrs["PATHWAY-ID"]||"."}},{key:"videoRange",get:function(){return this.attrs["VIDEO-RANGE"]||"SDR"}},{key:"score",get:function(){return this.attrs.optionalFloat("SCORE",0)}},{key:"uri",get:function(){return this.url[0]||""}},{key:"audioGroups",get:function(){return this._audioGroups}},{key:"subtitleGroups",get:function(){return this._subtitleGroups}},{key:"urlId",get:function(){return 0},set:function(e){}},{key:"audioGroupIds",get:function(){return this.audioGroups?[this.audioGroupId]:void 0}},{key:"textGroupIds",get:function(){return this.subtitleGroups?[this.textGroupId]:void 0}},{key:"audioGroupId",get:function(){var e;return null==(e=this.audioGroups)?void 0:e[0]}},{key:"textGroupId",get:function(){var e;return null==(e=this.subtitleGroups)?void 0:e[0]}}]),e}();function Yn(e,t){return!(!t||!e)&&-1!==e.indexOf(t)}var Vn=function(e,t){return JSON.stringify(e,function(e){var t=new WeakSet;return function(r,n){if(e&&(n=e(r,n)),"object"==typeof n&&null!==n){if(t.has(n))return;t.add(n)}return n}}(t))};function Hn(e,t){Ar.log('[abr] start candidates with "'.concat(e,'" ignored because ').concat(t))}function Kn(e){return e.reduce((function(e,t){var r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);var n=t.channels||"2";return r.channels[n]=(r.channels[n]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e}),{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function Qn(e){return e?{lang:e.lang,assocLang:e.assocLang,characteristics:e.characteristics,channels:e.channels,audioCodec:e.audioCodec}:e}function Wn(e,t,r){if("attrs"in e){var n=t.indexOf(e);if(-1!==n)return n}for(var i=0;i<t.length;i++)if(qn(e,t[i],r))return i;return-1}function qn(e,t,r){var n=e.groupId,i=e.name,a=e.lang,o=e.assocLang,s=e.default,l=e.forced;return(void 0===n||t.groupId===n)&&(void 0===i||t.name===i)&&(void 0===a||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"--";return e.length===t.length?e===t:e.startsWith(t)||t.startsWith(e)}(a,t.lang))&&(void 0===a||t.assocLang===o)&&(void 0===s||t.default===s)&&(void 0===l||t.forced===l)&&(!("characteristics"in e)||function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=e.split(","),n=t.split(",");return r.length===n.length&&!r.some((function(e){return-1===n.indexOf(e)}))}(e.characteristics||"",t.characteristics))&&(void 0===r||r(e,t))}function Xn(e,t){var r=e.audioCodec,n=e.channels;return!(void 0!==r&&(t.audioCodec||"").substring(0,4)!==r.substring(0,4)||void 0!==n&&n!==(t.channels||"2"))}function Jn(e,t,r){for(var n=t;n>-1;n--)if(r(e[n]))return n;for(var i=t+1;i<e.length;i++)if(r(e[i]))return i;return-1}function Zn(e,t){var r;return!!e&&e!==(null==(r=t.loadLevelObj)?void 0:r.uri)}var $n=function(e,t){for(var r=0,n=e.length-1,i=null,a=null;r<=n;){var o=t(a=e[i=(r+n)/2|0]);if(o>0)r=i+1;else{if(!(o<0))return a;n=i-1}}return null};function ei(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.005,a=null;if(e){a=t[1+e.sn-t[0].sn]||null;var o=e.endDTS-r;o>0&&o<15e-7&&(r+=15e-7),a&&e.level!==a.level&&a.end<=e.end&&(a=t[2+e.sn-t[0].sn]||null)}else 0===r&&0===t[0].start&&(a=t[0]);if(a&&((!e||e.level===a.level)&&0===ti(r,n,a)||function(e,t,r){if(t&&0===t.start&&t.level<e.level&&(t.endPTS||0)>0){var n=t.tagList.reduce((function(e,t){return"INF"===t[0]&&(e+=parseFloat(t[1])),e}),r);return e.start<=n}return!1}(a,e,Math.min(i,n))))return a;var s=$n(t,ti.bind(null,r,n));return!s||s===e&&a?a:s}function ti(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(r.start<=e&&r.start+r.duration>e)return 0;var n=Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return r.start+r.duration-n<=e?1:r.start-n>e&&r.start?-1:0}function ri(e,t,r){var n=1e3*Math.min(t,r.duration+(r.deltaPTS?r.deltaPTS:0));return(r.endProgramDateTime||0)-n>e}function ni(e,t,r){if(e&&e.startCC<=t&&e.endCC>=t){var n,i=e.fragments,a=e.fragmentHint;return a&&(i=i.concat(a)),$n(i,(function(e){return e.cc<t?1:e.cc>t?-1:(n=e,e.end<=r?1:e.start>r?-1:0)})),n||null}return null}function ii(e){switch(e.details){case Zt.FRAG_LOAD_TIMEOUT:case Zt.KEY_LOAD_TIMEOUT:case Zt.LEVEL_LOAD_TIMEOUT:case Zt.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function ai(e){return e.details.startsWith("key")}function oi(e){return ai(e)&&!!e.frag&&!e.frag.decryptdata}function si(e,t){var r=ii(t);return e.default["".concat(r?"timeout":"error","Retry")]}function li(e,t){var r="linear"===e.backoff?1:Math.pow(2,t);return Math.min(r*e.retryDelayMs,e.maxRetryDelayMs)}function ui(e){return dr(dr({},e),{errorRetry:null,timeoutRetry:null})}function ci(e,t,r,n){if(!e)return!1;var i=null==n?void 0:n.code,a=t<e.maxNumRetry&&(function(e){return fi(e)||!!e&&(e<400||e>499)}(i)||!!r);return e.shouldRetry?e.shouldRetry(e,t,r,n,a):a}function fi(e){return 0===e&&!1===navigator.onLine}var di=0,hi=2,pi=3,gi=5,vi=0,yi=1,mi=2,Ai=4;function bi(e){var t={action:di,flags:vi};return e&&(t.resolved=!0),t}var Ei="NOT_LOADED",ki="APPENDING",Ti="PARTIAL",Si="OK",wi=function(){function e(t){h(this,e),this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=t,this._registerListeners()}return p(e,[{key:"_registerListeners",value:function(){var e=this.hls;e&&(e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.BUFFER_APPENDED,this.onBufferAppended,this),e.on($t.FRAG_BUFFERED,this.onFragBuffered,this),e.on($t.FRAG_LOADED,this.onFragLoaded,this))}},{key:"_unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.BUFFER_APPENDED,this.onBufferAppended,this),e.off($t.FRAG_BUFFERED,this.onFragBuffered,this),e.off($t.FRAG_LOADED,this.onFragLoaded,this))}},{key:"destroy",value:function(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}},{key:"getAppendedFrag",value:function(e,t){var r=this.activePartLists[t];if(r)for(var n=r.length;n--;){var i=r[n];if(!i)break;if(i.start<=e&&e<=i.end&&i.loaded)return i}return this.getBufferedFrag(e,t)}},{key:"getBufferedFrag",value:function(e,t){return this.getFragAtPos(e,t,!0)}},{key:"getFragAtPos",value:function(e,t,r){for(var n=this.fragments,i=Object.keys(n),a=i.length;a--;){var o=n[i[a]];if((null==o?void 0:o.body.type)===t&&(!r||o.buffered)){var s=o.body;if(s.start<=e&&e<=s.end)return s}}return null}},{key:"detectEvictedFragments",value:function(e,t,r,n,i){var a=this;this.timeRanges&&(this.timeRanges[e]=t);var o=(null==n?void 0:n.fragment.sn)||-1;Object.keys(this.fragments).forEach((function(n){var s=a.fragments[n];if(s&&!(o>=s.body.sn))if(s.buffered||s.loaded&&!i){var l=s.range[e];l&&(0!==l.time.length?l.time.some((function(e){var r=!a.isTimeBuffered(e.startPTS,e.endPTS,t);return r&&a.removeFragment(s.body),r})):a.removeFragment(s.body))}else s.body.type===r&&a.removeFragment(s.body)}))}},{key:"detectPartialFragments",value:function(e){var t=this,r=this.timeRanges;if(r&&"initSegment"!==e.frag.sn){var n=e.frag,i=Li(n),a=this.fragments[i];if(!(!a||a.buffered&&n.gap)){var o=!n.relurl;Object.keys(r).forEach((function(i){var s=n.elementaryStreams[i];if(s){var l=r[i],u=o||!0===s.partial;a.range[i]=t.getBufferedTimes(n,e.part,u,l)}})),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=n.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),_i(a)||this.removeParts(n.sn-1,n.type)):this.removeFragment(a.body)}}}},{key:"removeParts",value:function(e,t){var r=this.activePartLists[t];r&&(this.activePartLists[t]=Pi(r,(function(t){return t.fragment.sn>=e})))}},{key:"fragBuffered",value:function(e,t){var r=Li(e),n=this.fragments[r];!n&&t&&(n=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),n&&(n.loaded=null,n.buffered=!0)}},{key:"getBufferedTimes",value:function(e,t,r,n){for(var i={time:[],partial:r},a=e.start,o=e.end,s=e.minEndPTS||o,l=e.maxStartPTS||a,u=0;u<n.length;u++){var c=n.start(u)-this.bufferPadding,f=n.end(u)+this.bufferPadding;if(l>=c&&s<=f){i.time.push({startPTS:Math.max(a,n.start(u)),endPTS:Math.min(o,n.end(u))});break}if(a<f&&o>c){var d=Math.max(a,n.start(u)),h=Math.min(o,n.end(u));h>d&&(i.partial=!0,i.time.push({startPTS:d,endPTS:h}))}else if(o<=c)break}return i}},{key:"getPartialFragment",value:function(e){var t,r,n,i=null,a=0,o=this.bufferPadding,s=this.fragments;return Object.keys(s).forEach((function(l){var u=s[l];u&&_i(u)&&(r=u.body.start-o,n=u.body.end+o,e>=r&&e<=n&&(t=Math.min(e-r,n-e),a<=t&&(i=u.body,a=t)))})),i}},{key:"isEndListAppended",value:function(e){var t=this.endListFragments[e];return void 0!==t&&(t.buffered||_i(t))}},{key:"getState",value:function(e){var t=Li(e),r=this.fragments[t];return r?r.buffered?_i(r)?Ti:Si:ki:Ei}},{key:"isTimeBuffered",value:function(e,t,r){for(var n,i,a=0;a<r.length;a++){if(n=r.start(a)-this.bufferPadding,i=r.end(a)+this.bufferPadding,e>=n&&t<=i)return!0;if(t<=n)return!1}return!1}},{key:"onManifestLoading",value:function(){this.removeAllFragments()}},{key:"onFragLoaded",value:function(e,t){if("initSegment"!==t.frag.sn&&!t.frag.bitrateTest){var r=t.frag,n=t.part?null:t,i=Li(r);this.fragments[i]={body:r,appendedPTS:null,loaded:n,buffered:!1,range:Object.create(null)}}}},{key:"onBufferAppended",value:function(e,t){var r=t.frag,n=t.part,i=t.timeRanges,a=t.type;if("initSegment"!==r.sn){var o=r.type;if(n){var s=this.activePartLists[o];s||(this.activePartLists[o]=s=[]),s.push(n)}this.timeRanges=i;var l=i[a];this.detectEvictedFragments(a,l,o,n)}}},{key:"onFragBuffered",value:function(e,t){this.detectPartialFragments(t)}},{key:"hasFragment",value:function(e){var t=Li(e);return!!this.fragments[t]}},{key:"hasFragments",value:function(e){var t=this.fragments,r=Object.keys(t);if(!e)return r.length>0;for(var n=r.length;n--;){var i=t[r[n]];if((null==i?void 0:i.body.type)===e)return!0}return!1}},{key:"hasParts",value:function(e){var t;return!(null==(t=this.activePartLists[e])||!t.length)}},{key:"removeFragmentsInRange",value:function(e,t,r,n,i){var a=this;n&&!this.hasGaps||Object.keys(this.fragments).forEach((function(o){var s=a.fragments[o];if(s){var l=s.body;l.type!==r||n&&!l.gap||l.start<t&&l.end>e&&(s.buffered||i)&&a.removeFragment(l)}}))}},{key:"removeFragment",value:function(e){var t=Li(e);e.clearElementaryStreamInfo();var r=this.activePartLists[e.type];if(r){var n=e.sn;this.activePartLists[e.type]=Pi(r,(function(e){return e.fragment.sn!==n}))}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}},{key:"removeAllFragments",value:function(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;var t=null==(e=this.hls)||null==(e=e.latestLevelDetails)?void 0:e.partList;t&&t.forEach((function(e){return e.clearElementaryStreamInfo()}))}}]),e}();function _i(e){var t,r,n;return e.buffered&&!!(e.body.gap||null!=(t=e.range.video)&&t.partial||null!=(r=e.range.audio)&&r.partial||null!=(n=e.range.audiovideo)&&n.partial)}function Li(e){return"".concat(e.type,"_").concat(e.level,"_").concat(e.sn)}function Pi(e,t){return e.filter((function(e){var r=t(e);return r||e.clearElementaryStreamInfo(),r}))}var Ii=0,Ri=1,Ci=function(){function e(t,r,n){h(this,e),this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=t,this.aesIV=r,this.aesMode=n}return p(e,[{key:"decrypt",value:function(e,t){switch(this.aesMode){case Ii:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case Ri:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw new Error("[AESCrypto] invalid aes mode ".concat(this.aesMode))}}}]),e}(),Di=function(){function e(){h(this,e),this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}return p(e,[{key:"uint8ArrayToUint32Array_",value:function(e){for(var t=new DataView(e),r=new Uint32Array(4),n=0;n<4;n++)r[n]=t.getUint32(4*n);return r}},{key:"initTable",value:function(){var e=this.sBox,t=this.invSBox,r=this.subMix,n=r[0],i=r[1],a=r[2],o=r[3],s=this.invSubMix,l=s[0],u=s[1],c=s[2],f=s[3],d=new Uint32Array(256),h=0,p=0,g=0;for(g=0;g<256;g++)d[g]=g<128?g<<1:g<<1^283;for(g=0;g<256;g++){var v=p^p<<1^p<<2^p<<3^p<<4;v=v>>>8^255&v^99,e[h]=v,t[v]=h;var y=d[h],m=d[y],A=d[m],b=257*d[v]^16843008*v;n[h]=b<<24|b>>>8,i[h]=b<<16|b>>>16,a[h]=b<<8|b>>>24,o[h]=b,b=16843009*A^65537*m^257*y^16843008*h,l[v]=b<<24|b>>>8,u[v]=b<<16|b>>>16,c[v]=b<<8|b>>>24,f[v]=b,h?(h=y^d[d[d[A^y]]],p^=d[d[p]]):h=p=1}}},{key:"expandKey",value:function(e){for(var t=this.uint8ArrayToUint32Array_(e),r=!0,n=0;n<t.length&&r;)r=t[n]===this.key[n],n++;if(!r){this.key=t;var i=this.keySize=t.length;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size="+i);var a,o,s,l,u=this.ksRows=4*(i+6+1),c=this.keySchedule=new Uint32Array(u),f=this.invKeySchedule=new Uint32Array(u),d=this.sBox,h=this.rcon,p=this.invSubMix,g=p[0],v=p[1],y=p[2],m=p[3];for(a=0;a<u;a++)a<i?s=c[a]=t[a]:(l=s,a%i==0?(l=d[(l=l<<8|l>>>24)>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l],l^=h[a/i|0]<<24):i>6&&a%i==4&&(l=d[l>>>24]<<24|d[l>>>16&255]<<16|d[l>>>8&255]<<8|d[255&l]),c[a]=s=(c[a-i]^l)>>>0);for(o=0;o<u;o++)a=u-o,l=3&o?c[a]:c[a-4],f[o]=o<4||a<=4?l:g[d[l>>>24]]^v[d[l>>>16&255]]^y[d[l>>>8&255]]^m[d[255&l]],f[o]=f[o]>>>0}}},{key:"networkToHostOrderSwap",value:function(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}},{key:"decrypt",value:function(e,t,r){for(var n,i,a,o,s,l,u,c,f,d,h,p,g,v,y=this.keySize+6,m=this.invKeySchedule,A=this.invSBox,b=this.invSubMix,E=b[0],k=b[1],T=b[2],S=b[3],w=this.uint8ArrayToUint32Array_(r),_=w[0],L=w[1],P=w[2],I=w[3],R=new Int32Array(e),C=new Int32Array(R.length),D=this.networkToHostOrderSwap;t<R.length;){for(f=D(R[t]),d=D(R[t+1]),h=D(R[t+2]),p=D(R[t+3]),s=f^m[0],l=p^m[1],u=h^m[2],c=d^m[3],g=4,v=1;v<y;v++)n=E[s>>>24]^k[l>>16&255]^T[u>>8&255]^S[255&c]^m[g],i=E[l>>>24]^k[u>>16&255]^T[c>>8&255]^S[255&s]^m[g+1],a=E[u>>>24]^k[c>>16&255]^T[s>>8&255]^S[255&l]^m[g+2],o=E[c>>>24]^k[s>>16&255]^T[l>>8&255]^S[255&u]^m[g+3],s=n,l=i,u=a,c=o,g+=4;n=A[s>>>24]<<24^A[l>>16&255]<<16^A[u>>8&255]<<8^A[255&c]^m[g],i=A[l>>>24]<<24^A[u>>16&255]<<16^A[c>>8&255]<<8^A[255&s]^m[g+1],a=A[u>>>24]<<24^A[c>>16&255]<<16^A[s>>8&255]<<8^A[255&l]^m[g+2],o=A[c>>>24]<<24^A[s>>16&255]<<16^A[l>>8&255]<<8^A[255&u]^m[g+3],C[t]=D(n^_),C[t+1]=D(o^L),C[t+2]=D(a^P),C[t+3]=D(i^I),_=f,L=d,P=h,I=p,t+=4}return C.buffer}}]),e}(),Oi=function(){function e(t,r,n){h(this,e),this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=t,this.key=r,this.aesMode=n}return p(e,[{key:"expandKey",value:function(){var e=function(e){switch(e){case Ii:return"AES-CBC";case Ri:return"AES-CTR";default:throw new Error("[FastAESKey] invalid aes mode ".concat(e))}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}]),e}(),zi=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.removePKCS7Padding,i=void 0===n||n;if(h(this,e),this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=t.enableSoftwareAES,this.removePKCS7Padding=i,i)try{var a=self.crypto;a&&(this.subtle=a.subtle||a.webkitSubtle)}catch(t){}this.useSoftware=!this.subtle}return p(e,[{key:"destroy",value:function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}},{key:"isSync",value:function(){return this.useSoftware}},{key:"flush",value:function(){var e=this.currentResult,t=this.remainderData;if(!e||t)return this.reset(),null;var r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(e){var t=e.byteLength,r=t&&new DataView(e.buffer).getUint8(t-1);return r?e.slice(0,t-r):e}(r):r}},{key:"reset",value:function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}},{key:"decrypt",value:function(e,t,r,n){var i=this;return this.useSoftware?new Promise((function(a,o){var s=ArrayBuffer.isView(e)?e:new Uint8Array(e);i.softwareDecrypt(s,t,r,n);var l=i.flush();l?a(l.buffer):o(new Error("[softwareDecrypt] Failed to decrypt data"))})):this.webCryptoDecrypt(new Uint8Array(e),t,r,n)}},{key:"softwareDecrypt",value:function(e,t,r,n){var i=this.currentIV,a=this.currentResult,o=this.remainderData;if(n!==Ii||16!==t.byteLength)return Ar.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),o&&(e=on(o,e),this.remainderData=null);var s=this.getValidChunk(e);if(!s.length)return null;i&&(r=i);var l=this.softwareDecrypter;l||(l=this.softwareDecrypter=new Di),l.expandKey(t);var u=a;return this.currentResult=l.decrypt(s.buffer,0,r),this.currentIV=s.slice(-16).buffer,u||null}},{key:"webCryptoDecrypt",value:function(e,t,r,n){var i=this;if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,n));this.key=t,this.fastAesKey=new Oi(this.subtle,t,n)}return this.fastAesKey.expandKey().then((function(t){return i.subtle?(i.logOnce("WebCrypto AES decrypt"),new Ci(i.subtle,new Uint8Array(r),n).decrypt(e.buffer,t)):Promise.reject(new Error("web crypto not initialized"))})).catch((function(a){return Ar.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, ".concat(a.name,": ").concat(a.message)),i.onWebCryptoError(e,t,r,n)}))}},{key:"onWebCryptoError",value:function(e,t,r,n){var i=this.enableSoftwareAES;if(i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,n);var a=this.flush();if(a)return a.buffer}throw new Error("WebCrypto"+(i?" and softwareDecrypt":"")+": failed to decrypt data")}},{key:"getValidChunk",value:function(e){var t=e,r=e.length-e.length%16;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}},{key:"logOnce",value:function(e){this.logEnabled&&(Ar.log("[decrypter]: ".concat(e)),this.logEnabled=!1)}}]),e}(),Mi=Math.pow(2,17),xi=function(){function e(t){h(this,e),this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}return p(e,[{key:"destroy",value:function(){this.loader&&(this.loader.destroy(),this.loader=null)}},{key:"abort",value:function(){this.loader&&this.loader.abort()}},{key:"load",value:function(e,t){var r=this,n=e.url;if(!n)return Promise.reject(new Ni({type:Jt.NETWORK_ERROR,details:Zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:new Error("Fragment does not have a ".concat(n?"part list":"url")),networkDetails:null}));this.abort();var i=this.config,a=i.fLoader,o=i.loader;return new Promise((function(s,l){if(r.loader&&r.loader.destroy(),e.gap){if(e.tagList.some((function(e){return"GAP"===e[0]})))return void l(Fi(e));e.gap=!1}var u=r.loader=a?new a(i):new o(i),c=Bi(e);e.loader=u;var f=ui(i.fragLoadPolicy.default),d={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:Mi};e.stats=u.stats;var h={onSuccess:function(t,n,i,a){r.resetLoader(e,u);var o=t.data;i.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(o.slice(0,16)),o=o.slice(16)),s({frag:e,part:null,payload:o,networkDetails:a})},onError:function(t,i,a,o){r.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:dr({url:n,data:void 0},t),error:new Error("HTTP Error ".concat(t.code," ").concat(t.text)),networkDetails:a,stats:o}))},onAbort:function(t,n,i){r.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.INTERNAL_ABORTED,fatal:!1,frag:e,error:new Error("Aborted"),networkDetails:i,stats:t}))},onTimeout:function(t,n,i){r.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:new Error("Timeout after ".concat(d.timeout,"ms")),networkDetails:i,stats:t}))}};t&&(h.onProgress=function(r,n,i,a){return t({frag:e,part:null,payload:i,networkDetails:a})}),u.load(c,d,h)}))}},{key:"loadPart",value:function(e,t,r){var n=this;this.abort();var i=this.config,a=i.fLoader,o=i.loader;return new Promise((function(s,l){if(n.loader&&n.loader.destroy(),e.gap||t.gap)l(Fi(e,t));else{var u=n.loader=a?new a(i):new o(i),c=Bi(e,t);e.loader=u;var f=ui(i.fragLoadPolicy.default),d={loadPolicy:f,timeout:f.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:Mi};t.stats=u.stats,u.load(c,d,{onSuccess:function(i,a,o,l){n.resetLoader(e,u),n.updateStatsFromPart(e,t);var c={frag:e,part:t,payload:i.data,networkDetails:l};r(c),s(c)},onError:function(r,i,a,o){n.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:dr({url:c.url,data:void 0},r),error:new Error("HTTP Error ".concat(r.code," ").concat(r.text)),networkDetails:a,stats:o}))},onAbort:function(r,i,a){e.stats.aborted=t.stats.aborted,n.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:new Error("Aborted"),networkDetails:a,stats:r}))},onTimeout:function(r,i,a){n.resetLoader(e,u),l(new Ni({type:Jt.NETWORK_ERROR,details:Zt.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:new Error("Timeout after ".concat(d.timeout,"ms")),networkDetails:a,stats:r}))}})}}))}},{key:"updateStatsFromPart",value:function(e,t){var r=e.stats,n=t.stats,i=n.total;if(r.loaded+=n.loaded,i){var a=Math.round(e.duration/t.duration),o=Math.min(Math.round(r.loaded/i),a),s=(a-o)*Math.round(r.loaded/o);r.total=r.loaded+s}else r.total=Math.max(r.loaded,r.total);var l=r.loading,u=n.loading;l.start?l.first+=u.first-u.start:(l.start=u.start,l.first=u.first),l.end=u.end}},{key:"resetLoader",value:function(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}]),e}();function Bi(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=r||e,i={frag:e,part:r,responseType:"arraybuffer",url:n.url,headers:{},rangeStart:0,rangeEnd:0},a=n.byteRangeStartOffset,o=n.byteRangeEndOffset;if(Wt(a)&&Wt(o)){var s,l=a,u=o;if("initSegment"===e.sn&&("AES-128"===(t=null==(s=e.decryptdata)?void 0:s.method)||"AES-256"===t)){var c=o-a;c%16&&(u=o+(16-c%16)),0!==a&&(i.resetIV=!0,l=a-16)}i.rangeStart=l,i.rangeEnd=u}return i}function Fi(e,t){var r=new Error("GAP ".concat(e.gap?"tag":"attribute"," found")),n={type:Jt.MEDIA_ERROR,details:Zt.FRAG_GAP,fatal:!1,frag:e,error:r,networkDetails:null};return t&&(n.part=t),(t||e).stats.aborted=!0,new Ni(n)}var Ni=function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,e.error.message)).data=void 0,n.data=e,n}return r}(u(Error)),Ui=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,e,n))._boundTick=void 0,i._tickTimer=null,i._tickInterval=null,i._tickCallCount=0,i._boundTick=i.tick.bind(l(i)),i}return p(r,[{key:"destroy",value:function(){this.onHandlerDestroying(),this.onHandlerDestroyed()}},{key:"onHandlerDestroying",value:function(){this.clearNextTick(),this.clearInterval()}},{key:"onHandlerDestroyed",value:function(){}},{key:"hasInterval",value:function(){return!!this._tickInterval}},{key:"hasNextTick",value:function(){return!!this._tickTimer}},{key:"setInterval",value:function(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}},{key:"clearInterval",value:function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}},{key:"clearNextTick",value:function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}},{key:"tick",value:function(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}},{key:"tickImmediate",value:function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}},{key:"doTick",value:function(){}}]),r}(hr),ji=function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-1,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5];h(this,e),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=t,this.sn=r,this.id=n,this.size=i,this.part=a,this.partial=o},Gi={length:0,start:function(){return 0},end:function(){return 0}},Yi=function(){function e(){h(this,e)}return p(e,null,[{key:"isBuffered",value:function(t,r){if(t)for(var n=e.getBuffered(t),i=n.length;i--;)if(r>=n.start(i)&&r<=n.end(i))return!0;return!1}},{key:"bufferedRanges",value:function(t){if(t){var r=e.getBuffered(t);return e.timeRangesToArray(r)}return[]}},{key:"timeRangesToArray",value:function(e){for(var t=[],r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}},{key:"bufferInfo",value:function(t,r,n){if(t){var i=e.bufferedRanges(t);if(i.length)return e.bufferedInfo(i,r,n)}return{len:0,start:r,end:r,bufferedIndex:-1}}},{key:"bufferedInfo",value:function(e,t,r){t=Math.max(0,t),e.length>1&&e.sort((function(e,t){return e.start-t.start||t.end-e.end}));var n=-1,i=[];if(r)for(var a=0;a<e.length;a++){t>=e[a].start&&t<=e[a].end&&(n=a);var o=i.length;if(o){var s=i[o-1].end;e[a].start-s<r?e[a].end>s&&(i[o-1].end=e[a].end):i.push(e[a])}else i.push(e[a])}else i=e;for(var l,u=0,c=t,f=t,d=0;d<i.length;d++){var h=i[d].start,p=i[d].end;if(-1===n&&t>=h&&t<=p&&(n=d),t+r>=h&&t<p)c=h,u=(f=p)-t;else if(t+r<h){l=h;break}}return{len:u,start:c||0,end:f||0,nextStart:l,buffered:e,bufferedIndex:n}}},{key:"getBuffered",value:function(e){try{return e.buffered||Gi}catch(e){return Ar.log("failed to get media.buffered",e),Gi}}}]),e}(),Vi=/\{\$([a-zA-Z0-9-_]+)\}/g;function Hi(e){return Vi.test(e)}function Ki(e,t){if(null!==e.variableList||e.hasVariableRefs){var r=e.variableList;return t.replace(Vi,(function(t){var n=t.substring(2,t.length-1),i=null==r?void 0:r[n];return void 0===i?(e.playlistParsingError||(e.playlistParsingError=new Error('Missing preceding EXT-X-DEFINE tag for Variable Reference: "'.concat(n,'"'))),t):i}))}return t}function Qi(e,t,r){var n,i,a=e.variableList;if(a||(e.variableList=a={}),"QUERYPARAM"in t){n=t.QUERYPARAM;try{var o=new self.URL(r).searchParams;if(!o.has(n))throw new Error('"'.concat(n,'" does not match any query parameter in URI: "').concat(r,'"'));i=o.get(n)}catch(t){e.playlistParsingError||(e.playlistParsingError=new Error("EXT-X-DEFINE QUERYPARAM: ".concat(t.message)))}}else n=t.NAME,i=t.VALUE;n in a?e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE duplicate Variable Name declarations: "'.concat(n,'"'))):a[n]=i||""}function Wi(e,t,r){var n=t.IMPORT;if(r&&n in r){var i=e.variableList;i||(e.variableList=i={}),i[n]=r[n]}else e.playlistParsingError||(e.playlistParsingError=new Error('EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "'.concat(n,'"')))}var qi=/^(\d+)x(\d+)$/,Xi=/(.+?)=(".*?"|.*?)(?:,|$)/g,Ji=function(){function e(t,r){h(this,e),"string"==typeof t&&(t=e.parseAttrList(t,r)),cr(this,t)}return p(e,[{key:"decimalInteger",value:function(e){var t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"hexadecimalInteger",value:function(e){if(this[e]){var t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;for(var r=new Uint8Array(t.length/2),n=0;n<t.length/2;n++)r[n]=parseInt(t.slice(2*n,2*n+2),16);return r}return null}},{key:"hexadecimalIntegerAsNumber",value:function(e){var t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}},{key:"decimalFloatingPoint",value:function(e){return parseFloat(this[e])}},{key:"optionalFloat",value:function(e,t){var r=this[e];return r?parseFloat(r):t}},{key:"enumeratedString",value:function(e){return this[e]}},{key:"enumeratedStringList",value:function(e,t){var r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((function(e,t){return e[t.toLowerCase()]=!0,e}),t)}},{key:"bool",value:function(e){return"YES"===this[e]}},{key:"decimalResolution",value:function(e){var t=qi.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}},{key:"clientAttrs",get:function(){return Object.keys(this).filter((function(e){return"X-"===e.substring(0,2)}))}}],[{key:"parseAttrList",value:function(e,t){var r,n={};for(Xi.lastIndex=0;null!==(r=Xi.exec(e));){var i=r[1].trim(),a=r[2],o=0===a.indexOf('"')&&a.lastIndexOf('"')===a.length-1,s=!1;if(o)a=a.slice(1,-1);else switch(i){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":s=!0}if(t&&(o||s))a=Ki(t,a);else if(!s&&!o)switch(i){case"CLOSED-CAPTIONS":if("NONE"===a)break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":Ar.warn("".concat(e,": attribute ").concat(i," is missing quotes"))}n[i]=a}return n}}]),e}();function Zi(e){return"SCTE35-OUT"===e||"SCTE35-IN"===e||"SCTE35-CMD"===e}var $i=function(){function e(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(h(this,e),this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=(null==r?void 0:r.tagAnchor)||null,this.tagOrder=null!=(n=null==r?void 0:r.tagOrder)?n:i,r){var a=r.attr;for(var o in a)if(Object.prototype.hasOwnProperty.call(t,o)&&t[o]!==a[o]){Ar.warn('DATERANGE tag attribute: "'.concat(o,'" does not match for tags with ID: "').concat(t.ID,'"')),this._badValueForSameId=o;break}t=cr(new Ji({}),a,t)}if(this.attr=t,r?(this._startDate=r._startDate,this._cue=r._cue,this._endDate=r._endDate,this._dateAtEnd=r._dateAtEnd):this._startDate=new Date(t["START-DATE"]),"END-DATE"in this.attr){var s=(null==r?void 0:r.endDate)||new Date(this.attr["END-DATE"]);Wt(s.getTime())&&(this._endDate=s)}}return p(e,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"cue",get:function(){var e=this._cue;return void 0===e?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}},{key:"startTime",get:function(){var e=this.tagAnchor;return null===e||null===e.programDateTime?(Ar.warn('Expected tagAnchor Fragment with PDT set for DateRange "'.concat(this.id,'": ').concat(e)),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){var e=this._endDate||this._dateAtEnd;if(e)return e;var t=this.duration;return null!==t?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}},{key:"duration",get:function(){if("DURATION"in this.attr){var e=this.attr.decimalFloatingPoint("DURATION");if(Wt(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}},{key:"endOnNext",get:function(){return this.attr.bool("END-ON-NEXT")}},{key:"isInterstitial",get:function(){return"com.apple.hls.interstitial"===this.class}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Wt(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}]),e}(),ea=function(){function e(t){h(this,e),this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=t}return p(e,[{key:"reloaded",value:function(e){if(!e)return this.advanced=!0,void(this.updated=!0);var t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}},{key:"hasKey",value:function(e){return this.encryptedFragments.some((function(t){var r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)}))}},{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&Wt(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}},{key:"fragmentStart",get:function(){return this.fragments.length?this.fragments[0].start:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}},{key:"maxPartIndex",get:function(){var e=this.partList;if(e){var t=this.lastPartIndex;if(-1!==t){for(var r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}},{key:"expired",get:function(){if(this.live&&this.age&&this.misses<3){var e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}]),e}();function ta(e,t){return e.length===t.length&&!e.some((function(e,r){return e!==t[r]}))}function ra(e,t){return!e&&!t||!(!e||!t)&&ta(e,t)}function na(e){return"AES-128"===e||"AES-256"===e||"AES-256-CTR"===e}function ia(e){switch(e){case"AES-128":case"AES-256":return Ii;case"AES-256-CTR":return Ri;default:throw new Error("invalid full segment method ".concat(e))}}function aa(e){return Uint8Array.from(atob(e),(function(e){return e.charCodeAt(0)}))}function oa(e){return Uint8Array.from(unescape(encodeURIComponent(e)),(function(e){return e.charCodeAt(0)}))}function sa(e){var t=function(e,t,r){var n=e[t];e[t]=e[r],e[r]=n};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}function la(e){var t=e.split(":"),r=null;if("data"===t[0]&&2===t.length){var n=t[1].split(";"),i=n[n.length-1].split(",");if(2===i.length){var a="base64"===i[0],o=i[1];a?(n.splice(-1,1),r=aa(o)):r=function(e){var t=oa(e).subarray(0,16),r=new Uint8Array(16);return r.set(t,16-t.length),r}(o)}}return r}var ua="undefined"!=typeof self?self:void 0,ca={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},fa="org.w3.clearkey",da="com.apple.streamingkeydelivery",ha="com.microsoft.playready",pa="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed";function ga(e){switch(e){case da:return ca.FAIRPLAY;case ha:return ca.PLAYREADY;case pa:return ca.WIDEVINE;case fa:return ca.CLEARKEY}}function va(e){switch(e){case ca.FAIRPLAY:return da;case ca.PLAYREADY:return ha;case ca.WIDEVINE:return pa;case ca.CLEARKEY:return fa}}function ya(e){var t=e.drmSystems,r=e.widevineLicenseUrl,n=t?[ca.FAIRPLAY,ca.WIDEVINE,ca.PLAYREADY,ca.CLEARKEY].filter((function(e){return!!t[e]})):[];return!n[ca.WIDEVINE]&&r&&n.push(ca.WIDEVINE),n}var ma,Aa=null!=ua&&null!=(ma=ua.navigator)&&ma.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function ba(e){var t=new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),r=String.fromCharCode.apply(null,Array.from(t)),n=r.substring(r.indexOf("<"),r.length),i=(new DOMParser).parseFromString(n,"text/xml").getElementsByTagName("KID")[0];if(i){var a=i.childNodes[0]?i.childNodes[0].nodeValue:i.getAttribute("VALUE");if(a){var o=aa(a).subarray(0,16);return sa(o),o}}return null}var Ea={},ka=function(){function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[1],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5?arguments[5]:void 0;h(this,e),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=r,this.keyFormat=n,this.keyFormatVersions=i,this.iv=a,this.encrypted=!!t&&"NONE"!==t,this.isCommonEncryption=this.encrypted&&!na(t),null!=o&&o.startsWith("0x")&&(this.keyId=new Uint8Array(Sr(o)))}return p(e,null,[{key:"clearKeyUriToKeyIdMap",value:function(){Ea={}}},{key:"setKeyIdForUri",value:function(e,t){Ea[e]=t}}]),p(e,[{key:"matches",value:function(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&ta(e.keyFormatVersions,this.keyFormatVersions)&&ra(e.iv,this.iv)&&ra(e.keyId,this.keyId)}},{key:"isSupported",value:function(){if(this.method){if(na(this.method)||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case da:case pa:case ha:case fa:return-1!==["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}},{key:"getDecryptData",value:function(t,r){if(!this.encrypted||!this.uri)return null;if(na(this.method)){var n=this.iv;return n||("number"!=typeof t&&(Ar.warn('missing IV for initialization segment with method="'.concat(this.method,'" - compliance issue')),t=0),n=function(e){for(var t=new Uint8Array(16),r=12;r<16;r++)t[r]=e>>8*(15-r)&255;return t}(t)),new e(this.method,this.uri,"identity",this.keyFormatVersions,n)}if(this.keyId){var i=Ea[this.uri];if(i&&!ta(this.keyId,i)&&e.setKeyIdForUri(this.uri,this.keyId),this.pssh)return this}var a,o=la(this.uri);if(o)switch(this.keyFormat){case pa:if(this.pssh=o,!this.keyId){var s=function(e){var t=[];if(e instanceof ArrayBuffer)for(var r=e.byteLength,n=0;n+32<r;){var i=dn(new DataView(e,n));t.push(i),n+=i.size}return t}(o.buffer);if(s.length){var l,u=s[0];this.keyId=null!=(l=u.kids)&&l.length?u.kids[0]:null}}this.keyId||(this.keyId=Ta(r));break;case ha:var c=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,r){if(16!==e.byteLength)throw new RangeError("Invalid system id");var n,i;n=new Uint8Array,i=new Uint8Array;var a=new Uint8Array(4);return r.byteLength>0&&new DataView(a.buffer).setUint32(0,r.byteLength,!1),function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=r.length,a=8,o=i;o--;)a+=r[o].byteLength;var s=new Uint8Array(a);for(s[0]=a>>24&255,s[1]=a>>16&255,s[2]=a>>8&255,s[3]=255&a,s.set(e,4),o=0,a=8;o<i;o++)s.set(r[o],a),a+=r[o].byteLength;return s}([112,115,115,104],new Uint8Array([0,0,0,0]),e,i,n,a,r)}(c,0,o),this.keyId=ba(o);break;default:var f=o.subarray(0,16);if(16!==f.length){var d=new Uint8Array(16);d.set(f,16-f.length),f=d}this.keyId=f}return this.keyId&&16===this.keyId.byteLength||((a=function(e){var t=null==e?void 0:e[pa];return t?t.keyId:null}(r))||(a=Ta(r))||(a=Ea[this.uri]),a&&(this.keyId=a,e.setKeyIdForUri(this.uri,a))),this}}]),e}();function Ta(e){var t=null==e?void 0:e[ha];if(t){var r=la(t.uri);if(r)return ba(r)}return null}var Sa=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,wa=/#EXT-X-MEDIA:(.*)/g,_a=/^#EXT(?:INF|-X-TARGETDURATION):/m,La=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Pa=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),Ia=function(){function e(){h(this,e)}return p(e,null,[{key:"findGroup",value:function(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(n.id===t)return n}}},{key:"resolve",value:function(e,t){return Dr.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}},{key:"isMediaPlaylist",value:function(e){return _a.test(e)}},{key:"parseMasterPlaylist",value:function(t,r){var n,i={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:Hi(t)},a=[];if(Sa.lastIndex=0,!t.startsWith("#EXTM3U"))return i.playlistParsingError=new Error("no EXTM3U delimiter"),i;for(;null!=(n=Sa.exec(t));)if(n[1]){var o,s=new Ji(n[1],i),l=Ki(i,n[2]),u={attrs:s,bitrate:s.decimalInteger("BANDWIDTH")||s.decimalInteger("AVERAGE-BANDWIDTH"),name:s.NAME,url:e.resolve(l,r)},c=s.decimalResolution("RESOLUTION");c&&(u.width=c.width,u.height=c.height),za(s.CODECS,u);var f=s["SUPPLEMENTAL-CODECS"];f&&(u.supplemental={},za(f,u.supplemental)),null!=(o=u.unknownCodecs)&&o.length||a.push(u),i.levels.push(u)}else if(n[3]){var d=n[3],h=n[4];switch(d){case"SESSION-DATA":var p=new Ji(h,i),g=p["DATA-ID"];g&&(null===i.sessionData&&(i.sessionData={}),i.sessionData[g]=p);break;case"SESSION-KEY":var v=Da(h,r,i);v.encrypted&&v.isSupported()?(null===i.sessionKeys&&(i.sessionKeys=[]),i.sessionKeys.push(v)):Ar.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'.concat(h,'"'));break;case"DEFINE":Qi(i,new Ji(h,i),r);break;case"CONTENT-STEERING":var y=new Ji(h,i);i.contentSteering={uri:e.resolve(y["SERVER-URI"],r),pathwayId:y["PATHWAY-ID"]||"."};break;case"START":i.startTimeOffset=Oa(h)}}var m=a.length>0&&a.length<i.levels.length;return i.levels=m?a:i.levels,0===i.levels.length&&(i.playlistParsingError=new Error("no levels found in manifest")),i}},{key:"parseMasterPlaylistMedia",value:function(t,r,n){var i,a={},o=n.levels,s={AUDIO:o.map((function(e){return{id:e.attrs.AUDIO,audioCodec:e.audioCodec}})),SUBTITLES:o.map((function(e){return{id:e.attrs.SUBTITLES,textCodec:e.textCodec}})),"CLOSED-CAPTIONS":[]},l=0;for(wa.lastIndex=0;null!==(i=wa.exec(t));){var u=new Ji(i[1],n),c=u.TYPE;if(c){var f=s[c],d=a[c]||[];a[c]=d;var h=u.LANGUAGE,p=u["ASSOC-LANGUAGE"],g=u.CHANNELS,v=u.CHARACTERISTICS,y=u["INSTREAM-ID"],m={attrs:u,bitrate:0,id:l++,groupId:u["GROUP-ID"]||"",name:u.NAME||h||"",type:c,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:h,url:u.URI?e.resolve(u.URI,r):""};if(p&&(m.assocLang=p),g&&(m.channels=g),v&&(m.characteristics=v),y&&(m.instreamId=y),null!=f&&f.length){var A=e.findGroup(f,m.groupId)||f[0];Ma(m,A,"audioCodec"),Ma(m,A,"textCodec")}d.push(m)}}return a}},{key:"parseLevelPlaylist",value:function(e,t,r,n,i,a){var o,s,l,u,c,f={url:t},d=new ea(t),h=d.fragments,p=[],g=null,v=0,y=0,m=0,A=0,b=0,E=null,k=new Nr(n,f),T=-1,S=!1,w=null;if(La.lastIndex=0,d.m3u8=e,d.hasVariableRefs=Hi(e),"#EXTM3U"!==(null==(o=La.exec(e))?void 0:o[0]))return d.playlistParsingError=new Error("Missing format identifier #EXTM3U"),d;for(;null!==(s=La.exec(e));){S&&(S=!1,(k=new Nr(n,f)).playlistOffset=m,k.setStart(m),k.sn=v,k.cc=A,b&&(k.bitrate=b),k.level=r,g&&(k.initSegment=g,g.rawProgramDateTime&&(k.rawProgramDateTime=g.rawProgramDateTime,g.rawProgramDateTime=null),w&&(k.setByteRange(w),w=null)));var _=s[1];if(_){k.duration=parseFloat(_);var L=(" "+s[2]).slice(1);k.title=L||null,k.tagList.push(L?["INF",_,L]:["INF",_])}else if(s[3]){if(Wt(k.duration)){k.playlistOffset=m,k.setStart(m),u&&Fa(k,u,d),k.sn=v,k.level=r,k.cc=A,h.push(k);var P=(" "+s[3]).slice(1);k.relurl=Ki(d,P),xa(k,E,p),E=k,m+=k.duration,v++,y=0,S=!0}}else{if(!(s=s[0].match(Pa))){Ar.warn("No matches on slow regex match for level playlist!");continue}for(l=1;l<s.length&&void 0===s[l];l++);var I=(" "+s[l]).slice(1),R=(" "+s[l+1]).slice(1),C=s[l+2]?(" "+s[l+2]).slice(1):null;switch(I){case"BYTERANGE":E?k.setByteRange(R,E):k.setByteRange(R);break;case"PROGRAM-DATE-TIME":k.rawProgramDateTime=R,k.tagList.push(["PROGRAM-DATE-TIME",R]),-1===T&&(T=h.length);break;case"PLAYLIST-TYPE":d.type&&Na(d,I,s),d.type=R.toUpperCase();break;case"MEDIA-SEQUENCE":0!==d.startSN?Na(d,I,s):h.length>0&&Ua(d,I,s),v=d.startSN=parseInt(R);break;case"SKIP":d.skippedSegments&&Na(d,I,s);var D=new Ji(R,d),O=D.decimalInteger("SKIPPED-SEGMENTS");if(Wt(O)){d.skippedSegments+=O;for(var z=O;z--;)h.push(null);v+=O}var M=D.enumeratedString("RECENTLY-REMOVED-DATERANGES");M&&(d.recentlyRemovedDateranges=(d.recentlyRemovedDateranges||[]).concat(M.split("\t")));break;case"TARGETDURATION":0!==d.targetduration&&Na(d,I,s),d.targetduration=Math.max(parseInt(R),1);break;case"VERSION":null!==d.version&&Na(d,I,s),d.version=parseInt(R);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":d.live||Na(d,I,s),d.live=!1;break;case"#":(R||C)&&k.tagList.push(C?[R,C]:[R]);break;case"DISCONTINUITY":A++,k.tagList.push(["DIS"]);break;case"GAP":k.gap=!0,k.tagList.push([I]);break;case"BITRATE":k.tagList.push([I,R]),b=1e3*parseInt(R),Wt(b)?k.bitrate=b:b=0;break;case"DATERANGE":var x=new Ji(R,d),B=new $i(x,d.dateRanges[x.ID],d.dateRangeTagCount);d.dateRangeTagCount++,B.isValid||d.skippedSegments?d.dateRanges[B.id]=B:Ar.warn('Ignoring invalid DATERANGE tag: "'.concat(R,'"')),k.tagList.push(["EXT-X-DATERANGE",R]);break;case"DEFINE":var F=new Ji(R,d);"IMPORT"in F?Wi(d,F,a):Qi(d,F,t);break;case"DISCONTINUITY-SEQUENCE":0!==d.startCC?Na(d,I,s):h.length>0&&Ua(d,I,s),d.startCC=A=parseInt(R);break;case"KEY":var N=Da(R,t,d);if(N.isSupported()){if("NONE"===N.method){u=void 0;break}u||(u={});var U=u[N.keyFormat];null!=U&&U.matches(N)||(U&&(u=cr({},u)),u[N.keyFormat]=N)}else Ar.warn('[Keys] Ignoring unsupported EXT-X-KEY tag: "'.concat(R,'"'));break;case"START":d.startTimeOffset=Oa(R);break;case"MAP":var j=new Ji(R,d);if(k.duration){var G=new Nr(n,f);Ba(G,j,r,u),g=G,k.initSegment=g,g.rawProgramDateTime&&!k.rawProgramDateTime&&(k.rawProgramDateTime=g.rawProgramDateTime)}else{var Y=k.byteRangeEndOffset;if(Y){var V=k.byteRangeStartOffset;w="".concat(Y-V,"@").concat(V)}else w=null;Ba(k,j,r,u),g=k,S=!0}g.cc=A;break;case"SERVER-CONTROL":c&&Na(d,I,s),c=new Ji(R),d.canBlockReload=c.bool("CAN-BLOCK-RELOAD"),d.canSkipUntil=c.optionalFloat("CAN-SKIP-UNTIL",0),d.canSkipDateRanges=d.canSkipUntil>0&&c.bool("CAN-SKIP-DATERANGES"),d.partHoldBack=c.optionalFloat("PART-HOLD-BACK",0),d.holdBack=c.optionalFloat("HOLD-BACK",0);break;case"PART-INF":d.partTarget&&Na(d,I,s);var H=new Ji(R);d.partTarget=H.decimalFloatingPoint("PART-TARGET");break;case"PART":var K=d.partList;K||(K=d.partList=[]);var Q=y>0?K[K.length-1]:void 0,W=y++,q=new Ji(R,d),X=new Ur(q,k,f,W,Q);K.push(X),k.duration+=X.duration;break;case"PRELOAD-HINT":var J=new Ji(R,d);d.preloadHint=J;break;case"RENDITION-REPORT":var Z=new Ji(R,d);d.renditionReports=d.renditionReports||[],d.renditionReports.push(Z);break;default:Ar.warn("line parsed but not handled: ".concat(s))}}}E&&!E.relurl?(h.pop(),m-=E.duration,d.partList&&(d.fragmentHint=E)):d.partList&&(xa(k,E,p),k.cc=A,d.fragmentHint=k,u&&Fa(k,u,d)),d.targetduration||(d.playlistParsingError=new Error("Missing Target Duration"));var $=h.length,ee=h[0],te=h[$-1];if((m+=d.skippedSegments*d.targetduration)>0&&$&&te){d.averagetargetduration=m/$;var re=te.sn;d.endSN="initSegment"!==re?re:0,d.live||(te.endList=!0),T>0&&(function(e,t){for(var r=e[t],n=t;n--;){var i=e[n];if(!i)return;i.programDateTime=r.programDateTime-1e3*i.duration,r=i}}(h,T),ee&&p.unshift(ee))}return d.fragmentHint&&(m+=d.fragmentHint.duration),d.totalduration=m,p.length&&d.dateRangeTagCount&&ee&&Ra(p,d),d.endCC=A,d}}]),e}();function Ra(e,t){var r=e.length;if(!r){if(!t.hasProgramDateTime)return;var n=t.fragments[t.fragments.length-1];e.push(n),r++}for(var i=e[r-1],a=t.live?1/0:t.totalduration,o=Object.keys(t.dateRanges),s=o.length;s--;){var l=t.dateRanges[o[s]],u=l.startDate.getTime();l.tagAnchor=i.ref;for(var c=r;c--;){var f;if((null==(f=e[c])?void 0:f.sn)<t.startSN)break;var d=Ca(t,u,e,c,a);if(-1!==d){l.tagAnchor=t.fragments[d].ref;break}}}}function Ca(e,t,r,n,i){var a=r[n];if(a){var o,s=a.programDateTime;if((t>=s||0===n)&&t<=s+1e3*(((null==(o=r[n+1])?void 0:o.start)||i)-a.start)){var l=r[n].sn-e.startSN;if(l<0)return-1;var u=e.fragments;if(u.length>r.length)for(var c=(r[n+1]||u[u.length-1]).sn-e.startSN;c>l;c--){var f=u[c].programDateTime;if(t>=f&&t<f+1e3*u[c].duration)return c}return l}}return-1}function Da(e,t,r){var n,i,a=new Ji(e,r),o=null!=(n=a.METHOD)?n:"",s=a.URI,l=a.hexadecimalInteger("IV"),u=a.KEYFORMATVERSIONS,c=null!=(i=a.KEYFORMAT)?i:"identity";s&&a.IV&&!l&&Ar.error("Invalid IV: ".concat(a.IV));var f=s?Ia.resolve(s,t):"",d=(u||"1").split("/").map(Number).filter(Number.isFinite);return new ka(o,f,c,d,l,a.KEYID)}function Oa(e){var t=new Ji(e).decimalFloatingPoint("TIME-OFFSET");return Wt(t)?t:null}function za(e,t){var r=(e||"").split(/[ ,]+/).filter((function(e){return e}));["video","audio","text"].forEach((function(e){var n=r.filter((function(t){return gn(t,e)}));n.length&&(t["".concat(e,"Codec")]=n.map((function(e){return e.split("/")[0]})).join(","),r=r.filter((function(e){return-1===n.indexOf(e)})))})),t.unknownCodecs=r}function Ma(e,t,r){var n=t[r];n&&(e[r]=n)}function xa(e,t,r){e.rawProgramDateTime?r.push(e):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime)}function Ba(e,t,r,n){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=r,e.sn="initSegment",n&&(e.levelkeys=n),e.initSegment=null}function Fa(e,t,r){e.levelkeys=t;var n=r.encryptedFragments;n.length&&n[n.length-1].levelkeys===t||!Object.keys(t).some((function(e){return t[e].isCommonEncryption}))||n.push(e)}function Na(e,t,r){e.playlistParsingError=new Error("#EXT-X-".concat(t," must not appear more than once (").concat(r[0],")"))}function Ua(e,t,r){e.playlistParsingError=new Error("#EXT-X-".concat(t," must appear before the first Media Segment (").concat(r[0],")"))}function ja(e,t){var r=t.startPTS;if(Wt(r)){var n,i=0;t.sn>e.sn?(i=r-e.start,n=e):(i=e.start-r,n=t),n.duration!==i&&n.setDuration(i)}else t.sn>e.sn?e.cc===t.cc&&e.minEndPTS?t.setStart(e.start+(e.minEndPTS-e.start)):t.setStart(e.start+e.duration):t.setStart(Math.max(e.start-t.duration,0))}function Ga(e,t,r,n,i,a,o){n-r<=0&&(o.warn("Fragment should have a positive duration",t),n=r+t.duration,a=i+t.duration);var s=r,l=n,u=t.startPTS,c=t.endPTS;if(Wt(u)){var f=Math.abs(u-r);e&&f>e.totalduration?o.warn("media timestamps and playlist times differ by ".concat(f,"s for level ").concat(t.level," ").concat(e.url)):Wt(t.deltaPTS)?t.deltaPTS=Math.max(f,t.deltaPTS):t.deltaPTS=f,s=Math.max(r,u),r=Math.min(r,u),i=void 0!==t.startDTS?Math.min(i,t.startDTS):i,l=Math.min(n,c),n=Math.max(n,c),a=void 0!==t.endDTS?Math.max(a,t.endDTS):a}var d=r-t.start;0!==t.start&&t.setStart(r),t.setDuration(n-t.start),t.startPTS=r,t.maxStartPTS=s,t.startDTS=i,t.endPTS=n,t.minEndPTS=l,t.endDTS=a;var h,p=t.sn;if(!e||p<e.startSN||p>e.endSN)return 0;var g=p-e.startSN,v=e.fragments;for(v[g]=t,h=g;h>0;h--)ja(v[h],v[h-1]);for(h=g;h<v.length-1;h++)ja(v[h],v[h+1]);return e.fragmentHint&&ja(v[v.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,d}function Ya(e,t,r,n,i){return new Error("".concat(e," ").concat(i.url,"\nPlaylist starting @").concat(t.startSN,"\n").concat(t.m3u8,"\n\nPlaylist starting @").concat(r.startSN,"\n").concat(r.m3u8))}function Va(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.startSN+t.skippedSegments-e.startSN,i=e.fragments,a=n>=0,o=0;if(a&&n<i.length)o=i[n].start;else if(a&&t.startSN===e.endSN+1)o=e.fragmentEnd;else if(a&&r)o=e.fragmentStart+n*t.levelTargetDuration;else{if(t.skippedSegments||0!==t.fragmentStart)return;o=e.fragmentStart}Ha(t,o)}function Ha(e,t){if(t){for(var r=e.fragments,n=e.skippedSegments;n<r.length;n++)r[n].addStart(t);e.fragmentHint&&e.fragmentHint.addStart(t)}}function Ka(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,r=1e3*e.targetduration;if(e.updated){var n=e.fragments,i=4;if(n.length&&r*i>t){var a=1e3*n[n.length-1].duration;a<r&&(r=a)}}else r/=2;return Math.round(r)}function Qa(e,t,r){if(!e)return null;var n=e.fragments[t-e.startSN];return n||((n=e.fragmentHint)&&n.sn===t?n:t<e.startSN&&r&&r.sn===t?r:null)}function Wa(e,t,r){return e?qa(e.partList,t,r):null}function qa(e,t,r){if(e)for(var n=e.length;n--;){var i=e[n];if(i.index===r&&i.fragment.sn===t)return i}return null}function Xa(e){e.forEach((function(e,t){var r;null==(r=e.details)||r.fragments.forEach((function(e){e.level=t,e.initSegment&&(e.initSegment.level=t)}))}))}function Ja(e,t){return!(e===t||!t)&&Za(e)!==Za(t)}function Za(e){return e.replace(/\?[^?]*$/,"")}function $a(e,t){for(var r=0,n=e.length;r<n;r++){var i;if((null==(i=e[r])?void 0:i.cc)===t)return e[r]}return null}function eo(e,t){var r=e.start+t;e.startPTS=r,e.setStart(r),e.endPTS=r+e.duration}function to(e,t){for(var r=t.fragments,n=0,i=r.length;n<i;n++)eo(r[n],e);t.fragmentHint&&eo(t.fragmentHint,e),t.alignedSliding=!0}function ro(e,t){if(function(e,t){return!!(e&&t.startCC<e.endCC&&t.endCC>e.startCC)}(t,e)){var r=Math.min(t.endCC,e.endCC),n=$a(t.fragments,r),i=$a(e.fragments,r);n&&i&&(Ar.log("Aligning playlist at start of dicontinuity sequence ".concat(r)),to(n.start-i.start,e))}}function no(e,t){if(e.hasProgramDateTime&&t.hasProgramDateTime){var r=e.fragments,n=t.fragments;if(r.length&&n.length){var i,a,o=Math.min(t.endCC,e.endCC);t.startCC<o&&e.startCC<o&&(i=$a(n,o),a=$a(r,o)),i&&a||(a=$a(r,(i=n[Math.floor(n.length/2)]).cc)||r[Math.floor(r.length/2)]);var s=i.programDateTime,l=a.programDateTime;s&&l&&to((l-s)/1e3-(a.start-i.start),e)}}}function io(e,t,r){ao(e,t,r),e.addEventListener(t,r)}function ao(e,t,r){e.removeEventListener(t,r)}var oo=function(e){for(var t="",r=e.length,n=0;n<r;n++)t+="[".concat(e.start(n).toFixed(3),"-").concat(e.end(n).toFixed(3),"]");return t},so="STOPPED",lo="IDLE",uo="KEY_LOADING",co="FRAG_LOADING",fo="FRAG_LOADING_WAITING_RETRY",ho="WAITING_TRACK",po="PARSING",go="PARSED",vo="ENDED",yo="ERROR",mo="WAITING_INIT_PTS",Ao="WAITING_LEVEL",bo=function(e){c(r,e);var t=f(r);function r(e,n,i,a,o){var s;return h(this,r),(s=t.call(this,a,e.logger)).hls=void 0,s.fragPrevious=null,s.fragCurrent=null,s.fragmentTracker=void 0,s.transmuxer=null,s._state=so,s.playlistType=void 0,s.media=null,s.mediaBuffer=null,s.config=void 0,s.bitrateTest=!1,s.lastCurrentTime=0,s.nextLoadPosition=0,s.startPosition=0,s.startTimeOffset=null,s.retryDate=0,s.levels=null,s.fragmentLoader=void 0,s.keyLoader=void 0,s.levelLastLoaded=null,s.startFragRequested=!1,s.decrypter=void 0,s.initPTS=[],s.buffering=!0,s.loadingParts=!1,s.loopSn=void 0,s.onMediaSeeking=function(){var e=l(s),t=e.config,r=e.fragCurrent,n=e.media,i=e.mediaBuffer,a=e.state,o=n?n.currentTime:0,u=Yi.bufferInfo(i||n,o,t.maxBufferHole),c=!u.len;if(s.log("Media seeking to ".concat(Wt(o)?o.toFixed(3):o,", state: ").concat(a,", ").concat(c?"out of":"in"," buffer")),s.state===vo)s.resetLoadingState();else if(r){var f=t.maxFragLookUpTolerance,d=r.start-f,h=r.start+r.duration+f;if(c||h<u.start||d>u.end){var p=o>h;(o<d||p)&&(p&&r.loader&&(s.log("Cancelling fragment load for seek (sn: ".concat(r.sn,")")),r.abortRequests(),s.resetLoadingState()),s.fragPrevious=null)}}if(n&&(s.fragmentTracker.removeFragmentsInRange(o,1/0,s.playlistType,!0),o>s.lastCurrentTime&&(s.lastCurrentTime=o),!s.loadingParts)){var g=Math.max(u.end,o),v=s.shouldLoadParts(s.getLevelDetails(),g);v&&(s.log("LL-Part loading ON after seeking to ".concat(o.toFixed(2)," with buffer @").concat(g.toFixed(2))),s.loadingParts=v)}s.hls.hasEnoughToStart||(s.log("Setting ".concat(c?"startPosition":"nextLoadPosition"," to ").concat(o," for seek without enough to start")),s.nextLoadPosition=o,c&&(s.startPosition=o)),c&&s.state===lo&&s.tickImmediate()},s.onMediaEnded=function(){s.log("setting startPosition to 0 because media ended"),s.startPosition=s.lastCurrentTime=0},s.playlistType=o,s.hls=e,s.fragmentLoader=new xi(e.config),s.keyLoader=i,s.fragmentTracker=n,s.config=e.config,s.decrypter=new zi(e.config),s}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($t.ERROR,this.onError,this)}},{key:"doTick",value:function(){this.onTickEnd()}},{key:"onTickEnd",value:function(){}},{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){if(this.state!==so){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);var e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=so}}},{key:"pauseBuffering",value:function(){this.buffering=!1}},{key:"resumeBuffering",value:function(){this.buffering=!0}},{key:"_streamEnded",value:function(e,t){if(t.live||!this.media)return!1;var r=e.end||0,n=this.config.timelineOffset||0;if(r<=n)return!1;var i=e.buffered;this.config.maxBufferHole&&i&&i.length>1&&(e=Yi.bufferedInfo(i,e.start,0));var a=e.nextStart;if(a&&a>n&&a<t.edge)return!1;if(this.media.currentTime<e.start)return!1;var o=t.partList;if(null!=o&&o.length){var s=o[o.length-1];return Yi.isBuffered(this.media,s.start+s.duration/2)}var l=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(l)}},{key:"getLevelDetails",value:function(){if(this.levels&&null!==this.levelLastLoaded)return this.levelLastLoaded.details}},{key:"onMediaAttached",value:function(e,t){var r=this.media=this.mediaBuffer=t.media;io(r,"seeking",this.onMediaSeeking),io(r,"ended",this.onMediaEnded);var n=this.config;this.levels&&n.autoStartLoad&&this.state===so&&this.startLoad(n.startPosition)}},{key:"onMediaDetaching",value:function(e,t){var r=!!t.transferMedia,n=this.media;if(null!==n){if(n.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),ao(n,"seeking",this.onMediaSeeking),ao(n,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r)return this.resetLoadingState(),void this.resetTransmuxer();this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}},{key:"onManifestLoading",value:function(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}},{key:"onError",value:function(e,t){}},{key:"onManifestLoaded",value:function(e,t){this.startTimeOffset=t.startTimeOffset}},{key:"onHandlerDestroying",value:function(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),o(s(r.prototype),"onHandlerDestroying",this).call(this),this.hls=this.onMediaSeeking=this.onMediaEnded=null}},{key:"onHandlerDestroyed",value:function(){this.state=so,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,o(s(r.prototype),"onHandlerDestroyed",this).call(this)}},{key:"loadFragment",value:function(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}},{key:"_loadFragForPlayback",value:function(e,t,r){var n=this;this._doFragLoad(e,t,r,(function(e){var t=e.frag;if(n.fragContextChanged(t))return n.warn("".concat(t.type," sn: ").concat(t.sn).concat(e.part?" part: "+e.part.index:""," of ").concat(n.fragInfo(t,!1,e.part),") was dropped during download.")),void n.fragmentTracker.removeFragment(t);t.stats.chunkCount++,n._handleFragmentLoadProgress(e)})).then((function(e){if(e){var t=n.state,r=e.frag;n.fragContextChanged(r)?(t===co||!n.fragCurrent&&t===po)&&(n.fragmentTracker.removeFragment(r),n.state=lo):("payload"in e&&(n.log("Loaded ".concat(r.type," sn: ").concat(r.sn," of ").concat(n.playlistLabel()," ").concat(r.level)),n.hls.trigger($t.FRAG_LOADED,e)),n._handleFragmentLoadComplete(e))}})).catch((function(t){n.state!==so&&n.state!==yo&&(n.warn("Frag error: ".concat((null==t?void 0:t.message)||t)),n.resetFragmentLoading(e))}))}},{key:"clearTrackerIfNeeded",value:function(e){var t,r=this.fragmentTracker;if(r.getState(e)===ki){var n=e.type,i=this.getFwdBufferInfo(this.mediaBuffer,n),a=Math.max(e.duration,i?i.len:this.config.maxBufferLength),o=this.backtrackFragment;(1===(o?e.sn-o.sn:0)||this.reduceMaxBufferLength(a,e.duration))&&r.removeFragment(e)}else 0===(null==(t=this.mediaBuffer)?void 0:t.buffered.length)?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Ti&&r.removeFragment(e))}},{key:"checkLiveUpdate",value:function(e){if(e.updated&&!e.live){var t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}},{key:"waitForLive",value:function(e){var t=e.details;return(null==t?void 0:t.live)&&"EVENT"!==t.type&&(this.levelLastLoaded!==e||t.expired)}},{key:"flushMainBuffer",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e-t){var n={startOffset:e,endOffset:t,type:r};this.hls.trigger($t.BUFFER_FLUSHING,n)}}},{key:"_loadInitSegment",value:function(e,t){var r=this;this._doFragLoad(e,t).then((function(e){var t=null==e?void 0:e.frag;if(!t||r.fragContextChanged(t)||!r.levels)throw new Error("init load aborted");return e})).then((function(e){var t=r.hls,n=e.frag,i=e.payload,a=n.decryptdata;if(i&&i.byteLength>0&&null!=a&&a.key&&a.iv&&na(a.method)){var o=self.performance.now();return r.decrypter.decrypt(new Uint8Array(i),a.key.buffer,a.iv.buffer,ia(a.method)).catch((function(e){throw t.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:n}),e})).then((function(i){var a=self.performance.now();return t.trigger($t.FRAG_DECRYPTED,{frag:n,payload:i,stats:{tstart:o,tdecrypt:a}}),e.payload=i,r.completeInitSegmentLoad(e)}))}return r.completeInitSegmentLoad(e)})).catch((function(t){r.state!==so&&r.state!==yo&&(r.warn(t),r.resetFragmentLoading(e))}))}},{key:"completeInitSegmentLoad",value:function(e){if(!this.levels)throw new Error("init load aborted, missing levels");var t=e.frag.stats;this.state!==so&&(this.state=lo),e.frag.data=new Uint8Array(e.payload),t.parsing.start=t.buffering.start=self.performance.now(),t.parsing.end=t.buffering.end=self.performance.now(),this.tick()}},{key:"unhandledEncryptionError",value:function(e,t){var r,n,i=e.tracks;if(i&&!t.encrypted&&(null!=(r=i.audio)&&r.encrypted||null!=(n=i.video)&&n.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){var a=this.media,o=new Error("Encrypted track with no key in ".concat(this.fragInfo(t)," (media ").concat(a?"attached mediaKeys: "+a.mediaKeys:"detached",")"));return this.warn(o.message),!(!a||a.mediaKeys)&&(this.hls.trigger($t.ERROR,{type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_NO_KEYS,fatal:!1,error:o,frag:t}),this.resetTransmuxer(),!0)}return!1}},{key:"fragContextChanged",value:function(e){var t=this.fragCurrent;return!e||!t||e.sn!==t.sn||e.level!==t.level}},{key:"fragBufferedComplete",value:function(e,t){var r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log("Buffered ".concat(e.type," sn: ").concat(e.sn).concat(t?" part: "+t.index:""," of ").concat(this.fragInfo(e,!1,t)," > buffer:").concat(r?oo(Yi.getBuffered(r)):"(detached)",")")),Fr(e)){var n;if(e.type!==or){var i=e.elementaryStreams;if(!Object.keys(i).some((function(e){return!!i[e]})))return void(this.state=lo)}var a=null==(n=this.levels)?void 0:n[e.level];null!=a&&a.fragmentError&&(this.log("Resetting level fragment error count of ".concat(a.fragmentError," on frag buffered")),a.fragmentError=0)}this.state=lo}},{key:"_handleFragmentLoadComplete",value:function(e){var t=this.transmuxer;if(t){var r=e.frag,n=e.part,i=e.partsLoaded,a=!i||0===i.length||i.some((function(e){return!e})),o=new ji(r.level,r.sn,r.stats.chunkCount+1,0,n?n.index:-1,!a);t.flush(o)}}},{key:"_handleFragmentLoadProgress",value:function(e){}},{key:"_doFragLoad",value:function(e,t){var r,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3?arguments[3]:void 0;this.fragCurrent=e;var s=t.details;if(!this.levels||!s)throw new Error("frag load aborted, missing level".concat(s?"":" detail","s"));var l=null;if(!e.encrypted||null!=(r=e.decryptdata)&&r.key)e.encrypted||(l=this.keyLoader.loadClear(e,s.encryptedFragments,this.startFragRequested))&&this.log("[eme] blocking frag load until media-keys acquired");else if(this.log("Loading key for ".concat(e.sn," of [").concat(s.startSN,"-").concat(s.endSN,"], ").concat(this.playlistLabel()," ").concat(e.level)),this.state=uo,this.fragCurrent=e,l=this.keyLoader.load(e).then((function(e){if(!n.fragContextChanged(e.frag))return n.hls.trigger($t.KEY_LOADED,e),n.state===uo&&(n.state=lo),e})),this.hls.trigger($t.KEY_LOADING,{frag:e}),null===this.fragCurrent)return this.log("context changed in KEY_LOADING"),Promise.resolve(null);var u,c=this.fragPrevious;if(Fr(e)&&(!c||e.sn!==c.sn)){var f=this.shouldLoadParts(t.details,e.end);f!==this.loadingParts&&(this.log("LL-Part loading ".concat(f?"ON":"OFF"," loading sn ").concat(null==c?void 0:c.sn,"->").concat(e.sn)),this.loadingParts=f)}if(i=Math.max(e.start,i||0),this.loadingParts&&Fr(e)){var d=s.partList;if(d&&o){i>s.fragmentEnd&&s.fragmentHint&&(e=s.fragmentHint);var h=this.getNextPart(d,e,i);if(h>-1){var p,g=d[h];return e=this.fragCurrent=g.fragment,this.log("Loading ".concat(e.type," sn: ").concat(e.sn," part: ").concat(g.index," (").concat(h,"/").concat(d.length-1,") of ").concat(this.fragInfo(e,!1,g),") cc: ").concat(e.cc," [").concat(s.startSN,"-").concat(s.endSN,"], target: ").concat(parseFloat(i.toFixed(3)))),this.nextLoadPosition=g.start+g.duration,this.state=co,p=l?l.then((function(r){return!r||n.fragContextChanged(r.frag)?null:n.doFragPartsLoad(e,g,t,o)})).catch((function(e){return n.handleFragLoadError(e)})):this.doFragPartsLoad(e,g,t,o).catch((function(e){return n.handleFragLoadError(e)})),this.hls.trigger($t.FRAG_LOADING,{frag:e,part:g,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING parts")):p}if(!e.url||this.loadedEndOfParts(d,i))return Promise.resolve(null)}}if(Fr(e)&&this.loadingParts)this.log("LL-Part loading OFF after next part miss @".concat(i.toFixed(2)," Check buffer at sn: ").concat(e.sn," loaded parts: ").concat(null==(u=s.partList)?void 0:u.filter((function(e){return e.loaded})).map((function(e){return"[".concat(e.start,"-").concat(e.end,"]")})))),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log("Loading ".concat(e.type," sn: ").concat(e.sn," of ").concat(this.fragInfo(e,!1),") cc: ").concat(e.cc," ").concat("["+s.startSN+"-"+s.endSN+"]",", target: ").concat(parseFloat(i.toFixed(3)))),Wt(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=co;var v,y=this.config.progressive;return v=y&&l?l.then((function(t){return!t||n.fragContextChanged(t.frag)?null:n.fragmentLoader.load(e,o)})).catch((function(e){return n.handleFragLoadError(e)})):Promise.all([this.fragmentLoader.load(e,y?o:void 0),l]).then((function(e){var t=a(e,1)[0];return!y&&o&&o(t),t})).catch((function(e){return n.handleFragLoadError(e)})),this.hls.trigger($t.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent?Promise.reject(new Error("frag load aborted, context changed in FRAG_LOADING")):v}},{key:"doFragPartsLoad",value:function(e,t,r,n){var i=this;return new Promise((function(a,o){var s,l=[],u=null==(s=r.details)?void 0:s.partList;!function t(s){i.fragmentLoader.loadPart(e,s,n).then((function(n){l[s.index]=n;var o=n.part;i.hls.trigger($t.FRAG_LOADED,n);var c=Wa(r.details,e.sn,s.index+1)||qa(u,e.sn,s.index+1);if(!c)return a({frag:e,part:o,partsLoaded:l});t(c)})).catch(o)}(t)}))}},{key:"handleFragLoadError",value:function(e){if("data"in e){var t=e.data;t.frag&&t.details===Zt.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===Jt.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetStartWhenNotLoaded(),this.resetFragmentLoading(t.frag)):this.hls.trigger($t.ERROR,t)}else this.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}},{key:"_handleTransmuxerFlush",value:function(e){var t=this.getCurrentContext(e);if(t&&this.state===po){var r=t.frag,n=t.part,i=t.level,a=self.performance.now();r.stats.parsing.end=a,n&&(n.stats.parsing.end=a);var o=this.getLevelDetails(),s=o&&r.sn>o.endSN||this.shouldLoadParts(o,r.end);s!==this.loadingParts&&(this.log("LL-Part loading ".concat(s?"ON":"OFF"," after parsing segment ending @").concat(r.end.toFixed(2))),this.loadingParts=s),this.updateLevelTiming(r,n,i,e.partial)}else this.fragCurrent||this.state===so||this.state===yo||(this.state=lo)}},{key:"shouldLoadParts",value:function(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r,n,i=e.partList[0];if(i.fragment.type===or)return!1;if(t>=i.end+((null==(r=e.fragmentHint)?void 0:r.duration)||0)&&(this.hls.hasEnoughToStart?(null==(n=this.media)?void 0:n.currentTime)||this.lastCurrentTime:this.getLoadPosition())>i.start-i.fragment.duration)return!0}}return!1}},{key:"getCurrentContext",value:function(e){var t=this.levels,r=this.fragCurrent,n=e.level,i=e.sn,a=e.part;if(null==t||!t[n])return this.warn("Levels object was unset while buffering fragment ".concat(i," of ").concat(this.playlistLabel()," ").concat(n,". The current chunk will not be buffered.")),null;var o=t[n],s=o.details,l=a>-1?Wa(s,i,a):null,u=l?l.fragment:Qa(s,i,r);return u?(r&&r!==u&&(u.stats=r.stats),{frag:u,part:l,level:o}):null}},{key:"bufferFragmentData",value:function(e,t,r,n,i){if(this.state===po){var a=e.data1,o=e.data2,s=a;if(o&&(s=on(a,o)),s.length){var l=this.initPTS[t.cc],u=l?-l.baseTime/l.timescale:void 0,c={type:e.type,frag:t,part:r,chunkMeta:n,offset:u,parent:t.type,data:s};if(this.hls.trigger($t.BUFFER_APPENDING,c),e.dropped&&e.independent&&!r){if(i)return;this.flushBufferGap(t)}}}}},{key:"flushBufferGap",value:function(e){var t=this.media;if(t)if(Yi.isBuffered(t,t.currentTime)){var r=t.currentTime,n=Yi.bufferInfo(t,r,0),i=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*i),o=Math.max(Math.min(e.start-a,n.end-a),r+a);e.start-o>a&&this.flushMainBuffer(o,e.start)}else this.flushMainBuffer(0,e.start)}},{key:"getFwdBufferInfo",value:function(e,t){var r,n=this.getLoadPosition();if(!Wt(n))return null;var i=this.lastCurrentTime>n||null!=(r=this.media)&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,n,t,i)}},{key:"getFwdBufferInfoAtPos",value:function(e,t,r,n){var i=Yi.bufferInfo(e,t,n);if(0===i.len&&void 0!==i.nextStart){var a=this.fragmentTracker.getBufferedFrag(t,r);if(a&&(i.nextStart<=a.end||a.gap)){var o=Math.max(Math.min(i.nextStart,a.end)-t,n);return Yi.bufferInfo(e,t,o)}}return i}},{key:"getMaxBufferLength",value:function(e){var t,r=this.config;return t=e?Math.max(8*r.maxBufferSize/e,r.maxBufferLength):r.maxBufferLength,Math.min(t,r.maxMaxBufferLength)}},{key:"reduceMaxBufferLength",value:function(e,t){var r=this.config,n=Math.max(Math.min(e-t,r.maxBufferLength),t),i=Math.max(e-3*t,r.maxMaxBufferLength/2,n);return i>=n&&(r.maxMaxBufferLength=i,this.warn("Reduce max buffer length to ".concat(i,"s")),!0)}},{key:"getAppendedFrag",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ir,r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}},{key:"getNextFragment",value:function(e,t){var r=t.fragments,n=r.length;if(!n)return null;var i=this.config,a=r[0].start,o=i.lowLatencyMode&&!!t.partList,s=null;if(t.live){var l=i.initialLiveManifestSize;if(n<l)return this.warn("Not enough fragments to start playback (have: ".concat(n,", need: ").concat(l,")")),null;if(!t.PTSKnown&&!this.startFragRequested&&-1===this.startPosition||e<a){var u;o&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),s=this.getInitialLiveFragment(t);var c=this.hls.startPosition,f=this.hls.liveSyncPosition,d=s?(-1!==c&&c>=a?c:f)||s.start:e;this.log("Setting startPosition to ".concat(d," to match start frag at live edge. mainStart: ").concat(c," liveSyncPosition: ").concat(f," frag.start: ").concat(null==(u=s)?void 0:u.start)),this.startPosition=this.nextLoadPosition=d}}else e<=a&&(s=r[0]);if(!s){var h=this.loadingParts?t.partEnd:t.fragmentEnd;s=this.getFragmentAtPosition(e,h,t)}var p=this.filterReplacedPrimary(s,t);if(!p&&s){var g=s.sn-t.startSN;p=this.filterReplacedPrimary(r[g+1]||null,t)}return this.mapToInitFragWhenRequired(p)}},{key:"isLoopLoading",value:function(e,t){var r=this.fragmentTracker.getState(e);return(r===Si||r===Ti&&!!e.gap)&&this.nextLoadPosition>t}},{key:"getNextFragmentLoopLoading",value:function(e,t,r,n,i){var a=null;if(e.gap&&(a=this.getNextFragment(this.nextLoadPosition,t))&&!a.gap&&r.nextStart){var o=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,n,0);if(null!==o&&r.len+o.len>=i){var s=a.sn;return this.loopSn!==s&&(this.log('buffer full after gaps in "'.concat(n,'" playlist starting at sn: ').concat(s)),this.loopSn=s),null}}return this.loopSn=void 0,a}},{key:"filterReplacedPrimary",value:function(e,t){if(!e)return e;if(Eo(this.config)&&e.type!==or){var r=this.hls.interstitialsManager,n=null==r?void 0:r.bufferingItem;if(n){var i=n.event;if(i){if(i.appendInPlace||Math.abs(e.start-n.start)>1||0===n.start)return null}else{if(e.end<=n.start&&!1===(null==t?void 0:t.live))return null;if(e.start>n.end&&n.nextEvent&&(n.nextEvent.appendInPlace||e.start-n.end>1))return null}}var a=null==r?void 0:r.playerQueue;if(a)for(var o=a.length;o--;){var s=a[o].interstitial;if(s.appendInPlace&&e.start>=s.startTime&&e.end<=s.resumeTime)return null}}return e}},{key:"mapToInitFragWhenRequired",value:function(e){return null==e||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment}},{key:"getNextPart",value:function(e,t,r){for(var n=-1,i=!1,a=!0,o=0,s=e.length;o<s;o++){var l=e[o];if(a=a&&!l.independent,n>-1&&r<l.start)break;var u=l.loaded;u?n=-1:(i||(l.independent||a)&&l.fragment===t)&&(l.fragment!==t&&this.warn("Need buffer at ".concat(r," but next unloaded part starts at ").concat(l.start)),n=o),i=u}return n}},{key:"loadedEndOfParts",value:function(e,t){for(var r,n=e.length;n--;){if(!(r=e[n]).loaded)return!1;if(t>r.start)return!0}return!1}},{key:"getInitialLiveFragment",value:function(e){var t=e.fragments,r=this.fragPrevious,n=null;if(r){if(e.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: ".concat(r.programDateTime)),n=function(e,t,r){if(null===t||!Array.isArray(e)||!e.length||!Wt(t))return null;if(t<(e[0].programDateTime||0))return null;if(t>=(e[e.length-1].endProgramDateTime||0))return null;for(var n=0;n<e.length;++n){var i=e[n];if(ri(t,r,i))return i}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!n){var i=r.sn+1;if(i>=e.startSN&&i<=e.endSN){var a=t[i-e.startSN];r.cc===a.cc&&(n=a,this.log("Live playlist, switching playlist, load frag with next SN: ".concat(n.sn)))}n||(n=ni(e,r.cc,r.end))&&this.log("Live playlist, switching playlist, load frag with same CC: ".concat(n.sn))}}else{var o=this.hls.liveSyncPosition;null!==o&&(n=this.getFragmentAtPosition(o,this.bitrateTest?e.fragmentEnd:e.edge,e))}return n}},{key:"getFragmentAtPosition",value:function(e,t,r){var n,i,a=this.config,o=this.fragPrevious,s=r.fragments,l=r.endSN,u=r.fragmentHint,c=a.maxFragLookUpTolerance,f=r.partList,d=!!(this.loadingParts&&null!=f&&f.length&&u);if(d&&!this.bitrateTest&&f[f.length-1].fragment.sn===u.sn&&(s=s.concat(u),l=u.sn),n=e<t?ei(o,s,e,e<this.lastCurrentTime||e>t-c||null!=(i=this.media)&&i.paused||!this.startFragRequested?0:c):s[s.length-1]){var h=n.sn-r.startSN,p=this.fragmentTracker.getState(n);if((p===Si||p===Ti&&n.gap)&&(o=n),o&&n.sn===o.sn&&(!d||f[0].fragment.sn>n.sn||!r.live)&&n.level===o.level){var g=s[h+1];n=n.sn<l&&this.fragmentTracker.getState(g)!==Si?g:null}}return n}},{key:"alignPlaylists",value:function(e,t,r){var n=e.fragments.length;if(!n)return this.warn("No fragments in live playlist"),0;var i=e.fragmentStart,a=!t,o=e.alignedSliding&&Wt(i);if(a||!o&&!i){!function(e,t){e&&(ro(t,e),t.alignedSliding||no(t,e),t.alignedSliding||t.skippedSegments||Va(e,t,!1))}(r,e);var s=e.fragmentStart;return this.log("Live playlist sliding: ".concat(s.toFixed(2)," start-sn: ").concat(t?t.startSN:"na","->").concat(e.startSN," fragments: ").concat(n)),s}return i}},{key:"waitForCdnTuneIn",value:function(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}},{key:"setStartPosition",value:function(e,t){var r=this.startPosition;r<t&&(r=-1);var n=this.timelineOffset;if(-1===r){var i=null!==this.startTimeOffset,a=i?this.startTimeOffset:e.startTimeOffset;null!==a&&Wt(a)?(r=t+a,a<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log("Setting startPosition to ".concat(r," for start time offset ").concat(a," found in ").concat(i?"multivariant":"media"," playlist")),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log("Setting startPosition to -1 to start at live edge ".concat(r)),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+n}this.nextLoadPosition=r+n}},{key:"getLoadPosition",value:function(){var e,t=this.media,r=0;return null!=(e=this.hls)&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}},{key:"handleFragLoadAborted",value:function(e,t){this.transmuxer&&e.type===this.playlistType&&Fr(e)&&e.stats.aborted&&(this.log("Fragment ".concat(e.sn).concat(t?" part "+t.index:""," of ").concat(this.playlistLabel()," ").concat(e.level," was aborted")),this.resetFragmentLoading(e))}},{key:"resetFragmentLoading",value:function(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===fo)||(this.state=lo)}},{key:"onFragmentOrKeyLoadError",value:function(e,t){var r;if(t.chunkMeta&&!t.frag){var n=this.getCurrentContext(t.chunkMeta);n&&(t.frag=n.frag)}var i,a=t.frag;if(a&&a.type===e&&this.levels)if(this.fragContextChanged(a))this.warn("Frag load error must match current frag to retry ".concat(a.url," > ").concat(null==(i=this.fragCurrent)?void 0:i.url));else{var o=t.details===Zt.FRAG_GAP;o&&this.fragmentTracker.fragBuffered(a,!0);var s=t.errorAction;if(s){var l=s.action,u=s.flags,c=s.retryCount,f=void 0===c?0:c,d=s.retryConfig,h=!!d,p=h&&l===gi,g=h&&!s.resolved&&u===yi,v=null==(r=this.hls.latestLevelDetails)?void 0:r.live;if(!p&&g&&Fr(a)&&!a.endList&&v&&!oi(t))this.resetFragmentErrors(e),this.treatAsGap(a),s.resolved=!0;else if((p||g)&&f<d.maxNumRetry){var y,m=fi(null==(y=t.response)?void 0:y.code),A=li(d,f);if(this.resetStartWhenNotLoaded(),this.retryDate=self.performance.now()+A,this.state=fo,s.resolved=!0,m)return this.log("Waiting for connection (offline)"),this.retryDate=1/0,void(t.reason="offline");this.warn("Fragment ".concat(a.sn," of ").concat(e," ").concat(a.level," errored with ").concat(t.details,", retrying loading ").concat(f+1,"/").concat(d.maxNumRetry," in ").concat(A,"ms"))}else if(d){if(this.resetFragmentErrors(e),!(f<d.maxNumRetry))return void this.warn("".concat(t.details," reached or exceeded max retry (").concat(f,")"));o||l===pi||(s.resolved=!0)}else this.state=l===hi?Ao:yo;this.tickImmediate()}else this.state=yo}}},{key:"checkRetryDate",value:function(){var e=self.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!fi(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=lo)}},{key:"reduceLengthAndFlushBuffer",value:function(e){if(this.state===po||this.state===go){var t=e.frag,r=e.parent,n=this.getFwdBufferInfo(this.mediaBuffer,r),i=n&&n.len>.5;i&&this.reduceMaxBufferLength(n.len,(null==t?void 0:t.duration)||10);var a=!i;return a&&this.warn("Buffer full error while media.currentTime (".concat(this.getLoadPosition(),") is not buffered, flush ").concat(r," buffer")),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),a}return!1}},{key:"resetFragmentErrors",value:function(e){e===ar&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==so&&(this.state=lo)}},{key:"afterBufferFlushed",value:function(e,t,r){if(e){var n=Yi.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,n,r),this.state===vo&&this.resetLoadingState()}}},{key:"resetLoadingState",value:function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==so&&(this.state=lo)}},{key:"resetStartWhenNotLoaded",value:function(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;var e=this.levelLastLoaded,t=e?e.details:null;null!=t&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}},{key:"resetWhenMissingContext",value:function(e){this.log("Loading context changed while buffering sn ".concat(e.sn," of ").concat(this.playlistLabel()," ").concat(-1===e.level?"<removed>":e.level,". This chunk will not be buffered.")),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}},{key:"removeUnbufferedFrags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}},{key:"updateLevelTiming",value:function(e,t,r,n){var i=this,a=r.details;if(a){var o;if(!Object.keys(e.elementaryStreams).reduce((function(t,o){var s=e.elementaryStreams[o];if(s){var l=s.endPTS-s.startPTS;if(l<=0)return i.warn("Could not parse fragment ".concat(e.sn," ").concat(o," duration reliably (").concat(l,")")),t||!1;var u=n?0:Ga(a,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS,i);return i.hls.trigger($t.LEVEL_PTS_UPDATED,{details:a,level:r,drift:u,type:o,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t}),!1)&&(0===r.fragmentError&&this.treatAsGap(e,r),null===(null==(o=this.transmuxer)?void 0:o.error))){var s=new Error("Found no media in fragment ".concat(e.sn," of ").concat(this.playlistLabel()," ").concat(e.level," resetting transmuxer to fallback to playlist timing"));if(this.warn(s.message),this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_PARSING_ERROR,fatal:!1,error:s,frag:e,reason:"Found no media in msn ".concat(e.sn," of ").concat(this.playlistLabel(),' "').concat(r.url,'"')}),!this.hls)return;this.resetTransmuxer()}this.state=go,this.log("Parsed ".concat(e.type," sn: ").concat(e.sn).concat(t?" part: "+t.index:""," of ").concat(this.fragInfo(e,!1,t),")")),this.hls.trigger($t.FRAG_PARSED,{frag:e,part:t})}else this.warn("level.details undefined")}},{key:"playlistLabel",value:function(){return this.playlistType===ir?"level":"track"}},{key:"fragInfo",value:function(e){var t,r,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;return"".concat(this.playlistLabel()," ").concat(e.level," (").concat(i?"part":"frag",":[").concat((null!=(t=n&&!i?e.startPTS:(i||e).start)?t:NaN).toFixed(3),"-").concat((null!=(r=n&&!i?e.endPTS:(i||e).end)?r:NaN).toFixed(3),"]").concat(i&&"main"===e.type?"INDEPENDENT="+(i.independent?"YES":"NO"):"")}},{key:"treatAsGap",value:function(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}},{key:"resetTransmuxer",value:function(){var e;null==(e=this.transmuxer)||e.reset()}},{key:"recoverWorkerError",value:function(e){"demuxerWorker"===e.event&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}},{key:"startPositionValue",get:function(){var e=this.nextLoadPosition,t=this.startPosition;return-1===t&&e?e:t}},{key:"bufferingEnabled",get:function(){return this.buffering}},{key:"inFlightFrag",get:function(){return{frag:this.fragCurrent,state:this.state}}},{key:"timelineOffset",get:function(){var e,t=this.config.timelineOffset;return t?(null==(e=this.getLevelDetails())?void 0:e.appliedTimelineOffset)||t:0}},{key:"primaryPrefetch",get:function(){var e;return!(!Eo(this.config)||!(null==(e=this.hls.interstitialsManager)||null==(e=e.playingItem)?void 0:e.event))}},{key:"state",set:function(e){var t=this._state;t!==e&&(this._state=e,this.log("".concat(t,"->").concat(e)))},get:function(){return this._state}}]),r}(Ui);function Eo(e){return!!e.interstitialsController&&!1!==e.enableInterstitialPlayback}var ko,To=function(){function e(){h(this,e),this.chunks=[],this.dataLength=0}return p(e,[{key:"push",value:function(e){this.chunks.push(e),this.dataLength+=e.length}},{key:"flush",value:function(){var e,t=this.chunks,r=this.dataLength;return t.length?(e=1===t.length?t[0]:function(e,t){for(var r=new Uint8Array(t),n=0,i=0;i<e.length;i++){var a=e[i];r.set(a,n),n+=a.length}return r}(t,r),this.reset(),e):new Uint8Array(0)}},{key:"reset",value:function(){this.chunks.length=0,this.dataLength=0}}]),e}(),So={exports:{}},wo=function(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}((ko||(ko=1,function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function a(e,t,n,a,o){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new i(n,a||e,o),l=r?r+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],s]:e._events[l].push(s):(e._events[l]=s,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,a=n.length,o=new Array(a);i<a;i++)o[i]=n[i].fn;return o},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,a,o){var s=r?r+e:e;if(!this._events[s])return!1;var l,u,c=this._events[s],f=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),f){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,i),!0;case 5:return c.fn.call(c.context,t,n,i,a),!0;case 6:return c.fn.call(c.context,t,n,i,a,o),!0}for(u=1,l=new Array(f-1);u<f;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var d,h=c.length;for(u=0;u<h;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),f){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,n);break;case 4:c[u].fn.call(c[u].context,t,n,i);break;default:if(!l)for(d=1,l=new Array(f-1);d<f;d++)l[d-1]=arguments[d];c[u].fn.apply(c[u].context,l)}}return!0},s.prototype.on=function(e,t,r){return a(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return a(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var a=r?r+e:e;if(!this._events[a])return this;if(!t)return o(this,a),this;var s=this._events[a];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||o(this,a);else{for(var l=0,u=[],c=s.length;l<c;l++)(s[l].fn!==t||i&&!s[l].once||n&&s[l].context!==n)&&u.push(s[l]);u.length?this._events[a]=1===u.length?u[0]:u:o(this,a)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s}(So)),So.exports)),_o="1.6.13",Lo={};function Po(e,t){return t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Io(e,t){return t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128}function Ro(e,t){var r=0;return r=(127&e[t])<<21,r|=(127&e[t+1])<<14,(r|=(127&e[t+2])<<7)|127&e[t+3]}function Co(e,t){for(var r=t,n=0;Io(e,t);)n+=10,n+=Ro(e,t+6),Po(e,t+10)&&(n+=10),t+=n;if(n>0)return e.subarray(r,r+n)}function Do(e,t){return 255===e[t]&&240==(246&e[t+1])}function Oo(e,t){return 1&e[t+1]?7:9}function zo(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function Mo(e,t){return t+1<e.length&&Do(e,t)}function xo(e,t){if(Mo(e,t)){var r=Oo(e,t);if(t+r>=e.length)return!1;var n=zo(e,t);if(n<=r)return!1;var i=t+n;return i===e.length||Mo(e,i)}return!1}function Bo(e,t,r,n,i){if(!e.samplerate){var a=function(e,t,r,n){var i=t[r+2],a=i>>2&15;if(!(a>12)){var o=1+(i>>6&3),s=t[r+3]>>6&3|(1&i)<<2,l="mp4a.40."+o,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][a],c=a;5!==o&&29!==o||(c-=3);var f=[o<<3|(14&c)>>1,(1&c)<<7|s<<3];return Ar.log("manifest codec:".concat(n,", parsed codec:").concat(l,", channels:").concat(s,", rate:").concat(u," (ADTS object type:").concat(o," sampling index:").concat(a,")")),{config:f,samplerate:u,channelCount:s,codec:l,parsedCodec:l,manifestCodec:n}}var d=new Error("invalid ADTS sampling index:".concat(a));e.emit($t.ERROR,$t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_PARSING_ERROR,fatal:!0,error:d,reason:d.message})}(t,r,n,i);if(!a)return;cr(e,a)}}function Fo(e){return 9216e4/e}function No(e,t,r,n,i){var a,o=n+i*Fo(e.samplerate),s=function(e,t){var r=Oo(e,t);if(t+r<=e.length){var n=zo(e,t)-r;if(n>0)return{headerLength:r,frameLength:n}}}(t,r);if(s){var l=s.frameLength,u=s.headerLength,c=u+l,f=Math.max(0,r+c-t.length);f?(a=new Uint8Array(c-u)).set(t.subarray(r+u,t.length),0):a=t.subarray(r+u,r+c);var d={unit:a,pts:o};return f||e.samples.push(d),{sample:d,length:c,missing:f}}var h=t.length-r;return(a=new Uint8Array(h)).set(t.subarray(r,t.length),0),{sample:{unit:a,pts:o},length:h,missing:-1}}function Uo(e,t){return Io(e,t)&&Ro(e,t+6)+10<=e.length-t}function jo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return function(e,t,r,n){var i,a=(i=e)instanceof ArrayBuffer?i:i.buffer,o=1;"BYTES_PER_ELEMENT"in n&&(o=n.BYTES_PER_ELEMENT);var s,l=(s=e)&&s.buffer instanceof ArrayBuffer&&void 0!==s.byteLength&&void 0!==s.byteOffset?e.byteOffset:0,u=(l+e.byteLength)/o,c=(l+t)/o,f=Math.floor(Math.max(0,Math.min(c,u)));return new n(a,f,Math.floor(Math.min(f+Math.max(r,0),u))-f)}(e,t,r,Uint8Array)}function Go(e){return"PRIV"===e.type?function(e){if(!(e.size<2)){var t=kr(e.data,!0),r=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:r.buffer}}}(e):"W"===e.type[0]?function(e){if("WXXX"===e.type){if(e.size<2)return;var t=1,r=kr(e.data.subarray(t),!0);t+=r.length+1;var n=kr(e.data.subarray(t));return{key:e.type,info:r,data:n}}var i=kr(e.data);return{key:e.type,info:"",data:i}}(e):"APIC"===e.type?function(e){var t={key:e.type,description:"",data:"",mimeType:null,pictureType:null};if(!(e.size<2))if(3===e.data[0]){var r=e.data.subarray(1).indexOf(0);if(-1!==r){var n=kr(jo(e.data,1,r)),i=e.data[2+r],a=e.data.subarray(3+r).indexOf(0);if(-1!==a){var o,s,l=kr(jo(e.data,3+r,a));return o="--\x3e"===n?kr(jo(e.data,4+r+a)):(s=e.data.subarray(4+r+a))instanceof ArrayBuffer?s:0==s.byteOffset&&s.byteLength==s.buffer.byteLength?s.buffer:new Uint8Array(s).buffer,t.mimeType=n,t.pictureType=i,t.description=l,t.data=o,t}}}else console.log("Ignore frame with unrecognized character encoding")}(e):function(e){if(!(e.size<2)){if("TXXX"===e.type){var t=1,r=kr(e.data.subarray(t),!0);t+=r.length+1;var n=kr(e.data.subarray(t));return{key:e.type,info:r,data:n}}var i=kr(e.data.subarray(1));return{key:e.type,info:"",data:i}}}(e)}function Yo(e){var t=String.fromCharCode(e[0],e[1],e[2],e[3]),r=Ro(e,4);return{type:t,size:r,data:e.subarray(10,10+r)}}function Vo(e){for(var t=0,r=[];Io(e,t);){var n=Ro(e,t+6);e[t+5]>>6&1&&(t+=10);for(var i=(t+=10)+n;t+10<i;){var a=Yo(e.subarray(t)),o=Go(a);o&&r.push(o),t+=a.size+10}Po(e,t)&&(t+=10)}return r}function Ho(e){return e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info}function Ko(e){if(8===e.data.byteLength){var t=new Uint8Array(e.data),r=1&t[3],n=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return n/=45,r&&(n+=47721858.84),Math.round(n)}}function Qo(e){for(var t=Vo(e),r=0;r<t.length;r++){var n=t[r];if(Ho(n))return Ko(n)}}var Wo=function(e){return e.audioId3="org.id3",e.dateRange="com.apple.quicktime.HLS",e.emsg="https://aomedia.org/emsg/ID3",e.misbklv="urn:misb:KLV:bin:1910.1",e}({});function qo(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9e4;return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}var Xo=function(){function e(){h(this,e),this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}return p(e,[{key:"resetInitSegment",value:function(e,t,r,n){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}},{key:"resetTimeStamp",value:function(e){this.initPTS=e,this.resetContiguity()}},{key:"resetContiguity",value:function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}},{key:"canParse",value:function(e,t){return!1}},{key:"appendFrame",value:function(e,t,r){}},{key:"demux",value:function(e,t){this.cachedData&&(e=on(this.cachedData,e),this.cachedData=null);var r,n=Co(e,0),i=n?n.length:0,a=this._audioTrack,o=this._id3Track,s=n?Qo(n):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&Wt(s))&&(this.basePTS=Jo(s,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),n&&n.length>0&&o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Wo.audioId3,duration:Number.POSITIVE_INFINITY});i<l;){if(this.canParse(e,i)){var u=this.appendFrame(a,e,i);u?(this.frameIndex++,this.lastPTS=u.sample.pts,r=i+=u.length):i=l}else Uo(e,i)?(n=Co(e,i),o.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:n,type:Wo.audioId3,duration:Number.POSITIVE_INFINITY}),r=i+=n.length):i++;if(i===l&&r!==l){var c=e.slice(r);this.cachedData?this.cachedData=on(this.cachedData,c):this.cachedData=c}}return{audioTrack:a,videoTrack:qo(),id3Track:o,textTrack:qo()}}},{key:"demuxSampleAes",value:function(e,t,r){return Promise.reject(new Error("[".concat(this,"] This demuxer does not support Sample-AES decryption")))}},{key:"flush",value:function(e){var t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:qo(),id3Track:this._id3Track,textTrack:qo()}}},{key:"destroy",value:function(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}]),e}(),Jo=function(e,t,r){return Wt(e)?90*e:9e4*t+(r?9e4*r.baseTime/r.timescale:0)},Zo=null,$o=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],es=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ts=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],rs=[0,1,1,4];function ns(e,t,r,n,i){if(!(r+24>t.length)){var a=is(t,r);if(a&&r+a.frameLength<=t.length){var o=n+i*(9e4*a.samplesPerFrame/a.sampleRate),s={unit:t.subarray(r,r+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(s),{sample:s,length:a.frameLength,missing:0}}}}function is(e,t){var r=e[t+1]>>3&3,n=e[t+1]>>1&3,i=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==r&&0!==i&&15!==i&&3!==a){var o=e[t+2]>>1&1,s=e[t+3]>>6,l=1e3*$o[14*(3===r?3-n:3===n?3:4)+i-1],u=es[3*(3===r?0:2===r?1:2)+a],c=3===s?1:2,f=ts[r][n],d=rs[n],h=8*f*d,p=Math.floor(f*l/u+o)*d;if(null===Zo){var g=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Zo=g?parseInt(g[1]):0}return!!Zo&&Zo<=87&&2===n&&l>=224e3&&0===s&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:c,frameLength:p,samplesPerFrame:h}}}function as(e,t){return 255===e[t]&&224==(224&e[t+1])&&0!=(6&e[t+1])}function os(e,t){return t+1<e.length&&as(e,t)}function ss(e,t){if(t+1<e.length&&as(e,t)){var r=is(e,t),n=4;null!=r&&r.frameLength&&(n=r.frameLength);var i=t+n;return i===e.length||os(e,i)}return!1}var ls=function(e,t){var r=0,n=5;t+=n;for(var i=new Uint32Array(1),a=new Uint32Array(1),o=new Uint8Array(1);n>0;){o[0]=e[t];var s=Math.min(n,8),l=8-s;a[0]=4278190080>>>24+l<<l,i[0]=(o[0]&a[0])>>l,r=r?r<<s|i[0]:i[0],t+=1,n-=s}return r},us=function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this)).observer=void 0,n.observer=e,n}return p(r,[{key:"resetInitSegment",value:function(e,t,n,i){o(s(r.prototype),"resetInitSegment",this).call(this,e,t,n,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return t+64<e.length}},{key:"appendFrame",value:function(e,t,r){var n=cs(e,t,r,this.basePTS,this.frameIndex);if(-1!==n)return{sample:e.samples[e.samples.length-1],length:n,missing:0}}}],[{key:"probe",value:function(e){if(!e)return!1;var t=Co(e,0);if(!t)return!1;var r=t.length;return 11===e[r]&&119===e[r+1]&&void 0!==Qo(t)&&ls(e,r)<16}}]),r}(Xo);function cs(e,t,r,n,i){if(r+8>t.length)return-1;if(11!==t[r]||119!==t[r+1])return-1;var a=t[r+4]>>6;if(a>=3)return-1;var o=[48e3,44100,32e3][a],s=63&t[r+4],l=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*s+a];if(r+l>t.length)return-1;var u=t[r+6]>>5,c=0;2===u?c+=2:(1&u&&1!==u&&(c+=2),4&u&&(c+=2));var f=(t[r+6]<<8|t[r+7])>>12-c&1,d=[2,1,2,3,3,4,4,5][u]+f,h=t[r+5]>>3,p=7&t[r+5],g=new Uint8Array([a<<6|h<<1|p>>2,(3&p)<<6|u<<3|f<<2|s>>4,s<<4&224]),v=n+i*(1536/o*9e4),y=t.subarray(r,r+l);return e.config=g,e.channelCount=d,e.samplerate=o,e.samples.push({unit:y,pts:v}),l}var fs=/\/emsg[-\/]ID3/i;function ds(e,t){return Wt(e.presentationTime)?e.presentationTime/e.timeScale:t+e.presentationTimeDelta/e.timeScale}var hs=function(){function e(t,r,n){h(this,e),this.keyData=void 0,this.decrypter=void 0,this.keyData=n,this.decrypter=new zi(r,{removePKCS7Padding:!1})}return p(e,[{key:"decryptBuffer",value:function(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,Ii)}},{key:"decryptAacSample",value:function(e,t,r){var n=this,i=e[t].unit;if(!(i.length<=16)){var a=i.subarray(16,i.length-i.length%16),o=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(o).then((function(a){var o=new Uint8Array(a);i.set(o,16),n.decrypter.isSync()||n.decryptAacSamples(e,t+1,r)})).catch(r)}}},{key:"decryptAacSamples",value:function(e,t,r){for(;;t++){if(t>=e.length)return void r();if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}},{key:"getAvcEncryptedData",value:function(e){for(var t=16*Math.floor((e.length-48)/160)+16,r=new Int8Array(t),n=0,i=32;i<e.length-16;i+=160,n+=16)r.set(e.subarray(i,i+16),n);return r}},{key:"getAvcDecryptedUnit",value:function(e,t){for(var r=new Uint8Array(t),n=0,i=32;i<e.length-16;i+=160,n+=16)e.set(r.subarray(n,n+16),i);return e}},{key:"decryptAvcSample",value:function(e,t,r,n,i){var a=this,o=fn(i.data),s=this.getAvcEncryptedData(o);this.decryptBuffer(s.buffer).then((function(s){i.data=a.getAvcDecryptedUnit(o,s),a.decrypter.isSync()||a.decryptAvcSamples(e,t,r+1,n)})).catch(n)}},{key:"decryptAvcSamples",value:function(e,t,r,n){if(e instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length)return void n();for(var i=e[t].units;!(r>=i.length);r++){var a=i[r];if(!(a.data.length<=48||1!==a.type&&5!==a.type||(this.decryptAvcSample(e,t,r,n,a),this.decrypter.isSync())))return}}}}]),e}(),ps=function(){function e(){h(this,e),this.VideoSample=null}return p(e,[{key:"createVideoSample",value:function(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}},{key:"getLastNalUnit",value:function(e){var t,r,n=this.VideoSample;if(n&&0!==n.units.length||(n=e[e.length-1]),null!=(t=n)&&t.units){var i=n.units;r=i[i.length-1]}return r}},{key:"pushAccessUnit",value:function(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){var r=t.samples,n=r.length;if(!n)return void t.dropped++;var i=r[n-1];e.pts=i.pts,e.dts=i.dts}t.samples.push(e)}}},{key:"parseNALu",value:function(e,t,r){var n,i,a=t.byteLength,o=e.naluState||0,s=o,l=[],u=0,c=-1,f=0;for(-1===o&&(c=0,f=this.getNALuType(t,0),o=0,u=1);u<a;)if(n=t[u++],o)if(1!==o)if(n)if(1===n){if(i=u-o-1,c>=0){var d={data:t.subarray(c,i),type:f};l.push(d)}else{var h=this.getLastNalUnit(e.samples);h&&(s&&u<=4-s&&h.state&&(h.data=h.data.subarray(0,h.data.byteLength-s)),i>0&&(h.data=on(h.data,t.subarray(0,i)),h.state=0))}u<a?(c=u,f=this.getNALuType(t,u),o=0):o=-1}else o=0;else o=3;else o=n?0:2;else o=n?0:1;if(c>=0&&o>=0){var p={data:t.subarray(c,a),type:f,state:o};l.push(p)}if(0===l.length){var g=this.getLastNalUnit(e.samples);g&&(g.data=on(g.data,t))}return e.naluState=o,l}}]),e}(),gs=function(){function e(t){h(this,e),this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=t,this.bytesAvailable=t.byteLength,this.word=0,this.bitsAvailable=0}return p(e,[{key:"loadWord",value:function(){var e=this.data,t=this.bytesAvailable,r=e.byteLength-t,n=new Uint8Array(4),i=Math.min(4,t);if(0===i)throw new Error("no bytes available");n.set(e.subarray(r,r+i)),this.word=new DataView(n.buffer).getUint32(0),this.bitsAvailable=8*i,this.bytesAvailable-=i}},{key:"skipBits",value:function(e){var t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e?(this.word<<=e,this.bitsAvailable-=e):(e-=this.bitsAvailable,e-=(t=e>>3)<<3,this.bytesAvailable-=t,this.loadWord(),this.word<<=e,this.bitsAvailable-=e)}},{key:"readBits",value:function(e){var t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&Ar.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}},{key:"skipLZ",value:function(){var e;for(e=0;e<this.bitsAvailable;++e)if(0!=(this.word&2147483648>>>e))return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}},{key:"skipUEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"skipEG",value:function(){this.skipBits(1+this.skipLZ())}},{key:"readUEG",value:function(){var e=this.skipLZ();return this.readBits(e+1)-1}},{key:"readEG",value:function(){var e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}},{key:"readBoolean",value:function(){return 1===this.readBits(1)}},{key:"readUByte",value:function(){return this.readBits(8)}},{key:"readUShort",value:function(){return this.readBits(16)}},{key:"readUInt",value:function(){return this.readBits(32)}}]),e}(),vs=function(e){c(r,e);var t=f(r);function r(){return h(this,r),t.apply(this,arguments)}return p(r,[{key:"parsePES",value:function(e,t,r,n){var i,a=this,o=this.parseNALu(e,r.data,n),s=this.VideoSample,l=!1;r.data=null,s&&o.length&&!e.audFound&&(this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach((function(n){var o,u;switch(n.type){case 1:var c=!1;i=!0;var f,d=n.data;if(l&&d.length>4){var h=a.readSliceType(d);2!==h&&4!==h&&7!==h&&9!==h||(c=!0)}c&&null!=(f=s)&&f.frame&&!s.key&&(a.pushAccessUnit(s,e),s=a.VideoSample=null),s||(s=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),s.frame=!0,s.key=c;break;case 5:i=!0,null!=(o=s)&&o.frame&&!s.key&&(a.pushAccessUnit(s,e),s=a.VideoSample=null),s||(s=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),s.key=!0,s.frame=!0;break;case 6:i=!0,cn(n.data,1,r.pts,t.samples);break;case 7:var p,g;i=!0,l=!0;var v=n.data,y=a.readSPS(v);if(!e.sps||e.width!==y.width||e.height!==y.height||(null==(p=e.pixelRatio)?void 0:p[0])!==y.pixelRatio[0]||(null==(g=e.pixelRatio)?void 0:g[1])!==y.pixelRatio[1]){e.width=y.width,e.height=y.height,e.pixelRatio=y.pixelRatio,e.sps=[v];for(var m=v.subarray(1,4),A="avc1.",b=0;b<3;b++){var E=m[b].toString(16);E.length<2&&(E="0"+E),A+=E}e.codec=A}break;case 8:i=!0,e.pps=[n.data];break;case 9:i=!0,e.audFound=!0,null!=(u=s)&&u.frame&&(a.pushAccessUnit(s,e),s=null),s||(s=a.VideoSample=a.createVideoSample(!1,r.pts,r.dts));break;case 12:i=!0;break;default:i=!1}s&&i&&s.units.push(n)})),n&&s&&(this.pushAccessUnit(s,e),this.VideoSample=null)}},{key:"getNALuType",value:function(e,t){return 31&e[t]}},{key:"readSliceType",value:function(e){var t=new gs(e);return t.readUByte(),t.readUEG(),t.readUEG()}},{key:"skipScalingList",value:function(e,t){for(var r=8,n=8,i=0;i<e;i++)0!==n&&(n=(r+t.readEG()+256)%256),r=0===n?r:n}},{key:"readSPS",value:function(e){var t,r,n,i=new gs(e),a=0,o=0,s=0,l=0,u=i.readUByte.bind(i),c=i.readBits.bind(i),f=i.readUEG.bind(i),d=i.readBoolean.bind(i),h=i.skipBits.bind(i),p=i.skipEG.bind(i),g=i.skipUEG.bind(i),v=this.skipScalingList.bind(this);u();var y=u();if(c(5),h(3),u(),g(),100===y||110===y||122===y||244===y||44===y||83===y||86===y||118===y||128===y){var m=f();if(3===m&&h(1),g(),g(),h(1),d())for(r=3!==m?8:12,n=0;n<r;n++)d()&&v(n<6?16:64,i)}g();var A=f();if(0===A)f();else if(1===A)for(h(1),p(),p(),t=f(),n=0;n<t;n++)p();g(),h(1);var b=f(),E=f(),k=c(1);0===k&&h(1),h(1),d()&&(a=f(),o=f(),s=f(),l=f());var T=[1,1];if(d()&&d())switch(u()){case 1:T=[1,1];break;case 2:T=[12,11];break;case 3:T=[10,11];break;case 4:T=[16,11];break;case 5:T=[40,33];break;case 6:T=[24,11];break;case 7:T=[20,11];break;case 8:T=[32,11];break;case 9:T=[80,33];break;case 10:T=[18,11];break;case 11:T=[15,11];break;case 12:T=[64,33];break;case 13:T=[160,99];break;case 14:T=[4,3];break;case 15:T=[3,2];break;case 16:T=[2,1];break;case 255:T=[u()<<8|u(),u()<<8|u()]}return{width:Math.ceil(16*(b+1)-2*a-2*o),height:(2-k)*(E+1)*16-(k?2:4)*(s+l),pixelRatio:T}}}]),r}(ps),ys=function(e){c(r,e);var t=f(r);function r(){var e;h(this,r);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(e=t.call.apply(t,[this].concat(i))).initVPS=null,e}return p(r,[{key:"parsePES",value:function(e,t,r,n){var i,a=this,o=this.parseNALu(e,r.data,n),s=this.VideoSample,l=!1;r.data=null,s&&o.length&&!e.audFound&&(this.pushAccessUnit(s,e),s=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),o.forEach((function(n){var o,u;switch(n.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:s||(s=a.VideoSample=a.createVideoSample(!1,r.pts,r.dts)),s.frame=!0,i=!0;break;case 16:case 17:case 18:case 21:var c;i=!0,l&&null!=(c=s)&&c.frame&&!s.key&&(a.pushAccessUnit(s,e),s=a.VideoSample=null),s||(s=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),s.key=!0,s.frame=!0;break;case 19:case 20:i=!0,null!=(o=s)&&o.frame&&!s.key&&(a.pushAccessUnit(s,e),s=a.VideoSample=null),s||(s=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),s.key=!0,s.frame=!0;break;case 39:i=!0,cn(n.data,2,r.pts,t.samples);break;case 32:i=!0,e.vps||("object"!=typeof e.params&&(e.params={}),e.params=cr(e.params,a.readVPS(n.data)),a.initVPS=n.data),e.vps=[n.data];break;case 33:if(i=!0,l=!0,void 0===e.vps||e.vps[0]===a.initVPS||void 0===e.sps||a.matchSPS(e.sps[0],n.data)||(a.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){var f=a.readSPS(n.data);for(var d in e.width=f.width,e.height=f.height,e.pixelRatio=f.pixelRatio,e.codec=f.codecString,e.sps=[],"object"!=typeof e.params&&(e.params={}),f.params)e.params[d]=f.params[d]}a.pushParameterSet(e.sps,n.data,e.vps),s||(s=a.VideoSample=a.createVideoSample(!0,r.pts,r.dts)),s.key=!0;break;case 34:if(i=!0,"object"==typeof e.params){if(!e.pps){e.pps=[];var h=a.readPPS(n.data);for(var p in h)e.params[p]=h[p]}a.pushParameterSet(e.pps,n.data,e.vps)}break;case 35:i=!0,e.audFound=!0,null!=(u=s)&&u.frame&&(a.pushAccessUnit(s,e),s=null),s||(s=a.VideoSample=a.createVideoSample(!1,r.pts,r.dts));break;default:i=!1}s&&i&&s.units.push(n)})),n&&s&&(this.pushAccessUnit(s,e),this.VideoSample=null)}},{key:"pushParameterSet",value:function(e,t,r){(r&&r[0]===this.initVPS||!r&&!e.length)&&e.push(t)}},{key:"getNALuType",value:function(e,t){return(126&e[t])>>>1}},{key:"ebsp2rbsp",value:function(e){for(var t=new Uint8Array(e.byteLength),r=0,n=0;n<e.byteLength;n++)n>=2&&3===e[n]&&0===e[n-1]&&0===e[n-2]||(t[r]=e[n],r++);return new Uint8Array(t.buffer,0,r)}},{key:"pushAccessUnit",value:function(e,t){o(s(r.prototype),"pushAccessUnit",this).call(this,e,t),this.initVPS&&(this.initVPS=null)}},{key:"readVPS",value:function(e){var t=new gs(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}}},{key:"readSPS",value:function(e){var t=new gs(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);var r=t.readBits(3);t.readBoolean();for(var n=t.readBits(2),i=t.readBoolean(),a=t.readBits(5),o=t.readUByte(),s=t.readUByte(),l=t.readUByte(),u=t.readUByte(),c=t.readUByte(),f=t.readUByte(),d=t.readUByte(),h=t.readUByte(),p=t.readUByte(),g=t.readUByte(),v=t.readUByte(),y=[],m=[],A=0;A<r;A++)y.push(t.readBoolean()),m.push(t.readBoolean());if(r>0)for(var b=r;b<8;b++)t.readBits(2);for(var E=0;E<r;E++)y[E]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),m[E]&&t.readUByte();t.readUEG();var k=t.readUEG();3==k&&t.skipBits(1);var T=t.readUEG(),S=t.readUEG(),w=t.readBoolean(),_=0,L=0,P=0,I=0;w&&(_+=t.readUEG(),L+=t.readUEG(),P+=t.readUEG(),I+=t.readUEG());for(var R=t.readUEG(),C=t.readUEG(),D=t.readUEG(),O=t.readBoolean()?0:r;O<=r;O++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(var z=0;z<4;z++)for(var M=0;M<(3===z?2:6);M++)if(t.readBoolean()){var x=Math.min(64,1<<4+(z<<1));z>1&&t.readEG();for(var B=0;B<x;B++)t.readEG()}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());for(var F=t.readUEG(),N=0,U=0;U<F;U++){var j=!1;if(0!==U&&(j=t.readBoolean()),j){U===F&&t.readUEG(),t.readBoolean(),t.readUEG();for(var G=0,Y=0;Y<=N;Y++){var V=t.readBoolean(),H=!1;V||(H=t.readBoolean()),(V||H)&&G++}N=G}else{var K=t.readUEG(),Q=t.readUEG();N=K+Q;for(var W=0;W<K;W++)t.readUEG(),t.readBoolean();for(var q=0;q<Q;q++)t.readUEG(),t.readBoolean()}}if(t.readBoolean())for(var X=t.readUEG(),J=0;J<X;J++){for(var Z=0;Z<D+4;Z++)t.readBits(1);t.readBits(1)}var $=0,ee=1,te=1,re=!0,ne=1,ie=0;if(t.readBoolean(),t.readBoolean(),t.readBoolean()){if(t.readBoolean()){var ae=t.readUByte();ae>0&&ae<16?(ee=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][ae-1],te=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][ae-1]):255===ae&&(ee=t.readBits(16),te=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(ne=t.readBits(32),ie=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){var oe=t.readBoolean(),se=t.readBoolean(),le=!1;(oe||se)&&((le=t.readBoolean())&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),le&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(var ue=0;ue<=r;ue++){var ce=!1;(re=t.readBoolean())||t.readBoolean()?t.readEG():ce=t.readBoolean();var fe=ce?1:t.readUEG()+1;if(oe)for(var de=0;de<fe;de++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(se)for(var he=0;he<fe;he++)t.readUEG(),t.readUEG(),le&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),$=t.readUEG())}var pe=T,ge=S;if(w){var ve=1,ye=1;1===k?ve=ye=2:2==k&&(ve=2),pe=T-ve*L-ve*_,ge=S-ye*I-ye*P}for(var me=n?["A","B","C"][n]:"",Ae=o<<24|s<<16|l<<8|u,be=0,Ee=0;Ee<32;Ee++)be=(be|(Ae>>Ee&1)<<31-Ee)>>>0;var ke=be.toString(16);return 1===a&&"2"===ke&&(ke="6"),{codecString:"hvc1.".concat(me).concat(a,".").concat(ke,".").concat(i?"H":"L").concat(v,".B0"),params:{general_tier_flag:i,general_profile_idc:a,general_profile_space:n,general_profile_compatibility_flags:[o,s,l,u],general_constraint_indicator_flags:[c,f,d,h,p,g],general_level_idc:v,bit_depth:R+8,bit_depth_luma_minus8:R,bit_depth_chroma_minus8:C,min_spatial_segmentation_idc:$,chroma_format_idc:k,frame_rate:{fixed:re,fps:ie/ne}},width:pe,height:ge,pixelRatio:[ee,te]}}},{key:"readPPS",value:function(e){var t=new gs(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);var r=t.readBoolean(),n=t.readBoolean(),i=1;return n&&r?i=0:n?i=3:r&&(i=2),{parallelismType:i}}},{key:"matchSPS",value:function(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}]),r}(ps),ms=188,As=function(){function e(t,r,n,i){h(this,e),this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=t,this.config=r,this.typeSupported=n,this.logger=i,this.videoParser=null}return p(e,[{key:"resetInitSegment",value:function(t,r,n,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=e.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=e.createTrack("audio",i),this._id3Track=e.createTrack("id3"),this._txtTrack=e.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=r,this.videoCodec=n}},{key:"resetTimeStamp",value:function(){}},{key:"resetContiguity",value:function(){var e=this._audioTrack,t=this._videoTrack,r=this._id3Track;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}},{key:"demux",value:function(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];i||(this.sampleAes=null);var o=this._videoTrack,s=this._audioTrack,l=this._id3Track,u=this._txtTrack,c=o.pid,f=o.pesData,d=s.pid,h=l.pid,p=s.pesData,g=l.pesData,v=null,y=this.pmtParsed,m=this._pmtId,A=t.length;if(this.remainderData&&(A=(t=on(this.remainderData,t)).length,this.remainderData=null),A<ms&&!a)return this.remainderData=t,{audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};var b=Math.max(0,e.syncOffset(t));(A-=(A-b)%ms)<t.byteLength&&!a&&(this.remainderData=new Uint8Array(t.buffer,A,t.buffer.byteLength-A));for(var E=0,k=b;k<A;k+=ms)if(71===t[k]){var T=!!(64&t[k+1]),S=bs(t,k),w=void 0;if((48&t[k+3])>>4>1){if((w=k+5+t[k+4])===k+ms)continue}else w=k+4;switch(S){case c:T&&(f&&(n=ws(f,this.logger))&&(this.readyVideoParser(o.segmentCodec),null!==this.videoParser&&this.videoParser.parsePES(o,u,n,!1)),f={data:[],size:0}),f&&(f.data.push(t.subarray(w,k+ms)),f.size+=k+ms-w);break;case d:if(T){if(p&&(n=ws(p,this.logger)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,n);break;case"mp3":this.parseMPEGPES(s,n);break;case"ac3":this.parseAC3PES(s,n)}p={data:[],size:0}}p&&(p.data.push(t.subarray(w,k+ms)),p.size+=k+ms-w);break;case h:T&&(g&&(n=ws(g,this.logger))&&this.parseID3PES(l,n),g={data:[],size:0}),g&&(g.data.push(t.subarray(w,k+ms)),g.size+=k+ms-w);break;case 0:T&&(w+=t[w]+1),m=this._pmtId=Es(t,w);break;case m:T&&(w+=t[w]+1);var _=ks(t,w,this.typeSupported,i,this.observer,this.logger);(c=_.videoPid)>0&&(o.pid=c,o.segmentCodec=_.segmentVideoCodec),(d=_.audioPid)>0&&(s.pid=d,s.segmentCodec=_.segmentAudioCodec),(h=_.id3Pid)>0&&(l.pid=h),null===v||y||(this.logger.warn("MPEG-TS PMT found at ".concat(k," after unknown PID '").concat(v,"'. Backtracking to sync byte @").concat(b," to parse all TS packets.")),v=null,k=b-188),y=this.pmtParsed=!0;break;case 17:case 8191:break;default:v=S}}else E++;E>0&&Ts(this.observer,new Error("Found ".concat(E," TS packet/s that do not start with 0x47")),void 0,this.logger),o.pesData=f,s.pesData=p,l.pesData=g;var L={audioTrack:s,videoTrack:o,id3Track:l,textTrack:u};return a&&this.extractRemainingSamples(L),L}},{key:"flush",value:function(){var e,t=this.remainderData;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}},{key:"extractRemainingSamples",value:function(e){var t,r=e.audioTrack,n=e.videoTrack,i=e.id3Track,a=e.textTrack,o=n.pesData,s=r.pesData,l=i.pesData;if(o&&(t=ws(o,this.logger))?(this.readyVideoParser(n.segmentCodec),null!==this.videoParser&&(this.videoParser.parsePES(n,a,t,!0),n.pesData=null)):n.pesData=o,s&&(t=ws(s,this.logger))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t);break;case"ac3":this.parseAC3PES(r,t)}r.pesData=null}else null!=s&&s.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=s;l&&(t=ws(l,this.logger))?(this.parseID3PES(i,t),i.pesData=null):i.pesData=l}},{key:"demuxSampleAes",value:function(e,t,r){var n=this.demux(e,r,!0,!this.config.progressive),i=this.sampleAes=new hs(this.observer,this.config,t);return this.decrypt(n,i)}},{key:"readyVideoParser",value:function(e){null===this.videoParser&&("avc"===e?this.videoParser=new vs:"hevc"===e&&(this.videoParser=new ys))}},{key:"decrypt",value:function(e,t){return new Promise((function(r){var n=e.audioTrack,i=e.videoTrack;n.samples&&"aac"===n.segmentCodec?t.decryptAacSamples(n.samples,0,(function(){i.samples?t.decryptAvcSamples(i.samples,0,0,(function(){r(e)})):r(e)})):i.samples&&t.decryptAvcSamples(i.samples,0,0,(function(){r(e)}))}))}},{key:"destroy",value:function(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}},{key:"parseAACPES",value:function(e,t){var r,n,i,a=0,o=this.aacOverFlow,s=t.data;if(o){this.aacOverFlow=null;var l=o.missing,u=o.sample.unit.byteLength;if(-1===l)s=on(o.sample.unit,s);else{var c=u-l;o.sample.unit.set(s.subarray(0,l),c),e.samples.push(o.sample),a=o.missing}}for(r=a,n=s.length;r<n-1&&!Mo(s,r);r++);if(r!==a){var f,d=r<n-1;if(f=d?"AAC PES did not start with ADTS header,offset:".concat(r):"No ADTS header found in AAC PES",Ts(this.observer,new Error(f),d,this.logger),!d)return}if(Bo(e,this.observer,s,r,this.audioCodec),void 0!==t.pts)i=t.pts;else{if(!o)return void this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var h=Fo(e.samplerate);i=o.sample.pts+h}for(var p,g=0;r<n;){if(r+=(p=No(e,s,r,i,g)).length,p.missing){this.aacOverFlow=p;break}for(g++;r<n-1&&!Mo(s,r);r++);}}},{key:"parseMPEGPES",value:function(e,t){var r=t.data,n=r.length,i=0,a=0,o=t.pts;if(void 0!==o)for(;a<n;)if(os(r,a)){var s=ns(e,r,a,o,i);if(!s)break;a+=s.length,i++}else a++;else this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")}},{key:"parseAC3PES",value:function(e,t){var r=t.data,n=t.pts;if(void 0!==n)for(var i,a=r.length,o=0,s=0;s<a&&(i=cs(e,r,s,n,o++))>0;)s+=i;else this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS")}},{key:"parseID3PES",value:function(e,t){if(void 0!==t.pts){var r=cr({},t,{type:this._videoTrack?Wo.emsg:Wo.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}else this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")}}],[{key:"probe",value:function(t,r){var n=e.syncOffset(t);return n>0&&r.warn("MPEG2-TS detected but first sync word found @ offset ".concat(n)),-1!==n}},{key:"syncOffset",value:function(e){for(var t=e.length,r=Math.min(940,t-ms)+1,n=0;n<r;){for(var i=!1,a=-1,o=0,s=n;s<t;s+=ms){if(71!==e[s]||t-s!==ms&&71!==e[s+ms]){if(o)return-1;break}if(o++,-1===a&&0!==(a=s)&&(r=Math.min(a+18612,e.length-ms)+1),i||(i=0===bs(e,s)),i&&o>1&&(0===a&&o>2||s+ms>r))return a}n++}return-1}},{key:"createTrack",value:function(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:Yr[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}}]),e}();function bs(e,t){return((31&e[t+1])<<8)+e[t+2]}function Es(e,t){return(31&e[t+10])<<8|e[t+11]}function ks(e,t,r,n,i,a){var o={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},s=t+3+((15&e[t+1])<<8|e[t+2])-4;for(t+=12+((15&e[t+10])<<8|e[t+11]);t<s;){var l=bs(e,t),u=(15&e[t+3])<<8|e[t+4];switch(e[t]){case 207:if(!n){Ss("ADTS AAC",a);break}case 15:-1===o.audioPid&&(o.audioPid=l);break;case 21:-1===o.id3Pid&&(o.id3Pid=l);break;case 219:if(!n){Ss("H.264",a);break}case 27:-1===o.videoPid&&(o.videoPid=l);break;case 3:case 4:r.mpeg||r.mp3?-1===o.audioPid&&(o.audioPid=l,o.segmentAudioCodec="mp3"):a.log("MPEG audio found, not supported in this browser");break;case 193:if(!n){Ss("AC-3",a);break}case 129:r.ac3?-1===o.audioPid&&(o.audioPid=l,o.segmentAudioCodec="ac3"):a.log("AC-3 audio found, not supported in this browser");break;case 6:if(-1===o.audioPid&&u>0)for(var c=t+5,f=u;f>2;){switch(e[c]){case 106:!0!==r.ac3?a.log("AC-3 audio found, not supported in this browser for now"):(o.audioPid=l,o.segmentAudioCodec="ac3")}var d=e[c+1]+2;c+=d,f-=d}break;case 194:case 135:return Ts(i,new Error("Unsupported EC-3 in M2TS found"),void 0,a),o;case 36:-1===o.videoPid&&(o.videoPid=l,o.segmentVideoCodec="hevc",a.log("HEVC in M2TS found"))}t+=u+5}return o}function Ts(e,t,r,n){n.warn("parsing error: ".concat(t.message)),e.emit($t.ERROR,$t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_PARSING_ERROR,fatal:!1,levelRetry:r,error:t,reason:t.message})}function Ss(e,t){t.log("".concat(e," with AES-128-CBC encryption found in unencrypted stream"))}function ws(e,t){var r,n,i,a,o,s=0,l=e.data;if(!e||0===e.size)return null;for(;l[0].length<19&&l.length>1;)l[0]=on(l[0],l[1]),l.splice(1,1);if(1===((r=l[0])[0]<<16)+(r[1]<<8)+r[2]){if((n=(r[4]<<8)+r[5])&&n>e.size-6)return null;var u=r[7];192&u&&(a=536870912*(14&r[9])+4194304*(255&r[10])+16384*(254&r[11])+128*(255&r[12])+(254&r[13])/2,64&u?a-(o=536870912*(14&r[14])+4194304*(255&r[15])+16384*(254&r[16])+128*(255&r[17])+(254&r[18])/2)>54e5&&(t.warn("".concat(Math.round((a-o)/9e4),"s delta between PTS and DTS, align them")),a=o):o=a);var c=(i=r[8])+9;if(e.size<=c)return null;e.size-=c;for(var f=new Uint8Array(e.size),d=0,h=l.length;d<h;d++){var p=(r=l[d]).byteLength;if(c){if(c>p){c-=p;continue}r=r.subarray(c),p-=c,c=0}f.set(r,s),s+=p}return n&&(n-=i+3),{data:f,pts:a,dts:o,len:n}}return null}var _s=function(){function e(){h(this,e)}return p(e,null,[{key:"getSilentFrame",value:function(e,t){switch(e){case"mp4a.40.2":if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}]),e}(),Ls=Math.pow(2,32)-1,Ps=function(){function e(){h(this,e)}return p(e,null,[{key:"init",value:function(){var t;for(t in e.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),n=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);e.HDLR_TYPES={video:r,audio:n};var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);e.STTS=e.STSC=e.STCO=a,e.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),e.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),e.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),e.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var o=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),l=new Uint8Array([0,0,0,1]);e.FTYP=e.box(e.types.ftyp,o,l,o,s),e.DINF=e.box(e.types.dinf,e.box(e.types.dref,i))}},{key:"box",value:function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=8,a=r.length,o=a;a--;)i+=r[a].byteLength;var s=new Uint8Array(i);for(s[0]=i>>24&255,s[1]=i>>16&255,s[2]=i>>8&255,s[3]=255&i,s.set(e,4),a=0,i=8;a<o;a++)s.set(r[a],i),i+=r[a].byteLength;return s}},{key:"hdlr",value:function(t){return e.box(e.types.hdlr,e.HDLR_TYPES[t])}},{key:"mdat",value:function(t){return e.box(e.types.mdat,t)}},{key:"mdhd",value:function(t,r){r*=t;var n=Math.floor(r/(Ls+1)),i=Math.floor(r%(Ls+1));return e.box(e.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}},{key:"mdia",value:function(t){return e.box(e.types.mdia,e.mdhd(t.timescale||0,t.duration||0),e.hdlr(t.type),e.minf(t))}},{key:"mfhd",value:function(t){return e.box(e.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))}},{key:"minf",value:function(t){return"audio"===t.type?e.box(e.types.minf,e.box(e.types.smhd,e.SMHD),e.DINF,e.stbl(t)):e.box(e.types.minf,e.box(e.types.vmhd,e.VMHD),e.DINF,e.stbl(t))}},{key:"moof",value:function(t,r,n){return e.box(e.types.moof,e.mfhd(t),e.traf(n,r))}},{key:"moov",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trak(t[r]);return e.box.apply(null,[e.types.moov,e.mvhd(t[0].timescale||0,t[0].duration||0)].concat(n).concat(e.mvex(t)))}},{key:"mvex",value:function(t){for(var r=t.length,n=[];r--;)n[r]=e.trex(t[r]);return e.box.apply(null,[e.types.mvex].concat(n))}},{key:"mvhd",value:function(t,r){r*=t;var n=Math.floor(r/(Ls+1)),i=Math.floor(r%(Ls+1)),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,n>>24,n>>16&255,n>>8&255,255&n,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return e.box(e.types.mvhd,a)}},{key:"sdtp",value:function(t){var r,n,i=t.samples||[],a=new Uint8Array(4+i.length);for(r=0;r<i.length;r++)n=i[r].flags,a[r+4]=n.dependsOn<<4|n.isDependedOn<<2|n.hasRedundancy;return e.box(e.types.sdtp,a)}},{key:"stbl",value:function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.STTS),e.box(e.types.stsc,e.STSC),e.box(e.types.stsz,e.STSZ),e.box(e.types.stco,e.STCO))}},{key:"avc1",value:function(t){var r,n,i,a=[],o=[];for(r=0;r<t.sps.length;r++)i=(n=t.sps[r]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(n));for(r=0;r<t.pps.length;r++)i=(n=t.pps[r]).byteLength,o.push(i>>>8&255),o.push(255&i),o=o.concat(Array.prototype.slice.call(n));var s=e.box(e.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|t.sps.length].concat(a).concat([t.pps.length]).concat(o))),l=t.width,u=t.height,c=t.pixelRatio[0],f=t.pixelRatio[1];return e.box(e.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,l>>8&255,255&l,u>>8&255,255&u,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,255&c,f>>24,f>>16&255,f>>8&255,255&f])))}},{key:"esds",value:function(e){var t=e.config;return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2].concat(i(t),[6,1,2]))}},{key:"audioStsd",value:function(e){var t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}},{key:"mp4a",value:function(t){return e.box(e.types.mp4a,e.audioStsd(t),e.box(e.types.esds,e.esds(t)))}},{key:"mp3",value:function(t){return e.box(e.types[".mp3"],e.audioStsd(t))}},{key:"ac3",value:function(t){return e.box(e.types["ac-3"],e.audioStsd(t),e.box(e.types.dac3,t.config))}},{key:"stsd",value:function(t){var r=t.segmentCodec;if("audio"===t.type){if("aac"===r)return e.box(e.types.stsd,e.STSD,e.mp4a(t));if("ac3"===r&&t.config)return e.box(e.types.stsd,e.STSD,e.ac3(t));if("mp3"===r&&"mp3"===t.codec)return e.box(e.types.stsd,e.STSD,e.mp3(t))}else{if(!t.pps||!t.sps)throw new Error("video track missing pps or sps");if("avc"===r)return e.box(e.types.stsd,e.STSD,e.avc1(t));if("hevc"===r&&t.vps)return e.box(e.types.stsd,e.STSD,e.hvc1(t))}throw new Error("unsupported ".concat(t.type," segment codec (").concat(r,"/").concat(t.codec,")"))}},{key:"tkhd",value:function(t){var r=t.id,n=(t.duration||0)*(t.timescale||0),i=t.width||0,a=t.height||0,o=Math.floor(n/(Ls+1)),s=Math.floor(n%(Ls+1));return e.box(e.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}},{key:"traf",value:function(t,r){var n=e.sdtp(t),i=t.id,a=Math.floor(r/(Ls+1)),o=Math.floor(r%(Ls+1));return e.box(e.types.traf,e.box(e.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),e.box(e.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,o>>24,o>>16&255,o>>8&255,255&o])),e.trun(t,n.length+16+20+8+16+8+8),n)}},{key:"trak",value:function(t){return t.duration=t.duration||4294967295,e.box(e.types.trak,e.tkhd(t),e.mdia(t))}},{key:"trex",value:function(t){var r=t.id;return e.box(e.types.trex,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}},{key:"trun",value:function(t,r){var n,i,a,o,s,l,u=t.samples||[],c=u.length,f=12+16*c,d=new Uint8Array(f);for(r+=8+f,d.set(["video"===t.type?1:0,0,15,1,c>>>24&255,c>>>16&255,c>>>8&255,255&c,r>>>24&255,r>>>16&255,r>>>8&255,255&r],0),n=0;n<c;n++)a=(i=u[n]).duration,o=i.size,s=i.flags,l=i.cts,d.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,l>>>24&255,l>>>16&255,l>>>8&255,255&l],12+16*n);return e.box(e.types.trun,d)}},{key:"initSegment",value:function(t){e.types||e.init();var r=e.moov(t);return on(e.FTYP,r)}},{key:"hvc1",value:function(t){for(var r=t.params,n=[t.vps,t.sps,t.pps],i=new Uint8Array([1,r.general_profile_space<<6|(r.general_tier_flag?32:0)|r.general_profile_idc,r.general_profile_compatibility_flags[0],r.general_profile_compatibility_flags[1],r.general_profile_compatibility_flags[2],r.general_profile_compatibility_flags[3],r.general_constraint_indicator_flags[0],r.general_constraint_indicator_flags[1],r.general_constraint_indicator_flags[2],r.general_constraint_indicator_flags[3],r.general_constraint_indicator_flags[4],r.general_constraint_indicator_flags[5],r.general_level_idc,240|r.min_spatial_segmentation_idc>>8,255&r.min_spatial_segmentation_idc,252|r.parallelismType,252|r.chroma_format_idc,248|r.bit_depth_luma_minus8,248|r.bit_depth_chroma_minus8,0,parseInt(r.frame_rate.fps),3|r.temporal_id_nested<<2|r.num_temporal_layers<<3|(r.frame_rate.fixed?64:0),n.length]),a=i.length,o=0;o<n.length;o+=1){a+=3;for(var s=0;s<n[o].length;s+=1)a+=2+n[o][s].length}var l=new Uint8Array(a);l.set(i,0),a=i.length;for(var u=n.length-1,c=0;c<n.length;c+=1){l.set(new Uint8Array([32+c|(c===u?128:0),0,n[c].length]),a),a+=3;for(var f=0;f<n[c].length;f+=1)l.set(new Uint8Array([n[c][f].length>>8,255&n[c][f].length]),a),a+=2,l.set(n[c][f],a),a+=n[c][f].length}var d=e.box(e.types.hvcC,l),h=t.width,p=t.height,g=t.pixelRatio[0],v=t.pixelRatio[1];return e.box(e.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,p>>8&255,255&p,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),d,e.box(e.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),e.box(e.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,255&g,v>>24,v>>16&255,v>>8&255,255&v])))}}]),e}();Ps.types=void 0,Ps.HDLR_TYPES=void 0,Ps.STTS=void 0,Ps.STSC=void 0,Ps.STCO=void 0,Ps.STSZ=void 0,Ps.VMHD=void 0,Ps.SMHD=void 0,Ps.STSD=void 0,Ps.FTYP=void 0,Ps.DINF=void 0;var Is=9e4;function Rs(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e*t*r;return n?Math.round(i):i}function Cs(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Rs(e,1e3,1/Is,t)}function Ds(e){var t=e.baseTime,r=e.timescale,n=e.trackId;return"".concat(t/r," (").concat(t,"/").concat(r,") trackId: ").concat(n)}var Os,zs=null,Ms=null;function xs(e,t,r,n){return{duration:t,size:r,cts:n,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:e?2:1,isNonSync:e?0:1}}}var Bs=function(e){c(r,e);var t=f(r);function r(e,i,a,o){var s;if(h(this,r),(s=t.call(this,"mp4-remuxer",o)).observer=void 0,s.config=void 0,s.typeSupported=void 0,s.ISGenerated=!1,s._initPTS=null,s._initDTS=null,s.nextVideoTs=null,s.nextAudioTs=null,s.videoSampleDuration=null,s.isAudioContiguous=!1,s.isVideoContiguous=!1,s.videoTrackConfig=void 0,s.observer=e,s.config=i,s.typeSupported=a,s.ISGenerated=!1,null===zs){var l=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);zs=l?parseInt(l[1]):0}if(null===Ms){var u=navigator.userAgent.match(/Safari\/(\d+)/i);Ms=u?parseInt(u[1]):0}return n(s)}return p(r,[{key:"destroy",value:function(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}},{key:"resetTimeStamp",value:function(e){var t=this._initPTS;t&&e&&e.trackId===t.trackId&&e.baseTime===t.baseTime&&e.timescale===t.timescale||this.log("Reset initPTS: ".concat(t?Ds(t):t," > ").concat(e?Ds(e):e)),this._initPTS=this._initDTS=e}},{key:"resetNextTimestamp",value:function(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}},{key:"resetInitSegment",value:function(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}},{key:"getVideoStartPts",value:function(e){var t=!1,r=e[0].pts,n=e.reduce((function(e,n){var i=n.pts,a=i-e;return a<-4294967296&&(t=!0,a=(i=Fs(i,r))-e),a>0?e:i}),r);return t&&this.debug("PTS rollover detected"),n}},{key:"remux",value:function(e,t,r,n,i,a,o,s){var l,u,c,f,d,h,p=i,g=i,v=e.pid>-1,y=t.pid>-1,m=t.samples.length,A=e.samples.length>0,b=o&&m>0||m>1;if((!v||A)&&(!y||b)||this.ISGenerated||o){if(this.ISGenerated){var E,k,T,S,w=this.videoTrackConfig;(w&&(t.width!==w.width||t.height!==w.height||(null==(E=t.pixelRatio)?void 0:E[0])!==(null==(k=w.pixelRatio)?void 0:k[0])||(null==(T=t.pixelRatio)?void 0:T[1])!==(null==(S=w.pixelRatio)?void 0:S[1]))||!w&&b||null===this.nextAudioTs&&A)&&this.resetInitSegment()}this.ISGenerated||(c=this.generateIS(e,t,i,a));var _,L=this.isVideoContiguous,P=-1;if(b&&(P=function(e){for(var t=0;t<e.length;t++)if(e[t].key)return t;return-1}(t.samples),!L&&this.config.forceKeyFrameOnDiscontinuity))if(h=!0,P>0){this.warn("Dropped ".concat(P," out of ").concat(m," video samples due to a missing keyframe"));var I=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(P),t.dropped+=P,_=g+=(t.samples[0].pts-I)/t.inputTimeScale}else-1===P&&(this.warn("No keyframe found out of ".concat(m," video samples")),h=!1);if(this.ISGenerated){if(A&&b){var R=this.getVideoStartPts(t.samples),C=(Fs(e.samples[0].pts,R)-R)/t.inputTimeScale;p+=Math.max(0,C),g+=Math.max(0,-C)}if(A){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),c=this.generateIS(e,t,i,a)),u=this.remuxAudio(e,p,this.isAudioContiguous,a,y||b||s===ar?g:void 0),b){var D=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),c=this.generateIS(e,t,i,a)),l=this.remuxVideo(t,g,L,D)}}else b&&(l=this.remuxVideo(t,g,L,0));l&&(l.firstKeyFrame=P,l.independent=-1!==P,l.firstKeyFramePTS=_)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(d=Ns(r,i,this._initPTS,this._initDTS)),n.samples.length&&(f=Us(n,i,this._initPTS))),{audio:u,video:l,initSegment:c,independent:h,text:f,id3:d}}},{key:"computeInitPts",value:function(e,t,r,n){var i=Math.round(r*t),a=Fs(e,i);if(a<i+t)for(this.log("Adjusting PTS for rollover in timeline near ".concat((i-a)/t," ").concat(n));a<i+t;)a+=8589934592;return a-i}},{key:"generateIS",value:function(e,t,r,n){var i,a,o,s=e.samples,l=t.samples,u=this.typeSupported,c={},f=this._initPTS,d=!f||n,h="audio/mp4",p=-1;if(d&&(i=a=1/0),e.config&&s.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":u.mpeg?(h="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}c.audio={id:"audio",container:h,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):Ps.initSegment([e]),metadata:{channelCount:e.channelCount}},d&&(p=e.id,o=e.inputTimeScale,f&&o===f.timescale?d=!1:i=a=this.computeInitPts(s[0].pts,o,r,"audio"))}if(t.sps&&t.pps&&l.length){if(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ps.initSegment([t]),metadata:{width:t.width,height:t.height}},d)if(p=t.id,o=t.inputTimeScale,f&&o===f.timescale)d=!1;else{var g=this.getVideoStartPts(l),v=Fs(l[0].dts,g),y=this.computeInitPts(v,o,r,"video"),m=this.computeInitPts(g,o,r,"video");a=Math.min(a,y),i=Math.min(i,m)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(c).length)return this.ISGenerated=!0,d?(f&&this.warn("Timestamps at playlist time: ".concat(n?"":"~").concat(r," ").concat(i/o," != initPTS: ").concat(f.baseTime/f.timescale," (").concat(f.baseTime,"/").concat(f.timescale,") trackId: ").concat(f.trackId)),this.log("Found initPTS at playlist time: ".concat(r," offset: ").concat(i/o," (").concat(i,"/").concat(o,") trackId: ").concat(p)),this._initPTS={baseTime:i,timescale:o,trackId:p},this._initDTS={baseTime:a,timescale:o,trackId:p}):i=o=void 0,{tracks:c,initPTS:i,timescale:o,trackId:p}}},{key:"remuxVideo",value:function(e,t,r,n){var i,a,o=e.inputTimeScale,s=e.samples,l=[],u=s.length,c=this._initPTS,f=c.baseTime*o/c.timescale,d=this.nextVideoTs,h=8,p=this.videoSampleDuration,g=Number.POSITIVE_INFINITY,v=Number.NEGATIVE_INFINITY,y=!1;if(!r||null===d){var m=f+t*o,A=s[0].pts-Fs(s[0].dts,s[0].pts);zs&&null!==d&&Math.abs(m-A-(d+f))<15e3?r=!0:d=m-A-f}for(var b=d+f,E=0;E<u;E++){var k=s[E];k.pts=Fs(k.pts,b),k.dts=Fs(k.dts,b),k.dts<s[E>0?E-1:E].dts&&(y=!0)}y&&s.sort((function(e,t){var r=e.dts-t.dts,n=e.pts-t.pts;return r||n})),i=s[0].dts;var T=s[s.length-1].dts-i,S=T?Math.round(T/(u-1)):p||e.inputTimeScale/30;if(r){var w=i-b,_=w>S,L=w<-1;if((_||L)&&(_?this.warn("".concat((e.segmentCodec||"").toUpperCase(),": ").concat(Cs(w,!0)," ms (").concat(w,"dts) hole between fragments detected at ").concat(t.toFixed(3))):this.warn("".concat((e.segmentCodec||"").toUpperCase(),": ").concat(Cs(-w,!0)," ms (").concat(w,"dts) overlapping between fragments detected at ").concat(t.toFixed(3))),!L||b>=s[0].pts||zs)){i=b;var P=s[0].pts-w;if(_)s[0].dts=i,s[0].pts=P;else for(var I=!0,R=0;R<s.length&&!(s[R].dts>P&&I);R++){var C=s[R].pts;if(s[R].dts-=w,s[R].pts-=w,R<s.length-1){var D=s[R+1].pts;I=D<=s[R].pts==D<=C}}this.log("Video: Initial PTS/DTS adjusted: ".concat(Cs(P,!0),"/").concat(Cs(i,!0),", delta: ").concat(Cs(w,!0)," ms"))}}for(var O=0,z=0,M=i=Math.max(0,i),x=0;x<u;x++){for(var B=s[x],F=B.units,N=F.length,U=0,j=0;j<N;j++)U+=F[j].data.length;z+=U,O+=N,B.length=U,B.dts<M?(B.dts=M,M+=S/4|0||1):M=B.dts,g=Math.min(B.pts,g),v=Math.max(B.pts,v)}a=s[u-1].dts;var G,Y=z+4*O+8;try{G=new Uint8Array(Y)}catch(e){return void this.observer.emit($t.ERROR,$t.ERROR,{type:Jt.MUX_ERROR,details:Zt.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:Y,reason:"fail allocating video mdat ".concat(Y)})}var V=new DataView(G.buffer);V.setUint32(0,Y),G.set(Ps.types.mdat,4);for(var H=!1,K=Number.POSITIVE_INFINITY,Q=Number.POSITIVE_INFINITY,W=Number.NEGATIVE_INFINITY,q=Number.NEGATIVE_INFINITY,X=0;X<u;X++){for(var J=s[X],Z=J.units,$=void 0,ee=0,te=0,re=Z.length;te<re;te++){var ne=Z[te],ie=ne.data,ae=ne.data.byteLength;V.setUint32(h,ae),h+=4,G.set(ie,h),h+=ae,ee+=4+ae}if(X<u-1)p=s[X+1].dts-J.dts,$=s[X+1].pts-J.pts;else{var oe=this.config,se=X>0?J.dts-s[X-1].dts:S;if($=X>0?J.pts-s[X-1].pts:S,oe.stretchShortVideoTrack&&null!==this.nextAudioTs){var le=Math.floor(oe.maxBufferHole*o),ue=(n?g+n*o:this.nextAudioTs+f)-J.pts;ue>le?((p=ue-se)<0?p=se:H=!0,this.log("It is approximately ".concat(ue/90," ms to the next segment; using duration ").concat(p/90," ms for the last video frame."))):p=se}else p=se}var ce=Math.round(J.pts-J.dts);K=Math.min(K,p),W=Math.max(W,p),Q=Math.min(Q,$),q=Math.max(q,$),l.push(xs(J.key,p,ee,ce))}if(l.length)if(zs){if(zs<70){var fe=l[0].flags;fe.dependsOn=2,fe.isNonSync=0}}else if(Ms&&q-Q<W-K&&S/W<.025&&0===l[0].cts){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var de=i,he=0,pe=l.length;he<pe;he++){var ge=de+l[he].duration,ve=de+l[he].cts;if(he<pe-1){var ye=ge+l[he+1].cts;l[he].duration=ye-ve}else l[he].duration=he?l[he-1].duration:S;l[he].cts=0,de=ge}}var me=a+(p=H||!p?S:p);this.nextVideoTs=d=me-f,this.videoSampleDuration=p,this.isVideoContiguous=!0;var Ae={data1:Ps.moof(e.sequenceNumber++,i,cr(e,{samples:l})),data2:G,startPTS:(g-f)/o,endPTS:(v+p-f)/o,startDTS:(i-f)/o,endDTS:d/o,type:"video",hasAudio:!1,hasVideo:!0,nb:l.length,dropped:e.dropped};return e.samples=[],e.dropped=0,Ae}},{key:"getSamplesPerFrame",value:function(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}},{key:"remuxAudio",value:function(e,t,r,n,i){var a=e.inputTimeScale,o=a/(e.samplerate?e.samplerate:a),s=this.getSamplesPerFrame(e),l=s*o,u=this._initPTS,c="mp3"===e.segmentCodec&&this.typeSupported.mpeg,f=[],d=void 0!==i,h=e.samples,p=c?0:8,g=this.nextAudioTs||-1,v=u.baseTime*a/u.timescale,y=v+t*a;if(this.isAudioContiguous=r=r||h.length&&g>0&&(n&&Math.abs(y-(g+v))<9e3||Math.abs(Fs(h[0].pts,y)-(g+v))<20*l),h.forEach((function(e){e.pts=Fs(e.pts,y)})),!r||g<0){var m=h.length;if(m!==(h=h.filter((function(e){return e.pts>=0}))).length&&this.warn("Removed ".concat(h.length-m," of ").concat(m," samples (initPTS ").concat(v," / ").concat(a,")")),!h.length)return;g=0===i?0:n&&!d?Math.max(0,y-v):h[0].pts-v}if("aac"===e.segmentCodec)for(var A=this.config.maxAudioFramesDrift,b=0,E=g+v;b<h.length;b++){var k=h[b],T=k.pts,S=T-E,w=Math.abs(1e3*S/a);if(S<=-A*l&&d)0===b&&(this.warn("Audio frame @ ".concat((T/a).toFixed(3),"s overlaps marker by ").concat(Math.round(1e3*S/a)," ms.")),this.nextAudioTs=g=T-v,E=T);else if(S>=A*l&&w<1e4&&d){var _=Math.round(S/l);for(E=T-_*l;E<0&&_&&l;)_--,E+=l;0===b&&(this.nextAudioTs=g=E-v),this.warn("Injecting ".concat(_," audio frames @ ").concat(((E-v)/a).toFixed(3),"s due to ").concat(Math.round(1e3*S/a)," ms gap."));for(var L=0;L<_;L++){var P=_s.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);P||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),P=k.unit.subarray()),h.splice(b,0,{unit:P,pts:E}),E+=l,b++}}k.pts=E,E+=l}for(var I,R=null,C=null,D=0,O=h.length;O--;)D+=h[O].unit.byteLength;for(var z=0,M=h.length;z<M;z++){var x=h[z],B=x.unit,F=x.pts;if(null!==C)f[z-1].duration=Math.round((F-C)/o);else{if(r&&"aac"===e.segmentCodec&&(F=g+v),R=F,!(D>0))return;D+=p;try{I=new Uint8Array(D)}catch(e){return void this.observer.emit($t.ERROR,$t.ERROR,{type:Jt.MUX_ERROR,details:Zt.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:D,reason:"fail allocating audio mdat ".concat(D)})}c||(new DataView(I.buffer).setUint32(0,D),I.set(Ps.types.mdat,4))}I.set(B,p);var N=B.byteLength;p+=N,f.push(xs(!0,s,N,0)),C=F}var U=f.length;if(U){var j=f[f.length-1];g=C-v,this.nextAudioTs=g+o*j.duration;var G=c?new Uint8Array(0):Ps.moof(e.sequenceNumber++,R/o,cr({},e,{samples:f}));e.samples=[];var Y=(R-v)/a,V=g/a,H={data1:G,data2:I,startPTS:Y,endPTS:V,startDTS:Y,endDTS:V,type:"audio",hasAudio:!0,hasVideo:!1,nb:U};return this.isAudioContiguous=!0,H}}}]),r}(hr);function Fs(e,t){var r;if(null===t)return e;for(r=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=r;return e}function Ns(e,t,r,n){var i=e.samples.length;if(i){for(var a=e.inputTimeScale,o=0;o<i;o++){var s=e.samples[o];s.pts=Fs(s.pts-r.baseTime*a/r.timescale,t*a)/a,s.dts=Fs(s.dts-n.baseTime*a/n.timescale,t*a)/a}var l=e.samples;return e.samples=[],{samples:l}}}function Us(e,t,r){var n=e.samples.length;if(n){for(var i=e.inputTimeScale,a=0;a<n;a++){var o=e.samples[a];o.pts=Fs(o.pts-r.baseTime*i/r.timescale,t*i)/i}e.samples.sort((function(e,t){return e.pts-t.pts}));var s=e.samples;return e.samples=[],{samples:s}}}function js(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return void 0!==(null==e?void 0:e.start)?(e.start+(r?e.duration:0))/e.timescale:t}function Gs(e,t,r){var n=e.codec;return n&&n.length>4?n:t===zr?"ec-3"===n||"ac-3"===n||"alac"===n?n:"fLaC"===n||"Opus"===n?Tn(n,!1):(r.warn('Unhandled audio codec "'.concat(n,'" in mp4 MAP')),n||"mp4a"):(r.warn('Unhandled video codec "'.concat(n,'" in mp4 MAP')),n||"avc1")}try{Os=self.performance.now.bind(self.performance)}catch(e){Os=Date.now}var Ys=[{demux:function(){function e(t,r){h(this,e),this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=r}return p(e,[{key:"resetTimeStamp",value:function(){}},{key:"resetInitSegment",value:function(e,t,r,n){var i=this.videoTrack=qo("video",1),a=this.audioTrack=qo("audio",1),o=this.txtTrack=qo("text",1);if(this.id3Track=qo("id3",1),this.timeOffset=0,null!=e&&e.byteLength){var s=Jr(e);if(s.video){var l=s.video,u=l.id,c=l.timescale,f=l.codec,d=l.supplemental;i.id=u,i.timescale=o.timescale=c,i.codec=f,i.supplemental=d}if(s.audio){var h=s.audio,p=h.id,g=h.timescale,v=h.codec;a.id=p,a.timescale=g,a.codec=v}o.id=Yr.text,i.sampleDuration=0,i.duration=a.duration=n}}},{key:"resetContiguity",value:function(){this.remainderData=null}},{key:"demux",value:function(e,t){this.timeOffset=t;var r=e,n=this.videoTrack,i=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=on(this.remainderData,e));var a=function(e){var t={valid:null,remainder:null},r=qr(e,["moof"]);if(r.length<2)return t.remainder=e,t;var n=r[r.length-1];return t.valid=e.slice(0,n.byteOffset-8),t.remainder=e.slice(n.byteOffset-8),t}(r);this.remainderData=a.remainder,n.samples=a.valid||new Uint8Array}else n.samples=r;var o=this.extractID3Track(n,t);return i.samples=sn(t,n),{videoTrack:n,audioTrack:this.audioTrack,id3Track:o,textTrack:this.txtTrack}}},{key:"flush",value:function(){var e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;var n=this.extractID3Track(t,this.timeOffset);return r.samples=sn(e,t),{videoTrack:t,audioTrack:qo(),id3Track:n,textTrack:qo()}}},{key:"extractID3Track",value:function(e,t){var r=this,n=this.id3Track;if(e.samples.length){var i=qr(e.samples,["emsg"]);i&&i.forEach((function(e){var i=function(e){var t=e[0],r="",n="",i=0,a=0,o=0,s=0,l=0,u=0;if(0===t){for(;"\0"!==Vr(e.subarray(u,u+1));)r+=Vr(e.subarray(u,u+1)),u+=1;for(r+=Vr(e.subarray(u,u+1)),u+=1;"\0"!==Vr(e.subarray(u,u+1));)n+=Vr(e.subarray(u,u+1)),u+=1;n+=Vr(e.subarray(u,u+1)),u+=1,i=Kr(e,12),a=Kr(e,16),s=Kr(e,20),l=Kr(e,24),u=28}else if(1===t){i=Kr(e,u+=4);var c=Kr(e,u+=4),f=Kr(e,u+=4);for(u+=4,qt(o=Math.pow(2,32)*c+f)||(o=Number.MAX_SAFE_INTEGER,Ar.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),s=Kr(e,u),l=Kr(e,u+=4),u+=4;"\0"!==Vr(e.subarray(u,u+1));)r+=Vr(e.subarray(u,u+1)),u+=1;for(r+=Vr(e.subarray(u,u+1)),u+=1;"\0"!==Vr(e.subarray(u,u+1));)n+=Vr(e.subarray(u,u+1)),u+=1;n+=Vr(e.subarray(u,u+1)),u+=1}return{schemeIdUri:r,value:n,timeScale:i,presentationTime:o,presentationTimeDelta:a,eventDuration:s,id:l,payload:e.subarray(u,e.byteLength)}}(e);if(fs.test(i.schemeIdUri)){var a=ds(i,t),o=4294967295===i.eventDuration?Number.POSITIVE_INFINITY:i.eventDuration/i.timeScale;o<=.001&&(o=Number.POSITIVE_INFINITY);var s=i.payload;n.samples.push({data:s,len:s.byteLength,dts:a,pts:a,type:Wo.emsg,duration:o})}else if(r.config.enableEmsgKLVMetadata&&i.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){var l=ds(i,t);n.samples.push({data:i.payload,len:i.payload.byteLength,dts:l,pts:l,type:Wo.misbklv,duration:Number.POSITIVE_INFINITY})}}))}return n}},{key:"demuxSampleAes",value:function(e,t,r){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}},{key:"destroy",value:function(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}],[{key:"probe",value:function(e){return function(e){for(var t=e.byteLength,r=0;r<t;){var n=Kr(e,r);if(n>8&&109===e[r+4]&&111===e[r+5]&&111===e[r+6]&&102===e[r+7])return!0;r=n>1?r+n:t}return!1}(e)}}]),e}(),remux:function(e){c(r,e);var t=f(r);function r(e,n,i,a){var o;return h(this,r),(o=t.call(this,"passthrough-remuxer",a)).emitInitSegment=!1,o.audioCodec=void 0,o.videoCodec=void 0,o.initData=void 0,o.initPTS=null,o.initTracks=void 0,o.lastEndTime=null,o.isVideoContiguous=!1,o}return p(r,[{key:"destroy",value:function(){}},{key:"resetTimeStamp",value:function(e){this.lastEndTime=null;var t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}},{key:"resetNextTimestamp",value:function(){this.isVideoContiguous=!1,this.lastEndTime=null}},{key:"resetInitSegment",value:function(e,t,r,n){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,n),this.emitInitSegment=!0}},{key:"generateInitSegment",value:function(e,t){var r=this.audioCodec,n=this.videoCodec;if(null==e||!e.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var i=this.initData=Jr(e),a=i.audio,o=i.video;if(t)!function(e,t){if(e&&t){var r=t.keyId;r&&t.isCommonEncryption&&nn(e,(function(e,t){var n=e.subarray(8,24);n.some((function(e){return 0!==e}))||(Ar.log("[eme] Patching keyId in 'enc".concat(t?"a":"v",">sinf>>tenc' box: ").concat(Tr(n)," -> ").concat(Tr(r))),e.set(r,8))}))}}(e,t);else{var s=a||o;null!=s&&s.encrypted&&this.warn('Init segment with encrypted track with has no key ("'.concat(s.codec,'")!'))}a&&(r=Gs(a,zr,this)),o&&(n=Gs(o,Mr,this));var l={};a&&o?l.audiovideo={container:"video/mp4",codec:r+","+n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:a?l.audio={container:"audio/mp4",codec:r,encrypted:a.encrypted,initSegment:e,id:"audio"}:o?l.video={container:"video/mp4",codec:n,supplemental:o.supplemental,encrypted:o.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}},{key:"remux",value:function(e,t,r,n,i,a){var o,s,l=this.initPTS,u=this.lastEndTime,c={audio:void 0,video:void 0,text:n,id3:r,initSegment:void 0};Wt(u)||(u=this.lastEndTime=i||0);var f=t.samples;if(!f.length)return c;var d={initPTS:void 0,timescale:void 0,trackId:void 0},h=this.initData;if(null!=(o=h)&&o.length||(this.generateInitSegment(f),h=this.initData),null==(s=h)||!s.length)return this.warn("Failed to generate initSegment."),c;this.emitInitSegment&&(d.tracks=this.initTracks,this.emitInitSegment=!1);var p=function(e,t,r){for(var n={},i=qr(e,["moof","traf"]),a=0;a<i.length;a++){var o=i[a],s=qr(o,["tfhd"])[0],l=Kr(s,4),u=t[l];if(u){n[l]||(n[l]={start:NaN,duration:0,sampleCount:0,timescale:u.timescale,type:u.type});var c=n[l],f=qr(o,["tfdt"])[0];if(f){var d=f[0],h=Kr(f,4);1===d&&(h===jr?r.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(h*=jr+1,h+=Kr(f,8))),Wt(h)&&(!Wt(c.start)||h<c.start)&&(c.start=h)}var p=u.default,g=Kr(s,0)|(null==p?void 0:p.flags),v=(null==p?void 0:p.duration)||0;8&g&&(v=Kr(s,2&g?12:8));for(var y=qr(o,["trun"]),m=c.start||0,A=0,b=v,E=0;E<y.length;E++){var k=y[E],T=Kr(k,4),S=c.sampleCount;c.sampleCount+=T;var w=1&k[3],_=4&k[3],L=1&k[2],P=2&k[2],I=4&k[2],R=8&k[2],C=8,D=T;for(w&&(C+=4),_&&T&&(1&k[C+1]||void 0!==c.keyFrameIndex||(c.keyFrameIndex=S),C+=4,L?(b=Kr(k,C),C+=4):b=v,P&&(C+=4),R&&(C+=4),m+=b,A+=b,D--);D--;)L?(b=Kr(k,C),C+=4):b=v,P&&(C+=4),I&&(1&k[C+1]||void 0===c.keyFrameIndex&&(c.keyFrameIndex=c.sampleCount-(D+1),c.keyFrameStart=m),C+=4),R&&(C+=4),m+=b,A+=b;!A&&v&&(A+=v*T)}c.duration+=A}}if(!Object.keys(n).some((function(e){return n[e].duration}))){for(var O=1/0,z=0,M=qr(e,["sidx"]),x=0;x<M.length;x++){var B=Xr(M[x]);if(null!=B&&B.references){O=Math.min(O,B.earliestPresentationTime/B.timescale);var F=B.references.reduce((function(e,t){return e+t.info.duration||0}),0);z=Math.max(z,F+B.earliestPresentationTime/B.timescale)}}z&&Wt(z)&&Object.keys(n).forEach((function(e){n[e].duration||(n[e].duration=z*n[e].timescale-n[e].start)}))}return n}(f,h,this),g=h.audio?p[h.audio.id]:null,v=h.video?p[h.video.id]:null,y=js(v,1/0),m=js(g,1/0),A=js(v,0,!0),b=js(g,0,!0),E=i,k=0,T=g&&(!v||!l&&m<y||l&&l.trackId===h.audio.id),S=T?g:v;if(S){var w=S.timescale,_=S.start-i*w,L=T?h.audio.id:h.video.id;E=S.start/w,k=T?b-m:A-y,!a&&l||!function(e,t,r,n){if(null===e)return!0;var i=Math.max(n,1),a=t-e.baseTime/e.timescale;return Math.abs(a-r)>i}(l,E,i,k)&&w===l.timescale||(l&&this.warn("Timestamps at playlist time: ".concat(a?"":"~").concat(i," ").concat(_/w," != initPTS: ").concat(l.baseTime/l.timescale," (").concat(l.baseTime,"/").concat(l.timescale,") trackId: ").concat(l.trackId)),this.log("Found initPTS at playlist time: ".concat(i," offset: ").concat(E-i," (").concat(_,"/").concat(w,") trackId: ").concat(L)),l=null,d.initPTS=_,d.timescale=w,d.trackId=L)}else this.warn("No audio or video samples found for initPTS at playlist time: ".concat(i));l?(d.initPTS=l.baseTime,d.timescale=l.timescale,d.trackId=l.trackId):(d.timescale&&void 0!==d.trackId&&void 0!==d.initPTS||(this.warn("Could not set initPTS"),d.initPTS=E,d.timescale=1,d.trackId=-1),this.initPTS=l={baseTime:d.initPTS,timescale:d.timescale,trackId:d.trackId});var P=E-l.baseTime/l.timescale,I=P+k;k>0?this.lastEndTime=I:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var R=!!h.audio,C=!!h.video,D="";R&&(D+="audio"),C&&(D+="video");var O={data1:f,startPTS:P,startDTS:P,endPTS:I,endDTS:I,type:D,hasAudio:R,hasVideo:C,nb:1,dropped:0,encrypted:!!h.audio&&h.audio.encrypted||!!h.video&&h.video.encrypted};c.audio=R&&!C?O:void 0,c.video=C?O:void 0;var z=null==v?void 0:v.sampleCount;if(z){var M=v.keyFrameIndex,x=-1!==M;O.nb=z,O.dropped=0===M||this.isVideoContiguous?0:x?M:z,O.independent=x,O.firstKeyFrame=M,x&&v.keyFrameStart&&(O.firstKeyFramePTS=(v.keyFrameStart-l.baseTime)/l.timescale),this.isVideoContiguous||(c.independent=x),this.isVideoContiguous||(this.isVideoContiguous=x),O.dropped&&this.warn("fmp4 does not start with IDR: firstIDR ".concat(M,"/").concat(z," dropped: ").concat(O.dropped," start: ").concat(O.firstKeyFramePTS||"NA"))}return c.initSegment=d,c.id3=Ns(r,i,l,l),n.samples.length&&(c.text=Us(n,i,l)),c}}]),r}(hr)},{demux:As,remux:Bs},{demux:function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this)).observer=void 0,i.config=void 0,i.observer=e,i.config=n,i}return p(r,[{key:"resetInitSegment",value:function(e,t,n,i){o(s(r.prototype),"resetInitSegment",this).call(this,e,t,n,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return function(e,t){return function(e,t){return t+5<e.length}(e,t)&&Do(e,t)&&zo(e,t)<=e.length-t}(e,t)}},{key:"appendFrame",value:function(e,t,r){Bo(e,this.observer,t,r,e.manifestCodec);var n=No(e,t,r,this.basePTS,this.frameIndex);if(n&&0===n.missing)return n}}],[{key:"probe",value:function(e,t){if(!e)return!1;var r=Co(e,0),n=(null==r?void 0:r.length)||0;if(ss(e,n))return!1;for(var i=e.length;n<i;n++)if(xo(e,n))return t.log("ADTS sync word found !"),!0;return!1}}]),r}(Xo),remux:Bs},{demux:function(e){c(r,e);var t=f(r);function r(){return h(this,r),t.apply(this,arguments)}return p(r,[{key:"resetInitSegment",value:function(e,t,n,i){o(s(r.prototype),"resetInitSegment",this).call(this,e,t,n,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}},{key:"canParse",value:function(e,t){return function(e,t){return as(e,t)&&4<=e.length-t}(e,t)}},{key:"appendFrame",value:function(e,t,r){if(null!==this.basePTS)return ns(e,t,r,this.basePTS,this.frameIndex)}}],[{key:"probe",value:function(e){if(!e)return!1;var t=Co(e,0),r=(null==t?void 0:t.length)||0;if(t&&11===e[r]&&119===e[r+1]&&void 0!==Qo(t)&&ls(e,r)<=16)return!1;for(var n=e.length;r<n;r++)if(ss(e,r))return Ar.log("MPEG Audio sync word found !"),!0;return!1}}]),r}(Xo),remux:Bs}];Ys.splice(2,0,{demux:us,remux:Bs});var Vs=function(){function e(t,r,n,i,a,o){h(this,e),this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=t,this.typeSupported=r,this.config=n,this.id=a,this.logger=o}return p(e,[{key:"configure",value:function(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}},{key:"push",value:function(e,t,r,n){var i=this,a=r.transmuxing;a.executeStart=Os();var o=new Uint8Array(e),s=this.currentTransmuxState,l=this.transmuxConfig;n&&(this.currentTransmuxState=n);var u=n||s,c=u.contiguous,f=u.discontinuity,d=u.trackSwitch,h=u.accurateTimeOffset,p=u.timeOffset,g=u.initSegmentChange,v=l.audioCodec,y=l.videoCodec,m=l.defaultInitPts,A=l.duration,b=l.initSegmentData,E=function(e,t){var r=null;return e.byteLength>0&&null!=(null==t?void 0:t.key)&&null!==t.iv&&null!=t.method&&(r=t),r}(o,t);if(E&&na(E.method)){var k=this.getDecrypter(),T=ia(E.method);if(!k.isSync())return this.asyncResult=!0,this.decryptionPromise=k.webCryptoDecrypt(o,E.key.buffer,E.iv.buffer,T).then((function(e){var t=i.push(e,null,r);return i.decryptionPromise=null,t})),this.decryptionPromise;var S=k.softwareDecrypt(o,E.key.buffer,E.iv.buffer,T);if(r.part>-1){var w=k.flush();S=w?w.buffer:w}if(!S)return a.executeEnd=Os(),Hs(r);o=new Uint8Array(S)}var _=this.needsProbing(f,d);if(_){var L=this.configureTransmuxer(o);if(L)return this.logger.warn("[transmuxer] ".concat(L.message)),this.observer.emit($t.ERROR,$t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_PARSING_ERROR,fatal:!1,error:L,reason:L.message}),a.executeEnd=Os(),Hs(r)}(f||d||g||_)&&this.resetInitSegment(b,v,y,A,t),(f||g||_)&&this.resetInitialTimestamp(m),c||this.resetContiguity();var P=this.transmux(o,E,p,h,r);this.asyncResult=Ks(P);var I=this.currentTransmuxState;return I.contiguous=!0,I.discontinuity=!1,I.trackSwitch=!1,a.executeEnd=Os(),P}},{key:"flush",value:function(e){var t=this,r=e.transmuxing;r.executeStart=Os();var n=this.decrypter,i=this.currentTransmuxState,a=this.decryptionPromise;if(a)return this.asyncResult=!0,a.then((function(){return t.flush(e)}));var o=[],s=i.timeOffset;if(n){var l=n.flush();l&&o.push(this.push(l.buffer,null,e))}var u=this.demuxer,c=this.remuxer;if(!u||!c){r.executeEnd=Os();var f=[Hs(e)];return this.asyncResult?Promise.resolve(f):f}var d=u.flush(s);return Ks(d)?(this.asyncResult=!0,d.then((function(r){return t.flushRemux(o,r,e),o}))):(this.flushRemux(o,d,e),this.asyncResult?Promise.resolve(o):o)}},{key:"flushRemux",value:function(e,t,r){var n=t.audioTrack,i=t.videoTrack,a=t.id3Track,o=t.textTrack,s=this.currentTransmuxState,l=s.accurateTimeOffset,u=s.timeOffset;this.logger.log("[transmuxer.ts]: Flushed ".concat(this.id," sn: ").concat(r.sn).concat(r.part>-1?" part: "+r.part:""," of ").concat(this.id===ir?"level":"track"," ").concat(r.level));var c=this.remuxer.remux(n,i,a,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:r}),r.transmuxing.executeEnd=Os()}},{key:"resetInitialTimestamp",value:function(e){var t=this.demuxer,r=this.remuxer;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))}},{key:"resetContiguity",value:function(){var e=this.demuxer,t=this.remuxer;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}},{key:"resetInitSegment",value:function(e,t,r,n,i){var a=this.demuxer,o=this.remuxer;a&&o&&(a.resetInitSegment(e,t,r,n),o.resetInitSegment(e,t,r,i))}},{key:"destroy",value:function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}},{key:"transmux",value:function(e,t,r,n,i){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,r,n,i):this.transmuxUnencrypted(e,r,n,i)}},{key:"transmuxUnencrypted",value:function(e,t,r,n){var i=this.demuxer.demux(e,t,!1,!this.config.progressive),a=i.audioTrack,o=i.videoTrack,s=i.id3Track,l=i.textTrack;return{remuxResult:this.remuxer.remux(a,o,s,l,t,r,!1,this.id),chunkMeta:n}}},{key:"transmuxSampleAes",value:function(e,t,r,n,i){var a=this;return this.demuxer.demuxSampleAes(e,t,r).then((function(e){return{remuxResult:a.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,r,n,!1,a.id),chunkMeta:i}}))}},{key:"configureTransmuxer",value:function(e){for(var t,r=this.config,n=this.observer,i=this.typeSupported,a=0,o=Ys.length;a<o;a++){var s;if(null!=(s=Ys[a].demux)&&s.probe(e,this.logger)){t=Ys[a];break}}if(!t)return new Error("Failed to find demuxer by probing fragment data");var l=this.demuxer,u=this.remuxer,c=t.remux,f=t.demux;u&&u instanceof c||(this.remuxer=new c(n,r,i,this.logger)),l&&l instanceof f||(this.demuxer=new f(n,r,i,this.logger),this.probe=f.probe)}},{key:"needsProbing",value:function(e,t){return!this.demuxer||!this.remuxer||e||t}},{key:"getDecrypter",value:function(){var e=this.decrypter;return e||(e=this.decrypter=new zi(this.config)),e}}]),e}(),Hs=function(e){return{remuxResult:{},chunkMeta:e}};function Ks(e){return"then"in e&&e.then instanceof Function}var Qs=function e(t,r,n,i,a){h(this,e),this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=t,this.videoCodec=r,this.initSegmentData=n,this.duration=i,this.defaultInitPts=a||null},Ws=function e(t,r,n,i,a,o){h(this,e),this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=t,this.contiguous=r,this.accurateTimeOffset=n,this.trackSwitch=i,this.timeOffset=a,this.initSegmentChange=o},qs=0,Xs=function(){function e(t,r,n,i){var a=this;h(this,e),this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=qs++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=function(e){var t=e.data,r=a.hls;if(r&&null!=t&&t.event&&t.instanceNo===a.instanceNo)switch(t.event){case"init":var n,i=null==(n=a.workerContext)?void 0:n.objectURL;i&&self.URL.revokeObjectURL(i);break;case"transmuxComplete":a.handleTransmuxComplete(t.data);break;case"flush":a.onFlush(t.data);break;case"workerLog":r.logger[t.data.logType]&&r.logger[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=a.frag,t.data.part=a.part,t.data.id=a.id,r.trigger(t.event,t.data)}},this.onWorkerError=function(e){if(a.hls){var t=new Error("".concat(e.message,"  (").concat(e.filename,":").concat(e.lineno,")"));a.hls.config.enableWorker=!1,a.hls.logger.warn('Error in "'.concat(a.id,'" Web Worker, fallback to inline')),a.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:t})}};var o=t.config;this.hls=t,this.id=r,this.useWorker=!!o.enableWorker,this.onTransmuxComplete=n,this.onFlush=i;var s=function(e,t){(t=t||{}).frag=a.frag||void 0,e===$t.ERROR&&((t=t).parent=a.id,t.part=a.part,a.error=t.error),a.hls.trigger(e,t)};this.observer=new wo,this.observer.on($t.FRAG_DECRYPTED,s),this.observer.on($t.ERROR,s);var l=Ln(o.preferManagedMediaSource);if(this.useWorker&&"undefined"!=typeof Worker){var u=this.hls.logger;if(o.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__){try{o.workerPath?(u.log("loading Web Worker ".concat(o.workerPath,' for "').concat(r,'"')),this.workerContext=function(e){var t=Lo[e];if(t)return t.clientCount++,t;var r=new self.URL(e,self.location.href).href,n={worker:new self.Worker(r),scriptURL:r,clientCount:1};return Lo[e]=n,n}(o.workerPath)):(u.log('injecting Web Worker for "'.concat(r,'"')),this.workerContext=function(){var e=Lo[_o];if(e)return e.clientCount++,e;var t=new self.Blob(["var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(".concat(__HLS_WORKER_BUNDLE__.toString(),")(true);")],{type:"text/javascript"}),r=self.URL.createObjectURL(t),n={worker:new self.Worker(r),objectURL:r,clientCount:1};return Lo[_o]=n,n}());var c=this.workerContext.worker;c.addEventListener("message",this.onWorkerMessage),c.addEventListener("error",this.onWorkerError),c.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:r,config:Vn(o)})}catch(i){u.warn('Error setting up "'.concat(r,'" Web Worker, fallback to inline'),i),this.terminateWorker(),this.error=null,this.transmuxer=new Vs(this.observer,l,o,"",r,t.logger)}return}}this.transmuxer=new Vs(this.observer,l,o,"",r,t.logger)}return p(e,[{key:"reset",value:function(){if(this.frag=null,this.part=null,this.workerContext){var e=this.instanceNo;this.instanceNo=qs++;var t=this.hls.config,r=Ln(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Vn(t)})}}},{key:"terminateWorker",value:function(){if(this.workerContext){var e=this.workerContext.worker;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(e){var t=Lo[e||_o];if(t&&1==t.clientCount--){var r=t.worker,n=t.objectURL;delete Lo[e||_o],n&&self.URL.revokeObjectURL(n),r.terminate()}}(this.hls.config.workerPath)}}},{key:"destroy",value:function(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{var e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}var t=this.observer;t&&t.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}},{key:"push",value:function(e,t,r,n,i,a,o,s,l,u){var c,f,d=this;l.transmuxing.start=self.performance.now();var h=this.instanceNo,p=this.transmuxer,g=a?a.start:i.start,v=i.decryptdata,y=this.frag,m=!(y&&i.cc===y.cc),A=!(y&&l.level===y.level),b=y?l.sn-y.sn:-1,E=this.part?l.part-this.part.index:-1,k=0===b&&l.id>1&&l.id===(null==y?void 0:y.stats.chunkCount),T=!A&&(1===b||0===b&&(1===E||k&&E<=0)),S=self.performance.now();(A||b||0===i.stats.parsing.start)&&(i.stats.parsing.start=S),!a||!E&&T||(a.stats.parsing.start=S);var w=!(y&&(null==(c=i.initSegment)?void 0:c.url)===(null==(f=y.initSegment)?void 0:f.url)),_=new Ws(m,T,s,A,g,w);if(!T||m||w){this.hls.logger.log("[transmuxer-interface]: Starting new transmux session for ".concat(i.type," sn: ").concat(l.sn).concat(l.part>-1?" part: "+l.part:""," ").concat(this.id===ir?"level":"track",": ").concat(l.level," id: ").concat(l.id,"\n        discontinuity: ").concat(m,"\n        trackSwitch: ").concat(A,"\n        contiguous: ").concat(T,"\n        accurateTimeOffset: ").concat(s,"\n        timeOffset: ").concat(g,"\n        initSegmentChange: ").concat(w));var L=new Qs(r,n,t,o,u);this.configureTransmuxer(L)}if(this.frag=i,this.part=a,this.workerContext)this.workerContext.worker.postMessage({instanceNo:h,cmd:"demux",data:e,decryptdata:v,chunkMeta:l,state:_},e instanceof ArrayBuffer?[e]:[]);else if(p){var P=p.push(e,v,l,_);Ks(P)?P.then((function(e){d.handleTransmuxComplete(e)})).catch((function(e){d.transmuxerError(e,l,"transmuxer-interface push error")})):this.handleTransmuxComplete(P)}}},{key:"flush",value:function(e){var t=this;e.transmuxing.start=self.performance.now();var r=this.instanceNo,n=this.transmuxer;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:r,cmd:"flush",chunkMeta:e});else if(n){var i=n.flush(e);Ks(i)?i.then((function(r){t.handleFlushResult(r,e)})).catch((function(r){t.transmuxerError(r,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}},{key:"transmuxerError",value:function(e,t,r){this.hls&&(this.error=e,this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}},{key:"handleFlushResult",value:function(e,t){var r=this;e.forEach((function(e){r.handleTransmuxComplete(e)})),this.onFlush(t)}},{key:"configureTransmuxer",value:function(e){var t=this.instanceNo,r=this.transmuxer;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}},{key:"handleTransmuxComplete",value:function(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}]),e}(),Js=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,n,e.logger)).hls=void 0,i.canLoad=!1,i.timer=-1,i.hls=e,i}return p(r,[{key:"destroy",value:function(){this.clearTimer(),this.hls=this.log=this.warn=null}},{key:"clearTimer",value:function(){-1!==this.timer&&(self.clearTimeout(this.timer),this.timer=-1)}},{key:"startLoad",value:function(){this.canLoad=!0,this.loadPlaylist()}},{key:"stopLoad",value:function(){this.canLoad=!1,this.clearTimer()}},{key:"switchParams",value:function(e,t,r){var n=null==t?void 0:t.renditionReports;if(n){for(var i=-1,a=0;a<n.length;a++){var o=n[a],s=void 0;try{s=new self.URL(o.URI,t.url).href}catch(e){this.warn("Could not construct new URL for Rendition Report: ".concat(e)),s=o.URI||""}if(s===e){i=a;break}s===e.substring(0,s.length)&&(i=a)}if(-1!==i){var l=n[i],u=parseInt(l["LAST-MSN"])||t.lastPartSn,c=parseInt(l["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){var f=Math.min(t.age-t.partTarget,t.targetduration);c>=0&&f>t.partTarget&&(c+=1)}var d=r&&Un(r);return new jn(u,c>=0?c:void 0,d)}}}},{key:"loadPlaylist",value:function(e){this.clearTimer()}},{key:"loadingPlaylist",value:function(e,t){this.clearTimer()}},{key:"shouldLoadPlaylist",value:function(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}},{key:"getUrlWithDirectives",value:function(e,t){if(t)try{return t.addDirectives(e)}catch(e){this.warn("Could not construct new URL with HLS Delivery Directives: ".concat(e))}return e}},{key:"playlistLoaded",value:function(e,t,r){var n=t.details,i=t.stats,a=self.performance.now(),o=i.loading.first?Math.max(0,a-i.loading.first):0;n.advancedDateTime=Date.now()-o;var s=this.hls.config.timelineOffset;if(s!==n.appliedTimelineOffset){var l=Math.max(s||0,0);n.appliedTimelineOffset=l,n.fragments.forEach((function(e){e.setStart(e.playlistOffset+l)}))}if(n.live||null!=r&&r.live){var u="levelInfo"in t?t.levelInfo:t.track;if(n.reloaded(r),r&&n.fragments.length>0){!function(e,t,r){if(e!==t){for(var n,i=null,a=e.fragments,o=a.length-1;o>=0;o--){var s=a[o].initSegment;if(s){i=s;break}}e.fragmentHint&&delete e.fragmentHint.endPTS,function(e,t,r){for(var n=t.skippedSegments,i=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(n?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,o=t.startSN-e.startSN,s=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments,u=i;u<=a;u++){var c=l[o+u],f=s[u];if(n&&!f&&c&&(f=t.fragments[u]=c),c&&f){r(c,f,u,s);var d=c.relurl,h=f.relurl;if(d&&Ja(d,h))return void(t.playlistParsingError=Ya("media sequence mismatch ".concat(f.sn,":"),e,t,0,f));if(c.cc!==f.cc)return void(t.playlistParsingError=Ya("discontinuity sequence mismatch (".concat(c.cc,"!=").concat(f.cc,")"),e,t,0,f))}}}(e,t,(function(e,r,a,o){if((!t.startCC||t.skippedSegments)&&r.cc!==e.cc){for(var s=e.cc-r.cc,l=a;l<o.length;l++)o[l].cc+=s;t.endCC=o[o.length-1].cc}Wt(e.startPTS)&&Wt(e.endPTS)&&(r.setStart(r.startPTS=e.startPTS),r.startDTS=e.startDTS,r.maxStartPTS=e.maxStartPTS,r.endPTS=e.endPTS,r.endDTS=e.endDTS,r.minEndPTS=e.minEndPTS,r.setDuration(e.endPTS-e.startPTS),r.duration&&(n=r),t.PTSKnown=t.alignedSliding=!0),e.hasStreams&&(r.elementaryStreams=e.elementaryStreams),r.loader=e.loader,e.hasStats&&(r.stats=e.stats),e.initSegment&&(r.initSegment=e.initSegment,i=e.initSegment)}));var l=t.fragments,u=t.fragmentHint?l.concat(t.fragmentHint):l;if(i&&u.forEach((function(e){var t;!e||e.initSegment&&e.initSegment.relurl!==(null==(t=i)?void 0:t.relurl)||(e.initSegment=i)})),t.skippedSegments){if(t.deltaUpdateFailed=l.some((function(e){return!e})),t.deltaUpdateFailed){r.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var c=t.skippedSegments;c--;)l.shift();t.startSN=l[0].sn}else{t.canSkipDateRanges&&(t.dateRanges=function(e,t,r){var n=t.dateRanges,i=t.recentlyRemovedDateranges,a=cr({},e);i&&i.forEach((function(e){delete a[e]}));var o=Object.keys(a).length;return o?(Object.keys(n).forEach((function(e){var t=a[e],i=new $i(n[e].attr,t);i.isValid?(a[e]=i,t||(i.tagOrder+=o)):r.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'.concat(Vn(n[e].attr),'"'))})),a):n}(e.dateRanges,t,r));var f=e.fragments.filter((function(e){return e.rawProgramDateTime}));if(e.hasProgramDateTime&&!t.hasProgramDateTime)for(var d=1;d<u.length;d++)null===u[d].programDateTime&&xa(u[d],u[d-1],f);Ra(f,t)}t.endCC=l[l.length-1].cc}if(!t.startCC){var h,p=Qa(e,t.startSN-1);t.startCC=null!=(h=null==p?void 0:p.cc)?h:l[0].cc}!function(e,t,r){if(e&&t)for(var n=0,i=0,a=e.length;i<=a;i++){var o=e[i],s=t[i+n];o&&s&&o.index===s.index&&o.fragment.sn===s.fragment.sn?r(o,s):n--}}(e.partList,t.partList,(function(e,t){t.elementaryStreams=e.elementaryStreams,t.stats=e.stats})),n?Ga(t,n,n.startPTS,n.endPTS,n.startDTS,n.endDTS,r):Va(e,t),l.length&&(t.totalduration=t.edge-l[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;var g=t.advancedDateTime;if(t.advanced&&g){var v=t.edge;t.driftStart||(t.driftStartTime=g,t.driftStart=v),t.driftEndTime=g,t.driftEnd=v}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime;-1===t.requestScheduled&&(t.requestScheduled=e.requestScheduled)}}(r,n,this);var c=n.playlistParsingError;if(c){this.warn(c);var f=this.hls;if(!f.config.ignorePlaylistParsingErrors){var d,h=t.networkDetails;return void f.trigger($t.ERROR,{type:Jt.NETWORK_ERROR,details:Zt.LEVEL_PARSING_ERROR,fatal:!1,url:n.url,error:c,reason:c.message,level:t.level||void 0,parent:null==(d=n.fragments[0])?void 0:d.type,networkDetails:h,stats:i})}n.playlistParsingError=null}}-1===n.requestScheduled&&(n.requestScheduled=i.loading.start);var p=this.hls.mainForwardBufferInfo,g=p?p.end-p.len:0,v=Ka(n,1e3*(n.edge-g));if(n.requestScheduled+v<a?n.requestScheduled=a:n.requestScheduled+=v,this.log("live playlist ".concat(e," ").concat(n.advanced?"REFRESHED "+n.lastPartSn+"-"+n.lastPartIndex:n.updated?"UPDATED":"MISSED")),!this.canLoad||!n.live)return;var y,m=void 0,A=void 0;if(n.canBlockReload&&n.endSN&&n.advanced){var b=this.hls.config.lowLatencyMode,E=n.lastPartSn,k=n.endSN,T=n.lastPartIndex,S=E===k;-1!==T?S?(m=k+1,A=b?0:T):(m=E,A=b?T+1:n.maxPartIndex):m=k+1;var w=n.age,_=w+n.ageHeader,L=Math.min(_-n.partTarget,1.5*n.targetduration);if(L>0){if(_>3*n.targetduration)this.log("Playlist last advanced ".concat(w.toFixed(2),"s ago. Omitting segment and part directives.")),m=void 0,A=void 0;else if(null!=r&&r.tuneInGoal&&_-n.partTarget>r.tuneInGoal)this.warn("CDN Tune-in goal increased from: ".concat(r.tuneInGoal," to: ").concat(L," with playlist age: ").concat(n.age)),L=0;else{var P=Math.floor(L/n.targetduration);m+=P,void 0!==A&&(A+=Math.round(L%n.targetduration/n.partTarget)),this.log("CDN Tune-in age: ".concat(n.ageHeader,"s last advanced ").concat(w.toFixed(2),"s goal: ").concat(L," skip sn ").concat(P," to part ").concat(A))}n.tuneInGoal=L}if(y=this.getDeliveryDirectives(n,t.deliveryDirectives,m,A),b||!S)return n.requestScheduled=a,void this.loadingPlaylist(u,y)}else(n.canBlockReload||n.canSkipUntil)&&(y=this.getDeliveryDirectives(n,t.deliveryDirectives,m,A));y&&void 0!==m&&n.canBlockReload&&(n.requestScheduled=i.loading.first+Math.max(v-2*o,v/2)),this.scheduleLoading(u,y,n)}else this.clearTimer()}},{key:"scheduleLoading",value:function(e,t,r){var n=this,i=r||e.details;if(i){var a=self.performance.now(),o=i.requestScheduled;if(a>=o)this.loadingPlaylist(e,t);else{var s=o-a;this.log("reload live playlist ".concat(e.name||e.bitrate+"bps"," in ").concat(Math.round(s)," ms")),this.clearTimer(),this.timer=self.setTimeout((function(){return n.loadingPlaylist(e,t)}),s)}}else this.loadingPlaylist(e,t)}},{key:"getDeliveryDirectives",value:function(e,t,r,n){var i=Un(e);return null!=t&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,n=t.part,i=Bn),new jn(r,n,i)}},{key:"checkRetry",value:function(e){var t=this,r=e.details,n=ii(e),i=e.errorAction,a=i||{},o=a.action,s=a.retryCount,l=void 0===s?0:s,u=a.retryConfig,c=!!i&&!!u&&(o===gi||!i.resolved&&o===hi);if(c){var f;if(l>=u.maxNumRetry)return!1;if(n&&null!=(f=e.context)&&f.deliveryDirectives)this.warn("Retrying playlist loading ".concat(l+1,"/").concat(u.maxNumRetry,' after "').concat(r,'" without delivery-directives')),this.loadPlaylist();else{var d=li(u,l);this.clearTimer(),this.timer=self.setTimeout((function(){return t.loadPlaylist()}),d),this.warn("Retrying playlist loading ".concat(l+1,"/").concat(u.maxNumRetry,' after "').concat(r,'" in ').concat(d,"ms"))}e.levelRetry=!0,i.resolved=!0}return c}}]),r}(hr);function Zs(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!$s(e[r].attrs,t[r].attrs))return!1;return!0}function $s(e,t,r){var n=e["STABLE-RENDITION-ID"];return n&&!r?n===t["STABLE-RENDITION-ID"]:!(r||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some((function(r){return e[r]!==t[r]}))}function el(e,t){return t.label.toLowerCase()===e.name.toLowerCase()&&(!t.language||t.language.toLowerCase()===(e.lang||"").toLowerCase())}var tl=function(){function e(t){h(this,e),this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=t}return p(e,[{key:"destroy",value:function(){this.tracks=this.queues=null}},{key:"append",value:function(e,t,r){if(null!==this.queues&&null!==this.tracks){var n=this.queues[t];n.push(e),1!==n.length||r||this.executeNext(t)}}},{key:"appendBlocker",value:function(e){var t=this;return new Promise((function(r){var n={label:"async-blocker",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.append(n,e)}))}},{key:"prependBlocker",value:function(e){var t=this;return new Promise((function(r){if(t.queues){var n={label:"async-blocker-prepend",execute:r,onStart:function(){},onComplete:function(){},onError:function(){}};t.queues[e].unshift(n)}}))}},{key:"removeBlockers",value:function(){null!==this.queues&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach((function(e){var t,r=null==(t=e[0])?void 0:t.label;"async-blocker"!==r&&"async-blocker-prepend"!==r||(e[0].execute(),e.splice(0,1))}))}},{key:"unblockAudio",value:function(e){null!==this.queues&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}},{key:"executeNext",value:function(e){if(null!==this.queues&&null!==this.tracks){var t=this.queues[e];if(t.length){var r=t[0];try{r.execute()}catch(t){var n;if(r.onError(t),null===this.queues||null===this.tracks)return;var i=null==(n=this.tracks[e])?void 0:n.buffer;null!=i&&i.updating||this.shiftAndExecuteNext(e)}}}}},{key:"shiftAndExecuteNext",value:function(e){null!==this.queues&&(this.queues[e].shift(),this.executeNext(e))}},{key:"current",value:function(e){var t;return(null==(t=this.queues)?void 0:t[e][0])||null}},{key:"toString",value:function(){var e=this.queues,t=this.tracks;return null===e||null===t?"<destroyed>":"\n".concat(this.list("video"),"\n").concat(this.list("audio"),"\n").concat(this.list("audiovideo"),"}")}},{key:"list",value:function(e){var t,r;return null!=(t=this.queues)&&t[e]||null!=(r=this.tracks)&&r[e]?"".concat(e,": (").concat(this.listSbInfo(e),") ").concat(this.listOps(e)):""}},{key:"listSbInfo",value:function(e){var t,r=null==(t=this.tracks)?void 0:t[e],n=null==r?void 0:r.buffer;return n?"SourceBuffer".concat(n.updating?" updating":"").concat(r.ended?" ended":"").concat(r.ending?" ending":""):"none"}},{key:"listOps",value:function(e){var t;return(null==(t=this.queues)?void 0:t[e].map((function(e){return e.label})).join(", "))||""}}]),e}(),rl=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,nl="HlsJsTrackRemovedError",il=function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,e)).name=nl,n}return r}(u(Error));function al(e){var t=e.querySelectorAll("source");[].slice.call(t).forEach((function(t){e.removeChild(t)}))}function ol(e){return"audio"===e?1:0}var sl=function(){function e(t){h(this,e),this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=t,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}return p(e,[{key:"setStreamController",value:function(e){this.streamController=e}},{key:"destroy",value:function(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}},{key:"registerListeners",value:function(){var e=this.hls;e.on($t.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($t.BUFFER_CODECS,this.onBufferCodecs,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"unregisterListener",value:function(){var e=this.hls;e.off($t.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($t.BUFFER_CODECS,this.onBufferCodecs,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"onFpsDropLevelCapping",value:function(e,t){var r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}},{key:"onMediaAttaching",value:function(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}},{key:"onManifestParsed",value:function(e,t){var r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}},{key:"onLevelsUpdated",value:function(e,t){this.timer&&Wt(this.autoLevelCapping)&&this.detectPlayerSize()}},{key:"onBufferCodecs",value:function(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}},{key:"onMediaDetaching",value:function(){this.stopCapping(),this.media=null}},{key:"detectPlayerSize",value:function(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0)return void(this.clientRect=null);var e=this.hls.levels;if(e.length){var t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log("Setting autoLevelCapping to ".concat(r,": ").concat(e[r].height,"p@").concat(e[r].bitrate," for media ").concat(this.mediaWidth,"x").concat(this.mediaHeight)),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}},{key:"getMaxLevel",value:function(t){var r=this,n=this.hls.levels;if(!n.length)return-1;var i=n.filter((function(e,n){return r.isLevelAllowed(e)&&n<=t}));return this.clientRect=null,e.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}},{key:"startCapping",value:function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}},{key:"stopCapping",value:function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}},{key:"getDimensions",value:function(){if(this.clientRect)return this.clientRect;var e=this.media,t={width:0,height:0};if(e){var r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}},{key:"isLevelAllowed",value:function(e){return!this.restrictedLevels.some((function(t){return e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height}))}},{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return Math.min(e,this.hls.config.maxDevicePixelRatio)}}],[{key:"getMaxLevelByMediaSize",value:function(e,t,r){if(null==e||!e.length)return-1;for(var n=function(e,t){return!t||e.width!==t.width||e.height!==t.height},i=e.length-1,a=Math.max(t,r),o=0;o<e.length;o+=1){var s=e[o];if((s.width>=a||s.height>=a)&&n(s,e[o+1])){i=o;break}}return i}}]),e}(),ll="m",ul="a",cl="v",fl="av",dl="i",hl="tt",pl="h",gl=function e(t,r){h(this,e),Array.isArray(t)&&(t=t.map((function(t){return t instanceof e?t:new e(t)}))),this.value=t,this.params=r};function vl(e,t,r){return function(e,t,r,n){return new Error("failed to ".concat(e,' "').concat((i=t,Array.isArray(i)?JSON.stringify(i):i instanceof Map?"Map{}":i instanceof Set?"Set{}":"object"==typeof i?JSON.stringify(i):String(i)),'" as ').concat(r),{cause:n});var i}("serialize",e,t,r)}var yl=function e(t){h(this,e),this.description=t},ml="Bare Item";function Al(e){if(function(e){return e<-999999999999999||999999999999999<e}(e))throw vl(e,"Integer");return e.toString()}var bl=/[\x00-\x1f\x7f]+/;function El(e){var t,r=(t=e).description||t.toString().slice(7,-1);if(!1===/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:\/]*)$/.test(r))throw vl(r,"Token");return r}function kl(e){switch(typeof e){case"number":if(!Wt(e))throw vl(e,ml);return Number.isInteger(e)?Al(e):function(e){var t=function e(t,r){if(t<0)return-e(-t,r);var n=Math.pow(10,r);if(Math.abs(t*n%1-.5)<Number.EPSILON){var i=Math.floor(t*n);return(i%2==0?i:i+1)/n}return Math.round(t*n)/n}(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw vl(e,"Decimal");var r=t.toString();return r.includes(".")?r:"".concat(r,".0")}(e);case"string":return function(e){if(bl.test(e))throw vl(e,"String");return'"'.concat(e.replace(/\\/g,"\\\\").replace(/"/g,'\\"'),'"')}(e);case"symbol":return El(e);case"boolean":return function(e){if("boolean"!=typeof e)throw vl(e,"Boolean");return e?"?1":"?0"}(e);case"object":if(e instanceof Date)return function(e){return"@".concat(Al(e.getTime()/1e3))}(e);if(e instanceof Uint8Array)return function(e){if(!1===ArrayBuffer.isView(e))throw vl(e,"Byte Sequence");return":".concat((t=e,btoa(String.fromCharCode.apply(String,i(t)))),":");var t}(e);if(e instanceof yl)return El(e);default:throw vl(e,ml)}}function Tl(e){if(!1===/^[a-z*][a-z0-9\-_.*]*$/.test(e))throw vl(e,"Key");return e}function Sl(e){return null==e?"":Object.entries(e).map((function(e){var t=a(e,2),r=t[0],n=t[1];return!0===n?";".concat(Tl(r)):";".concat(Tl(r),"=").concat(kl(n))})).join("")}function wl(e){return e instanceof gl?"".concat(kl(e.value)).concat(Sl(e.params)):kl(e)}function _l(e,t){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{whitespace:!0};if("object"!=typeof e||null==e)throw vl(e,"Dict");var r=e instanceof Map?e.entries():Object.entries(e),n=(null==t?void 0:t.whitespace)?" ":"";return Array.from(r).map((function(e){var t=a(e,2),r=t[0],n=t[1];n instanceof gl==0&&(n=new gl(n));var i=Tl(r);return!0===n.value?i+=Sl(n.params):(i+="=",Array.isArray(n.value)?i+=function(e){return"(".concat(e.value.map(wl).join(" "),")").concat(Sl(e.params))}(n):i+=wl(n)),i})).join(",".concat(n))}(e,t)}var Ll="CMCD-Request",Pl={br:"CMCD-Object",ab:"CMCD-Object",d:"CMCD-Object",ot:"CMCD-Object",tb:"CMCD-Object",tpb:"CMCD-Object",lb:"CMCD-Object",tab:"CMCD-Object",lab:"CMCD-Object",url:"CMCD-Object",pb:Ll,bl:Ll,tbl:Ll,dl:Ll,ltc:Ll,mtp:Ll,nor:Ll,nrr:Ll,rc:Ll,sn:Ll,sta:Ll,su:Ll,ttfb:Ll,ttfbb:Ll,ttlb:Ll,cmsdd:Ll,cmsds:Ll,smrt:Ll,df:Ll,cs:Ll,ts:Ll,cid:"CMCD-Session",pr:"CMCD-Session",sf:"CMCD-Session",sid:"CMCD-Session",st:"CMCD-Session",v:"CMCD-Session",msd:"CMCD-Session",bs:"CMCD-Status",bsd:"CMCD-Status",cdn:"CMCD-Status",rtp:"CMCD-Status",bg:"CMCD-Status",pt:"CMCD-Status",ec:"CMCD-Status",e:"CMCD-Status"},Il=Ll;function Rl(e,t){var r={};if(!e)return r;var n,i=Object.keys(e),a=t?(n=t,Object.keys(n).reduce((function(e,t){var r;return null===(r=n[t])||void 0===r||r.forEach((function(r){return e[r]=t})),e}),{})):{};return i.reduce((function(t,r){var n,i=Pl[r]||a[r]||Il;return(null!==(n=t[i])&&void 0!==n?n:t[i]={})[r]=e[r],t}),r)}var Cl="event",Dl=function(e){return Math.round(e)},Ol=function(e){return 100*Dl(e/100)},zl={br:Dl,d:Dl,bl:Ol,dl:Ol,mtp:Ol,nor:function(e,t){var r=e;return t.version>=2&&(e instanceof gl&&"string"==typeof e.value?r=new gl([e]):"string"==typeof e&&(r=[e])),function e(t,r){return Array.isArray(t)?t.map((function(t){return e(t,r)})):t instanceof gl&&"string"==typeof t.value?new gl(e(t.value,r),t.params):(r.baseUrl&&(t=function(e,t){var r=new URL(e),n=new URL(t);if(r.origin!==n.origin)return e;for(var i=r.pathname.split("/").slice(1),a=n.pathname.split("/").slice(1,-1);i[0]===a[0];)i.shift(),a.shift();for(;a.length;)a.shift(),i.unshift("..");return i.join("/")+r.search+r.hash}(t,r.baseUrl)),1===r.version?encodeURIComponent(t):t)}(r,t)},rtp:Ol,tb:Dl},Ml="request",xl="response",Bl=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],Fl=["e"],Nl=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function Ul(e){return Nl.test(e)}var jl=["d","dl","nor","ot","rtp","su"],Gl=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],Yl=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function Vl(e){return Yl.includes(e)||Ul(e)}var Hl=(d(g={},xl,(function(e){return Bl.includes(e)||jl.includes(e)||Gl.includes(e)||Ul(e)})),d(g,Cl,(function(e){return Bl.includes(e)||Fl.includes(e)||Ul(e)})),d(g,Ml,(function(e){return Bl.includes(e)||jl.includes(e)||Ul(e)})),g);function Kl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};if(null==e||"object"!=typeof e)return r;var n=t.version||e.v||1,i=t.reportingMode||Ml,a=1===n?Vl:Hl[i],o=Object.keys(e).filter(a),s=t.filter;"function"==typeof s&&(o=o.filter(s));var l=i===xl||i===Cl;l&&!o.includes("ts")&&o.push("ts"),n>1&&!o.includes("v")&&o.push("v");var u=cr({},zl,t.formatters),c={version:n,reportingMode:i,baseUrl:t.baseUrl};return o.sort().forEach((function(t){var i=e[t],a=u[t];if("function"==typeof a&&(i=a(i,c)),"v"===t){if(1===n)return;i=n}"pr"==t&&1===i||(l&&"ts"===t&&!Wt(i)&&(i=Date.now()),function(e){return"number"==typeof e?Wt(e):null!=e&&""!==e&&!1!==e}(i)&&(function(e){return["ot","sf","st","e","sta"].includes(e)}(t)&&"string"==typeof i&&(i=new yl(i)),r[t]=i))})),r}function Ql(e,t,r){return cr(e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={};if(!e)return r;var n=Rl(Kl(e,t),null==t?void 0:t.customHeaderMap);return Object.entries(n).reduce((function(e,t){var r=a(t,2),n=r[0],i=_l(r[1],{whitespace:!1});return i&&(e[n]=i),e}),r)}(t,r))}function Wl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e?_l(Kl(e,t),{whitespace:!1}):""}(e,t);return encodeURIComponent(r)}var ql=/CMCD=[^&#]+/;function Xl(e,t,r){var n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)return"";var r=Wl(e,t);return"".concat("CMCD","=").concat(r)}(t,r);if(!n)return e;if(ql.test(e))return e.replace(ql,n);var i=e.includes("?")?"&":"?";return"".concat(e).concat(i).concat(n)}function Jl(e,t,r,n){e&&Object.keys(t).forEach((function(a){var o=e.filter((function(e){return e.groupId===a})).map((function(e){var i=cr({},e);return i.details=void 0,i.attrs=new Ji(i.attrs),i.url=i.attrs.URI=Zl(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",r),i.groupId=i.attrs["GROUP-ID"]=t[a],i.attrs["PATHWAY-ID"]=n,i}));e.push.apply(e,i(o))}))}function Zl(e,t,r,n){var i,a=n.HOST,o=n.PARAMS,s=n[r];t&&(i=null==s?void 0:s[t])&&(e=i);var l=new self.URL(e);return a&&!i&&(l.host=a),o&&Object.keys(o).sort().forEach((function(e){e&&l.searchParams.set(e,o[e])})),l.href}var $l=function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,"eme",e.logger)).hls=void 0,n.config=void 0,n.media=null,n.keyFormatPromise=null,n.keySystemAccessPromises={},n._requestLicenseFailureCount=0,n.mediaKeySessions=[],n.keyIdToKeySessionPromise={},n.mediaKeys=null,n.setMediaKeysQueue=r.CDMCleanupPromise?[r.CDMCleanupPromise]:[],n.bannedKeyIds={},n.onMediaEncrypted=function(e){var t=e.initDataType,r=e.initData,i='"'.concat(e.type,'" event: init data type: "').concat(t,'"');if(n.debug(i),null!==r){if(!n.keyFormatPromise){var a=Object.keys(n.keySystemAccessPromises);a.length||(a=ya(n.config));var o=a.map(va).filter((function(e){return!!e}));n.keyFormatPromise=n.getKeyFormatPromise(o)}n.keyFormatPromise.then((function(a){var o=ga(a);if("sinf"===t&&o===ca.FAIRPLAY){var s;try{var u=Vr(new Uint8Array(r)),c=an(aa(JSON.parse(u).sinf));if(!c)throw new Error("'schm' box missing or not cbcs/cenc with schi > tenc");s=new Uint8Array(c.subarray(8,24))}catch(e){return void n.warn("".concat(i," Failed to parse sinf: ").concat(e))}for(var f=Tr(s),d=l(n),h=d.keyIdToKeySessionPromise,p=d.mediaKeySessions,g=h[f],v=function(e){var i=p[e],a=i.decryptdata;if(!a.keyId)return"continue";var o=Tr(a.keyId);return ta(s,a.keyId)||-1!==a.uri.replace(/-/g,"").indexOf(f)?(g=h[o])?(a.pssh||(delete h[o],a.pssh=new Uint8Array(r),a.keyId=s,(g=h[f]=g.then((function(){return n.generateRequestWithPreferredKeySession(i,t,r,"encrypted-event-key-match")}))).catch((function(e){return n.handleError(e)}))),"break"):"continue":void 0},y=0;y<p.length;y++){var m=v(y);if("continue"!==m&&"break"===m)break}g||n.handleError(new Error("Key ID ".concat(f," not encountered in playlist. Key-system sessions ").concat(p.length,".")))}else n.log('Ignoring "'.concat(e.type,'" event with init data type: "').concat(t,'" for selected key-system ').concat(o))})).catch((function(e){return n.handleError(e)}))}},n.onWaitingForKey=function(e){n.log('"'.concat(e.type,'" event'))},n.hls=e,n.config=e.config,n.registerListeners(),n}return p(r,[{key:"destroy",value:function(){this.onDestroying(),this.onMediaDetached();var e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}},{key:"registerListeners",value:function(){this.hls.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on($t.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on($t.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on($t.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on($t.DESTROYING,this.onDestroying,this)}},{key:"unregisterListeners",value:function(){this.hls.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off($t.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off($t.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off($t.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off($t.DESTROYING,this.onDestroying,this)}},{key:"getLicenseServerUrl",value:function(e){var t=this.config,r=t.drmSystems,n=t.widevineLicenseUrl,i=null==r?void 0:r[e];return i?i.licenseUrl:e===ca.WIDEVINE&&n?n:void 0}},{key:"getLicenseServerUrlOrThrow",value:function(e){var t=this.getLicenseServerUrl(e);if(void 0===t)throw new Error('no license server URL configured for key-system "'.concat(e,'"'));return t}},{key:"getServerCertificateUrl",value:function(e){var t=this.config.drmSystems,r=null==t?void 0:t[e];if(r)return r.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'.concat(e,'"]'))}},{key:"attemptKeySystemAccess",value:function(e){var t=this,r=this.hls.levels,n=function(e,t,r){return!!e&&r.indexOf(e)===t},i=r.map((function(e){return e.audioCodec})).filter(n),a=r.map((function(e){return e.videoCodec})).filter(n);return i.length+a.length===0&&a.push("avc1.42e01e"),new Promise((function(r,n){!function e(o){var s=o.shift();t.getMediaKeysPromise(s,i,a).then((function(e){return r({keySystem:s,mediaKeys:e})})).catch((function(t){o.length?e(o):n(t instanceof ru?t:new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))}))}(e)}))}},{key:"requestMediaKeySystemAccess",value:function(e,t){var r=this.config.requestMediaKeySystemAccessFunc;if("function"!=typeof r){var n="Configured requestMediaKeySystemAccess is not a function ".concat(r);return null===Aa&&"http:"===self.location.protocol&&(n="navigator.requestMediaKeySystemAccess is not available over insecure protocol ".concat(location.protocol)),Promise.reject(new Error(n))}return r(e,t)}},{key:"getMediaKeysPromise",value:function(e,t,r){var n,i=this,a=function(e,t,r,n){var i;switch(e){case ca.FAIRPLAY:i=["cenc","sinf"];break;case ca.WIDEVINE:case ca.PLAYREADY:i=["cenc"];break;case ca.CLEARKEY:i=["cenc","keyids"];break;default:throw new Error("Unknown key-system: ".concat(e))}return function(e,t,r,n){return[{initDataTypes:e,persistentState:n.persistentState||"optional",distinctiveIdentifier:n.distinctiveIdentifier||"optional",sessionTypes:n.sessionTypes||[n.sessionType||"temporary"],audioCapabilities:t.map((function(e){return{contentType:"audio/mp4; codecs=".concat(e),robustness:n.audioRobustness||"",encryptionScheme:n.audioEncryptionScheme||null}})),videoCapabilities:r.map((function(e){return{contentType:"video/mp4; codecs=".concat(e),robustness:n.videoRobustness||"",encryptionScheme:n.videoEncryptionScheme||null}}))}]}(i,t,r,n)}(e,t,r,this.config.drmSystemOptions||{}),o=this.keySystemAccessPromises[e],s=null==(n=o)?void 0:n.keySystemAccess;if(!s){this.log('Requesting encrypted media "'.concat(e,'" key-system access with config: ').concat(Vn(a))),s=this.requestMediaKeySystemAccess(e,a);var l=o=this.keySystemAccessPromises[e]={keySystemAccess:s};return s.catch((function(t){i.log('Failed to obtain access to key-system "'.concat(e,'": ').concat(t))})),s.then((function(t){i.log('Access for key-system "'.concat(t.keySystem,'" obtained'));var r=i.fetchServerCertificate(e);i.log('Create media-keys for "'.concat(e,'"'));var n=l.mediaKeys=t.createMediaKeys().then((function(t){return i.log('Media-keys created for "'.concat(e,'"')),l.hasMediaKeys=!0,r.then((function(r){return r?i.setMediaKeysServerCertificate(t,e,r):t}))}));return n.catch((function(t){i.error('Failed to create media-keys for "'.concat(e,'"}: ').concat(t))})),n}))}return s.then((function(){return o.mediaKeys}))}},{key:"createMediaKeySessionContext",value:function(e){var t=e.decryptdata,r=e.keySystem,n=e.mediaKeys;this.log('Creating key-system session "'.concat(r,'" keyId: ').concat(Tr(t.keyId||[])," keyUri: ").concat(t.uri));var i=n.createSession(),a={decryptdata:t,keySystem:r,mediaKeys:n,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}},{key:"renewKeySession",value:function(e){var t=e.decryptdata;if(t.pssh){var r=this.createMediaKeySessionContext(e),n=eu(t);this.keyIdToKeySessionPromise[n]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}},{key:"updateKeySession",value:function(e,t){var r=e.mediaKeysSession;return this.log('Updating key-session "'.concat(r.sessionId,'" for keyId ').concat(Tr(e.decryptdata.keyId||[]),"\n      } (data length: ").concat(t.byteLength,")")),r.update(t)}},{key:"getSelectedKeySystemFormats",value:function(){var e=this;return Object.keys(this.keySystemAccessPromises).map((function(t){return{keySystem:t,hasMediaKeys:e.keySystemAccessPromises[t].hasMediaKeys}})).filter((function(e){return!!e.hasMediaKeys})).map((function(e){return va(e.keySystem)})).filter((function(e){return!!e}))}},{key:"getKeySystemAccess",value:function(e){var t=this;return this.getKeySystemSelectionPromise(e).then((function(e){var r=e.keySystem,n=e.mediaKeys;return t.attemptSetMediaKeys(r,n)}))}},{key:"selectKeySystem",value:function(e){var t=this;return new Promise((function(r,n){t.getKeySystemSelectionPromise(e).then((function(e){var t=e.keySystem,i=va(t);i?r(i):n(new Error('Unable to find format for key-system "'.concat(t,'"')))})).catch(n)}))}},{key:"selectKeySystemFormat",value:function(e){var t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: ".concat(e.sn," ").concat(e.type,": ").concat(e.level,") key formats ").concat(t.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}},{key:"getKeyFormatPromise",value:function(e){var t=ya(this.config),r=e.map(ga).filter((function(e){return!!e&&-1!==t.indexOf(e)}));return this.selectKeySystem(r)}},{key:"getKeyStatus",value:function(e){for(var t=this.mediaKeySessions,r=0;r<t.length;r++){var n=tu(e,t[r]);if(n)return n}}},{key:"loadKey",value:function(e){var t=this,r=e.keyInfo.decryptdata,n=eu(r),i=this.bannedKeyIds[n];if(i||"internal-error"===this.getKeyStatus(r)){var a=nu(i||"internal-error",r);return this.handleError(a,e.frag),Promise.reject(a)}var o="(keyId: ".concat(n,' format: "').concat(r.keyFormat,'" method: ').concat(r.method," uri: ").concat(r.uri,")");this.log("Starting session for key ".concat(o));var s=this.keyIdToKeySessionPromise[n];if(!s){var l=this.getKeySystemForKeyPromise(r).then((function(n){var i=n.keySystem,a=n.mediaKeys;return t.throwIfDestroyed(),t.log("Handle encrypted media sn: ".concat(e.frag.sn," ").concat(e.frag.type,": ").concat(e.frag.level," using key ").concat(o)),t.attemptSetMediaKeys(i,a).then((function(){return t.throwIfDestroyed(),t.createMediaKeySessionContext({keySystem:i,mediaKeys:a,decryptdata:r})}))})).then((function(e){var n=r.pssh?r.pssh.buffer:null;return t.generateRequestWithPreferredKeySession(e,"cenc",n,"playlist-key")}));return l.catch((function(r){return t.handleError(r,e.frag)})),this.keyIdToKeySessionPromise[n]=l,l}return s.catch((function(n){if(n instanceof ru){var i=dr({},n.data);"internal-error"===t.getKeyStatus(r)&&(i.decryptdata=r);var a=new ru(i,n.message);t.handleError(a,e.frag)}})),s}},{key:"throwIfDestroyed",value:function(){if(!this.hls)throw new Error("invalid state")}},{key:"handleError",value:function(e,t){if(this.hls)if(e instanceof ru){t&&(e.data.frag=t);var r=e.data.decryptdata;this.error("".concat(e.message).concat(r?" (".concat(Tr(r.keyId||[]),")"):"")),this.hls.trigger($t.ERROR,e.data)}else this.error(e.message),this.hls.trigger($t.ERROR,{type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0})}},{key:"getKeySystemForKeyPromise",value:function(e){var t=eu(e),r=this.keyIdToKeySessionPromise[t];if(!r){var n=ga(e.keyFormat),i=n?[n]:ya(this.config);return this.attemptKeySystemAccess(i)}return r}},{key:"getKeySystemSelectionPromise",value:function(e){if(e.length||(e=ya(this.config)),0===e.length)throw new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options ".concat(Vn({drmSystems:this.config.drmSystems})));return this.attemptKeySystemAccess(e)}},{key:"attemptSetMediaKeys",value:function(e,t){var r=this;if(this.mediaKeys===t)return Promise.resolve();var n=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'.concat(e,'"'));var i=Promise.all(n).then((function(){if(!r.media)throw r.mediaKeys=null,new Error("Attempted to set mediaKeys without media element attached");return r.media.setMediaKeys(t)}));return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then((function(){r.log('Media-keys set for "'.concat(e,'"')),n.push(i),r.setMediaKeysQueue=r.setMediaKeysQueue.filter((function(e){return-1===n.indexOf(e)}))}))}},{key:"generateRequestWithPreferredKeySession",value:function(e,t,r,n){var i,a=this,o=null==(i=this.config.drmSystems)||null==(i=i[e.keySystem])?void 0:i.generateRequest;if(o)try{var s=o.call(this.hls,t,r,e);if(!s)throw new Error("Invalid response from configured generateRequest filter");t=s.initDataType,r=s.initData?s.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(e){if(this.warn(e.message),this.hls&&this.hls.config.debug)throw e}if(null===r)return this.log('Skipping key-session request for "'.concat(n,'" (no initData)')),Promise.resolve(e);var l=eu(e.decryptdata),u=e.decryptdata.uri;this.log('Generating key-session request for "'.concat(n,'" keyId: ').concat(l," URI: ").concat(u," (init data type: ").concat(t," length: ").concat(r.byteLength,")"));var c=new wo,f=e._onmessage=function(t){var r=e.mediaKeysSession;if(r){var n=t.messageType,i=t.message;a.log('"'.concat(n,'" message event for session "').concat(r.sessionId,'" message size: ').concat(i.byteLength)),"license-request"===n||"license-renewal"===n?a.renewLicense(e,i).catch((function(e){c.eventNames().length?c.emit("error",e):a.handleError(e)})):"license-release"===n?e.keySystem===ca.FAIRPLAY&&a.updateKeySession(e,oa("acknowledged")).then((function(){return a.removeSession(e)})).catch((function(e){return a.handleError(e)})):a.warn('unhandled media key message type "'.concat(n,'"'))}else c.emit("error",new Error("invalid state"))},d=function(e,t){var r;t.keyStatus=e,e.startsWith("usable")?c.emit("resolved"):"internal-error"===e||"output-restricted"===e||"output-downscaled"===e?r=nu(e,t.decryptdata):"expired"===e?r=new Error("key expired (keyId: ".concat(l,")")):"released"===e?r=new Error("key released"):"status-pending"===e||a.warn('unhandled key status change "'.concat(e,'" (keyId: ').concat(l,")")),r&&(c.eventNames().length?c.emit("error",r):a.handleError(r))},h=e._onkeystatuseschange=function(t){if(e.mediaKeysSession){var r=a.getKeyStatuses(e);if(Object.keys(r).some((function(e){return"status-pending"!==r[e]}))){if("expired"===r[l])return a.log("Expired key ".concat(Vn(r),' in key-session "').concat(e.mediaKeysSession.sessionId,'"')),void a.renewKeySession(e);var n,i=r[l];i?d(i,e):(e.keyStatusTimeouts||(e.keyStatusTimeouts={}),(n=e.keyStatusTimeouts)[l]||(n[l]=self.setTimeout((function(){if(e.mediaKeysSession&&a.mediaKeys){var t=a.getKeyStatus(e.decryptdata);if(t&&"status-pending"!==t)return a.log("No status for keyId ".concat(l,' in key-session "').concat(e.mediaKeysSession.sessionId,'". Using session key-status ').concat(t," from other session.")),d(t,e);a.log("key status for ".concat(l,' in key-session "').concat(e.mediaKeysSession.sessionId,'" timed out after ').concat(1e3,"ms")),d(i="internal-error",e)}}),1e3)),a.log("No status for keyId ".concat(l," (").concat(Vn(r),").")))}}else c.emit("error",new Error("invalid state"))};io(e.mediaKeysSession,"message",f),io(e.mediaKeysSession,"keystatuseschange",h);var p=new Promise((function(e,t){c.on("error",t),c.on("resolved",e)}));return e.mediaKeysSession.generateRequest(t,r).then((function(){a.log('Request generated for key-session "'.concat(e.mediaKeysSession.sessionId,'" keyId: ').concat(l," URI: ").concat(u))})).catch((function(t){throw new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_NO_SESSION,error:t,decryptdata:e.decryptdata,fatal:!1},"Error generating key-session request: ".concat(t))})).then((function(){return p})).catch((function(t){return c.removeAllListeners(),a.removeSession(e).then((function(){throw t}))})).then((function(){return c.removeAllListeners(),e}))}},{key:"getKeyStatuses",value:function(e){var t=this,r={};return e.mediaKeysSession.keyStatuses.forEach((function(n,i){if("string"==typeof i&&"object"==typeof n){var a=i;i=n,n=a}var o="buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i);e.keySystem===ca.PLAYREADY&&16===o.length&&sa(o);var s=Tr(o);"internal-error"===n&&(t.bannedKeyIds[s]=n),t.log('key status change "'.concat(n,'" for keyStatuses keyId: ').concat(s,' key-session "').concat(e.mediaKeysSession.sessionId,'"')),r[s]=n})),r}},{key:"fetchServerCertificate",value:function(e){var t=this.config,r=new(0,t.loader)(t),n=this.getServerCertificateUrl(e);return n?(this.log('Fetching server certificate for "'.concat(e,'"')),new Promise((function(i,a){var o={responseType:"arraybuffer",url:n},s=t.certLoadPolicy.default,l={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},u={onSuccess:function(e,t,r,n){i(e.data)},onError:function(t,r,i,s){a(new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:dr({url:o.url,data:void 0},t)},'"'.concat(e,'" certificate request failed (').concat(n,"). Status: ").concat(t.code," (").concat(t.text,")")))},onTimeout:function(t,r,i){a(new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i,response:{url:o.url,data:void 0}},'"'.concat(e,'" certificate request timed out (').concat(n,")")))},onAbort:function(e,t,r){a(new Error("aborted"))}};r.load(o,l,u)}))):Promise.resolve()}},{key:"setMediaKeysServerCertificate",value:function(e,t,r){var n=this;return new Promise((function(i,a){e.setServerCertificate(r).then((function(a){n.log("setServerCertificate ".concat(a?"success":"not supported by CDM"," (").concat(r.byteLength,') on "').concat(t,'"')),i(e)})).catch((function(e){a(new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))}))}))}},{key:"renewLicense",value:function(e,t){var r=this;return this.requestLicense(e,new Uint8Array(t)).then((function(t){return r.updateKeySession(e,new Uint8Array(t)).catch((function(t){throw new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:t,fatal:!1},t.message)}))}))}},{key:"unpackPlayReadyKeyMessage",value:function(e,t){var r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;var n=(new DOMParser).parseFromString(r,"application/xml"),i=n.querySelectorAll("HttpHeader");if(i.length>0)for(var a,o=0,s=i.length;o<s;o++){var l,u,c=null==(l=(a=i[o]).querySelector("name"))?void 0:l.textContent,f=null==(u=a.querySelector("value"))?void 0:u.textContent;c&&f&&e.setRequestHeader(c,f)}var d=n.querySelector("Challenge"),h=null==d?void 0:d.textContent;if(!h)throw new Error("Cannot find <Challenge> in key message");return oa(atob(h))}},{key:"setupLicenseXHR",value:function(e,t,r,n){var i=this,a=this.config.licenseXhrSetup;return a?Promise.resolve().then((function(){if(!r.decryptdata)throw new Error("Key removed");return a.call(i.hls,e,t,r,n)})).catch((function(o){if(!r.decryptdata)throw o;return e.open("POST",t,!0),a.call(i.hls,e,t,r,n)})).then((function(r){return e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:r||n}})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:n}))}},{key:"requestLicense",value:function(e,t){var r=this,n=this.config.keyLoadPolicy.default;return new Promise((function(i,a){var o=r.getLicenseServerUrlOrThrow(e.keySystem);r.log("Sending license request to URL: ".concat(o));var s=new XMLHttpRequest;s.responseType="arraybuffer",s.onreadystatechange=function(){if(!r.hls||!e.mediaKeysSession)return a(new Error("invalid state"));if(4===s.readyState)if(200===s.status){r._requestLicenseFailureCount=0;var l=s.response;r.log("License received ".concat(l instanceof ArrayBuffer?l.byteLength:l));var u=r.config.licenseResponseCallback;if(u)try{l=u.call(r.hls,s,o,e)}catch(e){r.error(e)}i(l)}else{var c=n.errorRetry,f=c?c.maxNumRetry:0;if(r._requestLicenseFailureCount++,r._requestLicenseFailureCount>f||s.status>=400&&s.status<500)a(new ru({type:Jt.KEY_SYSTEM_ERROR,details:Zt.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:s,response:{url:o,data:void 0,code:s.status,text:s.statusText}},"License Request XHR failed (".concat(o,"). Status: ").concat(s.status," (").concat(s.statusText,")")));else{var d=f-r._requestLicenseFailureCount+1;r.warn("Retrying license request, ".concat(d," attempts left")),r.requestLicense(e,t).then(i,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=s,r.setupLicenseXHR(s,o,e,t).then((function(t){var n=t.xhr,i=t.licenseChallenge;e.keySystem==ca.PLAYREADY&&(i=r.unpackPlayReadyKeyMessage(n,i)),n.send(i)})).catch(a)}))}},{key:"onDestroying",value:function(){this.unregisterListeners(),this._clear()}},{key:"onMediaAttached",value:function(e,t){if(this.config.emeEnabled){var r=t.media;this.media=r,io(r,"encrypted",this.onMediaEncrypted),io(r,"waitingforkey",this.onWaitingForKey)}}},{key:"onMediaDetached",value:function(){var e=this.media;e&&(ao(e,"encrypted",this.onMediaEncrypted),ao(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}},{key:"_clear",value:function(){var e,t=this;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},this.mediaKeys||this.mediaKeySessions.length){var n=this.media,i=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,ka.clearKeyUriToKeyIdMap();var a=i.length;r.CDMCleanupPromise=Promise.all(i.map((function(e){return t.removeSession(e)})).concat((null==n||null==(e=n.setMediaKeys(null))?void 0:e.catch((function(e){t.log("Could not clear media keys: ".concat(e)),t.hls&&t.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:new Error("Could not clear media keys: ".concat(e))})})))||Promise.resolve())).catch((function(e){t.log("Could not close sessions and clear media keys: ".concat(e)),t.hls&&t.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close sessions and clear media keys: ".concat(e))})})).then((function(){a&&t.log("finished closing key sessions and clearing media keys")}))}}},{key:"onManifestLoading",value:function(){this.keyFormatPromise=null,this.bannedKeyIds={}}},{key:"onManifestLoaded",value:function(e,t){var r=t.sessionKeys;if(r&&this.config.emeEnabled&&!this.keyFormatPromise){var n=r.reduce((function(e,t){return-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e}),[]);this.log("Selecting key-system from session-keys ".concat(n.join(", "))),this.keyFormatPromise=this.getKeyFormatPromise(n)}}},{key:"removeSession",value:function(e){var t=this,r=e.mediaKeysSession,n=e.licenseXhr,i=e.decryptdata;if(r){this.log('Remove licenses and keys and close session "'.concat(r.sessionId,'" keyId: ').concat(Tr((null==i?void 0:i.keyId)||[]))),e._onmessage&&(r.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(r.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),n&&n.readyState!==XMLHttpRequest.DONE&&n.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;var a=this.mediaKeySessions.indexOf(e);a>-1&&this.mediaKeySessions.splice(a,1);var o=e.keyStatusTimeouts;return o&&Object.keys(o).forEach((function(e){return self.clearTimeout(o[e])})),(function(e){var t;return!(!e||"persistent-license"!==e.sessionType&&(null==(t=e.sessionTypes)||!t.some((function(e){return"persistent-license"===e}))))}(this.config.drmSystemOptions)?new Promise((function(e,t){self.setTimeout((function(){return t(new Error("MediaKeySession.remove() timeout"))}),8e3),r.remove().then(e).catch(t)})):Promise.resolve()).catch((function(e){t.log("Could not remove session: ".concat(e)),t.hls&&t.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:new Error("Could not remove session: ".concat(e))})})).then((function(){return r.close()})).catch((function(e){t.log("Could not close session: ".concat(e)),t.hls&&t.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:new Error("Could not close session: ".concat(e))})}))}return Promise.resolve()}}]),r}(hr);function eu(e){if(!e)throw new Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw new Error("keyId is null");return Tr(e.keyId)}function tu(e,t){return e.keyId&&t.mediaKeysSession.keyStatuses.has(e.keyId)?t.mediaKeysSession.keyStatuses.get(e.keyId):e.matches(t.decryptdata)?t.keyStatus:void 0}$l.CDMCleanupPromise=void 0;var ru=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,n)).data=void 0,e.error||(e.error=new Error(n)),i.data=e,e.err=e.error,i}return r}(u(Error));function nu(e,t){var r="output-restricted"===e,n=r?Zt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:Zt.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new ru({type:Jt.KEY_SYSTEM_ERROR,details:n,fatal:!1,decryptdata:t},r?"HDCP level output restricted":'key status changed to "'.concat(e,'"'))}function iu(e,t){var r;try{r=new Event("addtrack")}catch(e){(r=document.createEvent("Event")).initEvent("addtrack",!1,!1)}r.track=e,t.dispatchEvent(r)}function au(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw new Error("addCue is failed for: ".concat(t))}catch(r){Ar.debug("[texttrack-utils]: ".concat(r));try{var n=new self.TextTrackCue(t.startTime,t.endTime,t.text);n.id=t.id,e.addCue(n)}catch(e){Ar.debug("[texttrack-utils]: Legacy TextTrackCue fallback failed: ".concat(e))}}"disabled"===r&&(e.mode=r)}function ou(e,t){var r=e.mode;if("disabled"===r&&(e.mode="hidden"),e.cues)for(var n=e.cues.length;n--;)t&&e.cues[n].removeEventListener("enter",t),e.removeCue(e.cues[n]);"disabled"===r&&(e.mode=r)}function su(e,t,r,n){var i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&e.cues.length>0)for(var a=function(e,t,r){var n=[],i=function(e,t){if(t<=e[0].startTime)return 0;var r=e.length-1;if(t>e[r].endTime)return-1;for(var n,i=0,a=r;i<=a;)if(t<e[n=Math.floor((a+i)/2)].startTime)a=n-1;else{if(!(t>e[n].startTime&&i<r))return n;i=n+1}return e[i].startTime-t<t-e[a].startTime?i:a}(e,t);if(i>-1)for(var a=i,o=e.length;a<o;a++){var s=e[a];if(s.startTime>=t&&s.endTime<=r)n.push(s);else if(s.startTime>r)return n}return n}(e.cues,t,r),o=0;o<a.length;o++)n&&!n(a[o])||e.removeCue(a[o]);"disabled"===i&&(e.mode=i)}function lu(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];"subtitles"!==n.kind&&"captions"!==n.kind||!n.label||t.push(e[r])}return t}function uu(e){for(var t=5381,r=e.length;r;)t=33*t^e.charCodeAt(--r);return(t>>>0).toString()}var cu=.025,fu=function(e){return e[e.Point=0]="Point",e[e.Range=1]="Range",e}({});function du(e,t,r){return"".concat(e.identifier,"-").concat(r+1,"-").concat(uu(t))}var hu=function(){function e(t,r){h(this,e),this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=r,this.dateRange=t,this.setDateRange(t)}return p(e,[{key:"setDateRange",value:function(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}},{key:"reset",value:function(){var e;this.appendInPlaceStarted=!1,null==(e=this.assetListLoader)||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}},{key:"isAssetPastPlayoutLimit",value:function(e){var t;if(e>0&&e>=this.assetList.length)return!0;var r=this.playoutLimit;return!(e<=0||isNaN(r))&&(0===r||((null==(t=this.assetList[e])?void 0:t.startOffset)||0)>r)}},{key:"findAssetIndex",value:function(e){return this.assetList.indexOf(e)}},{key:"toString",value:function(){return'["'.concat((e=this).identifier,'" ').concat(e.cue.pre?"<pre>":e.cue.post?"<post>":"").concat(e.timelineStart.toFixed(2),"-").concat(e.resumeTime.toFixed(2),"]");var e}},{key:"identifier",get:function(){return this.dateRange.id}},{key:"startDate",get:function(){return this.dateRange.startDate}},{key:"startTime",get:function(){var e=this.dateRange.startTime;if(this.snapOptions.out){var t=this.dateRange.tagAnchor;if(t)return pu(e,t)}return e}},{key:"startOffset",get:function(){return this.cue.pre?0:this.startTime}},{key:"startIsAligned",get:function(){if(0===this.startTime||this.snapOptions.out)return!0;var e=this.dateRange.tagAnchor;if(e){var t=this.dateRange.startTime;return t-pu(t,e)<.1}return!1}},{key:"resumptionOffset",get:function(){var e=this.resumeOffset,t=Wt(e)?e:this.duration;return this.cumulativeDuration+t}},{key:"resumeTime",get:function(){var e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){var t=this.resumeAnchor;if(t)return pu(e,t)}return e}},{key:"appendInPlace",get:function(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!(this.cue.once||this.cue.pre||!this.startIsAligned||!(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&Math.abs(this.resumeOffset-this.duration)<cu))},set:function(e){this.appendInPlaceStarted?this.resetOnResume=!e:this.appendInPlaceDisabled=!e}},{key:"timelineStart",get:function(){return null!==this._timelineStart?this._timelineStart:this.startTime},set:function(e){this._timelineStart=e}},{key:"duration",get:function(){var e,t=this.playoutLimit;return e=null!==this._duration?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e},set:function(e){this._duration=e}},{key:"cue",get:function(){return this.dateRange.cue}},{key:"timelineOccupancy",get:function(){return"RANGE"===this.dateRange.attr["X-TIMELINE-OCCUPIES"]?fu.Range:fu.Point}},{key:"supplementsPrimary",get:function(){return"PRIMARY"===this.dateRange.attr["X-TIMELINE-STYLE"]}},{key:"contentMayVary",get:function(){return"NO"!==this.dateRange.attr["X-CONTENT-MAY-VARY"]}},{key:"assetUrl",get:function(){return this.dateRange.attr["X-ASSET-URI"]}},{key:"assetListUrl",get:function(){return this.dateRange.attr["X-ASSET-LIST"]}},{key:"baseUrl",get:function(){return this.base.url}},{key:"assetListLoaded",get:function(){return this.assetList.length>0||null!==this.assetListResponse}}]),e}();function pu(e,t){return e-t.start<t.duration/2&&!(Math.abs(e-(t.start+t.duration))<cu)?t.start:t.start+t.duration}function gu(e,t,r){var n=new self.URL(e,r);return"data:"!==n.protocol&&n.searchParams.set("_HLS_primary_id",t),n}function vu(e,t){for(;null!=(r=e.assetList[++t])&&r.error;)var r;return t}function yu(e){var t=e.timelineStart,r=e.duration||0;return'["'.concat(e.identifier,'" ').concat(t.toFixed(2),"-").concat((t+r).toFixed(2),"]")}var mu=function(){function e(t,r,n,i){var a=this;h(this,e),this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=function(){a.reachedPlayout(a.currentTime)&&a.hls&&a.hls.trigger($t.PLAYOUT_LIMIT_REACHED,{})};var o=this.hls=new t(r);this.interstitial=n,this.assetItem=i;var s=function(){a.hasDetails=!0};o.once($t.LEVEL_LOADED,s),o.once($t.AUDIO_TRACK_LOADED,s),o.once($t.SUBTITLE_TRACK_LOADED,s),o.on($t.MEDIA_ATTACHING,(function(e,t){var r=t.media;a.removeMediaListeners(),a.mediaAttached=r,a.interstitial.playoutLimit&&(r.addEventListener("timeupdate",a.checkPlayout),a.appendInPlace&&o.on($t.BUFFER_APPENDED,(function(){var e=a.bufferedEnd;a.reachedPlayout(e)&&(a._bufferedEosTime=e,o.trigger($t.BUFFERED_TO_END,void 0))})))}))}return p(e,[{key:"loadSource",value:function(){var e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{var t=this.assetItem.uri;try{t=gu(t,e.config.primarySessionId||"").href}catch(e){}e.loadSource(t)}}},{key:"bufferedInPlaceToEnd",value:function(e){var t;if(!this.appendInPlace)return!1;if(null!=(t=this.hls)&&t.bufferedToEnd)return!0;if(!e)return!1;var r=Math.min(this._bufferedEosTime||1/0,this.duration),n=this.timelineOffset,i=Yi.bufferInfo(e,n,0);return this.getAssetTime(i.end)>=r-.02}},{key:"reachedPlayout",value:function(e){var t=this.interstitial.playoutLimit;return this.startOffset+e>=t}},{key:"getAssetTime",value:function(e){var t=this.timelineOffset,r=this.duration;return Math.min(Math.max(0,e-t),r)}},{key:"removeMediaListeners",value:function(){var e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}},{key:"bufferSnapShot",value:function(){var e;this.mediaAttached&&null!=(e=this.hls)&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}},{key:"destroy",value:function(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}},{key:"attachMedia",value:function(e){var t;this.loadSource(),null==(t=this.hls)||t.attachMedia(e)}},{key:"detachMedia",value:function(){var e;this.removeMediaListeners(),this.mediaAttached=null,null==(e=this.hls)||e.detachMedia()}},{key:"resumeBuffering",value:function(){var e;null==(e=this.hls)||e.resumeBuffering()}},{key:"pauseBuffering",value:function(){var e;null==(e=this.hls)||e.pauseBuffering()}},{key:"transferMedia",value:function(){var e;return this.bufferSnapShot(),(null==(e=this.hls)?void 0:e.transferMedia())||null}},{key:"resetDetails",value:function(){var e=this.hls;if(e&&this.hasDetails){e.stopLoad();var t=function(e){return delete e.details};e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}},{key:"on",value:function(e,t,r){var n;null==(n=this.hls)||n.on(e,t)}},{key:"once",value:function(e,t,r){var n;null==(n=this.hls)||n.once(e,t)}},{key:"off",value:function(e,t,r){var n;null==(n=this.hls)||n.off(e,t)}},{key:"toString",value:function(){var e;return"HlsAssetPlayer: ".concat(yu(this.assetItem)," ").concat(null==(e=this.hls)?void 0:e.sessionId," ").concat(this.appendInPlace?"append-in-place":"")}},{key:"appendInPlace",get:function(){return this.interstitial.appendInPlace}},{key:"destroyed",get:function(){var e;return!(null!=(e=this.hls)&&e.userConfig)}},{key:"assetId",get:function(){return this.assetItem.identifier}},{key:"interstitialId",get:function(){return this.assetItem.parentIdentifier}},{key:"media",get:function(){var e;return(null==(e=this.hls)?void 0:e.media)||null}},{key:"bufferedEnd",get:function(){var e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;var t=Yi.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}},{key:"currentTime",get:function(){var e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}},{key:"duration",get:function(){var e=this.assetItem.duration;if(!e)return 0;var t=this.interstitial.playoutLimit;if(t){var r=t-this.startOffset;if(r>0&&r<e)return r}return e}},{key:"remaining",get:function(){var e=this.duration;return e?Math.max(0,e-this.currentTime):0}},{key:"startOffset",get:function(){return this.assetItem.startOffset}},{key:"timelineOffset",get:function(){var e;return(null==(e=this.hls)?void 0:e.config.timelineOffset)||0},set:function(e){var t=this.timelineOffset;if(e!==t){var r=e-t;if(Math.abs(r)>1/9e4&&this.hls){if(this.hasDetails)throw new Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}}}]),e}(),Au=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,"interstitials-sched",n)).onScheduleUpdate=void 0,i.eventMap={},i.events=null,i.items=null,i.durations={primary:0,playout:0,integrated:0},i.onScheduleUpdate=e,i}return p(r,[{key:"destroy",value:function(){this.reset(),this.onScheduleUpdate=null}},{key:"reset",value:function(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach((function(e){return e.reset()})),this.events=this.items=null}},{key:"resetErrorsInRange",value:function(e,t){return this.events?this.events.reduce((function(r,n){return e<=n.startOffset&&t>n.startOffset?(delete n.error,r+1):r}),0):0}},{key:"getEvent",value:function(e){return e&&this.eventMap[e]||null}},{key:"hasEvent",value:function(e){return e in this.eventMap}},{key:"findItemIndex",value:function(e,t){if(e.event)return this.findEventIndex(e.event.identifier);var r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);var n=this.items;if(n)for(n[r]||(void 0===t&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&null!=(i=n[r])&&i.event;){var i;r--}return r}},{key:"findItemIndexAtTime",value:function(e,t){var r=this.items;if(r)for(var n=0;n<r.length;n++){var i=r[n];if(t&&"primary"!==t&&(i=i[t]),e===i.start||e>i.start&&e<i.end)return n}return-1}},{key:"findJumpRestrictedIndex",value:function(e,t){var r=this.items;if(r)for(var n=e;n<=t&&r[n];n++){var i=r[n].event;if(null!=i&&i.restrictions.jump&&!i.appendInPlace)return n}return-1}},{key:"findEventIndex",value:function(e){var t=this.items;if(t)for(var r=t.length;r--;){var n;if((null==(n=t[r].event)?void 0:n.identifier)===e)return r}return-1}},{key:"findAssetIndex",value:function(e,t){var r=e.assetList,n=r.length;if(n>1)for(var i=0;i<n;i++){var a=r[i];if(!a.error){var o=a.timelineStart;if(t===o||t>o&&(t<o+(a.duration||0)||i===n-1))return i}}return 0}},{key:"parseInterstitialDateRanges",value:function(e,t){var r=this,n=e.main.details,i=n.dateRanges,a=this.events,o=this.parseDateRanges(i,{url:n.url},t),s=Object.keys(i),l=a?a.filter((function(e){return!s.includes(e.identifier)})):[];o.length&&o.sort((function(e,t){var r=e.cue.pre,n=e.cue.post,i=t.cue.pre,a=t.cue.post;if(r&&!i)return-1;if(i&&!r)return 1;if(n&&!a)return 1;if(a&&!n)return-1;if(!(r||i||n||a)){var o=e.startTime,s=t.startTime;if(o!==s)return o-s}return e.dateRange.tagOrder-t.dateRange.tagOrder})),this.events=o,l.forEach((function(e){r.removeEvent(e)})),this.updateSchedule(e,l)}},{key:"updateSchedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.events||[];if(n.length||t.length||this.length<2){var i=this.items,a=this.parseSchedule(n,e);(r||t.length||(null==i?void 0:i.length)!==a.length||a.some((function(e,t){return Math.abs(e.playout.start-i[t].playout.start)>.005||Math.abs(e.playout.end-i[t].playout.end)>.005})))&&(this.items=a,this.onScheduleUpdate(t,i))}}},{key:"parseDateRanges",value:function(e,t,r){for(var n=[],i=Object.keys(e),a=0;a<i.length;a++){var o=i[a],s=e[o];if(s.isInterstitial){var l=this.eventMap[o];l?l.setDateRange(s):(l=new hu(s,t),this.eventMap[o]=l,!1===r&&(l.appendInPlace=r)),n.push(l)}}return n}},{key:"parseSchedule",value:function(e,t){var r=[],n=t.main.details,i=n.live?1/0:n.edge,a=0;if((e=e.filter((function(e){return!(e.error||e.cue.once&&e.hasPlayed)}))).length){this.resolveOffsets(e,t);var o=0,s=0;if(e.forEach((function(t,n){var l=t.cue.pre,u=t.cue.post,c=e[n-1]||null,f=t.appendInPlace,d=u?i:t.startOffset,h=t.duration,p=t.timelineOccupancy===fu.Range?h:0,g=t.resumptionOffset,v=(null==c?void 0:c.startTime)===d,y=d+t.cumulativeDuration,m=f?y+h:d+g;if(l||!u&&d<=0){var A=s;s+=p,t.timelineStart=y;var b=a;a+=h,r.push({event:t,start:y,end:m,playout:{start:b,end:a},integrated:{start:A,end:s}})}else{if(!(d<=i))return;if(!v){var E=d-o;if(E>.033){var k=o,T=s;s+=E;var S=a;a+=E;var w={previousEvent:e[n-1]||null,nextEvent:t,start:k,end:k+E,playout:{start:S,end:a},integrated:{start:T,end:s}};r.push(w)}else E>0&&c&&(c.cumulativeDuration+=E,r[r.length-1].end=d)}u&&(m=y),t.timelineStart=y;var _=s;s+=p;var L=a;a+=h,r.push({event:t,start:y,end:m,playout:{start:L,end:a},integrated:{start:_,end:s}})}var P=t.resumeTime;o=u||P>i?i:P})),o<i){var l,u=o,c=s,f=i-o;s+=f;var d=a;a+=f,r.push({previousEvent:(null==(l=r[r.length-1])?void 0:l.event)||null,nextEvent:null,start:o,end:u+f,playout:{start:d,end:a},integrated:{start:c,end:s}})}this.setDurations(i,a,s)}else r.push({previousEvent:null,nextEvent:null,start:0,end:i,playout:{start:0,end:i},integrated:{start:0,end:i}}),this.setDurations(i,i,i);return r}},{key:"setDurations",value:function(e,t,r){this.durations={primary:e,playout:t,integrated:r}}},{key:"resolveOffsets",value:function(e,t){var r=this,n=t.main.details,i=n.live?1/0:n.edge,a=0,o=-1;e.forEach((function(s,l){var u=s.cue.pre,c=s.cue.post,f=u?0:c?i:s.startTime;r.updateAssetDurations(s),o===f?s.cumulativeDuration=a:(a=0,o=f),!c&&s.snapOptions.in&&(s.resumeAnchor=ei(null,n.fragments,s.startOffset+s.resumptionOffset,0,0)||void 0),s.appendInPlace&&!s.appendInPlaceStarted&&(r.primaryCanResumeInPlaceAt(s,t)||(s.appendInPlace=!1)),!s.appendInPlace&&l+1<e.length&&e[l+1].startTime-e[l].resumeTime<.033&&(e[l+1].appendInPlace=!1,e[l+1].appendInPlace&&r.warn("Could not change append strategy for abutting event ".concat(s)));var d=Wt(s.resumeOffset)?s.resumeOffset:s.duration;a+=d}))}},{key:"primaryCanResumeInPlaceAt",value:function(e,t){var r=this,n=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(n-i)>cu?(this.log('"'.concat(e.identifier,'" resumption ').concat(n," not aligned with estimated timeline end ").concat(i)),!1):!Object.keys(t).some((function(i){var a=t[i].details,o=a.edge;if(n>=o)return r.log('"'.concat(e.identifier,'" resumption ').concat(n," past ").concat(i," playlist end ").concat(o)),!1;var s=ei(null,a.fragments,n);if(!s)return r.log('"'.concat(e.identifier,'" resumption ').concat(n," does not align with any fragments in ").concat(i," playlist (").concat(a.fragStart,"-").concat(a.fragmentEnd,")")),!0;var l="audio"===i?.175:0;return!(Math.abs(s.start-n)<cu+l||Math.abs(s.end-n)<cu+l)&&(r.log('"'.concat(e.identifier,'" resumption ').concat(n," not aligned with ").concat(i," fragment bounds (").concat(s.start,"-").concat(s.end," sn: ").concat(s.sn," cc: ").concat(s.cc,")")),!0)}))}},{key:"updateAssetDurations",value:function(e){if(e.assetListLoaded){for(var t=e.timelineStart,r=0,n=!1,i=!1,a=0;a<e.assetList.length;a++){var o=e.assetList[a],s=t+r;o.startOffset=r,o.timelineStart=s,n||(n=null===o.duration),i||(i=!!o.error),r+=o.error?0:o.duration||0}e.duration=n&&!i?Math.max(r,e.duration):r}}},{key:"removeEvent",value:function(e){e.reset(),delete this.eventMap[e.identifier]}},{key:"duration",get:function(){var e=this.items;return e?e[e.length-1].end:0}},{key:"length",get:function(){return this.items?this.items.length:0}},{key:"assetIdAtEnd",get:function(){var e,t=null==(e=this.items)||null==(e=e[this.length-1])?void 0:e.event;if(t){var r=t.assetList,n=r[r.length-1];if(n)return n.identifier}return null}}]),r}(hr);function bu(e){return"[".concat(e.event?'"'+e.event.identifier+'"':"primary",": ").concat(e.start.toFixed(2),"-").concat(e.end.toFixed(2),"]")}var Eu=function(){function e(t){h(this,e),this.hls=void 0,this.hls=t}return p(e,[{key:"destroy",value:function(){this.hls=null}},{key:"loadAssetList",value:function(e,t){var r,n=this,i=e.assetListUrl;try{r=gu(i,this.hls.sessionId,e.baseUrl)}catch(t){var a=this.assignAssetListError(e,Zt.ASSET_LIST_LOAD_ERROR,t,i);return void this.hls.trigger($t.ERROR,a)}t&&"data:"!==r.protocol&&r.searchParams.set("_HLS_start_offset",""+t);var o=this.hls.config,s=new(0,o.loader)(o),l={responseType:"json",url:r.href},u=o.interstitialAssetListLoadPolicy.default,c={loadPolicy:u,timeout:u.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},f={onSuccess:function(t,r,i,a){var o=t.data,s=null==o?void 0:o.ASSETS;if(Array.isArray(s))e.assetListResponse=o,n.hls.trigger($t.ASSET_LIST_LOADED,{event:e,assetListResponse:o,networkDetails:a});else{var l=n.assignAssetListError(e,Zt.ASSET_LIST_PARSING_ERROR,new Error("Invalid interstitial asset list"),i.url,r,a);n.hls.trigger($t.ERROR,l)}},onError:function(t,r,i,a){var o=n.assignAssetListError(e,Zt.ASSET_LIST_LOAD_ERROR,new Error("Error loading X-ASSET-LIST: HTTP status ".concat(t.code," ").concat(t.text," (").concat(r.url,")")),r.url,a,i);n.hls.trigger($t.ERROR,o)},onTimeout:function(t,r,i){var a=n.assignAssetListError(e,Zt.ASSET_LIST_LOAD_TIMEOUT,new Error("Timeout loading X-ASSET-LIST (".concat(r.url,")")),r.url,t,i);n.hls.trigger($t.ERROR,a)}};return s.load(l,c,f),this.hls.trigger($t.ASSET_LIST_LOADING,{event:e}),s}},{key:"assignAssetListError",value:function(e,t,r,n,i,a){return e.error=r,{type:Jt.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:n,error:r,networkDetails:a,stats:i}}}]),e}();function ku(e){null==e||e.play().catch((function(){}))}function Tu(e,t){return"[".concat(e,"] Advancing timeline position to ").concat(t)}var Su=function e(t){h(this,e),this.buffered=void 0;var r=function(e,r,n){if((r>>>=0)>n-1)throw new DOMException("Failed to execute '".concat(e,"' on 'TimeRanges': The index provided (").concat(r,") is greater than the maximum bound (").concat(n,")"));return t[r][e]};this.buffered={get length(){return t.length},end:function(e){return r("end",e,t.length)},start:function(e){return r("start",e,t.length)}}},wu={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},_u=function(e){return String.fromCharCode(wu[e]||e)},Lu=100,Pu={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Iu={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ru={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},Cu={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Du=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],Ou=function(){function e(){h(this,e),this.time=null,this.verboseLevel=0}return p(e,[{key:"log",value:function(e,t){if(this.verboseLevel>=e){var r="function"==typeof t?t():t;Ar.log("".concat(this.time," [").concat(e,"] ").concat(r))}}}]),e}(),zu=function(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].toString(16));return t},Mu=function(){function e(){h(this,e),this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}return p(e,[{key:"reset",value:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}},{key:"setStyles",value:function(e){for(var t=["foreground","underline","italics","background","flash"],r=0;r<t.length;r++){var n=t[r];e.hasOwnProperty(n)&&(this[n]=e[n])}}},{key:"isDefault",value:function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}},{key:"equals",value:function(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}},{key:"copy",value:function(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}},{key:"toString",value:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}]),e}(),xu=function(){function e(){h(this,e),this.uchar=" ",this.penState=new Mu}return p(e,[{key:"reset",value:function(){this.uchar=" ",this.penState.reset()}},{key:"setChar",value:function(e,t){this.uchar=e,this.penState.copy(t)}},{key:"setPenState",value:function(e){this.penState.copy(e)}},{key:"equals",value:function(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}},{key:"copy",value:function(e){this.uchar=e.uchar,this.penState.copy(e.penState)}},{key:"isEmpty",value:function(){return" "===this.uchar&&this.penState.isDefault()}}]),e}(),Bu=function(){function e(t){h(this,e),this.chars=[],this.pos=0,this.currPenState=new Mu,this.cueStartTime=null,this.logger=void 0;for(var r=0;r<Lu;r++)this.chars.push(new xu);this.logger=t}return p(e,[{key:"equals",value:function(e){for(var t=0;t<Lu;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}},{key:"copy",value:function(e){for(var t=0;t<Lu;t++)this.chars[t].copy(e.chars[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<Lu;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}},{key:"setCursor",value:function(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>Lu&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=Lu)}},{key:"moveCursor",value:function(e){var t=this.pos+e;if(e>1)for(var r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}},{key:"backSpace",value:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}},{key:"insertChar",value:function(e){var t=this;e>=144&&this.backSpace();var r=_u(e);this.pos>=Lu?this.logger.log(0,(function(){return"Cannot insert "+e.toString(16)+" ("+r+") at position "+t.pos+". Skipping it!"})):(this.chars[this.pos].setChar(r,this.currPenState),this.moveCursor(1))}},{key:"clearFromPos",value:function(e){var t;for(t=e;t<Lu;t++)this.chars[t].reset()}},{key:"clear",value:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}},{key:"clearToEndOfRow",value:function(){this.clearFromPos(this.pos)}},{key:"getTextString",value:function(){for(var e=[],t=!0,r=0;r<Lu;r++){var n=this.chars[r].uchar;" "!==n&&(t=!1),e.push(n)}return t?"":e.join("")}},{key:"setPenStyles",value:function(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}]),e}(),Fu=function(){function e(t){h(this,e),this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(var r=0;r<15;r++)this.rows.push(new Bu(t));this.logger=t}return p(e,[{key:"reset",value:function(){for(var e=0;e<15;e++)this.rows[e].clear();this.currRow=14}},{key:"equals",value:function(e){for(var t=!0,r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}},{key:"copy",value:function(e){for(var t=0;t<15;t++)this.rows[t].copy(e.rows[t])}},{key:"isEmpty",value:function(){for(var e=!0,t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}},{key:"backSpace",value:function(){this.rows[this.currRow].backSpace()}},{key:"clearToEndOfRow",value:function(){this.rows[this.currRow].clearToEndOfRow()}},{key:"insertChar",value:function(e){this.rows[this.currRow].insertChar(e)}},{key:"setPen",value:function(e){this.rows[this.currRow].setPenStyles(e)}},{key:"moveCursor",value:function(e){this.rows[this.currRow].moveCursor(e)}},{key:"setCursor",value:function(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}},{key:"setPAC",value:function(e){this.logger.log(2,(function(){return"pacData = "+Vn(e)}));var t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(var r=0;r<15;r++)this.rows[r].clear();var n=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){var a=i.rows[n].cueStartTime,o=this.logger.time;if(null!==a&&null!==o&&a<o)for(var s=0;s<this.nrRollUpRows;s++)this.rows[t-this.nrRollUpRows+s+1].copy(i.rows[n+s])}}this.currRow=t;var l=this.rows[this.currRow];if(null!==e.indent){var u=e.indent,c=Math.max(u-1,0);l.setCursor(e.indent),e.color=l.chars[c].penState.foreground}var f={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(f)}},{key:"setBkgData",value:function(e){this.logger.log(2,(function(){return"bkgData = "+Vn(e)})),this.backSpace(),this.setPen(e),this.insertChar(32)}},{key:"setRollUpRows",value:function(e){this.nrRollUpRows=e}},{key:"rollUp",value:function(){var e=this;if(null!==this.nrRollUpRows){this.logger.log(1,(function(){return e.getDisplayText()}));var t=this.currRow+1-this.nrRollUpRows,r=this.rows.splice(t,1)[0];r.clear(),this.rows.splice(this.currRow,0,r),this.logger.log(2,"Rolling up")}else this.logger.log(3,"roll_up but nrRollUpRows not set yet")}},{key:"getDisplayText",value:function(e){e=e||!1;for(var t=[],r="",n=-1,i=0;i<15;i++){var a=this.rows[i].getTextString();a&&(n=i+1,e?t.push("Row "+n+": '"+a+"'"):t.push(a.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join("\n")),r}},{key:"getTextAndFormat",value:function(){return this.rows}}]),e}(),Nu=function(){function e(t,r,n){h(this,e),this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=r,this.mode=null,this.verbose=0,this.displayedMemory=new Fu(n),this.nonDisplayedMemory=new Fu(n),this.lastOutputScreen=new Fu(n),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=n}return p(e,[{key:"reset",value:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}},{key:"getHandler",value:function(){return this.outputFilter}},{key:"setHandler",value:function(e){this.outputFilter=e}},{key:"setPAC",value:function(e){this.writeScreen.setPAC(e)}},{key:"setBkgData",value:function(e){this.writeScreen.setBkgData(e)}},{key:"setMode",value:function(e){e!==this.mode&&(this.mode=e,this.logger.log(2,(function(){return"MODE="+e})),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}},{key:"insertChars",value:function(e){for(var t=this,r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);var n=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,(function(){return n+": "+t.writeScreen.getDisplayText(!0)})),"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(this.logger.log(1,(function(){return"DISPLAYED: "+t.displayedMemory.getDisplayText(!0)})),this.outputDataUpdate())}},{key:"ccRCL",value:function(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}},{key:"ccBS",value:function(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}},{key:"ccAOF",value:function(){}},{key:"ccAON",value:function(){}},{key:"ccDER",value:function(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}},{key:"ccRU",value:function(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}},{key:"ccFON",value:function(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}},{key:"ccRDC",value:function(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}},{key:"ccTR",value:function(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}},{key:"ccRTD",value:function(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}},{key:"ccEDM",value:function(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}},{key:"ccCR",value:function(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}},{key:"ccENM",value:function(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}},{key:"ccEOC",value:function(){var e=this;if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){var t=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=t,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,(function(){return"DISP: "+e.displayedMemory.getDisplayText()}))}this.outputDataUpdate(!0)}},{key:"ccTO",value:function(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}},{key:"ccMIDROW",value:function(e){var t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{var r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(2,"MIDROW: "+Vn(t)),this.writeScreen.setPen(t)}},{key:"outputDataUpdate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}},{key:"cueSplitAtTime",value:function(e){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e))}}]),e}(),Uu=function(){function e(t,r,n){h(this,e),this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;var i=this.logger=new Ou;this.channels=[null,new Nu(t,r,i),new Nu(t+1,n,i)]}return p(e,[{key:"getHandler",value:function(e){return this.channels[e].getHandler()}},{key:"setHandler",value:function(e,t){this.channels[e].setHandler(t)}},{key:"addData",value:function(e,t){var r=this;this.logger.time=e;for(var n=function(e){var n=127&t[e],i=127&t[e+1],a=!1,o=null;if(0===n&&0===i)return"continue";r.logger.log(3,(function(){return"["+zu([t[e],t[e+1]])+"] -> ("+zu([n,i])+")"}));var s=r.cmdHistory;if(n>=16&&n<=31){if(function(e,t,r){return r.a===e&&r.b===t}(n,i,s))return ju(null,null,s),r.logger.log(3,(function(){return"Repeated command ("+zu([n,i])+") is dropped"})),"continue";ju(n,i,r.cmdHistory),(a=r.parseCmd(n,i))||(a=r.parseMidrow(n,i)),a||(a=r.parsePAC(n,i)),a||(a=r.parseBackgroundAttributes(n,i))}else ju(null,null,s);if(!a&&(o=r.parseChars(n,i))){var l=r.currentChannel;l&&l>0?r.channels[l].insertChars(o):r.logger.log(2,"No channel found yet. TEXT-MODE?")}a||o||r.logger.log(2,(function(){return"Couldn't parse cleaned data "+zu([n,i])+" orig: "+zu([t[e],t[e+1]])}))},i=0;i<t.length;i+=2)n(i)}},{key:"parseCmd",value:function(e,t){if(!((20===e||28===e||21===e||29===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=33&&t<=35))return!1;var r=20===e||21===e||23===e?1:2,n=this.channels[r];return 20===e||21===e||28===e||29===e?32===t?n.ccRCL():33===t?n.ccBS():34===t?n.ccAOF():35===t?n.ccAON():36===t?n.ccDER():37===t?n.ccRU(2):38===t?n.ccRU(3):39===t?n.ccRU(4):40===t?n.ccFON():41===t?n.ccRDC():42===t?n.ccTR():43===t?n.ccRTD():44===t?n.ccEDM():45===t?n.ccCR():46===t?n.ccENM():47===t&&n.ccEOC():n.ccTO(t-32),this.currentChannel=r,!0}},{key:"parseMidrow",value:function(e,t){var r=0;if((17===e||25===e)&&t>=32&&t<=47){if((r=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;var n=this.channels[r];return!!n&&(n.ccMIDROW(t),this.logger.log(3,(function(){return"MIDROW ("+zu([e,t])+")"})),!0)}return!1}},{key:"parsePAC",value:function(e,t){var r;if(!((e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127)&&!((16===e||24===e)&&t>=64&&t<=95))return!1;var n=e<=23?1:2;r=t>=64&&t<=95?1===n?Pu[e]:Ru[e]:1===n?Iu[e]:Cu[e];var i=this.channels[n];return!!i&&(i.setPAC(this.interpretPAC(r,t)),this.currentChannel=n,!0)}},{key:"interpretPAC",value:function(e,t){var r,n={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,n.underline=1==(1&r),r<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((r-16)/2),n}},{key:"parseChars",value:function(e,t){var r,n,i=null,a=null;return e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19?(n=17===a?t+80:18===a?t+112:t+144,this.logger.log(2,(function(){return"Special char '"+_u(n)+"' in channel "+r})),i=[n]):e>=32&&e<=127&&(i=0===t?[e]:[e,t]),i&&this.logger.log(3,(function(){return"Char codes =  "+zu(i).join(",")})),i}},{key:"parseBackgroundAttributes",value:function(e,t){if(!((16===e||24===e)&&t>=32&&t<=47)&&!((23===e||31===e)&&t>=45&&t<=47))return!1;var r,n={};16===e||24===e?(r=Math.floor((t-32)/2),n.background=Du[r],t%2==1&&(n.background=n.background+"_semi")):45===t?n.background="transparent":(n.foreground="black",47===t&&(n.underline=!0));var i=e<=23?1:2;return this.channels[i].setBkgData(n),!0}},{key:"reset",value:function(){for(var e=0;e<Object.keys(this.channels).length;e++){var t=this.channels[e];t&&t.reset()}ju(null,null,this.cmdHistory)}},{key:"cueSplitAtTime",value:function(e){for(var t=0;t<this.channels.length;t++){var r=this.channels[t];r&&r.cueSplitAtTime(e)}}}]),e}();function ju(e,t,r){r.a=e,r.b=t}var Gu=function(){if(null!=ua&&ua.VTTCue)return self.VTTCue;var e=["","lr","rl"],t=["start","middle","end","left","right"];function r(e,t){if("string"!=typeof t)return!1;if(!Array.isArray(e))return!1;var r=t.toLowerCase();return!!~e.indexOf(r)&&r}function n(e){return r(t,e)}function i(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];for(var i=1;i<arguments.length;i++){var a=arguments[i];for(var o in a)e[o]=a[o]}return e}function a(t,a,o){var s=this,l={enumerable:!0};s.hasBeenReset=!1;var u="",c=!1,f=t,d=a,h=o,p=null,g="",v=!0,y="auto",m="start",A=50,b="middle",E=50,k="middle";Object.defineProperty(s,"id",i({},l,{get:function(){return u},set:function(e){u=""+e}})),Object.defineProperty(s,"pauseOnExit",i({},l,{get:function(){return c},set:function(e){c=!!e}})),Object.defineProperty(s,"startTime",i({},l,{get:function(){return f},set:function(e){if("number"!=typeof e)throw new TypeError("Start time must be set to a number.");f=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"endTime",i({},l,{get:function(){return d},set:function(e){if("number"!=typeof e)throw new TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"text",i({},l,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(s,"region",i({},l,{get:function(){return p},set:function(e){p=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"vertical",i({},l,{get:function(){return g},set:function(t){var n=function(t){return r(e,t)}(t);if(!1===n)throw new SyntaxError("An invalid or illegal string was specified.");g=n,this.hasBeenReset=!0}})),Object.defineProperty(s,"snapToLines",i({},l,{get:function(){return v},set:function(e){v=!!e,this.hasBeenReset=!0}})),Object.defineProperty(s,"line",i({},l,{get:function(){return y},set:function(e){if("number"!=typeof e&&"auto"!==e)throw new SyntaxError("An invalid number or illegal string was specified.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"lineAlign",i({},l,{get:function(){return m},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");m=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"position",i({},l,{get:function(){return A},set:function(e){if(e<0||e>100)throw new Error("Position must be between 0 and 100.");A=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"positionAlign",i({},l,{get:function(){return b},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");b=t,this.hasBeenReset=!0}})),Object.defineProperty(s,"size",i({},l,{get:function(){return E},set:function(e){if(e<0||e>100)throw new Error("Size must be between 0 and 100.");E=e,this.hasBeenReset=!0}})),Object.defineProperty(s,"align",i({},l,{get:function(){return k},set:function(e){var t=n(e);if(!t)throw new SyntaxError("An invalid or illegal string was specified.");k=t,this.hasBeenReset=!0}})),s.displayState=void 0}return a.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},a}(),Yu=function(){function e(){h(this,e)}return p(e,[{key:"decode",value:function(e,t){if(!e)return"";if("string"!=typeof e)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}]),e}();function Vu(e){function t(e,t,r,n){return 3600*(0|e)+60*(0|t)+(0|r)+parseFloat(n||0)}var r=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return r?parseFloat(r[2])>59?t(r[2],r[3],0,r[4]):t(r[1],r[2],r[3],r[4]):null}var Hu=function(){function e(){h(this,e),this.values=Object.create(null)}return p(e,[{key:"set",value:function(e,t){this.get(e)||""===t||(this.values[e]=t)}},{key:"get",value:function(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}},{key:"has",value:function(e){return e in this.values}},{key:"alt",value:function(e,t,r){for(var n=0;n<r.length;++n)if(t===r[n]){this.set(e,t);break}}},{key:"integer",value:function(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}},{key:"percent",value:function(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){var r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}]),e}();function Ku(e,t,r,n){var i=n?e.split(n):[e];for(var a in i)if("string"==typeof i[a]){var o=i[a].split(r);2===o.length&&t(o[0],o[1])}}var Qu=new Gu(0,0,""),Wu="middle"===Qu.align?"middle":"center";function qu(e,t,r){var n=e;function i(){var t=Vu(e);if(null===t)throw new Error("Malformed timestamp: "+n);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=i(),a(),"--\x3e"!==e.slice(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '--\x3e'): "+n);e=e.slice(3),a(),t.endTime=i(),a(),function(e,t){var n=new Hu;Ku(e,(function(e,t){var i;switch(e){case"region":for(var a=r.length-1;a>=0;a--)if(r[a].id===t){n.set(e,r[a].region);break}break;case"vertical":n.alt(e,t,["rl","lr"]);break;case"line":i=t.split(","),n.integer(e,i[0]),n.percent(e,i[0])&&n.set("snapToLines",!1),n.alt(e,i[0],["auto"]),2===i.length&&n.alt("lineAlign",i[1],["start",Wu,"end"]);break;case"position":i=t.split(","),n.percent(e,i[0]),2===i.length&&n.alt("positionAlign",i[1],["start",Wu,"end","line-left","line-right","auto"]);break;case"size":n.percent(e,t);break;case"align":n.alt(e,t,["start",Wu,"end","left","right"])}}),/:/,/\s/),t.region=n.get("region",null),t.vertical=n.get("vertical","");var i=n.get("line","auto");"auto"===i&&-1===Qu.line&&(i=-1),t.line=i,t.lineAlign=n.get("lineAlign","start"),t.snapToLines=n.get("snapToLines",!0),t.size=n.get("size",100),t.align=n.get("align",Wu);var a=n.get("position","auto");"auto"===a&&50===Qu.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}function Xu(e){return e.replace(/<br(?: \/)?>/gi,"\n")}var Ju=function(){function e(){h(this,e),this.state="INITIAL",this.buffer="",this.decoder=new Yu,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}return p(e,[{key:"parse",value:function(e){var t=this;function r(){var e=t.buffer,r=0;for(e=Xu(e);r<e.length&&"\r"!==e[r]&&"\n"!==e[r];)++r;var n=e.slice(0,r);return"\r"===e[r]&&++r,"\n"===e[r]&&++r,t.buffer=e.slice(r),n}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{var n="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;var i=(n=r()).match(/^(\xef\xbb\xbf)?WEBVTT([ \t].*)?$/);if(null==i||!i[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(var a=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(a?a=!1:n=r(),t.state){case"HEADER":/:/.test(n)?Ku(n,(function(e,t){}),/:/):n||(t.state="ID");continue;case"NOTE":n||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(n)){t.state="NOTE";break}if(!n)continue;if(t.cue=new Gu(0,0,""),t.state="CUE",-1===n.indexOf("--\x3e")){t.cue.id=n;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{qu(n,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":var o=-1!==n.indexOf("--\x3e");if(!n||o&&(a=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=n;continue;case"BADCUE":n||(t.state="ID")}}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}},{key:"flush",value:function(){var e=this;try{if((e.cue||"HEADER"===e.state)&&(e.buffer+="\n\n",e.parse()),"INITIAL"===e.state||"BADWEBVTT"===e.state)throw new Error("Malformed WebVTT signature.")}catch(t){e.onparsingerror&&e.onparsingerror(t)}return e.onflush&&e.onflush(),this}}]),e}(),Zu=/\r\n|\n\r|\n|\r/g,$u=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.slice(r,r+t.length)===t};function ec(e,t,r){return uu(e.toString())+uu(t.toString())+uu(r)}function tc(e,t,r,n,i,a,o){var s,l=new Ju,u=kr(new Uint8Array(e)).trim().replace(Zu,"\n").split("\n"),c=[],f=t?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Rs(e,Is,1/t)}(t.baseTime,t.timescale):0,d="00:00.000",h=0,p=0,g=!0;l.oncue=function(e){var a=r[n],o=r.ccOffset,l=(h-f)/9e4;if(null!=a&&a.new&&(void 0!==p?o=r.ccOffset=a.start:function(e,t,r){var n=e[t],i=e[n.prevCC];if(!i||!i.new&&n.new)return e.ccOffset=e.presentationOffset=n.start,void(n.new=!1);for(;null!=(a=i)&&a.new;){var a;e.ccOffset+=n.start-i.start,n.new=!1,i=e[(n=i).prevCC]}e.presentationOffset=r}(r,n,l)),l){if(!t)return void(s=new Error("Missing initPTS for VTT MPEGTS"));o=l-r.presentationOffset}var u=e.endTime-e.startTime,d=Fs(9e4*(e.startTime+o-p),9e4*i)/9e4;e.startTime=Math.max(d,0),e.endTime=Math.max(d+u,0);var g=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(g)),e.id||(e.id=ec(e.startTime,e.endTime,g)),e.endTime>0&&c.push(e)},l.onparsingerror=function(e){s=e},l.onflush=function(){s?o(s):a(c)},u.forEach((function(e){if(g){if($u(e,"X-TIMESTAMP-MAP=")){g=!1,e.slice(16).split(",").forEach((function(e){$u(e,"LOCAL:")?d=e.slice(6):$u(e,"MPEGTS:")&&(h=parseInt(e.slice(7)))}));try{p=function(e){var t=parseInt(e.slice(-3)),r=parseInt(e.slice(-6,-4)),n=parseInt(e.slice(-9,-7)),i=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!(Wt(t)&&Wt(r)&&Wt(n)&&Wt(i)))throw Error("Malformed X-TIMESTAMP-MAP: Local:".concat(e));return t+=1e3*r,(t+=6e4*n)+36e5*i}(d)/1e3}catch(e){s=e}return}""===e&&(g=!1)}l.parse(e+"\n")})),l.flush()}var rc="stpp.ttml.im1t",nc=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,ic=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ac={left:"start",center:"center",right:"end",start:"start",end:"end"};function oc(e,t,r,n){var i=qr(new Uint8Array(e),["mdat"]);if(0!==i.length){var a=i.map((function(e){return kr(e)})),o=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Rs(e,t,1/r,n)}(t.baseTime,1,t.timescale);try{a.forEach((function(e){return r(function(e,t){var r=(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("tt")[0];if(!r)throw new Error("Invalid ttml");var n={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},i=Object.keys(n).reduce((function(e,t){return e[t]=r.getAttribute("ttp:".concat(t))||n[t],e}),{}),a="preserve"!==r.getAttribute("xml:space"),o=lc(sc(r,"styling","style")),s=lc(sc(r,"layout","region")),l=sc(r,"body","[begin]");return[].map.call(l,(function(e){var r=function e(t,r){return[].slice.call(t.childNodes).reduce((function(t,n,i){var a;return"br"===n.nodeName&&i?t+"\n":null!=(a=n.childNodes)&&a.length?e(n,r):r?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent}),"")}(e,a);if(!r||!e.hasAttribute("begin"))return null;var n=fc(e.getAttribute("begin"),i),l=fc(e.getAttribute("dur"),i),u=fc(e.getAttribute("end"),i);if(null===n)throw cc(e);if(null===u){if(null===l)throw cc(e);u=n+l}var c=new Gu(n-t,u-t,r);c.id=ec(c.startTime,c.endTime,c.text);var f=function(e,t,r){var n="http://www.w3.org/ns/ttml#styling",i=null,a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return a&&r.hasOwnProperty(a)&&(i=r[a]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((function(r,a){var o=uc(t,n,a)||uc(e,n,a)||uc(i,n,a);return o&&(r[a]=o),r}),{})}(s[e.getAttribute("region")],o[e.getAttribute("style")],o),d=f.textAlign;if(d){var h=ac[d];h&&(c.lineAlign=h),c.align=d}return cr(c,f),c})).filter((function(e){return null!==e}))}(e,o))}))}catch(e){n(e)}}else n(new Error("Could not parse IMSC1 mdat"))}function sc(e,t,r){var n=e.getElementsByTagName(t)[0];return n?[].slice.call(n.querySelectorAll(r)):[]}function lc(e){return e.reduce((function(e,t){var r=t.getAttribute("xml:id");return r&&(e[r]=t),e}),{})}function uc(e,t,r){return e&&e.hasAttributeNS(t,r)?e.getAttributeNS(t,r):null}function cc(e){return new Error("Could not parse ttml timestamp ".concat(e))}function fc(e,t){if(!e)return null;var r=Vu(e);return null===r&&(nc.test(e)?r=function(e,t){var r=nc.exec(e),n=(0|r[4])+(0|r[5])/t.subFrameRate;return 3600*(0|r[1])+60*(0|r[2])+(0|r[3])+n/t.frameRate}(e,t):ic.test(e)&&(r=function(e,t){var r=ic.exec(e),n=Number(r[1]);switch(r[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/t.frameRate;case"t":return n/t.tickRate}return n}(e,t))),r}var dc=function(){function e(t,r){h(this,e),this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=r}return p(e,[{key:"dispatchCue",value:function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}},{key:"newCue",value:function(e,t,r){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}},{key:"reset",value:function(){this.cueRanges=[],this.startTime=null}}]),e}();function hc(e){return e.characteristics&&/transcribes-spoken-dialog/gi.test(e.characteristics)&&/describes-music-and-sound/gi.test(e.characteristics)?"captions":"subtitles"}function pc(e,t){return!!e&&e.kind===hc(t)&&el(t,e)}var gc=/\s/,vc={newCue:function(e,t,r,n){for(var i,a,o,s,l,u=[],c=self.VTTCue||self.TextTrackCue,f=0;f<n.rows.length;f++)if(o=!0,s=0,l="",!(i=n.rows[f]).isEmpty()){for(var d,h=0;h<i.chars.length;h++)gc.test(i.chars[h].uchar)&&o?s++:(l+=i.chars[h].uchar,o=!1);i.cueStartTime=t,t===r&&(r+=1e-4),s>=16?s--:s++;var p=Xu(l.trim()),g=ec(t,r,p);null!=e&&null!=(d=e.cues)&&d.getCueById(g)||((a=new c(t,r,p)).id=g,a.line=f+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*s/32)),u.push(a))}return e&&u.length&&(u.sort((function(e,t){return"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line})),u.forEach((function(t){return au(e,t)}))),u}},yc=/(\d+)-(\d+)\/(\d+)/,mc=function(){function e(t){h(this,e),this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||Ac,this.controller=new self.AbortController,this.stats=new Or}return p(e,[{key:"destroy",value:function(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}},{key:"abortInternal",value:function(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}},{key:"abort",value:function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}},{key:"load",value:function(e,t,r){var n=this,i=this.stats;if(i.loading.start)throw new Error("Loader can only be used once.");i.loading.start=self.performance.now();var a=function(e,t){var r={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(cr({},e.headers))};return e.rangeEnd&&r.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),r}(e,this.controller.signal),o="arraybuffer"===e.responseType,s=o?"byteLength":"length",l=t.loadPolicy,u=l.maxTimeToFirstByteMs,c=l.maxLoadTimeMs;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,a),self.clearTimeout(this.requestTimeout),t.timeout=u&&Wt(u)?u:c,this.requestTimeout=self.setTimeout((function(){n.callbacks&&(n.abortInternal(),n.callbacks.onTimeout(i,e,n.response))}),t.timeout),(Ks(this.request)?this.request.then(self.fetch):self.fetch(this.request)).then((function(r){var a;n.response=n.loader=r;var s=Math.max(self.performance.now(),i.loading.start);if(self.clearTimeout(n.requestTimeout),t.timeout=c,n.requestTimeout=self.setTimeout((function(){n.callbacks&&(n.abortInternal(),n.callbacks.onTimeout(i,e,n.response))}),c-(s-i.loading.start)),!r.ok){var l=r.status,u=r.statusText;throw new bc(u||"fetch, bad network response",l,r)}i.loading.first=s,i.total=function(e){var t=e.get("Content-Range");if(t){var r=function(e){var t=yc.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(Wt(r))return r}var n=e.get("Content-Length");if(n)return parseInt(n)}(r.headers)||i.total;var f=null==(a=n.callbacks)?void 0:a.onProgress;return f&&Wt(t.highWaterMark)?n.loadProgressively(r,i,e,t.highWaterMark,f):o?r.arrayBuffer():"json"===e.responseType?r.json():r.text()})).then((function(r){var a,o,l=n.response;if(!l)throw new Error("loader destroyed");self.clearTimeout(n.requestTimeout),i.loading.end=Math.max(self.performance.now(),i.loading.first);var u=r[s];u&&(i.loaded=i.total=u);var c={url:l.url,data:r,code:l.status},f=null==(a=n.callbacks)?void 0:a.onProgress;f&&!Wt(t.highWaterMark)&&f(i,e,r,l),null==(o=n.callbacks)||o.onSuccess(c,i,e,l)})).catch((function(t){var r;if(self.clearTimeout(n.requestTimeout),!i.aborted){var a=t&&t.code||0,o=t?t.message:null;null==(r=n.callbacks)||r.onError({code:a,text:o},e,t?t.details:null,i)}}))}},{key:"getCacheAge",value:function(){var e=null;if(this.response){var t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}},{key:"getResponseHeader",value:function(e){return this.response?this.response.headers.get(e):null}},{key:"loadProgressively",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0,a=new To,o=e.body.getReader(),s=function s(){return o.read().then((function(o){if(o.done)return a.dataLength&&i(t,r,a.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));var l=o.value,u=l.length;return t.loaded+=u,u<n||a.dataLength?(a.push(l),a.dataLength>=n&&i(t,r,a.flush().buffer,e)):i(t,r,l.buffer,e),s()})).catch((function(){return Promise.reject()}))};return s()}}]),e}();function Ac(e,t){return new self.Request(e.url,t)}var bc=function(e){c(r,e);var t=f(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this,e)).code=void 0,a.details=void 0,a.code=n,a.details=i,a}return r}(u(Error)),Ec=/^age:\s*[\d.]+\s*$/im,kc=function(){function e(t){h(this,e),this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=t&&t.xhrSetup||null,this.stats=new Or,this.retryDelay=0}return p(e,[{key:"destroy",value:function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}},{key:"abortInternal",value:function(){var e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}},{key:"abort",value:function(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}},{key:"load",value:function(e,t,r){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}},{key:"loadInternal",value:function(){var e=this,t=this.config,r=this.context;if(t&&r){var n=this.loader=new self.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;var a=this.xhrSetup;a?Promise.resolve().then((function(){if(e.loader===n&&!e.stats.aborted)return a(n,r.url)})).catch((function(t){if(e.loader===n&&!e.stats.aborted)return n.open("GET",r.url,!0),a(n,r.url)})).then((function(){e.loader!==n||e.stats.aborted||e.openAndSendXhr(n,r,t)})).catch((function(t){var a;null==(a=e.callbacks)||a.onError({code:n.status,text:t.message},r,n,i)})):this.openAndSendXhr(n,r,t)}}},{key:"openAndSendXhr",value:function(e,t,r){e.readyState||e.open("GET",t.url,!0);var n=t.headers,i=r.loadPolicy,a=i.maxTimeToFirstByteMs,o=i.maxLoadTimeMs;if(n)for(var s in n)e.setRequestHeader(s,n[s]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),r.timeout=a&&Wt(a)?a:o,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}},{key:"readystatechange",value:function(){var e=this.context,t=this.loader,r=this.stats;if(e&&t){var n=t.readyState,i=this.config;if(!r.aborted&&n>=2&&(0===r.loading.first&&(r.loading.first=Math.max(self.performance.now(),r.loading.start),i.timeout!==i.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),i.timeout=i.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),4===n)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;var a=t.status,o="text"===t.responseType?t.responseText:null;if(a>=200&&a<300){var s=null!=o?o:t.response;if(null!=s){var l,u;r.loading.end=Math.max(self.performance.now(),r.loading.first);var c="arraybuffer"===t.responseType?s.byteLength:s.length;r.loaded=r.total=c,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first);var f=null==(l=this.callbacks)?void 0:l.onProgress;f&&f(r,e,s,t);var d={url:t.responseURL,data:s,code:a};return void(null==(u=this.callbacks)||u.onSuccess(d,r,e,t))}}var h,p=i.loadPolicy.errorRetry;ci(p,r.retry,!1,{url:e.url,data:void 0,code:a})?this.retry(p):(Ar.error("".concat(a," while loading ").concat(e.url)),null==(h=this.callbacks)||h.onError({code:a,text:t.statusText},e,t,r))}}}},{key:"loadtimeout",value:function(){if(this.config){var e=this.config.loadPolicy.timeoutRetry;if(ci(e,this.stats.retry,!0))this.retry(e);else{var t;Ar.warn("timeout while loading ".concat(null==(t=this.context)?void 0:t.url));var r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}}},{key:"retry",value:function(e){var t=this.context,r=this.stats;this.retryDelay=li(e,r.retry),r.retry++,Ar.warn("".concat(status?"HTTP Status "+status:"Timeout"," while loading ").concat(null==t?void 0:t.url,", retrying ").concat(r.retry,"/").concat(e.maxNumRetry," in ").concat(this.retryDelay,"ms")),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}},{key:"loadprogress",value:function(e){var t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}},{key:"getCacheAge",value:function(){var e=null;if(this.loader&&Ec.test(this.loader.getAllResponseHeaders())){var t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}},{key:"getResponseHeader",value:function(e){return this.loader&&new RegExp("^".concat(e,":\\s*[\\d.]+\\s*$"),"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}]),e}(),Tc=dr(dr({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:kc,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,"abr",e.logger)).hls=void 0,n.lastLevelLoadSec=0,n.lastLoadedFragLevel=-1,n.firstSelection=-1,n._nextAutoLevel=-1,n.nextAutoLevelKey="",n.audioTracksByGroup=null,n.codecTiers=null,n.timer=-1,n.fragCurrent=null,n.partCurrent=null,n.bitrateTestDelay=0,n.rebufferNotice=-1,n.supportedCache={},n.bwEstimator=void 0,n._abandonRulesCheck=function(e){var t,r=l(n),i=r.fragCurrent,a=r.partCurrent,o=r.hls,s=o.autoLevelEnabled,u=o.media;if(i&&u){var c=performance.now(),f=a?a.stats:i.stats,d=a?a.duration:i.duration,h=c-f.loading.start,p=o.minAutoLevel,g=i.level,v=n._nextAutoLevel;if(f.aborted||f.loaded&&f.loaded===f.total||g<=p)return n.clearTimer(),void(n._nextAutoLevel=-1);if(s){var y=v>-1&&v!==g,m=!!e||y;if(m||!u.paused&&u.playbackRate&&u.readyState){var A=o.mainForwardBufferInfo;if(m||null!==A){var b=n.bwEstimator.getEstimateTTFB(),E=Math.abs(u.playbackRate);if(!(h<=Math.max(b,d/(2*E)*1e3))){var k=A?A.len/E:0,T=f.loading.first?f.loading.first-f.loading.start:-1,S=f.loaded&&T>-1,w=n.getBwEstimate(),_=o.levels,L=_[g],P=Math.max(f.loaded,Math.round(d*(i.bitrate||L.averageBitrate)/8)),I=S?h-T:h;I<1&&S&&(I=Math.min(h,8*f.loaded/w));var R=S?1e3*f.loaded/I:0,C=b/1e3,D=R?(P-f.loaded)/R:8*P/w+C;if(!(D<=k)){var O,z=R?8*R:w,M=!0===(null==(t=(null==e?void 0:e.details)||n.hls.latestLevelDetails)?void 0:t.live),x=n.hls.config.abrBandWidthUpFactor,B=Number.POSITIVE_INFINITY;for(O=g-1;O>p;O--){var F=_[O].maxBitrate,N=!_[O].details||M;if((B=n.getTimeToLoadFrag(C,z,d*F,N))<Math.min(k,d+C))break}if(!(B>=D)&&!(B>10*d)){S?n.bwEstimator.sample(h-Math.min(b,T),f.loaded):n.bwEstimator.sampleTTFB(h);var U=_[O].maxBitrate;n.getBwEstimate()*x>U&&n.resetEstimator(U);var j=n.findBestLevel(U,p,O,0,k,1,1);j>-1&&(O=j),n.warn("Fragment ".concat(i.sn).concat(a?" part "+a.index:""," of level ").concat(g," is loading too slowly;\n      Fragment duration: ").concat(i.duration.toFixed(3),"\n      Time to underbuffer: ").concat(k.toFixed(3)," s\n      Estimated load time for current fragment: ").concat(D.toFixed(3)," s\n      Estimated load time for down switch fragment: ").concat(B.toFixed(3)," s\n      TTFB estimate: ").concat(0|T," ms\n      Current BW estimate: ").concat(Wt(w)?0|w:"Unknown"," bps\n      New BW estimate: ").concat(0|n.getBwEstimate()," bps\n      Switching to level ").concat(O," @ ").concat(0|U," bps")),o.nextLoadLevel=o.nextAutoLevel=O,n.clearTimer();var G=function(){if(n.clearTimer(),n.fragCurrent===i&&n.hls.loadLevel===O&&O>0){var e=n.getStarvationDelay();if(n.warn("Aborting inflight request ".concat(O>0?"and switching down":"","\n      Fragment duration: ").concat(i.duration.toFixed(3)," s\n      Time to underbuffer: ").concat(e.toFixed(3)," s")),i.abortRequests(),n.fragCurrent=n.partCurrent=null,O>p){var t=n.findBestLevel(n.hls.levels[p].bitrate,p,O,0,e,1,1);-1===t&&(t=p),n.hls.nextLoadLevel=n.hls.nextAutoLevel=t,n.resetEstimator(n.hls.levels[t].bitrate)}}};y||D>2*B?G():n.timer=self.setInterval(G,1e3*B),o.trigger($t.FRAG_LOAD_EMERGENCY_ABORTED,{frag:i,part:a,stats:f})}}}}}}}},n.hls=e,n.bwEstimator=n.initEstimator(),n.registerListeners(),n}return p(r,[{key:"resetEstimator",value:function(e){e&&(this.log("setting initial bwe to ".concat(e)),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}},{key:"initEstimator",value:function(){var e=this.hls.config;return new lr(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}},{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.FRAG_LOADING,this.onFragLoading,this),e.on($t.FRAG_LOADED,this.onFragLoaded,this),e.on($t.FRAG_BUFFERED,this.onFragBuffered,this),e.on($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($t.LEVEL_LOADED,this.onLevelLoaded,this),e.on($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($t.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.FRAG_LOADING,this.onFragLoading,this),e.off($t.FRAG_LOADED,this.onFragLoaded,this),e.off($t.FRAG_BUFFERED,this.onFragBuffered,this),e.off($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($t.LEVEL_LOADED,this.onLevelLoaded,this),e.off($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($t.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off($t.ERROR,this.onError,this))}},{key:"destroy",value:function(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}},{key:"onManifestLoading",value:function(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}},{key:"onLevelsUpdated",value:function(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}},{key:"onMaxAutoLevelUpdated",value:function(){this.firstSelection=-1,this.nextAutoLevelKey=""}},{key:"onFragLoading",value:function(e,t){var r,n=t.frag;this.ignoreFragment(n)||(n.bitrateTest||(this.fragCurrent=n,this.partCurrent=null!=(r=t.part)?r:null),this.clearTimer(),this.timer=self.setInterval(this._abandonRulesCheck,100))}},{key:"onLevelSwitching",value:function(e,t){this.clearTimer()}},{key:"onError",value:function(e,t){if(!t.fatal)switch(t.details){case Zt.BUFFER_ADD_CODEC_ERROR:case Zt.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case Zt.FRAG_LOAD_TIMEOUT:var r=t.frag,n=this.fragCurrent,i=this.partCurrent;if(r&&n&&r.sn===n.sn&&r.level===n.level){var a=performance.now(),o=i?i.stats:r.stats,s=a-o.loading.start,l=o.loading.first?o.loading.first-o.loading.start:-1;if(o.loaded&&l>-1){var u=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(s-Math.min(u,l),o.loaded)}else this.bwEstimator.sampleTTFB(s)}}}},{key:"getTimeToLoadFrag",value:function(e,t,r,n){return e+r/t+(n?e+this.lastLevelLoadSec:0)}},{key:"onLevelLoaded",value:function(e,t){var r=this.hls.config,n=t.stats.loading,i=n.end-n.first;Wt(i)&&(this.lastLevelLoadSec=i/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}},{key:"onFragLoaded",value:function(e,t){var r=t.frag,n=t.part,i=n?n.stats:r.stats;if(r.type===ir&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(r)){if(this.clearTimer(),r.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){var a=n?n.duration:r.duration,o=this.hls.levels[r.level],s=(o.loaded?o.loaded.bytes:0)+i.loaded,l=(o.loaded?o.loaded.duration:0)+a;o.loaded={bytes:s,duration:l},o.realBitrate=Math.round(8*s/l)}if(r.bitrateTest){var u={stats:i,frag:r,part:n,id:r.type};this.onFragBuffered($t.FRAG_BUFFERED,u),r.bitrateTest=!1}else this.lastLoadedFragLevel=r.level}}},{key:"onFragBuffered",value:function(e,t){var r=t.frag,n=t.part,i=null!=n&&n.stats.loaded?n.stats:r.stats;if(!i.aborted&&!this.ignoreFragment(r)){var a=i.parsing.end-i.loading.start-Math.min(i.loading.first-i.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,i.loaded),i.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}}},{key:"ignoreFragment",value:function(e){return e.type!==ir||"initSegment"===e.sn}},{key:"clearTimer",value:function(){this.timer>-1&&(self.clearInterval(this.timer),this.timer=-1)}},{key:"getAutoLevelKey",value:function(){return"".concat(this.getBwEstimate(),"_").concat(this.getStarvationDelay().toFixed(2))}},{key:"getNextABRAutoLevel",value:function(){var e=this.fragCurrent,t=this.partCurrent,r=this.hls;if(r.levels.length<=1)return r.loadLevel;var n=r.maxAutoLevel,i=r.config,a=r.minAutoLevel,o=t?t.duration:e?e.duration:0,s=this.getBwEstimate(),l=this.getStarvationDelay(),u=i.abrBandWidthFactor,c=i.abrBandWidthUpFactor;if(l){var f=this.findBestLevel(s,a,n,l,0,u,c);if(f>=0)return this.rebufferNotice=-1,f}var d=o?Math.min(o,i.maxStarvationDelay):i.maxStarvationDelay;if(!l){var h=this.bitrateTestDelay;h&&(d=(o?Math.min(o,i.maxLoadingDelay):i.maxLoadingDelay)-h,this.info("bitrate test took ".concat(Math.round(1e3*h),"ms, set first fragment max fetchDuration to ").concat(Math.round(1e3*d)," ms")),u=c=1)}var p=this.findBestLevel(s,a,n,l,d,u,c);if(this.rebufferNotice!==p&&(this.rebufferNotice=p,this.info("".concat(l?"rebuffering expected":"buffer is empty",", optimal quality level ").concat(p))),p>-1)return p;var g=r.levels[a],v=r.loadLevelObj;return v&&(null==g?void 0:g.bitrate)<v.bitrate?a:r.loadLevel}},{key:"getStarvationDelay",value:function(){var e=this.hls,t=e.media;if(!t)return 1/0;var r=t&&0!==t.playbackRate?Math.abs(t.playbackRate):1,n=e.mainForwardBufferInfo;return(n?n.len:0)/r}},{key:"getBwEstimate",value:function(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}},{key:"findBestLevel",value:function(e,t,r,n,i,a,o){var s,l=this,u=n+i,c=this.lastLoadedFragLevel,f=-1===c?this.hls.firstLevel:c,d=this.fragCurrent,h=this.partCurrent,p=this.hls,g=p.levels,v=p.allAudioTracks,y=p.loadLevel,m=p.config;if(1===g.length)return 0;var A,b=g[f],E=!(null==(s=this.hls.latestLevelDetails)||!s.live),k=-1===y||-1===c,T="SDR",S=(null==b?void 0:b.frameRate)||0,w=m.audioPreference,_=m.videoPreference,L=this.audioTracksByGroup||(this.audioTracksByGroup=Kn(v)),P=-1;if(k){if(-1!==this.firstSelection)return this.firstSelection;var I=function(e,t,r,n,i){for(var a=Object.keys(e),o=null==n?void 0:n.channels,s=null==n?void 0:n.audioCodec,l=null==i?void 0:i.videoCodec,u=o&&2===parseInt(o),c=!1,f=!1,d=1/0,h=1/0,p=1/0,g=1/0,v=0,y=[],m=function(e,t){var r=!1,n=[];if(e&&(r="SDR"!==e,n=[e]),t){var i="SDR"!==(n=t.allowedVideoRanges||xn.slice(0)).join("")&&!t.videoCodec;(r=void 0!==t.preferHDR?t.preferHDR:i&&function(){if("function"==typeof matchMedia){var e=matchMedia("(dynamic-range: high)"),t=matchMedia("bad query");if(e.media!==t.media)return!0===e.matches}return!1}())||(n=["SDR"])}return{preferHDR:r,allowedVideoRanges:n}}(t,i),A=m.preferHDR,b=m.allowedVideoRanges,E=function(t){var r=e[a[t]];c||(c=r.channels[2]>0),d=Math.min(d,r.minHeight),h=Math.min(h,r.minFramerate),p=Math.min(p,r.minBitrate),b.filter((function(e){return r.videoRanges[e]>0})).length>0&&(f=!0)},k=a.length;k--;)E(k);d=Wt(d)?d:0,h=Wt(h)?h:0;var T=Math.max(1080,d),S=Math.max(30,h);p=Wt(p)?p:r,r=Math.max(p,r),f||(t=void 0);var w=a.length>1;return{codecSet:a.reduce((function(t,n){var i=e[n];if(n===t)return t;if(y=f?b.filter((function(e){return i.videoRanges[e]>0})):[],w){if(i.minBitrate>r)return Hn(n,"min bitrate of ".concat(i.minBitrate," > current estimate of ").concat(r)),t;if(!i.hasDefaultAudio)return Hn(n,"no renditions with default or auto-select sound found"),t;if(s&&n.indexOf(s.substring(0,4))%5!=0)return Hn(n,'audio codec preference "'.concat(s,'" not found')),t;if(o&&!u){if(!i.channels[o])return Hn(n,"no renditions with ".concat(o," channel sound found (channels options: ").concat(Object.keys(i.channels),")")),t}else if((!s||u)&&c&&0===i.channels[2])return Hn(n,"no renditions with stereo sound found"),t;if(i.minHeight>T)return Hn(n,"min resolution of ".concat(i.minHeight," > maximum of ").concat(T)),t;if(i.minFramerate>S)return Hn(n,"min framerate of ".concat(i.minFramerate," > maximum of ").concat(S)),t;if(!y.some((function(e){return i.videoRanges[e]>0})))return Hn(n,"no variants with VIDEO-RANGE of ".concat(Vn(y)," found")),t;if(l&&n.indexOf(l.substring(0,4))%5!=0)return Hn(n,'video codec preference "'.concat(l,'" not found')),t;if(i.maxScore<v)return Hn(n,"max score of ".concat(i.maxScore," < selected max of ").concat(v)),t}return t&&(bn(n)>=bn(t)||i.fragmentError>e[t].fragmentError)?t:(g=i.minIndex,v=i.maxScore,n)}),void 0),videoRanges:y,preferHDR:A,minFramerate:h,minBitrate:p,minIndex:g}}(this.codecTiers||(this.codecTiers=function(e,t,r,n){return e.slice(r,n+1).reduce((function(e,r,n){if(!r.codecSet)return e;var i=r.audioGroups,a=e[r.codecSet];a||(e[r.codecSet]=a={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:n,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!i,fragmentError:0}),a.minBitrate=Math.min(a.minBitrate,r.bitrate);var o=Math.min(r.height,r.width);return a.minHeight=Math.min(a.minHeight,o),a.minFramerate=Math.min(a.minFramerate,r.frameRate),a.minIndex=Math.min(a.minIndex,n),a.maxScore=Math.max(a.maxScore,r.score),a.fragmentError+=r.fragmentError,a.videoRanges[r.videoRange]=(a.videoRanges[r.videoRange]||0)+1,i&&i.forEach((function(e){if(e){var r=t.groups[e];r&&(a.hasDefaultAudio=a.hasDefaultAudio||t.hasDefaultAudio?r.hasDefault:r.hasAutoSelect||!t.hasDefaultAudio&&!t.hasAutoSelectAudio,Object.keys(r.channels).forEach((function(e){a.channels[e]=(a.channels[e]||0)+r.channels[e]})))}})),e}),{})}(g,L,t,r)),T,e,w,_),R=I.codecSet,C=I.videoRanges,D=I.minFramerate,O=I.minBitrate,z=I.minIndex,M=I.preferHDR;P=z,A=R,T=M?C[C.length-1]:C[0],S=D,e=Math.max(e,O),this.log("picked start tier ".concat(Vn(I)))}else A=null==b?void 0:b.codecSet,T=null==b?void 0:b.videoRange;for(var x=h?h.duration:d?d.duration:0,B=this.bwEstimator.getEstimateTTFB()/1e3,F=[],N=function(t){var s=g[t],d=t>f;if(!s)return"continue";if(m.useMediaCapabilities&&!s.supportedResult&&!s.supportedPromise){var p=navigator.mediaCapabilities;"function"==typeof(null==p?void 0:p.decodingInfo)&&function(e,t,r,n,i,a){var o=e.videoCodec,s=e.audioCodec?e.audioGroups:null,l=null==a?void 0:a.audioCodec,u=null==a?void 0:a.channels,c=u?parseInt(u):l?1/0:2,f=null;if(null!=s&&s.length)try{f=1===s.length&&s[0]?t.groups[s[0]].channels:s.reduce((function(e,r){if(r){var n=t.groups[r];if(!n)throw new Error("Audio track group ".concat(r," not found"));Object.keys(n.channels).forEach((function(t){e[t]=(e[t]||0)+n.channels[t]}))}return e}),{2:0})}catch(e){return!0}return void 0!==o&&(o.split(",").some((function(e){return ln(e)}))||e.width>1920&&e.height>1088||e.height>1920&&e.width>1088||e.frameRate>Math.max(n,30)||"SDR"!==e.videoRange&&e.videoRange!==r||e.bitrate>Math.max(i,8e6))||!!f&&Wt(c)&&Object.keys(f).some((function(e){return parseInt(e)>c}))}(s,L,T,S,e,w)?(s.supportedPromise=Dn(s,L,p,l.supportedCache),s.supportedPromise.then((function(e){if(l.hls){s.supportedResult=e;var t=l.hls.levels,r=t.indexOf(s);e.error?l.warn('MediaCapabilities decodingInfo error: "'.concat(e.error,'" for level ').concat(r," ").concat(Vn(e))):e.supported?e.decodingInfoResults.some((function(e){return!1===e.smooth||!1===e.powerEfficient}))&&l.log("MediaCapabilities decodingInfo for level ".concat(r," not smooth or powerEfficient: ").concat(Vn(e))):(l.warn("Unsupported MediaCapabilities decodingInfo result for level ".concat(r," ").concat(Vn(e))),r>-1&&t.length>1&&(l.log("Removing unsupported level ".concat(r)),l.hls.removeLevel(r),-1===l.hls.loadLevel&&(l.hls.nextLoadLevel=0)))}})).catch((function(e){l.warn("Error handling MediaCapabilities decodingInfo: ".concat(e))}))):s.supportedResult=Rn}if((A&&s.codecSet!==A||T&&s.videoRange!==T||d&&S>s.frameRate||!d&&S>0&&S<s.frameRate||null!=(j=s.supportedResult)&&null!=(j=j.decodingInfoResults)&&j.some((function(e){return!1===e.smooth})))&&(!k||t!==P))return F.push(t),"continue";var v,b=s.details,_=(h?null==b?void 0:b.partTarget:null==b?void 0:b.averagetargetduration)||x;v=d?o*e:a*e;var I=x&&n>=2*x&&0===i?s.averageBitrate:s.maxBitrate,R=l.getTimeToLoadFrag(B,v,I*_,void 0===b);if(v>=I&&(t===c||0===s.loadError&&0===s.fragmentError)&&(R<=B||!Wt(R)||E&&!l.bitrateTestDelay||R<u)){var C=l.forcedAutoLevel;return{v:(t===y||-1!==C&&C===y||(F.length&&l.trace("Skipped level(s) ".concat(F.join(",")," of ").concat(r,' max with CODECS and VIDEO-RANGE:"').concat(g[F[0]].codecs,'" ').concat(g[F[0]].videoRange,'; not compatible with "').concat(A,'" ').concat(T)),l.info("switch candidate:".concat(f,"->").concat(t," adjustedbw(").concat(Math.round(v),")-bitrate=").concat(Math.round(v-I)," ttfb:").concat(B.toFixed(1)," avgDuration:").concat(_.toFixed(1)," maxFetchDuration:").concat(u.toFixed(1)," fetchDuration:").concat(R.toFixed(1)," firstSelection:").concat(k," codecSet:").concat(s.codecSet," videoRange:").concat(s.videoRange," hls.loadLevel:").concat(y))),k&&(l.firstSelection=t),t)}}},U=r;U>=t;U--){var j,G=N(U);if("continue"!==G&&"object"===typeof G)return G.v}return-1}},{key:"deriveNextAutoLevel",value:function(e){var t=this.hls,r=t.maxAutoLevel,n=t.minAutoLevel;return Math.min(Math.max(e,n),r)}},{key:"firstAutoLevel",get:function(){var e=this.hls,t=e.maxAutoLevel,r=e.minAutoLevel,n=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,a=this.findBestLevel(n,r,t,0,i,1,1);if(a>-1)return a;var o=this.hls.firstLevel,s=Math.min(Math.max(o,r),t);return this.warn("Could not find best starting auto level. Defaulting to first in playlist ".concat(o," clamped to ").concat(s)),s}},{key:"forcedAutoLevel",get:function(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}},{key:"nextAutoLevel",get:function(){var e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(!(-1===e||t&&r&&this.nextAutoLevelKey!==this.getAutoLevelKey()))return e;var n=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(-1!==e){var i=this.hls.levels;if(i.length>Math.max(e,n)&&i[e].loadError<=i[n].loadError)return e}return this._nextAutoLevel=n,this.nextAutoLevelKey=this.getAutoLevelKey(),n},set:function(e){var t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}}]),r}(hr),bufferController:function(e){c(r,e);var t=f(r);function r(e,n){var i,a;return h(this,r),(i=t.call(this,"buffer-controller",e.logger)).hls=void 0,i.fragmentTracker=void 0,i.details=null,i._objectUrl=null,i.operationQueue=null,i.bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.lastMpegAudioChunk=null,i.blockedAudioAppend=null,i.lastVideoAppendEnd=0,i.appendSource=void 0,i.transferData=void 0,i.overrides=void 0,i.appendErrors={audio:0,video:0,audiovideo:0},i.tracks={},i.sourceBuffers=[[null,null],[null,null]],i._onEndStreaming=function(e){var t;i.hls&&"open"===(null==(t=i.mediaSource)?void 0:t.readyState)&&i.hls.pauseBuffering()},i._onStartStreaming=function(e){i.hls&&i.hls.resumeBuffering()},i._onMediaSourceOpen=function(e){var t=l(i),r=t.media,n=t.mediaSource;e&&i.log("Media source opened"),r&&n&&(n.removeEventListener("sourceopen",i._onMediaSourceOpen),r.removeEventListener("emptied",i._onMediaEmptied),i.updateDuration(),i.hls.trigger($t.MEDIA_ATTACHED,{media:r,mediaSource:n}),null!==i.mediaSource&&i.checkPendingTracks())},i._onMediaSourceClose=function(){i.log("Media source closed")},i._onMediaSourceEnded=function(){i.log("Media source ended")},i._onMediaEmptied=function(){var e=l(i),t=e.mediaSrc,r=e._objectUrl;t!==r&&i.error("Media element src was set while attaching MediaSource (".concat(r," > ").concat(t,")"))},i.hls=e,i.fragmentTracker=n,i.appendSource=(a=br(e.config.preferManagedMediaSource),"undefined"!=typeof self&&a===self.ManagedMediaSource),i.initTracks(),i.registerListeners(),i}return p(r,[{key:"hasSourceTypes",value:function(){return Object.keys(this.tracks).length>0}},{key:"destroy",value:function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}},{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.BUFFER_RESET,this.onBufferReset,this),e.on($t.BUFFER_APPENDING,this.onBufferAppending,this),e.on($t.BUFFER_CODECS,this.onBufferCodecs,this),e.on($t.BUFFER_EOS,this.onBufferEos,this),e.on($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($t.FRAG_PARSED,this.onFragParsed,this),e.on($t.FRAG_CHANGED,this.onFragChanged,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.BUFFER_RESET,this.onBufferReset,this),e.off($t.BUFFER_APPENDING,this.onBufferAppending,this),e.off($t.BUFFER_CODECS,this.onBufferCodecs,this),e.off($t.BUFFER_EOS,this.onBufferEos,this),e.off($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($t.FRAG_PARSED,this.onFragParsed,this),e.off($t.FRAG_CHANGED,this.onFragChanged,this),e.off($t.ERROR,this.onError,this)}},{key:"transferMedia",value:function(){var e=this,t=this.media,r=this.mediaSource;if(!t)return null;var n={};if(this.operationQueue){var i=this.isUpdating();i||this.operationQueue.removeBlockers();var o=this.isQueued();(i||o)&&this.warn("Transfering MediaSource with".concat(o?" operations in queue":"").concat(i?" updating SourceBuffer(s)":""," ").concat(this.operationQueue)),this.operationQueue.destroy()}var s=this.transferData;return!this.sourceBufferCount&&s&&s.mediaSource===r?cr(n,s.tracks):this.sourceBuffers.forEach((function(t){var r=a(t,1)[0];r&&(n[r]=cr({},e.tracks[r]),e.removeBuffer(r)),t[0]=t[1]=null})),{media:t,mediaSource:r,tracks:n}}},{key:"initTracks",value:function(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}},{key:"onManifestLoading",value:function(){this.bufferCodecEventsTotal=0,this.details=null}},{key:"onManifestParsed",value:function(e,t){var r,n=2;(t.audio&&!t.video||!t.altAudio)&&(n=1),this.bufferCodecEventsTotal=n,this.log("".concat(n," bufferCodec event(s) expected.")),null!=(r=this.transferData)&&r.mediaSource&&this.sourceBufferCount&&n&&this.bufferCreated()}},{key:"onMediaAttaching",value:function(e,t){var r=this.media=t.media;this.transferData=this.overrides=void 0;var n=br(this.appendSource);if(n){var i=!!t.mediaSource;(i||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);var a=this.mediaSource=t.mediaSource||new n;if(this.assignMediaSource(a),i)this._objectUrl=r.src,this.attachTransferred();else{var o=this._objectUrl=self.URL.createObjectURL(a);if(this.appendSource)try{r.removeAttribute("src");var s=self.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||s&&a instanceof s,al(r),function(e,t){var r=self.document.createElement("source");r.type="video/mp4",r.src=t,e.appendChild(r)}(r,o),r.load()}catch(t){r.src=o}else r.src=o}r.addEventListener("emptied",this._onMediaEmptied)}}},{key:"assignMediaSource",value:function(e){var t,r;this.log("".concat((null==(t=this.transferData)?void 0:t.mediaSource)===e?"transferred":"created"," media source: ").concat(null==(r=e.constructor)?void 0:r.name)),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}},{key:"attachTransferred",value:function(){var e=this,t=this.media,r=this.transferData;if(r&&t){var n=this.tracks,i=r.tracks,a=i?Object.keys(i):null,o=a?a.length:0,s=function(){Promise.resolve().then((function(){e.media&&e.mediaSourceOpenOrEnded&&e._onMediaSourceOpen()}))};if(i&&a&&o){if(!this.tracksReady)return this.hls.config.startFragPrefetch=!0,void this.log("attachTransferred: waiting for SourceBuffer track info");if(this.log("attachTransferred: (bufferCodecEventsTotal ".concat(this.bufferCodecEventsTotal,")\nrequired tracks: ").concat(Vn(n,(function(e,t){return"initSegment"===e?void 0:t})),";\ntransfer tracks: ").concat(Vn(i,(function(e,t){return"initSegment"===e?void 0:t})),"}")),!Er(i,n)){r.mediaSource=null,r.tracks=void 0;var l=t.currentTime,u=this.details,c=Math.max(l,(null==u?void 0:u.fragments[0].start)||0);return c-l>1?void this.log("attachTransferred: waiting for playback to reach new tracks start time ".concat(l," -> ").concat(c)):(this.warn('attachTransferred: resetting MediaSource for incompatible tracks ("'.concat(Object.keys(i),'"->"').concat(Object.keys(n),'") start time: ').concat(c," currentTime: ").concat(l)),this.onMediaDetaching($t.MEDIA_DETACHING,{}),this.onMediaAttaching($t.MEDIA_ATTACHING,r),void(t.currentTime=c))}this.transferData=void 0,a.forEach((function(t){var r=t,n=i[r];if(n){var a=n.buffer;if(a){var o=e.fragmentTracker,s=n.id;if(o.hasFragments(s)||o.hasParts(s)){var l=Yi.getBuffered(a);o.detectEvictedFragments(r,l,s,null,!0)}var u=ol(r),c=[r,a];e.sourceBuffers[u]=c,a.updating&&e.operationQueue&&e.operationQueue.prependBlocker(r),e.trackSourceBuffer(r,n)}}})),s(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),s()}}},{key:"onMediaDetaching",value:function(e,t){var r=this,n=!!t.transferMedia;this.transferData=this.overrides=void 0;var i=this.media,o=this.mediaSource,s=this._objectUrl;if(o){if(this.log("media source ".concat(n?"transferring":"detaching")),n)this.sourceBuffers.forEach((function(e){var t=a(e,1)[0];t&&r.removeBuffer(t)})),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){var l="open"===o.readyState;try{for(var u=o.sourceBuffers,c=u.length;c--;)l&&u[c].abort(),o.removeSourceBuffer(u[c]);l&&o.endOfStream()}catch(e){this.warn("onMediaDetaching: ".concat(e.message," while calling endOfStream"))}}this.sourceBufferCount&&this.onBufferReset()}o.removeEventListener("sourceopen",this._onMediaSourceOpen),o.removeEventListener("sourceended",this._onMediaSourceEnded),o.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(o.removeEventListener("startstreaming",this._onStartStreaming),o.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),n||(s&&self.URL.revokeObjectURL(s),this.mediaSrc===s?(i.removeAttribute("src"),this.appendSource&&al(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger($t.MEDIA_DETACHED,t)}},{key:"onBufferReset",value:function(){var e=this;this.sourceBuffers.forEach((function(t){var r=a(t,1)[0];r&&e.resetBuffer(r)})),this.initTracks()}},{key:"resetBuffer",value:function(e){var t,r=null==(t=this.tracks[e])?void 0:t.buffer;if(this.removeBuffer(e),r)try{var n;null!=(n=this.mediaSource)&&n.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(r)}catch(t){this.warn("onBufferReset ".concat(e),t)}delete this.tracks[e]}},{key:"removeBuffer",value:function(e){this.removeBufferListeners(e),this.sourceBuffers[ol(e)]=[null,null];var t=this.tracks[e];t&&(t.buffer=void 0)}},{key:"resetQueue",value:function(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new tl(this.tracks)}},{key:"onBufferCodecs",value:function(e,t){var r,n=this,i=this.tracks,a=Object.keys(t);this.log('BUFFER_CODECS: "'.concat(a,'" (current SB count ').concat(this.sourceBufferCount,")"));var o="audiovideo"in t&&(i.audio||i.video)||i.audiovideo&&("audio"in t||"video"in t),s=!o&&this.sourceBufferCount&&this.media&&a.some((function(e){return!i[e]}));o||s?this.warn('Unsupported transition between "'.concat(Object.keys(i),'" and "').concat(a,'" SourceBuffers')):(a.forEach((function(e){var r,a,o=t[e],s=o.id,l=o.codec,u=o.levelCodec,c=o.container,f=o.metadata,d=o.supplemental,h=i[e],p=null==(r=n.transferData)||null==(r=r.tracks)?void 0:r[e],g=null!=p&&p.buffer?p:h,v=(null==g?void 0:g.pendingCodec)||(null==g?void 0:g.codec),y=null==g?void 0:g.levelCodec;h||(h=i[e]={buffer:void 0,listeners:[],codec:l,supplemental:d,container:c,levelCodec:u,metadata:f,id:s});var m=Sn(v,y),A=null==m?void 0:m.replace(rl,"$1"),b=Sn(l,u),E=null==(a=b)?void 0:a.replace(rl,"$1");b&&m&&A!==E&&("audio"===e.slice(0,5)&&(b=Tn(b,n.appendSource)),n.log("switching codec ".concat(v," to ").concat(b)),b!==(h.pendingCodec||h.codec)&&(h.pendingCodec=b),h.container=c,n.appendChangeType(e,c,b))})),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),this.sourceBufferCount||(this.bufferCodecEventsTotal>1&&!this.tracks.video&&!t.video&&"main"===(null==(r=t.audio)?void 0:r.id)&&(this.log("Main audio-only"),this.bufferCodecEventsTotal=1),this.mediaSourceOpenOrEnded&&this.checkPendingTracks()))}},{key:"appendChangeType",value:function(e,t,r){var n=this,i="".concat(t,";codecs=").concat(r),a={label:"change-type=".concat(i),execute:function(){var a=n.tracks[e];if(a){var o=a.buffer;null!=o&&o.changeType&&(n.log("changing ".concat(e," sourceBuffer type to ").concat(i)),o.changeType(i),a.codec=r,a.container=t)}n.shiftAndExecuteNext(e)},onStart:function(){},onComplete:function(){},onError:function(t){n.warn("Failed to change ".concat(e," SourceBuffer type"),t)}};this.append(a,e,this.isPending(this.tracks[e]))}},{key:"blockAudio",value:function(e){var t,r=this,n=e.start,i=n+.05*e.duration;if(!0!==(null==(t=this.fragmentTracker.getAppendedFrag(n,ir))?void 0:t.gap)){var a={label:"block-audio",execute:function(){var e,t=r.tracks.video;(r.lastVideoAppendEnd>i||null!=t&&t.buffer&&Yi.isBuffered(t.buffer,i)||!0===(null==(e=r.fragmentTracker.getAppendedFrag(i,ir))?void 0:e.gap))&&(r.blockedAudioAppend=null,r.shiftAndExecuteNext("audio"))},onStart:function(){},onComplete:function(){},onError:function(e){r.warn("Error executing block-audio operation",e)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}}},{key:"unblockAudio",value:function(){var e=this.blockedAudioAppend,t=this.operationQueue;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}},{key:"onBufferAppending",value:function(e,t){var r=this,n=this.tracks,i=t.data,o=t.type,s=t.parent,l=t.frag,u=t.part,c=t.chunkMeta,f=t.offset,d=c.buffering[o],h=l.sn,p=l.cc,g=self.performance.now();d.start=g;var v=l.stats.buffering,y=u?u.stats.buffering:null;0===v.start&&(v.start=g),y&&0===y.start&&(y.start=g);var m=n.audio,A=!1;"audio"===o&&"audio/mpeg"===(null==m?void 0:m.container)&&(A=!this.lastMpegAudioChunk||1===c.id||this.lastMpegAudioChunk.sn!==c.sn,this.lastMpegAudioChunk=c);var b=n.video,E=null==b?void 0:b.buffer;if(E&&"initSegment"!==h){var k=u||l,T=this.blockedAudioAppend;if("audio"!==o||"main"===s||this.blockedAudioAppend||b.ending||b.ended){if("video"===o){var S=k.end;if(T){var w=T.frag.start;(S>w||S<this.lastVideoAppendEnd||Yi.isBuffered(E,w))&&this.unblockAudio()}this.lastVideoAppendEnd=S}}else{var _=k.start+.05*k.duration,L=E.buffered,P=this.currentOp("video");L.length||P?!P&&!Yi.isBuffered(E,_)&&this.lastVideoAppendEnd<_&&this.blockAudio(k):this.blockAudio(k)}}var I=(u||l).start,R={label:"append-".concat(o),execute:function(){var e;d.executeStart=self.performance.now();var t=null==(e=r.tracks[o])?void 0:e.buffer;t&&(A?r.updateTimestampOffset(t,I,.1,o,h,p):void 0!==f&&Wt(f)&&r.updateTimestampOffset(t,f,1e-6,o,h,p)),r.appendExecutor(i,o)},onStart:function(){},onComplete:function(){var e=self.performance.now();d.executeEnd=d.end=e,0===v.first&&(v.first=e),y&&0===y.first&&(y.first=e);var t={};r.sourceBuffers.forEach((function(e){var r=a(e,2),n=r[0],i=r[1];n&&(t[n]=Yi.getBuffered(i))})),r.appendErrors[o]=0,"audio"===o||"video"===o?r.appendErrors.audiovideo=0:(r.appendErrors.audio=0,r.appendErrors.video=0),r.hls.trigger($t.BUFFER_APPENDED,{type:o,frag:l,part:u,chunkMeta:c,parent:l.type,timeRanges:t})},onError:function(e){var t,n={type:Jt.MEDIA_ERROR,parent:l.type,details:Zt.BUFFER_APPEND_ERROR,sourceBufferName:o,frag:l,part:u,chunkMeta:c,error:e,err:e,fatal:!1},i=null==(t=r.media)?void 0:t.error;if(e.code===DOMException.QUOTA_EXCEEDED_ERR||"QuotaExceededError"==e.name||"quota"in e)n.details=Zt.BUFFER_FULL_ERROR;else if(e.code===DOMException.INVALID_STATE_ERR&&r.mediaSourceOpenOrEnded&&!i)n.errorAction=bi(!0);else if(e.name===nl&&0===r.sourceBufferCount)n.errorAction=bi(!0);else{var a=++r.appendErrors[o];r.warn("Failed ".concat(a,"/").concat(r.hls.config.appendErrorMaxRetry,' times to append segment in "').concat(o,'" sourceBuffer (').concat(i||"no media error",")")),(a>=r.hls.config.appendErrorMaxRetry||i)&&(n.fatal=!0)}r.hls.trigger($t.ERROR,n)}};this.log('queuing "'.concat(o,'" append sn: ').concat(h).concat(u?" p: "+u.index:""," of ").concat(l.type===ir?"level":"track"," ").concat(l.level," cc: ").concat(p)),this.append(R,o,this.isPending(this.tracks[o]))}},{key:"getFlushOp",value:function(e,t,r){var n=this;return this.log('queuing "'.concat(e,'" remove ').concat(t,"-").concat(r)),{label:"remove",execute:function(){n.removeExecutor(e,t,r)},onStart:function(){},onComplete:function(){n.hls.trigger($t.BUFFER_FLUSHED,{type:e})},onError:function(i){n.warn("Failed to remove ".concat(t,"-").concat(r,' from "').concat(e,'" SourceBuffer'),i)}}}},{key:"onBufferFlushing",value:function(e,t){var r=this,n=t.type,i=t.startOffset,o=t.endOffset;n?this.append(this.getFlushOp(n,i,o),n):this.sourceBuffers.forEach((function(e){var t=a(e,1)[0];t&&r.append(r.getFlushOp(t,i,o),t)}))}},{key:"onFragParsed",value:function(e,t){var r=this,n=t.frag,i=t.part,a=[],o=i?i.elementaryStreams:n.elementaryStreams;o[xr]?a.push("audiovideo"):(o[zr]&&a.push("audio"),o[Mr]&&a.push("video")),0===a.length&&this.warn("Fragments must have at least one ElementaryStreamType set. type: ".concat(n.type," level: ").concat(n.level," sn: ").concat(n.sn)),this.blockBuffers((function(){var e=self.performance.now();n.stats.buffering.end=e,i&&(i.stats.buffering.end=e);var t=i?i.stats:n.stats;r.hls.trigger($t.FRAG_BUFFERED,{frag:n,part:i,stats:t,id:n.type})}),a).catch((function(e){r.warn("Fragment buffered callback ".concat(e)),r.stepOperationQueue(r.sourceBufferTypes)}))}},{key:"onFragChanged",value:function(e,t){this.trimBuffers()}},{key:"onBufferEos",value:function(e,t){var r,n=this;this.sourceBuffers.forEach((function(e){var r=a(e,1)[0];if(r){var i=n.tracks[r];t.type&&t.type!==r||(i.ending=!0,i.ended||(i.ended=!0,n.log("".concat(r," buffer reached EOS"))))}}));var i=!1!==(null==(r=this.overrides)?void 0:r.endOfStream);this.sourceBufferCount>0&&!this.sourceBuffers.some((function(e){var t,r=a(e,1)[0];return r&&!(null!=(t=n.tracks[r])&&t.ended)}))?i?(this.log("Queueing EOS"),this.blockUntilOpen((function(){n.tracksEnded();var e=n.mediaSource;e&&"open"===e.readyState?(n.log("Calling mediaSource.endOfStream()"),e.endOfStream(),n.hls.trigger($t.BUFFERED_TO_END,void 0)):e&&n.log("Could not call mediaSource.endOfStream(). mediaSource.readyState: ".concat(e.readyState))}))):(this.tracksEnded(),this.hls.trigger($t.BUFFERED_TO_END,void 0)):"video"===t.type&&this.unblockAudio()}},{key:"tracksEnded",value:function(){var e=this;this.sourceBuffers.forEach((function(t){var r=a(t,1)[0];if(null!==r){var n=e.tracks[r];n&&(n.ending=!1)}}))}},{key:"onLevelUpdated",value:function(e,t){var r=t.details;r.fragments.length&&(this.details=r,this.updateDuration())}},{key:"updateDuration",value:function(){var e=this;this.blockUntilOpen((function(){var t=e.getDurationAndRange();t&&e.updateMediaSource(t)}))}},{key:"onError",value:function(e,t){if(t.details===Zt.BUFFER_APPEND_ERROR&&t.frag){var r,n=null==(r=t.errorAction)?void 0:r.nextAutoLevel;Wt(n)&&n!==t.frag.level&&this.resetAppendErrors()}}},{key:"resetAppendErrors",value:function(){this.appendErrors={audio:0,video:0,audiovideo:0}}},{key:"trimBuffers",value:function(){var e=this.hls,t=this.details,r=this.media;if(r&&null!==t&&this.sourceBufferCount){var n=e.config,i=r.currentTime,a=t.levelTargetDuration,o=t.live&&null!==n.liveBackBufferLength?n.liveBackBufferLength:n.backBufferLength;if(Wt(o)&&o>=0){var s=Math.max(o,a),l=Math.floor(i/a)*a-s;this.flushBackBuffer(i,a,l)}var u=n.frontBufferFlushThreshold;if(Wt(u)&&u>0){var c=Math.max(n.maxBufferLength,u),f=Math.max(c,a),d=Math.floor(i/a)*a+f;this.flushFrontBuffer(i,a,d)}}}},{key:"flushBackBuffer",value:function(e,t,r){var n=this;this.sourceBuffers.forEach((function(e){var t=a(e,2),i=t[0],o=t[1];if(o){var s=Yi.getBuffered(o);if(s.length>0&&r>s.start(0)){var l;n.hls.trigger($t.BACK_BUFFER_REACHED,{bufferEnd:r});var u=n.tracks[i];if(null!=(l=n.details)&&l.live)n.hls.trigger($t.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(null!=u&&u.ended)return void n.log("Cannot flush ".concat(i," back buffer while SourceBuffer is in ended state"));n.hls.trigger($t.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:i})}}}))}},{key:"flushFrontBuffer",value:function(e,t,r){var n=this;this.sourceBuffers.forEach((function(t){var i=a(t,2),o=i[0],s=i[1];if(s){var l=Yi.getBuffered(s),u=l.length;if(u<2)return;var c=l.start(u-1),f=l.end(u-1);if(r>c||e>=c&&e<=f)return;n.hls.trigger($t.BUFFER_FLUSHING,{startOffset:c,endOffset:1/0,type:o})}}))}},{key:"getDurationAndRange",value:function(){var e,t=this.details,r=this.mediaSource;if(!t||!this.media||"open"!==(null==r?void 0:r.readyState))return null;var n=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){var i=Math.max(0,t.fragmentStart);return{duration:1/0,start:i,end:Math.max(i,n)}}return{duration:1/0}}var a=null==(e=this.overrides)?void 0:e.duration;if(a)return Wt(a)?{duration:a}:null;var o=this.media.duration;return n>(Wt(r.duration)?r.duration:0)&&n>o||!Wt(o)?{duration:n}:null}},{key:"updateMediaSource",value:function(e){var t=e.duration,r=e.start,n=e.end,i=this.mediaSource;this.media&&i&&"open"===i.readyState&&(i.duration!==t&&(Wt(t)&&this.log("Updating MediaSource duration to ".concat(t.toFixed(3))),i.duration=t),void 0!==r&&void 0!==n&&(this.log("MediaSource duration is set to ".concat(i.duration,". Setting seekable range to ").concat(r,"-").concat(n,".")),i.setLiveSeekableRange(r,n)))}},{key:"checkPendingTracks",value:function(){var e=this.bufferCodecEventsTotal,t=this.pendingTrackCount,r=this.tracks;if(this.log("checkPendingTracks (pending: ".concat(t," codec events expected: ").concat(e,") ").concat(Vn(r))),this.tracksReady){var n,i=null==(n=this.transferData)?void 0:n.tracks;i&&Object.keys(i).length?this.attachTransferred():this.createSourceBuffers()}}},{key:"bufferCreated",value:function(){var e=this;if(this.sourceBufferCount){var t={};this.sourceBuffers.forEach((function(r){var n=a(r,2),i=n[0],o=n[1];if(i){var s=e.tracks[i];t[i]={buffer:o,container:s.container,codec:s.codec,supplemental:s.supplemental,levelCodec:s.levelCodec,id:s.id,metadata:s.metadata}}})),this.hls.trigger($t.BUFFER_CREATED,{tracks:t}),this.log("SourceBuffers created. Running queue: ".concat(this.operationQueue)),this.sourceBuffers.forEach((function(t){var r=a(t,1)[0];e.executeNext(r)}))}else{var r=new Error("could not create source buffer for media codec(s)");this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:r,reason:r.message})}}},{key:"createSourceBuffers",value:function(){var e=this.tracks,t=this.sourceBuffers,r=this.mediaSource;if(!r)throw new Error("createSourceBuffers called when mediaSource was null");for(var n in e){var i=n,a=e[i];if(this.isPending(a)){var o=this.getTrackCodec(a,i),s="".concat(a.container,";codecs=").concat(o);a.codec=o,this.log("creating sourceBuffer(".concat(s,")").concat(this.currentOp(i)?" Queued":""," ").concat(Vn(a)));try{var l=r.addSourceBuffer(s),u=ol(i),c=[i,l];t[u]=c,a.buffer=l}catch(e){var f;return this.error("error while trying to add sourceBuffer: ".concat(e.message)),this.shiftAndExecuteNext(i),null==(f=this.operationQueue)||f.removeBlockers(),delete this.tracks[i],void this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,sourceBufferName:i,mimeType:s,parent:a.id})}this.trackSourceBuffer(i,a)}}this.bufferCreated()}},{key:"getTrackCodec",value:function(e,t){var r=e.supplemental,n=e.codec;r&&("video"===t||"audiovideo"===t)&&vn(r,"video")&&(n=function(e,t){var r=[];if(e)for(var n=e.split(","),i=0;i<n.length;i++)gn(n[i],"video")||r.push(n[i]);return t&&r.push(t),r.join(",")}(n,r));var i=Sn(n,e.levelCodec);return i?"audio"===t.slice(0,5)?Tn(i,this.appendSource):i:""}},{key:"trackSourceBuffer",value:function(e,t){var r=this,n=t.buffer;if(n){var i=this.getTrackCodec(t,e);this.tracks[e]={buffer:n,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(function(e,t){var n=t.removedRanges;null!=n&&n.length&&r.hls.trigger($t.BUFFER_FLUSHED,{type:e})}))}}},{key:"onSBUpdateStart",value:function(e){var t=this.currentOp(e);t&&t.onStart()}},{key:"onSBUpdateEnd",value:function(e){var t;if("closed"!==(null==(t=this.mediaSource)?void 0:t.readyState)){var r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}else this.resetBuffer(e)}},{key:"onSBUpdateError",value:function(e,t){var r,n=new Error("".concat(e," SourceBuffer error. MediaSource readyState: ").concat(null==(r=this.mediaSource)?void 0:r.readyState));this.error("".concat(n),t),this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:n,fatal:!1});var i=this.currentOp(e);i&&i.onError(n)}},{key:"updateTimestampOffset",value:function(e,t,r,n,i,a){var o=t-e.timestampOffset;Math.abs(o)>=r&&(this.log("Updating ".concat(n," SourceBuffer timestampOffset to ").concat(t," (sn: ").concat(i," cc: ").concat(a,")")),e.timestampOffset=t)}},{key:"removeExecutor",value:function(e,t,r){var n=this.media,i=this.mediaSource,a=this.tracks[e],o=null==a?void 0:a.buffer;if(!n||!i||!o)return this.warn("Attempting to remove from the ".concat(e," SourceBuffer, but it does not exist")),void this.shiftAndExecuteNext(e);var s=Wt(n.duration)?n.duration:1/0,l=Wt(i.duration)?i.duration:1/0,u=Math.max(0,t),c=Math.min(r,s,l);c>u&&(!a.ending||a.ended)?(a.ended=!1,this.log("Removing [".concat(u,",").concat(c,"] from the ").concat(e," SourceBuffer")),o.remove(u,c)):this.shiftAndExecuteNext(e)}},{key:"appendExecutor",value:function(e,t){var r=this.tracks[t],n=null==r?void 0:r.buffer;if(!n)throw new il("Attempting to append to the ".concat(t," SourceBuffer, but it does not exist"));r.ending=!1,r.ended=!1,n.appendBuffer(e)}},{key:"blockUntilOpen",value:function(e){var t=this;if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch((function(e){t.warn("SourceBuffer blocked callback ".concat(e)),t.stepOperationQueue(t.sourceBufferTypes)}));else try{e()}catch(e){this.warn("Callback run without blocking ".concat(this.operationQueue," ").concat(e))}}},{key:"isUpdating",value:function(){return this.sourceBuffers.some((function(e){var t=a(e,2),r=t[0],n=t[1];return r&&n.updating}))}},{key:"isQueued",value:function(){var e=this;return this.sourceBuffers.some((function(t){var r=a(t,1)[0];return r&&!!e.currentOp(r)}))}},{key:"isPending",value:function(e){return!!e&&!e.buffer}},{key:"blockBuffers",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.sourceBufferTypes;if(!r.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);var n=this.operationQueue,i=r.map((function(e){return t.appendBlocker(e)}));return r.length>1&&!!this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then((function(r){n===t.operationQueue&&(e(),t.stepOperationQueue(t.sourceBufferTypes))}))}},{key:"stepOperationQueue",value:function(e){var t=this;e.forEach((function(e){var r,n=null==(r=t.tracks[e])?void 0:r.buffer;n&&!n.updating&&t.shiftAndExecuteNext(e)}))}},{key:"append",value:function(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}},{key:"appendBlocker",value:function(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}},{key:"currentOp",value:function(e){return this.operationQueue?this.operationQueue.current(e):null}},{key:"executeNext",value:function(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}},{key:"shiftAndExecuteNext",value:function(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}},{key:"addBufferListener",value:function(e,t,r){var n=this.tracks[e];if(n){var i=n.buffer;if(i){var a=r.bind(this,e);n.listeners.push({event:t,listener:a}),i.addEventListener(t,a)}}}},{key:"removeBufferListeners",value:function(e){var t=this.tracks[e];if(t){var r=t.buffer;r&&(t.listeners.forEach((function(e){r.removeEventListener(e.event,e.listener)})),t.listeners.length=0)}}},{key:"mediaSourceOpenOrEnded",get:function(){var e,t=null==(e=this.mediaSource)?void 0:e.readyState;return"open"===t||"ended"===t}},{key:"sourceBufferTracks",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){var n=e.tracks[r];return t[r]={id:n.id,container:n.container,codec:n.codec,levelCodec:n.levelCodec},t}),{})}},{key:"bufferedToEnd",get:function(){var e=this;return this.sourceBufferCount>0&&!this.sourceBuffers.some((function(t){var r=a(t,1)[0];if(r){var n=e.tracks[r];if(n)return!n.ended||n.ending}return!1}))}},{key:"tracksReady",get:function(){var e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}},{key:"mediaSrc",get:function(){var e,t,r=(null==(e=this.media)||null==(t=e.querySelector)?void 0:t.call(e,"source"))||this.media;return null==r?void 0:r.src}},{key:"pendingTrackCount",get:function(){var e=this;return Object.keys(this.tracks).reduce((function(t,r){return t+(e.isPending(e.tracks[r])?1:0)}),0)}},{key:"sourceBufferCount",get:function(){return this.sourceBuffers.reduce((function(e,t){return e+(a(t,1)[0]?1:0)}),0)}},{key:"sourceBufferTypes",get:function(){return this.sourceBuffers.map((function(e){return a(e,1)[0]})).filter((function(e){return!!e}))}}]),r}(hr),capLevelController:sl,errorController:function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,"error-controller",e.logger)).hls=void 0,n.playlistError=0,n.hls=e,n.registerListeners(),n}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e.on($t.ERROR,this.onError,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.LEVEL_UPDATED,this.onLevelUpdated,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.ERROR,this.onError,this),e.off($t.ERROR,this.onErrorOut,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.LEVEL_UPDATED,this.onLevelUpdated,this))}},{key:"destroy",value:function(){this.unregisterListeners(),this.hls=null}},{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){this.playlistError=0}},{key:"getVariantLevelIndex",value:function(e){return(null==e?void 0:e.type)===ir?e.level:this.getVariantIndex()}},{key:"getVariantIndex",value:function(){var e,t=this.hls,r=t.currentLevel;return null!=(e=t.loadLevelObj)&&e.details||-1===r?t.loadLevel:r}},{key:"variantHasKey",value:function(e,t){if(e){var r;if(null!=(r=e.details)&&r.hasKey(t))return!0;var n=e.audioGroups;if(n)return this.hls.allAudioTracks.filter((function(e){return n.indexOf(e.groupId)>=0})).some((function(e){var r;return null==(r=e.details)?void 0:r.hasKey(t)}))}return!1}},{key:"onManifestLoading",value:function(){this.playlistError=0}},{key:"onLevelUpdated",value:function(){this.playlistError=0}},{key:"onError",value:function(e,t){var r;if(!t.fatal){var n=this.hls,i=t.context;switch(t.details){case Zt.FRAG_LOAD_ERROR:case Zt.FRAG_LOAD_TIMEOUT:case Zt.KEY_LOAD_ERROR:case Zt.KEY_LOAD_TIMEOUT:return void(t.errorAction=this.getFragRetryOrSwitchAction(t));case Zt.FRAG_PARSING_ERROR:if(null!=(r=t.frag)&&r.gap)return void(t.errorAction=bi());case Zt.FRAG_GAP:case Zt.FRAG_DECRYPT_ERROR:return t.errorAction=this.getFragRetryOrSwitchAction(t),void(t.errorAction.action=hi);case Zt.LEVEL_EMPTY_ERROR:case Zt.LEVEL_PARSING_ERROR:var a,o=t.parent===ir?t.level:n.loadLevel;return void(t.details===Zt.LEVEL_EMPTY_ERROR&&null!=(a=t.context)&&null!=(a=a.levelDetails)&&a.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,o)));case Zt.LEVEL_LOAD_ERROR:case Zt.LEVEL_LOAD_TIMEOUT:return void("number"==typeof(null==i?void 0:i.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,i.level)));case Zt.AUDIO_TRACK_LOAD_ERROR:case Zt.AUDIO_TRACK_LOAD_TIMEOUT:case Zt.SUBTITLE_LOAD_ERROR:case Zt.SUBTITLE_TRACK_LOAD_TIMEOUT:if(i){var s=n.loadLevelObj;if(s&&(i.type===rr&&s.hasAudioGroup(i.groupId)||i.type===nr&&s.hasSubtitleGroup(i.groupId)))return t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=hi,void(t.errorAction.flags=yi)}return;case Zt.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:return void(t.errorAction={action:hi,flags:mi});case Zt.KEY_SYSTEM_SESSION_UPDATE_FAILED:case Zt.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case Zt.KEY_SYSTEM_NO_SESSION:return void(t.errorAction={action:hi,flags:Ai});case Zt.BUFFER_ADD_CODEC_ERROR:case Zt.REMUX_ALLOC_ERROR:case Zt.BUFFER_APPEND_ERROR:var l;return void(t.errorAction||(t.errorAction=this.getLevelSwitchAction(t,null!=(l=t.level)?l:n.loadLevel)));case Zt.INTERNAL_EXCEPTION:case Zt.BUFFER_APPENDING_ERROR:case Zt.BUFFER_FULL_ERROR:case Zt.LEVEL_SWITCH_ERROR:case Zt.BUFFER_STALLED_ERROR:case Zt.BUFFER_SEEK_OVER_HOLE:case Zt.BUFFER_NUDGE_ON_STALL:return void(t.errorAction=bi())}t.type===Jt.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=bi())}}},{key:"getPlaylistRetryOrSwitchAction",value:function(e,t){var r=si(this.hls.config.playlistLoadPolicy,e),n=this.playlistError++;if(ci(r,n,ii(e),e.response))return{action:gi,flags:vi,retryConfig:r,retryCount:n};var i=this.getLevelSwitchAction(e,t);return r&&(i.retryConfig=r,i.retryCount=n),i}},{key:"getFragRetryOrSwitchAction",value:function(e){var t=this.hls,r=this.getVariantLevelIndex(e.frag),n=t.levels[r],i=t.config,a=i.fragLoadPolicy,o=i.keyLoadPolicy,s=si(ai(e)?o:a,e),l=t.levels.reduce((function(e,t){return e+t.fragmentError}),0);if(n&&(e.details!==Zt.FRAG_GAP&&n.fragmentError++,!oi(e))&&ci(s,l,ii(e),e.response))return{action:gi,flags:vi,retryConfig:s,retryCount:l};var u=this.getLevelSwitchAction(e,r);return s&&(u.retryConfig=s,u.retryCount=l),u}},{key:"getLevelSwitchAction",value:function(e,t){var r=this.hls;null==t&&(t=r.loadLevel);var n=this.hls.levels[t];if(n){var i,a,o=e.details;n.loadError++,o===Zt.BUFFER_APPEND_ERROR&&n.fragmentError++;var s=-1,l=r.levels,u=r.loadLevel,c=r.minAutoLevel,f=r.maxAutoLevel;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);for(var d=null==(i=e.frag)?void 0:i.type,h=(d===ar&&o===Zt.FRAG_PARSING_ERROR||"audio"===e.sourceBufferName&&(o===Zt.BUFFER_ADD_CODEC_ERROR||o===Zt.BUFFER_APPEND_ERROR))&&l.some((function(e){var t=e.audioCodec;return n.audioCodec!==t})),p="video"===e.sourceBufferName&&(o===Zt.BUFFER_ADD_CODEC_ERROR||o===Zt.BUFFER_APPEND_ERROR)&&l.some((function(e){var t=e.codecSet,r=e.audioCodec;return n.codecSet!==t&&n.audioCodec===r})),g=null!=(a=e.context)?a:{},v=g.type,y=g.groupId,m=l.length;m--;){var A=(m+u)%l.length;if(A!==u&&A>=c&&A<=f&&0===l[A].loadError){var b,E,k=function(){var t=l[A];if(o===Zt.FRAG_GAP&&d===ir&&e.frag){var r=l[A].details;if(r){var i=ei(e.frag,r.fragments,e.frag.start);if(null!=i&&i.gap)return"continue"}}else{if(v===rr&&t.hasAudioGroup(y)||v===nr&&t.hasSubtitleGroup(y))return"continue";if(d===ar&&null!=(b=n.audioGroups)&&b.some((function(e){return t.hasAudioGroup(e)}))||d===or&&null!=(E=n.subtitleGroups)&&E.some((function(e){return t.hasSubtitleGroup(e)}))||h&&n.audioCodec===t.audioCodec||p&&n.codecSet===t.codecSet||!h&&n.codecSet!==t.codecSet)return"continue"}return s=A,"break"}();if("continue"===k)continue;if("break"===k)break}}if(s>-1&&r.loadLevel!==s)return e.levelRetry=!0,this.playlistError=0,{action:hi,flags:vi,nextAutoLevel:s}}return{action:hi,flags:yi}}},{key:"onErrorOut",value:function(e,t){var r;switch(null==(r=t.errorAction)?void 0:r.action){case di:break;case hi:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===Zt.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn('MediaSource ended after "'.concat(t.sourceBufferName,'" sourceBuffer append error. Attempting to recover from media error.')),this.hls.recoverMediaError()):t.fatal=!0}t.fatal&&this.hls.stopLoad()}},{key:"sendAlternateToPenaltyBox",value:function(e){var t=this.hls,r=e.errorAction;if(r){var n=r.flags,i=r.nextAutoLevel;switch(n){case vi:this.switchLevel(e,i);break;case mi:var a=this.getVariantLevelIndex(e.frag),o=t.levels[a],s=null==o?void 0:o.attrs["HDCP-LEVEL"];if(r.hdcpLevel=s,"NONE"===s)this.warn("HDCP policy resticted output with HDCP-LEVEL=NONE");else if(s){t.maxHdcpLevel=Mn[Mn.indexOf(s)-1],r.resolved=!0,this.warn('Restricting playback to HDCP-LEVEL of "'.concat(t.maxHdcpLevel,'" or lower'));break}case Ai:var l=e.decryptdata;if(l){for(var u=this.hls.levels,c=u.length,f=c;f--;){var d,h;this.variantHasKey(u[f],l)&&(this.log("Banned key found in level ".concat(f," (").concat(u[f].bitrate,'bps) or audio group "').concat(null==(d=u[f].audioGroups)?void 0:d.join(","),'" (').concat(null==(h=e.frag)?void 0:h.type," fragment) ").concat(Tr(l.keyId||[]))),u[f].fragmentError++,u[f].loadError++,this.log("Removing level ".concat(f," with key error (").concat(e.error,")")),this.hls.removeLevel(f))}var p=e.frag;if(this.hls.levels.length<c)r.resolved=!0;else if(p&&p.type!==ir){var g=p.decryptdata;g&&!l.matches(g)&&(r.resolved=!0)}}}r.resolved||this.switchLevel(e,i)}}},{key:"switchLevel",value:function(e,t){if(void 0!==t&&e.errorAction&&(this.warn("switching to level ".concat(t," after ").concat(e.details)),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===Zt.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&"audiovideo"!==e.sourceBufferName))for(var r=Pn(e.mimeType),n=this.hls.levels,i=n.length;i--;)n[i]["".concat(e.sourceBufferName,"Codec")]===r&&(this.log("Removing level ".concat(i," for ").concat(e.details,' ("').concat(r,'" not supported)')),this.hls.removeLevel(i))}}]),r}(hr),fpsController:function(){function e(t){h(this,e),this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}return p(e,[{key:"setStreamController",value:function(e){this.streamController=e}},{key:"registerListeners",value:function(){this.hls.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on($t.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"unregisterListeners",value:function(){this.hls.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off($t.MEDIA_DETACHING,this.onMediaDetaching,this)}},{key:"destroy",value:function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}},{key:"onMediaAttaching",value:function(e,t){var r=this.hls.config;if(r.capLevelOnFPSDrop){var n=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=n,n&&"function"==typeof n.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}},{key:"onMediaDetaching",value:function(){this.media=null}},{key:"checkFPS",value:function(e,t,r){var n=performance.now();if(t){if(this.lastTime){var i=n-this.lastTime,a=r-this.lastDroppedFrames,o=t-this.lastDecodedFrames,s=1e3*a/i,l=this.hls;if(l.trigger($t.FPS_DROP,{currentDropped:a,currentDecoded:o,totalDroppedFrames:r}),s>0&&a>l.config.fpsDroppedMonitoringThreshold*o){var u=l.currentLevel;l.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+u),u>0&&(-1===l.autoLevelCapping||l.autoLevelCapping>=u)&&(u-=1,l.trigger($t.FPS_DROP_LEVEL_CAPPING,{level:u,droppedLevel:l.currentLevel}),l.autoLevelCapping=u,this.streamController.nextLevelSwitch())}}this.lastTime=n,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}},{key:"checkFPSInterval",value:function(){var e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){var t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}]),e}(),stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:Aa,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:vc,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:function(e){c(r,e);var t=f(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this,e,n,i,"subtitle-stream-controller",or)).currentTrackId=-1,a.tracksBuffered=[],a.mainDetails=null,a.registerListeners(),a}return p(r,[{key:"onHandlerDestroying",value:function(){this.unregisterListeners(),o(s(r.prototype),"onHandlerDestroying",this).call(this),this.mainDetails=null}},{key:"registerListeners",value:function(){o(s(r.prototype),"registerListeners",this).call(this);var e=this.hls;e.on($t.LEVEL_LOADED,this.onLevelLoaded,this),e.on($t.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on($t.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on($t.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on($t.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on($t.BUFFER_FLUSHING,this.onBufferFlushing,this)}},{key:"unregisterListeners",value:function(){o(s(r.prototype),"unregisterListeners",this).call(this);var e=this.hls;e.off($t.LEVEL_LOADED,this.onLevelLoaded,this),e.off($t.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off($t.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off($t.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off($t.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off($t.BUFFER_FLUSHING,this.onBufferFlushing,this)}},{key:"startLoad",value:function(e,t){this.stopLoad(),this.state=lo,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}},{key:"onManifestLoading",value:function(){o(s(r.prototype),"onManifestLoading",this).call(this),this.mainDetails=null}},{key:"onMediaDetaching",value:function(e,t){this.tracksBuffered=[],o(s(r.prototype),"onMediaDetaching",this).call(this,e,t)}},{key:"onLevelLoaded",value:function(e,t){this.mainDetails=t.details}},{key:"onSubtitleFragProcessed",value:function(e,t){var r=t.frag,n=t.success;if(this.fragContextChanged(r)||(Fr(r)&&(this.fragPrevious=r),this.state=lo),n){var i=this.tracksBuffered[this.currentTrackId];if(i){for(var a,o=r.start,s=0;s<i.length;s++)if(o>=i[s].start&&o<=i[s].end){a=i[s];break}var l=r.start+r.duration;a?a.end=l:(a={start:o,end:l},i.push(a)),this.fragmentTracker.fragBuffered(r),this.fragBufferedComplete(r,null),this.media&&this.tick()}}}},{key:"onBufferFlushing",value:function(e,t){var r=t.startOffset,n=t.endOffset;if(0===r&&n!==Number.POSITIVE_INFINITY){var i=n-1;if(i<=0)return;t.endOffsetSubtitles=Math.max(0,i),this.tracksBuffered.forEach((function(e){for(var t=0;t<e.length;)if(e[t].end<=i)e.shift();else{if(!(e[t].start<i))break;e[t].start=i,t++}})),this.fragmentTracker.removeFragmentsInRange(r,i,or)}}},{key:"onError",value:function(e,t){var r=t.frag;(null==r?void 0:r.type)===or&&(t.details===Zt.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==so&&(this.state=lo))}},{key:"onSubtitleTracksUpdated",value:function(e,t){var r=this,n=t.subtitleTracks;this.levels&&Zs(this.levels,n)?this.levels=n.map((function(e){return new Gn(e)})):(this.tracksBuffered=[],this.levels=n.map((function(e){var t=new Gn(e);return r.tracksBuffered[t.id]=[],t})),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,or),this.fragPrevious=null,this.mediaBuffer=null)}},{key:"onSubtitleTrackSwitch",value:function(e,t){var r;if(this.currentTrackId=t.id,null!=(r=this.levels)&&r.length&&-1!==this.currentTrackId){var n=this.levels[this.currentTrackId];null!=n&&n.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,n&&this.state!==so&&this.setInterval(500)}else this.clearInterval()}},{key:"onSubtitleTrackLoaded",value:function(e,t){var r,n=this.currentTrackId,i=this.levels,a=t.details,o=t.id;if(i){var s=i[o];if(!(o>=i.length)&&s){this.log("Subtitle track ".concat(o," loaded [").concat(a.startSN,",").concat(a.endSN,"]").concat(a.lastPartSn?"[part-".concat(a.lastPartSn,"-").concat(a.lastPartIndex,"]"):"",",duration:").concat(a.totalduration)),this.mediaBuffer=this.mediaBufferTimeRanges;var l=0;if(a.live||null!=(r=s.details)&&r.live){if(a.deltaUpdateFailed)return;var u=this.mainDetails;if(!u)return void(this.startFragRequested=!1);var c,f=u.fragments[0];s.details?0===(l=this.alignPlaylists(a,s.details,null==(c=this.levelLastLoaded)?void 0:c.details))&&f&&Ha(a,l=f.start):a.hasProgramDateTime&&u.hasProgramDateTime?(no(a,u),l=a.fragmentStart):f&&Ha(a,l=f.start),u&&!this.startFragRequested&&this.setStartPosition(u,l)}s.details=a,this.levelLastLoaded=s,o===n&&(this.hls.trigger($t.SUBTITLE_TRACK_UPDATED,{details:a,id:o,groupId:t.groupId}),this.tick(),a.live&&!this.fragCurrent&&this.media&&this.state===lo)&&(ei(null,a.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),s.details=void 0))}}else this.warn("Subtitle tracks were reset while loading level ".concat(o))}},{key:"_handleFragmentLoadComplete",value:function(e){var t=this,r=e.frag,n=e.payload,i=r.decryptdata,a=this.hls;if(!this.fragContextChanged(r)&&n&&n.byteLength>0&&null!=i&&i.key&&i.iv&&na(i.method)){var o=performance.now();this.decrypter.decrypt(new Uint8Array(n),i.key.buffer,i.iv.buffer,ia(i.method)).catch((function(e){throw a.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:r}),e})).then((function(e){var t=performance.now();a.trigger($t.FRAG_DECRYPTED,{frag:r,payload:e,stats:{tstart:o,tdecrypt:t}})})).catch((function(e){t.warn("".concat(e.name,": ").concat(e.message)),t.state=lo}))}}},{key:"doTick",value:function(){if(this.media){if(this.state===lo){var e=this.currentTrackId,t=this.levels,r=null==t?void 0:t[e];if(!r||!t.length||!r.details)return;if(this.waitForLive(r))return;var n=this.config,i=this.getLoadPosition(),a=Yi.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],i,n.maxBufferHole),o=a.end,s=a.len,l=r.details;if(s>this.hls.maxBufferLength+l.levelTargetDuration)return;var u=l.fragments,c=u.length,f=l.edge,d=null,h=this.fragPrevious;if(o<f){var p=n.maxFragLookUpTolerance,g=o>f-p?0:p;!(d=ei(h,u,Math.max(u[0].start,o),g))&&h&&h.start<u[0].start&&(d=u[0])}else d=u[c-1];if(!(d=this.filterReplacedPrimary(d,r.details)))return;var v=u[d.sn-l.startSN-1];if(v&&v.cc===d.cc&&this.fragmentTracker.getState(v)===Ei&&(d=v),this.fragmentTracker.getState(d)===Ei){var y=this.mapToInitFragWhenRequired(d);y&&this.loadFragment(y,r,o)}}}else this.state=lo}},{key:"loadFragment",value:function(e,t,n){Fr(e)?o(s(r.prototype),"loadFragment",this).call(this,e,t,n):this._loadInitSegment(e,t)}},{key:"mediaBufferTimeRanges",get:function(){return new Su(this.tracksBuffered[this.currentTrackId]||[])}}]),r}(bo),subtitleTrackController:function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,e,"subtitle-track-controller")).media=null,n.tracks=[],n.groupIds=null,n.tracksInGroup=[],n.trackId=-1,n.currentTrack=null,n.selectDefaultTrack=!0,n.queuedDefaultTrack=-1,n.useTextTrackPolling=!1,n.subtitlePollingInterval=-1,n._subtitleDisplay=!0,n.asyncPollTrackChange=function(){return n.pollTrackChange(0)},n.onTextTracksChanged=function(){if(n.useTextTrackPolling||self.clearInterval(n.subtitlePollingInterval),n.media&&n.hls.config.renderTextTracksNatively){for(var e=null,t=lu(n.media.textTracks),r=0;r<t.length;r++)if("hidden"===t[r].mode)e=t[r];else if("showing"===t[r].mode){e=t[r];break}var i=n.findTrackForTextTrack(e);n.subtitleTrack!==i&&n.setSubtitleTrack(i)}},n.registerListeners(),n}return p(r,[{key:"destroy",value:function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,o(s(r.prototype),"destroy",this).call(this)}},{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.LEVEL_LOADING,this.onLevelLoading,this),e.on($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($t.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.LEVEL_LOADING,this.onLevelLoading,this),e.off($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($t.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off($t.ERROR,this.onError,this)}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}},{key:"pollTrackChange",value:function(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.onTextTracksChanged,e)}},{key:"onMediaDetaching",value:function(e,t){var r=this.media;if(r){var n=!!t.transferMedia;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,n||lu(r.textTracks).forEach((function(e){ou(e)}))}}},{key:"onManifestLoading",value:function(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}},{key:"onManifestParsed",value:function(e,t){this.tracks=t.subtitleTracks}},{key:"onSubtitleTrackLoaded",value:function(e,t){var r=t.id,n=t.groupId,i=t.details,a=this.tracksInGroup[r];if(a&&a.groupId===n){var o=a.details;a.details=t.details,this.log("Subtitle track ".concat(r,' "').concat(a.name,'" lang:').concat(a.lang," group:").concat(n," loaded [").concat(i.startSN,"-").concat(i.endSN,"]")),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Subtitle track with id:".concat(r," and group:").concat(n," not found in active group ").concat(null==a?void 0:a.groupId))}},{key:"onLevelLoading",value:function(e,t){this.switchLevel(t.level)}},{key:"onLevelSwitching",value:function(e,t){this.switchLevel(t.level)}},{key:"switchLevel",value:function(e){var t=this.hls.levels[e];if(t){var r=t.subtitleGroups||null,n=this.groupIds,i=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var a=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(a.length)this.selectDefaultTrack&&!a.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),a.forEach((function(e,t){e.id=t}));else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;var o=this.hls.config.subtitlePreference;if(!i&&o){this.selectDefaultTrack=!1;var s=Wn(o,a);if(s>-1)i=a[s];else{var l=Wn(o,this.tracks);i=this.tracks[l]}}var u=this.findTrackId(i);-1===u&&i&&(u=this.findTrackId(null));var c={subtitleTracks:a};this.log("Updating subtitle tracks, ".concat(a.length,' track(s) found in "').concat(null==r?void 0:r.join(","),'" group-id')),this.hls.trigger($t.SUBTITLE_TRACKS_UPDATED,c),-1!==u&&-1===this.trackId&&this.setSubtitleTrack(u)}}}},{key:"findTrackId",value:function(e){for(var t=this.tracksInGroup,r=this.selectDefaultTrack,n=0;n<t.length;n++){var i=t[n];if((!r||i.default)&&(r||e)&&(!e||qn(i,e)))return n}if(e){for(var a=0;a<t.length;a++){var o=t[a];if($s(e.attrs,o.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return a}for(var s=0;s<t.length;s++){var l=t[s];if($s(e.attrs,l.attrs,["LANGUAGE"]))return s}}return-1}},{key:"findTrackForTextTrack",value:function(e){if(e)for(var t=this.tracksInGroup,r=0;r<t.length;r++)if(el(t[r],e))return r;return-1}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&(t.context.type!==nr||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}},{key:"setSubtitleOption",value:function(e){if(this.hls.config.subtitlePreference=e,e){if(-1===e.id)return this.setSubtitleTrack(-1),null;var t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){var r=this.currentTrack;if(r&&qn(e,r))return r;var n=Wn(e,this.tracksInGroup);if(n>-1){var i=this.tracksInGroup[n];return this.setSubtitleTrack(n),i}if(r)return null;var a=Wn(e,t);if(a>-1)return t[a]}}return null}},{key:"loadPlaylist",value:function(e){o(s(r.prototype),"loadPlaylist",this).call(this),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}},{key:"loadingPlaylist",value:function(e,t){o(s(r.prototype),"loadingPlaylist",this).call(this,e,t);var n=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),l=e.details,u=null==l?void 0:l.age;this.log("Loading subtitle ".concat(n,' "').concat(e.name,'" lang:').concat(e.lang," group:").concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""," ").concat(a)),this.hls.trigger($t.SUBTITLE_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null,track:e})}},{key:"toggleTrackModes",value:function(){var e=this.media;if(e){var t,r=lu(e.textTracks),n=this.currentTrack;if(n&&((t=r.filter((function(e){return el(n,e)}))[0])||this.warn('Unable to find subtitle TextTrack with name "'.concat(n.name,'" and language "').concat(n.lang,'"'))),[].slice.call(r).forEach((function(e){"disabled"!==e.mode&&e!==t&&(e.mode="disabled")})),t){var i=this.subtitleDisplay?"showing":"hidden";t.mode!==i&&(t.mode=i)}}}},{key:"setSubtitleTrack",value:function(e){var t=this.tracksInGroup;if(this.media)if(e<-1||e>=t.length||!Wt(e))this.warn("Invalid subtitle track id: ".concat(e));else{this.selectDefaultTrack=!1;var r=this.currentTrack,n=t[e]||null;if(this.trackId=e,this.currentTrack=n,this.toggleTrackModes(),n){var i=!!n.details&&!n.details.live;if(e!==this.trackId||n!==r||!i){this.log("Switching to subtitle-track ".concat(e)+(n?' "'.concat(n.name,'" lang:').concat(n.lang," group:").concat(n.groupId):""));var a=n.id,o=n.groupId,s=void 0===o?"":o,l=n.name,u=n.type,c=n.url;this.hls.trigger($t.SUBTITLE_TRACK_SWITCH,{id:a,groupId:s,name:l,type:u,url:c});var f=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(f)}}else this.hls.trigger($t.SUBTITLE_TRACK_SWITCH,{id:e})}else this.queuedDefaultTrack=e}},{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}},{key:"allSubtitleTracks",get:function(){return this.tracks}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}}]),r}(Js),timelineController:function(){function e(t){h(this,e),this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},t.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),t.on($t.MANIFEST_LOADING,this.onManifestLoading,this),t.on($t.MANIFEST_LOADED,this.onManifestLoaded,this),t.on($t.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on($t.FRAG_LOADING,this.onFragLoading,this),t.on($t.FRAG_LOADED,this.onFragLoaded,this),t.on($t.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on($t.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on($t.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on($t.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on($t.BUFFER_FLUSHING,this.onBufferFlushing,this)}return p(e,[{key:"destroy",value:function(){var e=this.hls;e.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($t.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off($t.FRAG_LOADING,this.onFragLoading,this),e.off($t.FRAG_LOADED,this.onFragLoaded,this),e.off($t.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off($t.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off($t.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off($t.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off($t.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}},{key:"initCea608Parsers",value:function(){var e=new dc(this,"textTrack1"),t=new dc(this,"textTrack2"),r=new dc(this,"textTrack3"),n=new dc(this,"textTrack4");this.cea608Parser1=new Uu(1,e,t),this.cea608Parser2=new Uu(3,r,n)}},{key:"addCues",value:function(e,t,r,n,i){for(var a,o,s,l,u=!1,c=i.length;c--;){var f=i[c],d=(a=f[0],o=f[1],s=t,l=r,Math.min(o,l)-Math.max(a,s));if(d>=0&&(f[0]=Math.min(f[0],t),f[1]=Math.max(f[1],r),u=!0,d/(r-t)>.5))return}if(u||i.push([t,r]),this.config.renderTextTracksNatively){var h=this.captionsTracks[e];this.Cues.newCue(h,t,r,n)}else{var p=this.Cues.newCue(null,t,r,n);this.hls.trigger($t.CUES_PARSED,{type:"captions",cues:p,track:e})}}},{key:"onInitPtsFound",value:function(e,t){var r=this,n=t.frag,i=t.id,a=t.initPTS,o=t.timescale,s=t.trackId,l=this.unparsedVttFrags;i===ir&&(this.initPTS[n.cc]={baseTime:a,timescale:o,trackId:s}),l.length&&(this.unparsedVttFrags=[],l.forEach((function(e){r.initPTS[e.frag.cc]?r.onFragLoaded($t.FRAG_LOADED,e):r.hls.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e.frag,error:new Error("Subtitle discontinuity domain does not match main")})})))}},{key:"getExistingTrack",value:function(e,t){var r=this.media;if(r)for(var n=0;n<r.textTracks.length;n++){var i=r.textTracks[n];if(pc(i,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return i}return null}},{key:"createCaptionsTrack",value:function(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}},{key:"createNativeTrack",value:function(e){if(!this.captionsTracks[e]){var t=this.captionsProperties,r=this.captionsTracks,n=this.media,i=t[e],a=i.label,o=i.languageCode,s=this.getExistingTrack(a,o);if(s)r[e]=s,ou(r[e]),iu(r[e],n);else{var l=this.createTextTrack("captions",a,o);l&&(l[e]=!0,r[e]=l)}}}},{key:"createNonNativeTrack",value:function(e){if(!this.nonNativeCaptionsTracks[e]){var t=this.captionsProperties[e];if(t){var r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger($t.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}}}},{key:"createTextTrack",value:function(e,t,r){var n=this.media;if(n)return n.addTextTrack(e,t,r)}},{key:"onMediaAttaching",value:function(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}},{key:"onMediaDetaching",value:function(e,t){var r=!!t.transferMedia;if(this.media=null,!r){var n=this.captionsTracks;Object.keys(n).forEach((function(e){ou(n[e]),delete n[e]})),this.nonNativeCaptionsTracks={}}}},{key:"onManifestLoading",value:function(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}},{key:"_cleanTracks",value:function(){var e=this.media;if(e){var t=e.textTracks;if(t)for(var r=0;r<t.length;r++)ou(t[r])}}},{key:"onSubtitleTracksUpdated",value:function(e,t){var r=this,n=t.subtitleTracks||[],i=n.some((function(e){return e.textCodec===rc}));if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Zs(this.tracks,n))return void(this.tracks=n);if(this.textTracks=[],this.tracks=n,this.config.renderTextTracksNatively){var a=this.media,o=a?lu(a.textTracks):null;if(this.tracks.forEach((function(e,t){var n;if(o){for(var i=null,a=0;a<o.length;a++)if(o[a]&&pc(o[a],e)){i=o[a],o[a]=null;break}i&&(n=i)}if(n)ou(n);else{var s=hc(e);(n=r.createTextTrack(s,e.name,e.lang))&&(n.mode="disabled")}n&&r.textTracks.push(n)})),null!=o&&o.length){var s=o.filter((function(e){return null!==e})).map((function(e){return e.label}));s.length&&this.hls.logger.warn("Media element contains unused subtitle tracks: ".concat(s.join(", "),". Replace media element for each source to clear TextTracks and captions menu."))}}else if(this.tracks.length){var l=this.tracks.map((function(e){return{label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}}));this.hls.trigger($t.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:l})}}}},{key:"onManifestLoaded",value:function(e,t){var r=this;this.config.enableCEA708Captions&&t.captions&&t.captions.forEach((function(e){var t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(t){var n="textTrack".concat(t[1]),i=r.captionsProperties[n];i&&(i.label=e.name,e.lang&&(i.languageCode=e.lang),i.media=e)}}))}},{key:"closedCaptionsForLevel",value:function(e){var t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}},{key:"onFragLoading",value:function(e,t){if(this.enabled&&t.frag.type===ir){var r,n,i=this.cea608Parser1,a=this.cea608Parser2,o=this.lastSn,s=t.frag,l=s.cc,u=s.sn,c=null!=(r=null==(n=t.part)?void 0:n.index)?r:-1;i&&a&&(u!==o+1||u===o&&c!==this.lastPartIndex+1||l!==this.lastCc)&&(i.reset(),a.reset()),this.lastCc=l,this.lastSn=u,this.lastPartIndex=c}}},{key:"onFragLoaded",value:function(e,t){var r=t.frag,n=t.payload;if(r.type===or)if(n.byteLength){var i=r.decryptdata,a="stats"in t;if(null==i||!i.encrypted||a){var o=this.tracks[r.level],s=this.vttCCs;s[r.cc]||(s[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),o&&o.textCodec===rc?this._parseIMSC1(r,n):this._parseVTTs(t)}}else this.hls.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:new Error("Empty subtitle payload")})}},{key:"_parseIMSC1",value:function(e,t){var r=this,n=this.hls;oc(t,this.initPTS[e.cc],(function(t){r._appendCues(t,e.level),n.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})}),(function(t){n.logger.log("Failed to parse IMSC1: ".concat(t)),n.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})}))}},{key:"_parseVTTs",value:function(e){var t,r=this,n=e.frag,i=e.payload,a=this.initPTS,o=this.unparsedVttFrags,s=a.length-1;if(a[n.cc]||-1!==s){var l=this.hls;tc(null!=(t=n.initSegment)&&t.data?on(n.initSegment.data,new Uint8Array(i)).buffer:i,this.initPTS[n.cc],this.vttCCs,n.cc,n.start,(function(e){r._appendCues(e,n.level),l.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})}),(function(t){var a="Missing initPTS for VTT MPEGTS"===t.message;a?o.push(e):r._fallbackToIMSC1(n,i),l.logger.log("Failed to parse VTT cue: ".concat(t)),a&&s>n.cc||l.trigger($t.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n,error:t})}))}else o.push(e)}},{key:"_fallbackToIMSC1",value:function(e,t){var r=this,n=this.tracks[e.level];n.textCodec||oc(t,this.initPTS[e.cc],(function(){n.textCodec=rc,r._parseIMSC1(e,t)}),(function(){n.textCodec="wvtt"}))}},{key:"_appendCues",value:function(e,t){var r=this.hls;if(this.config.renderTextTracksNatively){var n=this.textTracks[t];if(!n||"disabled"===n.mode)return;e.forEach((function(e){return au(n,e)}))}else{var i=this.tracks[t];if(!i)return;var a=i.default?"default":"subtitles"+t;r.trigger($t.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}},{key:"onFragDecrypted",value:function(e,t){t.frag.type===or&&this.onFragLoaded($t.FRAG_LOADED,t)}},{key:"onSubtitleTracksCleared",value:function(){this.tracks=[],this.captionsTracks={}}},{key:"onFragParsingUserdata",value:function(e,t){if(this.enabled&&this.config.enableCEA708Captions){var r=t.frag,n=t.samples;if(r.type!==ir||"NONE"!==this.closedCaptionsForLevel(r))for(var i=0;i<n.length;i++){var a=n[i].bytes;if(a){this.cea608Parser1||this.initCea608Parsers();var o=this.extractCea608Data(a);this.cea608Parser1.addData(n[i].pts,o[0]),this.cea608Parser2.addData(n[i].pts,o[1])}}}}},{key:"onBufferFlushing",value:function(e,t){var r=t.startOffset,n=t.endOffset,i=t.endOffsetSubtitles,a=t.type,o=this.media;if(o&&!(o.currentTime<n)){if(!a||"video"===a){var s=this.captionsTracks;Object.keys(s).forEach((function(e){return su(s[e],r,n)}))}if(this.config.renderTextTracksNatively&&0===r&&void 0!==i){var l=this.textTracks;Object.keys(l).forEach((function(e){return su(l[e],r,i)}))}}}},{key:"extractCea608Data",value:function(e){for(var t=[[],[]],r=31&e[0],n=2,i=0;i<r;i++){var a=e[n++],o=127&e[n++],s=127&e[n++];if((0!==o||0!==s)&&0!=(4&a)){var l=3&a;0!==l&&1!==l||(t[l].push(o),t[l].push(s))}}return t}}]),e}(),audioStreamController:function(e){c(r,e);var t=f(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this,e,n,i,"audio-stream-controller",ar)).mainAnchor=null,a.mainFragLoading=null,a.audioOnly=!1,a.bufferedTrack=null,a.switchingTrack=null,a.trackId=-1,a.waitingData=null,a.mainDetails=null,a.flushing=!1,a.bufferFlushed=!1,a.cachedTrackLoadedData=null,a.registerListeners(),a}return p(r,[{key:"onHandlerDestroying",value:function(){this.unregisterListeners(),o(s(r.prototype),"onHandlerDestroying",this).call(this),this.resetItem()}},{key:"resetItem",value:function(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}},{key:"registerListeners",value:function(){o(s(r.prototype),"registerListeners",this).call(this);var e=this.hls;e.on($t.LEVEL_LOADED,this.onLevelLoaded,this),e.on($t.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($t.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on($t.BUFFER_RESET,this.onBufferReset,this),e.on($t.BUFFER_CREATED,this.onBufferCreated,this),e.on($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($t.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on($t.FRAG_LOADING,this.onFragLoading,this),e.on($t.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(o(s(r.prototype),"unregisterListeners",this).call(this),e.off($t.LEVEL_LOADED,this.onLevelLoaded,this),e.off($t.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($t.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off($t.BUFFER_RESET,this.onBufferReset,this),e.off($t.BUFFER_CREATED,this.onBufferCreated,this),e.off($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($t.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off($t.FRAG_LOADING,this.onFragLoading,this),e.off($t.FRAG_BUFFERED,this.onFragBuffered,this))}},{key:"onInitPtsFound",value:function(e,t){var r=t.frag,n=t.id,i=t.initPTS,a=t.timescale,o=t.trackId;if(n===ir){var s=r.cc,l=this.fragCurrent;if(this.initPTS[s]={baseTime:i,timescale:a,trackId:o},this.log("InitPTS for cc: ".concat(s," found from main: ").concat(i/a," (").concat(i,"/").concat(a,") trackId: ").concat(o)),this.mainAnchor=r,this.state===mo){var u=this.waitingData;(!u&&!this.loadingParts||u&&u.frag.cc!==s)&&this.syncWithAnchor(r,null==u?void 0:u.frag)}else!this.hls.hasEnoughToStart&&l&&l.cc!==s?(l.abortRequests(),this.syncWithAnchor(r,l)):this.state===lo&&this.tick()}}},{key:"getLoadPosition",value:function(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:o(s(r.prototype),"getLoadPosition",this).call(this)}},{key:"syncWithAnchor",value:function(e,t){var r,n=(null==(r=this.mainFragLoading)?void 0:r.frag)||null;if(!t||(null==n?void 0:n.cc)!==t.cc){var i=(n||e).cc,a=ni(this.getLevelDetails(),i,this.getLoadPosition());a&&(this.log("Syncing with main frag at ".concat(a.start," cc ").concat(a.cc)),this.startFragRequested=!1,this.nextLoadPosition=a.start,this.resetLoadingState(),this.state===lo&&this.doTickIdle())}}},{key:"startLoad",value:function(e,t){if(!this.levels)return this.startPosition=e,void(this.state=so);var r=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),r>0&&-1===e?(this.log("Override startPosition with lastCurrentTime @".concat(r.toFixed(3))),e=r,this.state=lo):this.state=ho,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}},{key:"doTick",value:function(){switch(this.state){case lo:this.doTickIdle();break;case ho:var e=this.levels,t=this.trackId,n=null==e?void 0:e[t],i=null==n?void 0:n.details;if(i&&!this.waitForLive(n)){if(this.waitForCdnTuneIn(i))break;this.state=mo}break;case fo:this.checkRetryDate();break;case mo:var a=this.waitingData;if(a){var l=a.frag,u=a.part,c=a.cache,f=a.complete,d=this.mainAnchor;if(void 0!==this.initPTS[l.cc]){this.waitingData=null,this.state=co;var h={frag:l,part:u,payload:c.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(h),f&&o(s(r.prototype),"_handleFragmentLoadComplete",this).call(this,h)}else d&&d.cc!==a.frag.cc&&this.syncWithAnchor(d,a.frag)}else this.state=lo}this.onTickEnd()}},{key:"resetLoadingState",value:function(){var e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),o(s(r.prototype),"resetLoadingState",this).call(this)}},{key:"onTickEnd",value:function(){var e=this.media;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}},{key:"doTickIdle",value:function(){var e,t=this.hls,r=this.levels,n=this.media,i=this.trackId,a=t.config;if(this.buffering&&(n||this.primaryPrefetch||!this.startFragRequested&&a.startFragPrefetch)&&null!=r&&r[i]){var o=r[i],s=o.details;if(!s||this.waitForLive(o)||this.waitForCdnTuneIn(s))return this.state=ho,void(this.startFragRequested=!1);var l=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&l&&(this.bufferFlushed=!1,this.afterBufferFlushed(l,zr,ar));var u=this.getFwdBufferInfo(l,ar);if(null!==u){if(!this.switchingTrack&&this._streamEnded(u,s))return t.trigger($t.BUFFER_EOS,{type:"audio"}),void(this.state=vo);var c=u.len,f=t.maxBufferLength,d=s.fragments,h=d[0].start,p=this.getLoadPosition(),g=this.flushing?p:u.end;if(this.switchingTrack&&n){var v=p;s.PTSKnown&&v<h&&(u.end>h||u.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),n.currentTime=h+.05)}if(!(c>=f&&!this.switchingTrack&&g<d[d.length-1].start)){var y=this.getNextFragment(g,s);if(y&&this.isLoopLoading(y,g)&&(y=this.getNextFragmentLoopLoading(y,s,u,ir,f)),y){var m=(null==(e=this.mainFragLoading)?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&m&&Fr(y)&&!y.endList&&(!s.live||!this.loadingParts&&g<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(m)===Si&&(this.mainFragLoading=m=null),m&&Fr(m))){if(y.start>m.end){var A=this.fragmentTracker.getFragAtPos(g,ir);A&&A.end>m.end&&(m=A,this.mainFragLoading={frag:A,targetBufferTime:null})}if(y.start>m.end)return}this.loadFragment(y,o,g)}else this.bufferFlushed=!0}}}}},{key:"onMediaDetaching",value:function(e,t){this.bufferFlushed=this.flushing=!1,o(s(r.prototype),"onMediaDetaching",this).call(this,e,t)}},{key:"onAudioTracksUpdated",value:function(e,t){var r=t.audioTracks;this.resetTransmuxer(),this.levels=r.map((function(e){return new Gn(e)}))}},{key:"onAudioTrackSwitching",value:function(e,t){var r=!!t.url;this.trackId=t.id;var n=this.fragCurrent;n&&(n.abortRequests(),this.removeUnbufferedFrags(n.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==so&&(this.setInterval(100),this.state=lo,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}},{key:"onManifestLoading",value:function(){o(s(r.prototype),"onManifestLoading",this).call(this),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}},{key:"onLevelLoaded",value:function(e,t){this.mainDetails=t.details;var r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded($t.AUDIO_TRACK_LOADED,r))}},{key:"onAudioTrackLoaded",value:function(e,t){var r,n=this.levels,i=t.details,a=t.id,o=t.groupId,s=t.track;if(n){var l=this.mainDetails;if(!l||i.endCC>l.endCC||l.expired)return this.cachedTrackLoadedData=t,void(this.state!==so&&(this.state=ho));this.cachedTrackLoadedData=null,this.log("Audio track ".concat(a,' "').concat(s.name,'" of "').concat(o,'" loaded [').concat(i.startSN,",").concat(i.endSN,"]").concat(i.lastPartSn?"[part-".concat(i.lastPartSn,"-").concat(i.lastPartIndex,"]"):"",",duration:").concat(i.totalduration));var u=n[a],c=0;if(i.live||null!=(r=u.details)&&r.live){if(this.checkLiveUpdate(i),i.deltaUpdateFailed)return;var f;u.details&&(c=this.alignPlaylists(i,u.details,null==(f=this.levelLastLoaded)?void 0:f.details)),i.alignedSliding||(ro(i,l),i.alignedSliding||no(i,l),c=i.fragmentStart)}u.details=i,this.levelLastLoaded=u,this.startFragRequested||this.setStartPosition(l,c),this.hls.trigger($t.AUDIO_TRACK_UPDATED,{details:i,id:a,groupId:t.groupId}),this.state!==ho||this.waitForCdnTuneIn(i)||(this.state=lo),this.tick()}else this.warn("Audio tracks reset while loading track ".concat(a,' "').concat(s.name,'" of "').concat(o,'"'))}},{key:"_handleFragmentLoadProgress",value:function(e){var t,r=e.frag,n=e.part,i=e.payload,a=this.config,o=this.trackId,s=this.levels;if(s){var l=s[o];if(l){var u=l.details;if(!u)return this.warn("Audio track details undefined on fragment load progress"),void this.removeUnbufferedFrags(r.start);var c=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2",f=this.transmuxer;f||(f=this.transmuxer=new Xs(this.hls,ar,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var d=this.initPTS[r.cc],h=null==(t=r.initSegment)?void 0:t.data;if(void 0!==d){var p=n?n.index:-1,g=-1!==p,v=new ji(r.level,r.sn,r.stats.chunkCount,i.byteLength,p,g);f.push(i,h,c,"",r,n,u.totalduration,!1,v,d)}else this.log("Unknown video PTS for cc ".concat(r.cc,", waiting for video PTS before demuxing audio frag ").concat(r.sn," of [").concat(u.startSN," ,").concat(u.endSN,"],track ").concat(o)),(this.waitingData=this.waitingData||{frag:r,part:n,cache:new To,complete:!1}).cache.push(new Uint8Array(i)),this.state!==so&&(this.state=mo)}else this.warn("Audio track is undefined on fragment load progress")}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment ".concat(r.sn," of level ").concat(r.level," will not be buffered"))}},{key:"_handleFragmentLoadComplete",value:function(e){this.waitingData?this.waitingData.complete=!0:o(s(r.prototype),"_handleFragmentLoadComplete",this).call(this,e)}},{key:"onBufferReset",value:function(){this.mediaBuffer=null}},{key:"onBufferCreated",value:function(e,t){this.bufferFlushed=this.flushing=!1;var r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}},{key:"onFragLoading",value:function(e,t){!this.audioOnly&&t.frag.type===ir&&Fr(t.frag)&&(this.mainFragLoading=t,this.state===lo&&this.tick())}},{key:"onFragBuffered",value:function(e,t){var r=t.frag,n=t.part;if(r.type===ar)if(this.fragContextChanged(r))this.warn("Fragment ".concat(r.sn).concat(n?" p: "+n.index:""," of level ").concat(r.level," finished buffering, but was aborted. state: ").concat(this.state,", audioSwitch: ").concat(this.switchingTrack?this.switchingTrack.name:"false"));else{if(Fr(r)){this.fragPrevious=r;var i=this.switchingTrack;i&&(this.bufferedTrack=i,this.switchingTrack=null,this.hls.trigger($t.AUDIO_TRACK_SWITCHED,dr({},i)))}this.fragBufferedComplete(r,n),this.media&&this.tick()}else this.audioOnly||r.type!==ir||r.elementaryStreams.video||r.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null)}},{key:"onError",value:function(e,t){var n;if(t.fatal)this.state=yo;else switch(t.details){case Zt.FRAG_GAP:case Zt.FRAG_PARSING_ERROR:case Zt.FRAG_DECRYPT_ERROR:case Zt.FRAG_LOAD_ERROR:case Zt.FRAG_LOAD_TIMEOUT:case Zt.KEY_LOAD_ERROR:case Zt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ar,t);break;case Zt.AUDIO_TRACK_LOAD_ERROR:case Zt.AUDIO_TRACK_LOAD_TIMEOUT:case Zt.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==ho||(null==(n=t.context)?void 0:n.type)!==rr||(this.state=lo);break;case Zt.BUFFER_ADD_CODEC_ERROR:case Zt.BUFFER_APPEND_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case Zt.BUFFER_FULL_ERROR:if("audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,o(s(r.prototype),"flushMainBuffer",this).call(this,0,Number.POSITIVE_INFINITY,"audio"));break;case Zt.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}},{key:"onBufferFlushing",value:function(e,t){t.type!==Mr&&(this.flushing=!0)}},{key:"onBufferFlushed",value:function(e,t){var r=t.type;if(r!==Mr){this.flushing=!1,this.bufferFlushed=!0,this.state===vo&&(this.state=lo);var n=this.mediaBuffer||this.media;n&&(this.afterBufferFlushed(n,r,ar),this.tick())}}},{key:"_handleTransmuxComplete",value:function(e){var t,r="audio",n=this.hls,i=e.remuxResult,a=e.chunkMeta,o=this.getCurrentContext(a);if(o){var s=o.frag,l=o.part,u=o.level,c=u.details,f=i.audio,d=i.text,h=i.id3,p=i.initSegment;if(!this.fragContextChanged(s)&&c){if(this.state=po,this.switchingTrack&&f&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){var g=s.initSegment||s;if(this.unhandledEncryptionError(p,s))return;this._bufferInitSegment(u,p.tracks,g,a),n.trigger($t.FRAG_PARSING_INIT_SEGMENT,{frag:g,id:r,tracks:p.tracks})}if(f){var v=f.startPTS,y=f.endPTS,m=f.startDTS,A=f.endDTS;l&&(l.elementaryStreams[zr]={startPTS:v,endPTS:y,startDTS:m,endDTS:A}),s.setElementaryStreamInfo(zr,v,y,m,A),this.bufferFragmentData(f,s,l,a)}if(null!=h&&null!=(t=h.samples)&&t.length){var b=cr({id:r,frag:s,details:c},h);n.trigger($t.FRAG_PARSING_METADATA,b)}if(d){var E=cr({id:r,frag:s,details:c},d);n.trigger($t.FRAG_PARSING_USERDATA,E)}}else this.fragmentTracker.removeFragment(s)}else this.resetWhenMissingContext(a)}},{key:"_bufferInitSegment",value:function(e,t,r,n){if(this.state===po&&(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,t.audio)){var i=t.audio;i.id=ar;var a=e.audioCodec;this.log("Init audio buffer, container:".concat(i.container,", codecs[level/parsed]=[").concat(a,"/").concat(i.codec,"]")),a&&1===a.split(",").length&&(i.levelCodec=a),this.hls.trigger($t.BUFFER_CODECS,t);var o=i.initSegment;if(null!=o&&o.byteLength){var s={type:"audio",frag:r,part:null,chunkMeta:n,parent:r.type,data:o};this.hls.trigger($t.BUFFER_APPENDING,s)}this.tickImmediate()}}},{key:"loadFragment",value:function(e,t,n){var i,a=this.fragmentTracker.getState(e);if(this.switchingTrack||a===Ei||a===Ti)if(Fr(e))if(null!=(i=t.details)&&i.live&&!this.initPTS[e.cc]){this.log("Waiting for video PTS in continuity counter ".concat(e.cc," of live stream before loading audio fragment ").concat(e.sn," of level ").concat(this.trackId)),this.state=mo;var l=this.mainDetails;l&&l.fragmentStart!==t.details.fragmentStart&&no(t.details,l)}else o(s(r.prototype),"loadFragment",this).call(this,e,t,n);else this._loadInitSegment(e,t);else this.clearTrackerIfNeeded(e)}},{key:"flushAudioIfNeeded",value:function(e){if(this.media&&this.bufferedTrack){var t=this.bufferedTrack;qn({name:t.name,lang:t.lang,assocLang:t.assocLang,characteristics:t.characteristics,audioCodec:t.audioCodec,channels:t.channels},e,Xn)||(Zn(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),o(s(r.prototype),"flushMainBuffer",this).call(this,0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}},{key:"completeAudioSwitch",value:function(e){var t=this.hls;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger($t.AUDIO_TRACK_SWITCHED,dr({},e))}}]),r}(bo),audioTrackController:function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,e,"audio-track-controller")).tracks=[],n.groupIds=null,n.tracksInGroup=[],n.trackId=-1,n.currentTrack=null,n.selectDefaultTrack=!0,n.registerListeners(),n}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.LEVEL_LOADING,this.onLevelLoading,this),e.on($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on($t.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.LEVEL_LOADING,this.onLevelLoading,this),e.off($t.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off($t.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off($t.ERROR,this.onError,this)}},{key:"destroy",value:function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,o(s(r.prototype),"destroy",this).call(this)}},{key:"onManifestLoading",value:function(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}},{key:"onManifestParsed",value:function(e,t){this.tracks=t.audioTracks||[]}},{key:"onAudioTrackLoaded",value:function(e,t){var r=t.id,n=t.groupId,i=t.details,a=this.tracksInGroup[r];if(a&&a.groupId===n){var o=a.details;a.details=t.details,this.log("Audio track ".concat(r,' "').concat(a.name,'" lang:').concat(a.lang," group:").concat(n," loaded [").concat(i.startSN,"-").concat(i.endSN,"]")),r===this.trackId&&this.playlistLoaded(r,t,o)}else this.warn("Audio track with id:".concat(r," and group:").concat(n," not found in active group ").concat(null==a?void 0:a.groupId))}},{key:"onLevelLoading",value:function(e,t){this.switchLevel(t.level)}},{key:"onLevelSwitching",value:function(e,t){this.switchLevel(t.level)}},{key:"switchLevel",value:function(e){var t=this.hls.levels[e];if(t){var r=t.audioGroups||null,n=this.groupIds,i=this.currentTrack;if(!r||(null==n?void 0:n.length)!==(null==r?void 0:r.length)||null!=r&&r.some((function(e){return-1===(null==n?void 0:n.indexOf(e))}))){this.groupIds=r,this.trackId=-1,this.currentTrack=null;var a=this.tracks.filter((function(e){return!r||-1!==r.indexOf(e.groupId)}));if(a.length)this.selectDefaultTrack&&!a.some((function(e){return e.default}))&&(this.selectDefaultTrack=!1),a.forEach((function(e,t){e.id=t}));else if(!i&&!this.tracksInGroup.length)return;this.tracksInGroup=a;var o=this.hls.config.audioPreference;if(!i&&o){var s=Wn(o,a,Xn);if(s>-1)i=a[s];else{var l=Wn(o,this.tracks);i=this.tracks[l]}}var u=this.findTrackId(i);-1===u&&i&&(u=this.findTrackId(null));var c={audioTracks:a};this.log("Updating audio tracks, ".concat(a.length," track(s) found in group(s): ").concat(null==r?void 0:r.join(","))),this.hls.trigger($t.AUDIO_TRACKS_UPDATED,c);var f=this.trackId;if(-1!==u&&-1===f)this.setAudioTrack(u);else if(a.length&&-1===f){var d,h=new Error("No audio track selected for current audio group-ID(s): ".concat(null==(d=this.groupIds)?void 0:d.join(",")," track count: ").concat(a.length));this.warn(h.message),this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:h})}}}}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&(t.context.type!==rr||t.context.id!==this.trackId||this.groupIds&&-1===this.groupIds.indexOf(t.context.groupId)||this.checkRetry(t))}},{key:"setAudioOption",value:function(e){var t=this.hls;if(t.config.audioPreference=e,e){var r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){var n=this.currentTrack;if(n&&qn(e,n,Xn))return n;var i=Wn(e,this.tracksInGroup,Xn);if(i>-1){var a=this.tracksInGroup[i];return this.setAudioTrack(i),a}if(n){var o=t.loadLevel;-1===o&&(o=t.firstAutoLevel);var s=function(e,t,r,n,i){var a=t[n],o=t.reduce((function(e,t,r){var n=t.uri;return(e[n]||(e[n]=[])).push(r),e}),{})[a.uri];o.length>1&&(n=Math.max.apply(Math,o));var s=a.videoRange,l=a.frameRate,u=a.codecSet.substring(0,4),c=Jn(t,n,(function(t){if(t.videoRange!==s||t.frameRate!==l||t.codecSet.substring(0,4)!==u)return!1;var n=t.audioGroups,a=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return Wn(e,a,i)>-1}));return c>-1?c:Jn(t,n,(function(t){var n=t.audioGroups,a=r.filter((function(e){return!n||-1!==n.indexOf(e.groupId)}));return Wn(e,a,i)>-1}))}(e,t.levels,r,o,Xn);if(-1===s)return null;t.nextLoadLevel=s}if(e.channels||e.audioCodec){var l=Wn(e,r);if(l>-1)return r[l]}}}return null}},{key:"setAudioTrack",value:function(e){var t=this.tracksInGroup;if(e<0||e>=t.length)this.warn("Invalid audio track id: ".concat(e));else{this.selectDefaultTrack=!1;var r=this.currentTrack,n=t[e],i=n.details&&!n.details.live;if((e!==this.trackId||n!==r||!i)&&(this.log("Switching to audio-track ".concat(e,' "').concat(n.name,'" lang:').concat(n.lang," group:").concat(n.groupId," channels:").concat(n.channels)),this.trackId=e,this.currentTrack=n,this.hls.trigger($t.AUDIO_TRACK_SWITCHING,dr({},n)),!i)){var a=this.switchParams(n.url,null==r?void 0:r.details,n.details);this.loadPlaylist(a)}}}},{key:"findTrackId",value:function(e){for(var t=this.tracksInGroup,r=0;r<t.length;r++){var n=t[r];if((!this.selectDefaultTrack||n.default)&&(!e||qn(e,n,Xn)))return r}if(e){for(var i=e.name,a=e.lang,o=e.assocLang,s=e.characteristics,l=e.audioCodec,u=e.channels,c=0;c<t.length;c++)if(qn({name:i,lang:a,assocLang:o,characteristics:s,audioCodec:l,channels:u},t[c],Xn))return c;for(var f=0;f<t.length;f++){var d=t[f];if($s(e.attrs,d.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return f}for(var h=0;h<t.length;h++){var p=t[h];if($s(e.attrs,p.attrs,["LANGUAGE"]))return h}}return-1}},{key:"loadPlaylist",value:function(e){o(s(r.prototype),"loadPlaylist",this).call(this);var t=this.currentTrack;this.shouldLoadPlaylist(t)&&Zn(t.url,this.hls)&&this.scheduleLoading(t,e)}},{key:"loadingPlaylist",value:function(e,t){o(s(r.prototype),"loadingPlaylist",this).call(this,e,t);var n=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),l=e.details,u=null==l?void 0:l.age;this.log("Loading audio-track ".concat(n,' "').concat(e.name,'" lang:').concat(e.lang," group:").concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""," ").concat(a)),this.hls.trigger($t.AUDIO_TRACK_LOADING,{url:a,id:n,groupId:i,deliveryDirectives:t||null,track:e})}},{key:"allAudioTracks",get:function(){return this.tracks}},{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}}]),r}(Js),emeController:$l,cmcdController:function(){function e(t){var r=this;h(this,e),this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){r.initialized&&(r.starved=!0),r.buffering=!0},this.onPlaying=function(){r.initialized||(r.initialized=!0),r.buffering=!1},this.applyPlaylistData=function(e){try{r.apply(e,{ot:ll,su:!r.initialized})}catch(e){r.hls.logger.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=function(e){try{var t=e.frag,n=e.part,i=r.hls.levels[t.level],a=r.getObjectType(t),o={d:1e3*(n||t).duration,ot:a};a!==cl&&a!==ul&&a!=fl||(o.br=i.bitrate/1e3,o.tb=r.getTopBandwidth(a)/1e3,o.bl=r.getBufferLength(a));var s=n?r.getNextPart(n):r.getNextFrag(t);null!=s&&s.url&&s.url!==t.url&&(o.nor=s.url),r.apply(e,o)}catch(e){r.hls.logger.warn("Could not generate segment CMCD data.",e)}},this.hls=t;var n=this.config=t.config,i=n.cmcd;null!=i&&(n.pLoader=this.createPlaylistLoader(),n.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||t.sessionId,this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.includeKeys=i.includeKeys,this.registerListeners())}return p(e,[{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHED,this.onMediaDetached,this),e.on($t.BUFFER_CREATED,this.onBufferCreated,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHED,this.onMediaDetached,this),e.off($t.BUFFER_CREATED,this.onBufferCreated,this)}},{key:"destroy",value:function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}},{key:"onMediaDetached",value:function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}},{key:"onBufferCreated",value:function(e,t){var r,n;this.audioBuffer=null==(r=t.tracks.audio)?void 0:r.buffer,this.videoBuffer=null==(n=t.tracks.video)?void 0:n.buffer}},{key:"createData",value:function(){var e;return{v:1,sf:pl,sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}},{key:"apply",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};cr(t,this.createData());var r=t.ot===dl||t.ot===cl||t.ot===fl;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering);var n=this.includeKeys;n&&(t=Object.keys(t).reduce((function(e,r){return n.includes(r)&&(e[r]=t[r]),e}),{}));var i={baseUrl:e.url};this.useHeaders?(e.headers||(e.headers={}),Ql(e.headers,t,i)):e.url=Xl(e.url,t,i)}},{key:"getNextFrag",value:function(e){var t,r=null==(t=this.hls.levels[e.level])?void 0:t.details;if(r){var n=e.sn-r.startSN;return r.fragments[n+1]}}},{key:"getNextPart",value:function(e){var t,r=e.index,n=e.fragment,i=null==(t=this.hls.levels[n.level])||null==(t=t.details)?void 0:t.partList;if(i)for(var a=n.sn,o=i.length-1;o>=0;o--){var s=i[o];if(s.index===r&&s.fragment.sn===a)return i[o+1]}}},{key:"getObjectType",value:function(e){var t=e.type;return"subtitle"===t?hl:"initSegment"===e.sn?dl:"audio"===t?ul:"main"===t?this.hls.audioTracks.length?cl:fl:void 0}},{key:"getTopBandwidth",value:function(e){var t,r=0,n=this.hls;if(e===ul)t=n.audioTracks;else{var i=n.maxAutoLevel,a=i>-1?i+1:n.levels.length;t=n.levels.slice(0,a)}return t.forEach((function(e){e.bitrate>r&&(r=e.bitrate)})),r>0?r:NaN}},{key:"getBufferLength",value:function(e){var t=this.media,r=e===ul?this.audioBuffer:this.videoBuffer;return r&&t?1e3*Yi.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN}},{key:"createPlaylistLoader",value:function(){var e=this.config.pLoader,t=this.applyPlaylistData,r=e||this.config.loader;return function(){function e(t){h(this,e),this.loader=void 0,this.loader=new r(t)}return p(e,[{key:"destroy",value:function(){this.loader.destroy()}},{key:"abort",value:function(){this.loader.abort()}},{key:"load",value:function(e,r,n){t(e),this.loader.load(e,r,n)}},{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()}},{key:"createFragmentLoader",value:function(){var e=this.config.fLoader,t=this.applyFragmentData,r=e||this.config.loader;return function(){function e(t){h(this,e),this.loader=void 0,this.loader=new r(t)}return p(e,[{key:"destroy",value:function(){this.loader.destroy()}},{key:"abort",value:function(){this.loader.abort()}},{key:"load",value:function(e,r,n){t(e),this.loader.load(e,r,n)}},{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),e}()}}]),e}(),contentSteeringController:function(e){c(r,e);var t=f(r);function r(e){var n;return h(this,r),(n=t.call(this,"content-steering",e.logger)).hls=void 0,n.loader=null,n.uri=null,n.pathwayId=".",n._pathwayPriority=null,n.timeToLoad=300,n.reloadTimer=-1,n.updated=0,n.started=!1,n.enabled=!0,n.levels=null,n.audioTracks=null,n.subtitleTracks=null,n.penalizedPathways={},n.hls=e,n.registerListeners(),n}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.ERROR,this.onError,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.ERROR,this.onError,this))}},{key:"pathways",value:function(){return(this.levels||[]).reduce((function(e,t){return-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e}),[])}},{key:"startLoad",value:function(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){var e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0)return void this.scheduleRefresh(this.uri,e)}this.loadSteeringManifest(this.uri)}}},{key:"stopLoad",value:function(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}},{key:"clearTimeout",value:function(){-1!==this.reloadTimer&&(self.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}},{key:"destroy",value:function(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}},{key:"removeLevel",value:function(e){var t=this.levels;t&&(this.levels=t.filter((function(t){return t!==e})))}},{key:"onManifestLoading",value:function(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}},{key:"onManifestLoaded",value:function(e,t){var r=t.contentSteering;null!==r&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}},{key:"onManifestParsed",value:function(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}},{key:"onError",value:function(e,t){var r=t.errorAction;if((null==r?void 0:r.action)===hi&&r.flags===yi){var n=this.levels,i=this._pathwayPriority,a=this.pathwayId;if(t.context){var o=t.context,s=o.groupId,l=o.pathwayId,u=o.type;s&&n?a=this.getPathwayForGroupId(s,u,a):l&&(a=l)}a in this.penalizedPathways||(this.penalizedPathways[a]=performance.now()),!i&&n&&(i=this.pathways()),i&&i.length>1&&(this.updatePathwayPriority(i),r.resolved=this.pathwayId!==a),t.details!==Zt.BUFFER_APPEND_ERROR||t.fatal?r.resolved||this.warn("Could not resolve ".concat(t.details,' ("').concat(t.error.message,'") with content-steering for Pathway: ').concat(a," levels: ").concat(n?n.length:n," priorities: ").concat(Vn(i)," penalized: ").concat(Vn(this.penalizedPathways))):r.resolved=!0}}},{key:"filterParsedLevels",value:function(e){this.levels=e;var t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){var r=e[0].pathwayId;this.log("No levels found in Pathway ".concat(this.pathwayId,'. Setting initial Pathway to "').concat(r,'"')),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log("Found ".concat(t.length,"/").concat(e.length,' levels in Pathway "').concat(this.pathwayId,'"')),t}},{key:"getLevelsForPathway",value:function(e){return null===this.levels?[]:this.levels.filter((function(t){return e===t.pathwayId}))}},{key:"updatePathwayPriority",value:function(e){var t;this._pathwayPriority=e;var r=this.penalizedPathways,n=performance.now();Object.keys(r).forEach((function(e){n-r[e]>3e5&&delete r[e]}));for(var i=0;i<e.length;i++){var a=e[i];if(!(a in r)){if(a===this.pathwayId)return;var o=this.hls.nextLoadLevel,s=this.hls.levels[o];if((t=this.getLevelsForPathway(a)).length>0){this.log('Setting Pathway to "'.concat(a,'"')),this.pathwayId=a,Xa(t),this.hls.trigger($t.LEVELS_UPDATED,{levels:t});var l=this.hls.levels[o];s&&l&&this.levels&&(l.attrs["STABLE-VARIANT-ID"]!==s.attrs["STABLE-VARIANT-ID"]&&l.bitrate!==s.bitrate&&this.log("Unstable Pathways change from bitrate ".concat(s.bitrate," to ").concat(l.bitrate)),this.hls.nextLoadLevel=o);break}}}}},{key:"getPathwayForGroupId",value:function(e,t,r){for(var n=this.getLevelsForPathway(r).concat(this.levels||[]),i=0;i<n.length;i++)if(t===rr&&n[i].hasAudioGroup(e)||t===nr&&n[i].hasSubtitleGroup(e))return n[i].pathwayId;return r}},{key:"clonePathways",value:function(e){var t=this,r=this.levels;if(r){var n={},a={};e.forEach((function(e){var o=e.ID,s=e["BASE-ID"],l=e["URI-REPLACEMENT"];if(!r.some((function(e){return e.pathwayId===o}))){var u=t.getLevelsForPathway(s).map((function(e){var t=new Ji(e.attrs);t["PATHWAY-ID"]=o;var r=t.AUDIO&&"".concat(t.AUDIO,"_clone_").concat(o),i=t.SUBTITLES&&"".concat(t.SUBTITLES,"_clone_").concat(o);r&&(n[t.AUDIO]=r,t.AUDIO=r),i&&(a[t.SUBTITLES]=i,t.SUBTITLES=i);var s=Zl(e.uri,t["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",l),u=new Gn({attrs:t,audioCodec:e.audioCodec,bitrate:e.bitrate,height:e.height,name:e.name,url:s,videoCodec:e.videoCodec,width:e.width});if(e.audioGroups)for(var c=1;c<e.audioGroups.length;c++)u.addGroupId("audio","".concat(e.audioGroups[c],"_clone_").concat(o));if(e.subtitleGroups)for(var f=1;f<e.subtitleGroups.length;f++)u.addGroupId("text","".concat(e.subtitleGroups[f],"_clone_").concat(o));return u}));r.push.apply(r,i(u)),Jl(t.audioTracks,n,l,o),Jl(t.subtitleTracks,a,l,o)}}))}}},{key:"loadSteeringManifest",value:function(e){var t,r=this,n=this.hls.config,i=n.loader;this.loader&&this.loader.destroy(),this.loader=new i(n);try{t=new self.URL(e)}catch(n){return this.enabled=!1,void this.log("Failed to parse Steering Manifest URI: ".concat(e))}if("data:"!==t.protocol){var a=0|(this.hls.bandwidthEstimate||n.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+a)}var o={responseType:"json",url:t.href},s=n.steeringManifestLoadPolicy.default,l=s.errorRetry||s.timeoutRetry||{},u={loadPolicy:s,timeout:s.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0},c={onSuccess:function(e,n,i,a){r.log('Loaded steering manifest: "'.concat(t,'"'));var o=e.data;if(1===(null==o?void 0:o.VERSION)){r.updated=performance.now(),r.timeToLoad=o.TTL;var s=o["RELOAD-URI"],l=o["PATHWAY-CLONES"],u=o["PATHWAY-PRIORITY"];if(s)try{r.uri=new self.URL(s,t).href}catch(e){return r.enabled=!1,void r.log("Failed to parse Steering Manifest RELOAD-URI: ".concat(s))}r.scheduleRefresh(r.uri||i.url),l&&r.clonePathways(l);var c={steeringManifest:o,url:t.toString()};r.hls.trigger($t.STEERING_MANIFEST_LOADED,c),u&&r.updatePathwayPriority(u)}else r.log("Steering VERSION ".concat(o.VERSION," not supported!"))},onError:function(e,t,n,i){if(r.log("Error loading steering manifest: ".concat(e.code," ").concat(e.text," (").concat(t.url,")")),r.stopLoad(),410===e.code)return r.enabled=!1,void r.log("Steering manifest ".concat(t.url," no longer available"));var a=1e3*r.timeToLoad;if(429!==e.code)r.scheduleRefresh(r.uri||t.url,a);else{var o=r.loader;if("function"==typeof(null==o?void 0:o.getResponseHeader)){var s=o.getResponseHeader("Retry-After");s&&(a=1e3*parseFloat(s))}r.log("Steering manifest ".concat(t.url," rate limited"))}},onTimeout:function(e,t,n){r.log("Timeout loading steering manifest (".concat(t.url,")")),r.scheduleRefresh(r.uri||t.url)}};this.log("Requesting steering manifest: ".concat(t)),this.loader.load(o,u,c)}},{key:"scheduleRefresh",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3*this.timeToLoad;this.clearTimeout(),this.reloadTimer=self.setTimeout((function(){var r,n=null==(r=t.hls)?void 0:r.media;!n||n.ended?t.scheduleRefresh(e,1e3*t.timeToLoad):t.loadSteeringManifest(e)}),r)}},{key:"pathwayPriority",get:function(){return this._pathwayPriority},set:function(e){this.updatePathwayPriority(e)}}]),r}(hr),interstitialsController:function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,"interstitials",e.logger)).HlsPlayerClass=void 0,i.hls=void 0,i.assetListLoader=void 0,i.mediaSelection=null,i.altSelection=null,i.media=null,i.detachedData=null,i.requiredTracks=null,i.manager=null,i.playerQueue=[],i.bufferedPos=-1,i.timelinePos=-1,i.schedule=void 0,i.playingItem=null,i.bufferingItem=null,i.waitingItem=null,i.endedItem=null,i.playingAsset=null,i.endedAsset=null,i.bufferingAsset=null,i.shouldPlay=!1,i.onPlay=function(){i.shouldPlay=!0},i.onPause=function(){i.shouldPlay=!1},i.onSeeking=function(){var e=i.currentTime;if(void 0!==e&&!i.playbackDisabled&&i.schedule){var t=e-i.timelinePos;if(!(Math.abs(t)<1/7056e5)){var r=t<=-.01;i.timelinePos=e,i.bufferedPos=e;var n=i.playingItem;if(n)if(r&&i.schedule.resetErrorsInRange(e,e-t)&&i.updateSchedule(!0),i.checkBuffer(),r&&e<n.start||e>=n.end){var a,o=i.findItemIndex(n),s=i.schedule.findItemIndexAtTime(e);if(-1===s&&(s=o+(r?-1:1),i.log("seeked ".concat(r?"back ":"","to position not covered by schedule ").concat(e," (resolving from ").concat(o," to ").concat(s,")"))),!i.isInterstitial(n)&&null!=(a=i.media)&&a.paused&&(i.shouldPlay=!1),!r&&s>o){var l=i.schedule.findJumpRestrictedIndex(o+1,s);if(l>o)return void i.setSchedulePosition(l)}i.setSchedulePosition(s)}else{var u=i.playingAsset;if(u){var c,f=u.timelineStart,d=u.duration||0;(r&&e<f||e>=f+d)&&(null!=(c=n.event)&&c.appendInPlace&&(i.clearInterstitial(n.event,n),i.flushFrontBuffer(e)),i.setScheduleToAssetAtTime(e,u))}else if(i.playingLastItem&&i.isInterstitial(n)){var h=n.event.assetList[0];h&&(i.endedItem=i.playingItem,i.playingItem=null,i.setScheduleToAssetAtTime(e,h))}}else i.checkBuffer()}}},i.onTimeupdate=function(){var e=i.currentTime;if(void 0!==e&&!i.playbackDisabled&&e>i.timelinePos){i.timelinePos=e,e>i.bufferedPos&&i.checkBuffer();var t=i.playingItem;if(t&&!i.playingLastItem){if(e>=t.end){i.timelinePos=t.end;var r=i.findItemIndex(t);i.setSchedulePosition(r+1)}var n=i.playingAsset;n&&e>=n.timelineStart+(n.duration||0)&&i.setScheduleToAssetAtTime(e,n)}}},i.onScheduleUpdate=function(e,t){var r=i.schedule;if(r){var n=i.playingItem,a=r.events||[],o=r.items||[],s=r.durations,l=e.map((function(e){return e.identifier})),u=!(!a.length&&!l.length);(u||t)&&i.log("INTERSTITIALS_UPDATED (".concat(a.length,"): ").concat(a,"\nSchedule: ").concat(o.map((function(e){return bu(e)}))," pos: ").concat(i.timelinePos)),l.length&&i.log("Removed events ".concat(l));var c=null,f=null;n&&(c=i.updateItem(n,i.timelinePos),i.itemsMatch(n,c)?i.playingItem=c:i.waitingItem=i.endedItem=null),i.waitingItem=i.updateItem(i.waitingItem),i.endedItem=i.updateItem(i.endedItem);var d=i.bufferingItem;if(d&&(f=i.updateItem(d,i.bufferedPos),i.itemsMatch(d,f)?i.bufferingItem=f:d.event&&(i.bufferingItem=i.playingItem,i.clearInterstitial(d.event,null))),e.forEach((function(e){e.assetList.forEach((function(e){i.clearAssetPlayer(e.identifier,null)}))})),i.playerQueue.forEach((function(e){if(e.interstitial.appendInPlace){var t=e.assetItem.timelineStart,r=e.timelineOffset-t;if(r)try{e.timelineOffset=t}catch(n){Math.abs(r)>cu&&i.warn("".concat(n,' ("').concat(e.assetId,'" ').concat(e.timelineOffset,"->").concat(t,")"))}}})),u||t){if(i.hls.trigger($t.INTERSTITIALS_UPDATED,{events:a.slice(0),schedule:o.slice(0),durations:s,removedIds:l}),i.isInterstitial(n)&&l.includes(n.event.identifier))return i.warn('Interstitial "'.concat(n.event.identifier,'" removed while playing')),void i.primaryFallback(n.event);n&&i.trimInPlace(c,n),d&&f!==c&&i.trimInPlace(f,d),i.checkBuffer()}}},i.hls=e,i.HlsPlayerClass=n,i.assetListLoader=new Eu(e),i.schedule=new Au(i.onScheduleUpdate,e.logger),i.registerListeners(),i}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e&&(e.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($t.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on($t.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on($t.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on($t.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on($t.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on($t.BUFFER_APPENDED,this.onBufferAppended,this),e.on($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($t.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on($t.MEDIA_ENDED,this.onMediaEnded,this),e.on($t.ERROR,this.onError,this),e.on($t.DESTROYING,this.onDestroying,this))}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($t.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off($t.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off($t.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off($t.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off($t.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off($t.BUFFER_CODECS,this.onBufferCodecs,this),e.off($t.BUFFER_APPENDED,this.onBufferAppended,this),e.off($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($t.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off($t.MEDIA_ENDED,this.onMediaEnded,this),e.off($t.ERROR,this.onError,this),e.off($t.DESTROYING,this.onDestroying,this))}},{key:"startLoad",value:function(){this.resumeBuffering()}},{key:"stopLoad",value:function(){this.pauseBuffering()}},{key:"resumeBuffering",value:function(){var e;null==(e=this.getBufferingPlayer())||e.resumeBuffering()}},{key:"pauseBuffering",value:function(){var e;null==(e=this.getBufferingPlayer())||e.pauseBuffering()}},{key:"destroy",value:function(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}},{key:"onDestroying",value:function(){var e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}},{key:"removeMediaListeners",value:function(e){ao(e,"play",this.onPlay),ao(e,"pause",this.onPause),ao(e,"seeking",this.onSeeking),ao(e,"timeupdate",this.onTimeupdate)}},{key:"onMediaAttaching",value:function(e,t){var r=this.media=t.media;io(r,"seeking",this.onSeeking),io(r,"timeupdate",this.onTimeupdate),io(r,"play",this.onPlay),io(r,"pause",this.onPause)}},{key:"onMediaAttached",value:function(e,t){var r=this.effectivePlayingItem,n=this.detachedData;if(this.detachedData=null,null===r)this.checkStart();else if(!n){this.clearScheduleState();var i=this.findItemIndex(r);this.setSchedulePosition(i)}}},{key:"clearScheduleState",value:function(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}},{key:"onMediaDetaching",value:function(e,t){var r=!!t.transferMedia,n=this.media;if(this.media=null,!r&&(n&&this.removeMediaListeners(n),this.detachedData)){var i=this.getBufferingPlayer();i&&(this.log("Removing schedule state for detachedData and ".concat(i)),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,i.detachMedia()),this.shouldPlay=!1}}},{key:"isInterstitial",value:function(e){return!(null==e||!e.event)}},{key:"retreiveMediaSource",value:function(e,t){var r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}},{key:"transferMediaFromPlayer",value:function(e,t){var r=e.interstitial.appendInPlace,n=e.media;if(r&&n===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&n)return void(this.detachedData={media:n});var i=e.transferMedia();this.log("transfer MediaSource from ".concat(e," ").concat(Vn(i))),this.detachedData=i}else t&&n&&(this.shouldPlay||(this.shouldPlay=!n.paused))}},{key:"transferMediaTo",value:function(e,t){var r,n,i=this;if(e.media!==t){var a,o=null,s=this.hls,l=e!==s,u=l&&e.interstitial.appendInPlace,c=null==(r=this.detachedData)?void 0:r.mediaSource;if(s.media)u&&(o=s.transferMedia(),this.detachedData=o),a="Primary";else if(c){var f=this.getBufferingPlayer();f?(o=f.transferMedia(),a="".concat(f)):a="detached MediaSource"}else a="detached media";if(!o)if(c)o=this.detachedData,this.log("using detachedData: MediaSource ".concat(Vn(o)));else if(!this.detachedData||s.media===t){var d=this.playerQueue;d.length>1&&d.forEach((function(e){if(l&&e.interstitial.appendInPlace!==u){var t=e.interstitial;i.clearInterstitial(e.interstitial,null),t.appendInPlace=!1,t.appendInPlace&&i.warn("Could not change append strategy for queued assets ".concat(t))}})),this.hls.detachMedia(),this.detachedData={media:t}}var h=o&&"mediaSource"in o&&"closed"!==(null==(n=o.mediaSource)?void 0:n.readyState),p=h&&o?o:t;this.log("".concat(h?"transfering MediaSource":"attaching media"," to ").concat(l?e:"Primary"," from ").concat(a," (media.currentTime: ").concat(t.currentTime,")"));var g=this.schedule;if(p===o&&g){var v=l&&e.assetId===g.assetIdAtEnd;p.overrides={duration:g.duration,endOfStream:!l||v,cueRemoval:!l}}e.attachMedia(p)}}},{key:"onInterstitialCueEnter",value:function(){this.onTimeupdate()}},{key:"checkStart",value:function(){var e=this.schedule,t=null==e?void 0:e.events;if(t&&!this.playbackDisabled&&this.media){-1===this.bufferedPos&&(this.bufferedPos=0);var r=this.timelinePos,n=this.effectivePlayingItem;if(-1===r){var i=this.hls.startPosition;if(this.log(Tu("checkStart",i)),this.timelinePos=i,t.length&&t[0].cue.pre){var a=e.findEventIndex(t[0].identifier);this.setSchedulePosition(a)}else if(i>=0||!this.primaryLive){var o=this.timelinePos=i>0?i:0,s=e.findItemIndexAtTime(o);this.setSchedulePosition(s)}}else if(n&&!this.playingItem){var l=e.findItemIndex(n);this.setSchedulePosition(l)}}}},{key:"advanceAssetBuffering",value:function(e,t){var r=e.event,n=r.findAssetIndex(t),i=vu(r,n);if(r.isAssetPastPlayoutLimit(i)){if(this.schedule){var a,o=null==(a=this.schedule.items)?void 0:a[this.findItemIndex(e)+1];o&&this.bufferedToItem(o)}}else this.bufferedToEvent(e,i)}},{key:"advanceAfterAssetEnded",value:function(e,t,r){var n=vu(e,r);if(e.isAssetPastPlayoutLimit(n)){if(this.schedule){var i=this.schedule.items;if(i){var a=t+1;if(a>=i.length)return void this.setSchedulePosition(-1);var o=e.resumeTime;this.timelinePos<o&&(this.log(Tu("advanceAfterAssetEnded",o)),this.timelinePos=o,e.appendInPlace&&this.advanceInPlace(o),this.checkBuffer(this.bufferedPos<o)),this.setSchedulePosition(a)}}}else{if(e.appendInPlace){var s=e.assetList[n];s&&this.advanceInPlace(s.timelineStart)}this.setSchedulePosition(t,n)}}},{key:"setScheduleToAssetAtTime",value:function(e,t){var r=this.schedule;if(r){var n=t.parentIdentifier,i=r.getEvent(n);if(i){var a=r.findEventIndex(n),o=r.findAssetIndex(i,e);this.advanceAfterAssetEnded(i,a,o-1)}}}},{key:"setSchedulePosition",value:function(e,t){var r,n=null==(r=this.schedule)?void 0:r.items;if(n&&!this.playbackDisabled){var i=e>=0?n[e]:null;this.log("setSchedulePosition ".concat(e,", ").concat(t," (").concat(i?bu(i):i,") pos: ").concat(this.timelinePos));var a=this.waitingItem||this.playingItem,o=this.playingLastItem;if(this.isInterstitial(a)){var s=a.event,l=this.playingAsset,u=null==l?void 0:l.identifier,c=u?this.getAssetPlayer(u):null;if(c&&u&&(!this.eventItemsMatch(a,i)||void 0!==t&&u!==s.assetList[t].identifier)){var f,d=s.findAssetIndex(l);if(this.log("INTERSTITIAL_ASSET_ENDED ".concat(d+1,"/").concat(s.assetList.length," ").concat(yu(l))),this.endedAsset=l,this.playingAsset=null,this.hls.trigger($t.INTERSTITIAL_ASSET_ENDED,{asset:l,assetListIndex:d,event:s,schedule:n.slice(0),scheduleIndex:e,player:c}),a!==this.playingItem)return void(this.itemsMatch(a,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(s,this.findItemIndex(this.playingItem),d));this.retreiveMediaSource(u,i),!c.media||null!=(f=this.detachedData)&&f.mediaSource||c.detachMedia()}if(!this.eventItemsMatch(a,i)&&(this.endedItem=a,this.playingItem=null,this.log("INTERSTITIAL_ENDED ".concat(s," ").concat(bu(a))),s.hasPlayed=!0,this.hls.trigger($t.INTERSTITIAL_ENDED,{event:s,schedule:n.slice(0),scheduleIndex:e}),s.cue.once)){var h;this.updateSchedule();var p=null==(h=this.schedule)?void 0:h.items;if(i&&p){var g=this.findItemIndex(i);this.advanceSchedule(g,p,t,a,o)}return}}this.advanceSchedule(e,n,t,a,o)}}},{key:"advanceSchedule",value:function(e,t,r,n,i){var a=this,o=this.schedule;if(o){var s=t[e]||null,l=this.primaryMedia,u=this.playerQueue;if(u.length&&u.forEach((function(t){var r=t.interstitial,n=o.findEventIndex(r.identifier);(n<e||n>e+1)&&a.clearInterstitial(r,s)})),this.isInterstitial(s)){this.timelinePos=Math.min(Math.max(this.timelinePos,s.start),s.end);var c=s.event;if(void 0===r){var f=vu(c,(r=o.findAssetIndex(c,this.timelinePos))-1);if(c.isAssetPastPlayoutLimit(f)||c.appendInPlace&&this.timelinePos===s.end)return void this.advanceAfterAssetEnded(c,e,r);r=f}var d=this.waitingItem;this.assetsBuffered(s,l)||this.setBufferingItem(s);var h=this.preloadAssets(c,r);if(this.eventItemsMatch(s,d||n)||(this.waitingItem=s,this.log("INTERSTITIAL_STARTED ".concat(bu(s)," ").concat(c.appendInPlace?"append in place":"")),this.hls.trigger($t.INTERSTITIAL_STARTED,{event:c,schedule:t.slice(0),scheduleIndex:e})),!c.assetListLoaded)return void this.log("Waiting for ASSET-LIST to complete loading ".concat(c));if(c.assetListLoader&&(c.assetListLoader.destroy(),c.assetListLoader=void 0),!l)return void this.log("Waiting for attachMedia to start Interstitial ".concat(c));this.waitingItem=this.endedItem=null,this.playingItem=s;var p=c.assetList[r];if(!p)return void this.advanceAfterAssetEnded(c,e,r||0);if(h||(h=this.getAssetPlayer(p.identifier)),null===h||h.destroyed){var g=c.assetList.length;this.warn("asset ".concat(r+1,"/").concat(g," player destroyed ").concat(c)),(h=this.createAssetPlayer(c,p,r)).loadSource()}if(!this.eventItemsMatch(s,this.bufferingItem)&&c.appendInPlace&&this.isAssetBuffered(p))return;this.startAssetPlayer(h,r,t,e,l),this.shouldPlay&&ku(h.media)}else s?(this.resumePrimary(s,e,n),this.shouldPlay&&ku(this.hls.media)):i&&this.isInterstitial(n)&&(this.endedItem=null,this.playingItem=n,n.event.appendInPlace||this.attachPrimary(o.durations.primary,null))}}},{key:"resumePrimary",value:function(e,t,r){var n,i;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log("resuming ".concat(bu(e))),null==(n=this.detachedData)||!n.mediaSource){var a=this.timelinePos;(a<e.start||a>=e.end)&&(a=this.getPrimaryResumption(e,t),this.log(Tu("resumePrimary",a)),this.timelinePos=a),this.attachPrimary(a,e)}if(r){var o=null==(i=this.schedule)?void 0:i.items;o&&(this.log("INTERSTITIALS_PRIMARY_RESUMED ".concat(bu(e))),this.hls.trigger($t.INTERSTITIALS_PRIMARY_RESUMED,{schedule:o.slice(0),scheduleIndex:t}),this.checkBuffer())}}},{key:"getPrimaryResumption",value:function(e,t){var r=e.start;if(this.primaryLive){var n=this.primaryDetails;if(0===t)return this.hls.startPosition;if(n&&(r<n.fragmentStart||r>n.edge))return this.hls.liveSyncPosition||-1}return r}},{key:"isAssetBuffered",value:function(e){var t=this.getAssetPlayer(e.identifier);return null!=t&&t.hls?t.hls.bufferedToEnd:Yi.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}},{key:"attachPrimary",value:function(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;var n=this.primaryMedia;if(n){var i=this.hls;i.media?this.checkBuffer():(this.transferMediaTo(i,n),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Tu("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}}},{key:"startLoadingPrimaryAt",value:function(e,t){var r,n=this.hls;!n.loadingEnabled||!n.media||Math.abs(((null==(r=n.mainForwardBufferInfo)?void 0:r.start)||n.media.currentTime)-e)>.5?n.startLoad(e,t):n.bufferingEnabled||n.resumeBuffering()}},{key:"onManifestLoading",value:function(){var e;this.stopLoad(),null==(e=this.schedule)||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off($t.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on($t.BUFFER_CODECS,this.onBufferCodecs,this)}},{key:"onLevelUpdated",value:function(e,t){if(-1!==t.level&&this.schedule){var r=this.hls.levels[t.level];if(r.details){var n=dr(dr({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=n,this.schedule.parseInterstitialDateRanges(n,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}}}},{key:"onAudioTrackUpdated",value:function(e,t){var r=this.hls.audioTracks[t.id],n=this.mediaSelection;if(n){var i=dr(dr({},n),{},{audio:r});this.mediaSelection=i}else this.altSelection=dr(dr({},this.altSelection),{},{audio:r})}},{key:"onSubtitleTrackUpdated",value:function(e,t){var r=this.hls.subtitleTracks[t.id],n=this.mediaSelection;if(n){var i=dr(dr({},n),{},{subtitles:r});this.mediaSelection=i}else this.altSelection=dr(dr({},this.altSelection),{},{subtitles:r})}},{key:"onAudioTrackSwitching",value:function(e,t){var r=Qn(t);this.playerQueue.forEach((function(e){var n=e.hls;return n&&(n.setAudioOption(t)||n.setAudioOption(r))}))}},{key:"onSubtitleTrackSwitch",value:function(e,t){var r=Qn(t);this.playerQueue.forEach((function(e){var n=e.hls;return n&&(n.setSubtitleOption(t)||-1!==t.id&&n.setSubtitleOption(r))}))}},{key:"onBufferCodecs",value:function(e,t){var r=t.tracks;r&&(this.requiredTracks=r)}},{key:"onBufferAppended",value:function(e,t){this.checkBuffer()}},{key:"onBufferFlushed",value:function(e,t){var r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){var n=this.timelinePos;this.bufferedPos=n,this.checkBuffer()}}},{key:"onBufferedToEnd",value:function(e){if(this.schedule){var t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(var r=0;r<t.length;r++){var n=t[r];if(n.cue.post){var i,a=this.schedule.findEventIndex(n.identifier),o=null==(i=this.schedule.items)?void 0:i[a];this.isInterstitial(o)&&this.eventItemsMatch(o,this.bufferingItem)&&this.bufferedToItem(o,0);break}}this.bufferedPos=Number.MAX_VALUE}}}},{key:"onMediaEnded",value:function(e){var t=this.playingItem;if(!this.playingLastItem&&t){var r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}},{key:"updateItem",value:function(e,t){var r,n=null==(r=this.schedule)?void 0:r.items;return e&&n&&n[this.findItemIndex(e,t)]||null}},{key:"trimInPlace",value:function(e,t){var r=this;if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((function(t,n){e.event.isAssetPastPlayoutLimit(n)&&r.clearAssetPlayer(t.identifier,null)}));var n=e.end+.25,i=Yi.bufferInfo(this.primaryMedia,n,0);(i.end>n||(i.nextStart||0)>n)&&(this.log("trim buffered interstitial ".concat(bu(e)," (was ").concat(bu(t),")")),this.attachPrimary(n,null,!0),this.flushFrontBuffer(n))}}},{key:"itemsMatch",value:function(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}},{key:"eventItemsMatch",value:function(e,t){var r;return!!t&&(e===t||e.event.identifier===(null==(r=t.event)?void 0:r.identifier))}},{key:"findItemIndex",value:function(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}},{key:"updateSchedule",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],r=this.mediaSelection;r&&(null==(e=this.schedule)||e.updateSchedule(r,[],t))}},{key:"checkBuffer",value:function(e){var t,r=null==(t=this.schedule)?void 0:t.items;if(r){var n=Yi.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=n.len<1),this.updateBufferedPos(n.end,r,e)}}},{key:"updateBufferedPos",value:function(e,t,r){var n=this.schedule,i=this.bufferingItem;if(!(this.bufferedPos>e)&&n)if(1===t.length&&this.itemsMatch(t[0],i))this.bufferedPos=e;else{var a=this.playingItem,o=this.findItemIndex(a),s=n.findItemIndexAtTime(e);if(this.bufferedPos<e){var l,u=this.findItemIndex(i),c=Math.min(u+1,t.length-1),f=t[c];if((-1===s&&i&&e>=i.end||null!=(l=f.event)&&l.appendInPlace&&e+.01>=f.start)&&(s=c),this.isInterstitial(i)){var d=i.event;if(c-o>1&&!1===d.appendInPlace)return;if(0===d.assetList.length&&d.assetListLoader)return}if(this.bufferedPos=e,s>u&&s>o)this.bufferedToItem(f);else{var h=this.primaryDetails;this.primaryLive&&h&&e>h.edge-h.targetduration&&f.start<h.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(f)&&this.preloadAssets(f.event,0)}}else r&&a&&!this.itemsMatch(a,i)&&(s===o?this.bufferedToItem(a):s===o+1&&this.bufferedToItem(t[s]))}}},{key:"assetsBuffered",value:function(e,t){var r=this;return 0!==e.event.assetList.length&&!e.event.assetList.some((function(e){var n=r.getAssetPlayer(e.identifier);return!(null!=n&&n.bufferedInPlaceToEnd(t))}))}},{key:"setBufferingItem",value:function(e){var t=this,r=this.bufferingItem,n=this.schedule;if(!this.itemsMatch(e,r)&&n){var i=n.items,a=n.events;if(!i||!a)return r;var o=this.isInterstitial(e),s=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));var l=s?s.remaining:r?r.end-this.timelinePos:0;if(this.log("INTERSTITIALS_BUFFERED_TO_BOUNDARY ".concat(bu(e))+(r?" (".concat(l.toFixed(2)," remaining)"):"")),!this.playbackDisabled)if(o){var u=n.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((function(e,r){var n=t.getAssetPlayer(e.identifier);n&&(r===u&&n.loadSource(),n.resumeBuffering())}))}else this.hls.resumeBuffering(),this.playerQueue.forEach((function(e){return e.pauseBuffering()}));this.hls.trigger($t.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return r}},{key:"bufferedToItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.setBufferingItem(e);if(!this.playbackDisabled)if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(null!==r){this.bufferingAsset=null;var n=this.detachedData;if(n)if(n.mediaSource){var i=!0;this.attachPrimary(e.start,e,i)}else this.preloadPrimary(e);else this.preloadPrimary(e)}}},{key:"preloadPrimary",value:function(e){var t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}},{key:"bufferedToEvent",value:function(e,t){var r=e.event,n=0===r.assetList.length&&!r.assetListLoader,i=r.cue.once;if(n||!i){var a=this.preloadAssets(r,t);if(null!=a&&a.interstitial.appendInPlace){var o=this.primaryMedia;o&&this.bufferAssetPlayer(a,o)}}}},{key:"preloadAssets",value:function(e,t){var r=e.assetUrl,n=e.assetList.length,i=0===n&&!e.assetListLoader,a=e.cue.once;if(i){var o=e.timelineStart;if(e.appendInPlace){var s,l=this.playingItem;this.isInterstitial(l)||(null==l||null==(s=l.nextEvent)?void 0:s.identifier)!==e.identifier||this.flushFrontBuffer(o+.25)}var u,c=0;if(!this.playingItem&&this.primaryLive&&-1===(c=this.hls.startPosition)&&(c=this.hls.liveSyncPosition||0),c&&!e.cue.pre&&!e.cue.post){var f=c-o;f>0&&(u=Math.round(1e3*f)/1e3)}if(this.log("Load interstitial asset ".concat(t+1,"/").concat(r?1:n," ").concat(e).concat(u?" live-start: ".concat(c," start-offset: ").concat(u):"")),r)return this.createAsset(e,0,0,o,e.duration,r);var d=this.assetListLoader.loadAssetList(e,u);d&&(e.assetListLoader=d)}else if(!a&&n){for(var h=t;h<n;h++){var p=e.assetList[h],g=this.getAssetPlayerQueueIndex(p.identifier);-1!==g&&!this.playerQueue[g].destroyed||p.error||this.createAssetPlayer(e,p,h)}var v=e.assetList[t];if(v){var y=this.getAssetPlayer(v.identifier);return y&&y.loadSource(),y}}return null}},{key:"flushFrontBuffer",value:function(e){var t=this,r=this.requiredTracks;r&&(this.log("Removing front buffer starting at ".concat(e)),Object.keys(r).forEach((function(r){t.hls.trigger($t.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})})))}},{key:"getAssetPlayerQueueIndex",value:function(e){for(var t=this.playerQueue,r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}},{key:"getAssetPlayer",value:function(e){var t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}},{key:"getBufferingPlayer",value:function(){var e=this.playerQueue,t=this.primaryMedia;if(t)for(var r=0;r<e.length;r++)if(e[r].media===t)return e[r];return null}},{key:"createAsset",value:function(e,t,r,n,i,a){var o={parentIdentifier:e.identifier,identifier:du(e,a,t),duration:i,startOffset:r,timelineStart:n,uri:a};return this.createAssetPlayer(e,o,t)}},{key:"createAssetPlayer",value:function(e,t,r){var n=this,i=this.hls,a=i.userConfig,o=a.videoPreference,s=i.loadLevelObj||i.levels[i.currentLevel];(o||s)&&(o=cr({},o),s.videoCodec&&(o.videoCodec=s.videoCodec),s.videoRange&&(o.allowedVideoRanges=[s.videoRange]));var l=i.audioTracks[i.audioTrack],u=i.subtitleTracks[i.subtitleTrack],c=0;if(this.primaryLive||e.appendInPlace){var f=this.timelinePos-t.timelineStart;if(f>1){var d=t.duration;d&&f<d&&(c=f)}}var h=t.identifier,p=dr(dr({},a),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:h,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:c,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:o,audioPreference:l||a.audioPreference,subtitlePreference:u||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(p.timelineOffset=t.timelineStart));var g=p.cmcd;null!=g&&g.sessionId&&g.contentId&&(p.cmcd=cr({},g,{contentId:uu(t.uri)})),this.getAssetPlayer(h)&&this.warn("Duplicate date range identifier ".concat(e," and asset ").concat(h));var v=new mu(this.HlsPlayerClass,p,e,t);this.playerQueue.push(v),e.assetList[r]=t;var y=!0,m=function(i){if(i.live){var a,o=new Error("Interstitials MUST be VOD assets ".concat(e)),s={fatal:!0,type:Jt.OTHER_ERROR,details:Zt.INTERSTITIAL_ASSET_ITEM_ERROR,error:o},l=(null==(a=n.schedule)?void 0:a.findEventIndex(e.identifier))||-1;n.handleAssetItemError(s,e,l,r,o.message)}else{var u=i.edge-i.fragmentStart,c=t.duration;(y||null===c||u>c)&&(y=!1,n.log('Interstitial asset "'.concat(h,'" duration change ').concat(c," > ").concat(u)),t.duration=u,n.updateSchedule())}};v.on($t.LEVEL_UPDATED,(function(e,t){var r=t.details;return m(r)})),v.on($t.LEVEL_PTS_UPDATED,(function(e,t){var r=t.details;return m(r)})),v.on($t.EVENT_CUE_ENTER,(function(){return n.onInterstitialCueEnter()})),v.on($t.BUFFER_CODECS,(function e(t,r){var i=n.getAssetPlayer(h);if(i&&r.tracks){i.off($t.BUFFER_CODECS,e),i.tracks=r.tracks;var a=n.primaryMedia;n.bufferingAsset===i.assetItem&&a&&!i.media&&n.bufferAssetPlayer(i,a)}})),v.on($t.BUFFERED_TO_END,(function(){var r,i=n.getAssetPlayer(h);if(n.log("buffered to end of asset ".concat(i)),i&&n.schedule){var a=n.schedule.findEventIndex(e.identifier),o=null==(r=n.schedule.items)?void 0:r[a];n.isInterstitial(o)&&n.advanceAssetBuffering(o,t)}}));var A=function(t){return function(){if(n.getAssetPlayer(h)&&n.schedule){n.shouldPlay=!0;var r=n.schedule.findEventIndex(e.identifier);n.advanceAfterAssetEnded(e,r,t)}}};return v.once($t.MEDIA_ENDED,A(r)),v.once($t.PLAYOUT_LIMIT_REACHED,A(1/0)),v.on($t.ERROR,(function(t,i){if(n.schedule){var a=n.getAssetPlayer(h);if(i.details===Zt.BUFFER_STALLED_ERROR)return null!=a&&a.appendInPlace?void n.handleInPlaceStall(e):(n.onTimeupdate(),void n.checkBuffer(!0));n.handleAssetItemError(i,e,n.schedule.findEventIndex(e.identifier),r,"Asset player error ".concat(i.error," ").concat(e))}})),v.on($t.DESTROYING,(function(){if(n.getAssetPlayer(h)&&n.schedule){var t=new Error("Asset player destroyed unexpectedly ".concat(h)),i={fatal:!0,type:Jt.OTHER_ERROR,details:Zt.INTERSTITIAL_ASSET_ITEM_ERROR,error:t};n.handleAssetItemError(i,e,n.schedule.findEventIndex(e.identifier),r,t.message)}})),this.log("INTERSTITIAL_ASSET_PLAYER_CREATED ".concat(yu(t))),this.hls.trigger($t.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:v}),v}},{key:"clearInterstitial",value:function(e,t){var r=this;e.assetList.forEach((function(e){r.clearAssetPlayer(e.identifier,t)})),e.reset()}},{key:"resetAssetPlayer",value:function(e){var t=this.getAssetPlayerQueueIndex(e);if(-1!==t){this.log('reset asset player "'.concat(e,'" after error'));var r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}},{key:"clearAssetPlayer",value:function(e,t){var r=this.getAssetPlayerQueueIndex(e);if(-1!==r){var n=this.playerQueue[r];this.log("clear ".concat(n," toSegment: ").concat(t?bu(t):t)),this.transferMediaFromPlayer(n,t),this.playerQueue.splice(r,1),n.destroy()}}},{key:"emptyPlayerQueue",value:function(){for(var e;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}},{key:"startAssetPlayer",value:function(e,t,r,n,i){var a=e.interstitial,o=e.assetItem,s=e.assetId,l=a.assetList.length,u=this.playingAsset;this.endedAsset=null,this.playingAsset=o,u&&u.identifier===s||(u&&(this.clearAssetPlayer(u.identifier,r[n]),delete u.error),this.log("INTERSTITIAL_ASSET_STARTED ".concat(t+1,"/").concat(l," ").concat(yu(o))),this.hls.trigger($t.INTERSTITIAL_ASSET_STARTED,{asset:o,assetListIndex:t,event:a,schedule:r.slice(0),scheduleIndex:n,player:e})),this.bufferAssetPlayer(e,i)}},{key:"bufferAssetPlayer",value:function(e,t){var r,n;if(this.schedule){var i=e.interstitial,a=e.assetItem,o=this.schedule.findEventIndex(i.identifier),s=null==(r=this.schedule.items)?void 0:r[o];if(s){e.loadSource(),this.setBufferingItem(s),this.bufferingAsset=a;var l=this.getBufferingPlayer();if(l!==e){var u=i.appendInPlace;if(!u||!1!==(null==l?void 0:l.interstitial.appendInPlace)){var c=(null==l?void 0:l.tracks)||(null==(n=this.detachedData)?void 0:n.tracks)||this.requiredTracks;if(u&&a!==this.playingAsset){if(!e.tracks)return void this.log("Waiting for track info before buffering ".concat(e));if(c&&!Er(c,e.tracks)){var f=new Error("Asset ".concat(yu(a)," SourceBuffer tracks ('").concat(Object.keys(e.tracks),"') are not compatible with primary content tracks ('").concat(Object.keys(c),"')")),d={fatal:!0,type:Jt.OTHER_ERROR,details:Zt.INTERSTITIAL_ASSET_ITEM_ERROR,error:f},h=i.findAssetIndex(a);return void this.handleAssetItemError(d,i,o,h,f.message)}}this.transferMediaTo(e,t)}}}}}},{key:"handleInPlaceStall",value:function(e){var t=this.schedule,r=this.primaryMedia;if(t&&r){var n=r.currentTime,i=t.findAssetIndex(e,n),a=e.assetList[i];if(a){var o=this.getAssetPlayer(a.identifier);if(o){var s=o.currentTime||n-a.timelineStart,l=o.duration-s;if(this.warn("Stalled at ".concat(s," of ").concat(s+l," in ").concat(o," ").concat(e," (media.currentTime: ").concat(n,")")),s&&(l/r.playbackRate<.5||o.bufferedInPlaceToEnd(r))&&o.hls){var u=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,u,i)}}}}}},{key:"advanceInPlace",value:function(e){var t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}},{key:"handleAssetItemError",value:function(e,t,r,n,i){if(e.details!==Zt.BUFFER_STALLED_ERROR){var a=t.assetList[n]||null;if(this.warn("INTERSTITIAL_ASSET_ERROR ".concat(a?yu(a):a," ").concat(e.error)),this.schedule){var o=(null==a?void 0:a.identifier)||"",s=this.getAssetPlayerQueueIndex(o),l=this.playerQueue[s]||null,u=this.schedule.items,c=cr({},e,{fatal:!1,errorAction:bi(!0),asset:a,assetListIndex:n,event:t,schedule:u,scheduleIndex:r,player:l});if(this.hls.trigger($t.INTERSTITIAL_ASSET_ERROR,c),e.fatal){var f=this.playingAsset,d=this.bufferingAsset,h=new Error(i);if(a&&(this.clearAssetPlayer(o,null),a.error=h),t.assetList.some((function(e){return!e.error})))for(var p=n;p<t.assetList.length;p++)this.resetAssetPlayer(t.assetList[p].identifier);else t.error=h;this.updateSchedule(!0),t.error?this.primaryFallback(t):f&&f.identifier===o?this.advanceAfterAssetEnded(t,r,n):d&&d.identifier===o&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,d)}}}}},{key:"primaryFallback",value:function(e){var t=e.timelineStart,r=this.effectivePlayingItem;if(r){this.log('Fallback to primary from event "'.concat(e.identifier,'" start: ').concat(t," pos: ").concat(this.timelinePos," playing: ").concat(bu(r)," error: ").concat(e.error));var n=this.timelinePos;-1===n&&(n=this.hls.startPosition);var i=this.updateItem(r,n);if(this.itemsMatch(r,i)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;var a=this.schedule.findItemIndexAtTime(n);this.setSchedulePosition(a)}else this.checkStart()}},{key:"onAssetListLoaded",value:function(e,t){var r,n,i=this,a=t.event,o=a.identifier,s=t.assetListResponse.ASSETS;if(null!=(r=this.schedule)&&r.hasEvent(o)){var l=a.timelineStart,u=a.duration,c=0;s.forEach((function(e,t){var r=parseFloat(e.DURATION);i.createAsset(a,t,c,l+c,r,e.URI),c+=r})),a.duration=c,this.log("Loaded asset-list with duration: ".concat(c," (was: ").concat(u,") ").concat(a));var f=this.waitingItem,d=(null==f?void 0:f.event.identifier)===o;this.updateSchedule();var h=null==(n=this.bufferingItem)?void 0:n.event;if(d){var p,g=this.schedule.findEventIndex(o),v=null==(p=this.schedule.items)?void 0:p[g];if(v){if(!this.playingItem&&this.timelinePos>v.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==g)return a.error=new Error("Interstitial no longer within playback range ".concat(this.timelinePos," ").concat(a)),this.updateSchedule(!0),void this.primaryFallback(a);this.setBufferingItem(v)}this.setSchedulePosition(g)}else if((null==h?void 0:h.identifier)===o){var y=a.assetList[0];if(y){var m=this.getAssetPlayer(y.identifier);if(h.appendInPlace){var A=this.primaryMedia;m&&A&&this.bufferAssetPlayer(m,A)}else m&&m.loadSource()}}}}},{key:"onError",value:function(e,t){if(this.schedule)switch(t.details){case Zt.ASSET_LIST_PARSING_ERROR:case Zt.ASSET_LIST_LOAD_ERROR:case Zt.ASSET_LIST_LOAD_TIMEOUT:var r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break;case Zt.BUFFER_STALLED_ERROR:var n=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(n)&&n.event.appendInPlace)return void this.handleInPlaceStall(n.event);this.log("Primary player stall @".concat(this.timelinePos," bufferedPos: ").concat(this.bufferedPos)),this.onTimeupdate(),this.checkBuffer(!0)}}},{key:"interstitialsManager",get:function(){if(!this.hls)return null;if(this.manager)return this.manager;var e=this,t=function(){return e.bufferingItem||e.waitingItem},r=function(t){return t?e.getAssetPlayer(t.identifier):t},n=function(t,n,a,o,s){if(t){var l=t[n].start,u=t.event;if(u){if("playout"===n||u.timelineOccupancy!==fu.Point){var c=r(a);(null==c?void 0:c.interstitial)===u&&(l+=c.assetItem.startOffset+c[s])}}else l+=("bufferedPos"===o?i():e[o])-t.start;return l}return 0},i=function(){var t=e.bufferedPos;return t===Number.MAX_VALUE?a("primary"):Math.max(t,0)},a=function(t){var r,n;return null!=(r=e.primaryDetails)&&r.live?e.primaryDetails.edge:(null==(n=e.schedule)?void 0:n.durations[t])||0},o=function(t,i){var a,o,s=e.effectivePlayingItem;if((null==s||null==(a=s.event)||!a.restrictions.skip)&&e.schedule){e.log("seek to ".concat(t,' "').concat(i,'"'));var l=e.effectivePlayingItem,u=e.schedule.findItemIndexAtTime(t,i),c=null==(o=e.schedule.items)?void 0:o[u],f=e.getBufferingPlayer(),d=null==f?void 0:f.interstitial,h=null==d?void 0:d.appendInPlace,p=l&&e.itemsMatch(l,c);if(l&&(h||p)){var g=r(e.playingAsset),v=(null==g?void 0:g.media)||e.primaryMedia;if(v){var y="primary"===i?v.currentTime:n(l,i,e.playingAsset,"timelinePos","currentTime"),m=t-y,A=(h?y:v.currentTime)+m;if(A>=0&&(!g||h||A<=g.duration))return void(v.currentTime=A)}}if(c){var b=t;if("primary"!==i){var E=t-c[i].start;b=c.start+E}var k=!e.isInterstitial(c);if(e.isInterstitial(l)&&!l.event.appendInPlace||!k&&!c.event.appendInPlace){if(l){var T=e.findItemIndex(l);if(u>T){var S=e.schedule.findJumpRestrictedIndex(T+1,u);if(S>T)return void e.setSchedulePosition(S)}var w=0;if(k)e.timelinePos=b,e.checkBuffer();else for(var _=c.event.assetList,L=t-(c[i]||c).start,P=_.length;P--;){var I=_[P];if(I.duration&&L>=I.startOffset&&L<I.startOffset+I.duration){w=P;break}}e.setSchedulePosition(u,w)}}else{var R=e.media||(h?null==f?void 0:f.media:null);R&&(R.currentTime=b)}}}},s=function(){var r=e.effectivePlayingItem;if(e.isInterstitial(r))return r;var n=t();return e.isInterstitial(n)?n:null},l={get bufferedEnd(){var r,i=t(),a=e.bufferingItem;return a&&a===i&&(n(a,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-a.playout.start||(null==(r=e.bufferingAsset)?void 0:r.startOffset))||0},get currentTime(){var t=s(),r=e.effectivePlayingItem;return r&&r===t?n(r,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-r.playout.start:0},set currentTime(t){var r=s(),n=e.effectivePlayingItem;n&&n===r&&o(t+n.playout.start,"playout")},get duration(){var e=s();return e?e.playout.end-e.playout.start:0},get assetPlayers(){var t,r=null==(t=s())?void 0:t.event.assetList;return r?r.map((function(t){return e.getAssetPlayer(t.identifier)})):[]},get playingIndex(){var t,r=null==(t=s())?void 0:t.event;return r&&e.effectivePlayingAsset?r.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return s()}};return this.manager={get events(){var t;return(null==(t=e.schedule)||null==(t=t.events)?void 0:t.slice(0))||[]},get schedule(){var t;return(null==(t=e.schedule)||null==(t=t.items)?void 0:t.slice(0))||[]},get interstitialPlayer(){return s()?l:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){var r=t();return e.findItemIndex(r)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){var t=e.effectivePlayingItem;return e.findItemIndex(t)},primary:{get bufferedEnd(){return i()},get currentTime(){var t=e.timelinePos;return t>0?t:0},set currentTime(e){o(e,"primary")},get duration(){return a("primary")},get seekableStart(){var t;return(null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0}},integrated:{get bufferedEnd(){return n(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return n(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(e){o(e,"integrated")},get duration(){return a("integrated")},get seekableStart(){var t;return function(t,r){var n;if(0!==t&&null!=(n=e.schedule)&&n.length){var i,a=e.schedule.findItemIndexAtTime(t),o=null==(i=e.schedule.items)?void 0:i[a];if(o)return t+(o[r].start-o.start)}return t}((null==(t=e.primaryDetails)?void 0:t.fragmentStart)||0,"integrated")}},skip:function(){var t=e.effectivePlayingItem,r=null==t?void 0:t.event;if(r&&!r.restrictions.skip){var n=e.findItemIndex(t);if(r.appendInPlace){var i=t.playout.start+t.event.duration;o(i+.001,"playout")}else e.advanceAfterAssetEnded(r,n,1/0)}}}}},{key:"effectivePlayingItem",get:function(){return this.waitingItem||this.playingItem||this.endedItem}},{key:"effectivePlayingAsset",get:function(){return this.playingAsset||this.endedAsset}},{key:"playingLastItem",get:function(){var e,t=this.playingItem,r=null==(e=this.schedule)?void 0:e.items;return!!(this.playbackStarted&&t&&r)&&this.findItemIndex(t)===r.length-1}},{key:"playbackStarted",get:function(){return null!==this.effectivePlayingItem}},{key:"currentTime",get:function(){var e,t;if(null!==this.mediaSelection){var r=this.waitingItem||this.playingItem;if(!this.isInterstitial(r)||r.event.appendInPlace){var n=this.media;!n&&null!=(e=this.bufferingItem)&&null!=(e=e.event)&&e.appendInPlace&&(n=this.primaryMedia);var i=null==(t=n)?void 0:t.currentTime;return void 0!==i&&Wt(i)?i:void 0}}}},{key:"primaryMedia",get:function(){var e;return this.media||(null==(e=this.detachedData)?void 0:e.media)||null}},{key:"playbackDisabled",get:function(){return!1===this.hls.config.enableInterstitialPlayback}},{key:"primaryDetails",get:function(){var e;return null==(e=this.mediaSelection)?void 0:e.main.details}},{key:"primaryLive",get:function(){var e;return!(null==(e=this.primaryDetails)||!e.live)}}]),r}(hr)});function Sc(e){return e&&"object"==typeof e?Array.isArray(e)?e.map(Sc):Object.keys(e).reduce((function(t,r){return t[r]=Sc(e[r]),t}),{}):e}function wc(e,t){var r=e.loader;r!==mc&&r!==kc?(t.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}()&&(e.loader=mc,e.progressive=!0,e.enableSoftwareAES=!0,t.log("[config]: Progressive streaming enabled, using FetchLoader"))}var _c=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,"gap-controller",e.logger)).hls=void 0,i.fragmentTracker=void 0,i.media=null,i.mediaSource=void 0,i.nudgeRetry=0,i.stallReported=!1,i.stalled=null,i.moved=!1,i.seeking=!1,i.buffered={},i.lastCurrentTime=0,i.ended=0,i.waiting=0,i.onMediaPlaying=function(){i.ended=0,i.waiting=0},i.onMediaWaiting=function(){var e;null!=(e=i.media)&&e.seeking||(i.waiting=self.performance.now(),i.tick())},i.onMediaEnded=function(){var e;i.hls&&(i.ended=(null==(e=i.media)?void 0:e.currentTime)||1,i.hls.trigger($t.MEDIA_ENDED,{stalled:!1}))},i.hls=e,i.fragmentTracker=n,i.registerListeners(),i}return p(r,[{key:"registerListeners",value:function(){var e=this.hls;e&&(e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.BUFFER_APPENDED,this.onBufferAppended,this))}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.BUFFER_APPENDED,this.onBufferAppended,this))}},{key:"destroy",value:function(){o(s(r.prototype),"destroy",this).call(this),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}},{key:"onMediaAttached",value:function(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;var r=this.media=t.media;io(r,"playing",this.onMediaPlaying),io(r,"waiting",this.onMediaWaiting),io(r,"ended",this.onMediaEnded)}},{key:"onMediaDetaching",value:function(e,t){this.clearInterval();var r=this.media;r&&(ao(r,"playing",this.onMediaPlaying),ao(r,"waiting",this.onMediaWaiting),ao(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}},{key:"onBufferAppended",value:function(e,t){this.buffered=t.timeRanges}},{key:"tick",value:function(){var e;if(null!=(e=this.media)&&e.readyState&&this.hasBuffered){var t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}}},{key:"poll",value:function(e,t){var r,n,i=null==(r=this.hls)?void 0:r.config;if(i){var a=this.media;if(a){var o=a.seeking,s=this.seeking&&!o,l=!this.seeking&&o,u=a.paused&&!o||a.ended||0===a.playbackRate;if(this.seeking=o,e!==t)return t&&(this.ended=0),this.moved=!0,o||(this.nudgeRetry=0,i.nudgeOnVideoHole&&!u&&e>t&&this.nudgeOnVideoHole(e,t)),void(0===this.waiting&&this.stallResolved(e));if(l||s)s&&this.stallResolved(e);else{if(u)return this.nudgeRetry=0,this.stallResolved(e),void(!this.ended&&a.ended&&this.hls&&(this.ended=e||1,this.hls.trigger($t.MEDIA_ENDED,{stalled:!1})));if(Yi.getBuffered(a).length){var c=Yi.bufferInfo(a,e,0),f=c.nextStart||0,d=this.fragmentTracker;if(o&&d&&this.hls){var h=Lc(this.hls.inFlightFragments,e),p=c.len>2,g=!f||h||f-e>2&&!d.getPartialFragment(e);if(p||g)return;this.moved=!1}var v=null==(n=this.hls)?void 0:n.latestLevelDetails;if(!this.moved&&null!==this.stalled&&d){if(!(c.len>0)&&!f)return;var y=Math.max(f,c.start||0)-e,m=null!=v&&v.live?2*v.targetduration:2,A=Ic(e,d);if(y>0&&(y<=m||A))return void(a.paused||this._trySkipBufferHole(A))}var b=i.detectStallWithCurrentTimeMs,E=self.performance.now(),k=this.waiting,T=this.stalled;if(null===T){if(!(k>0&&E-k<b))return void(this.stalled=E);T=this.stalled=k}var S=E-T;if(!o&&(S>=b||k)&&this.hls){var w;if("ended"===(null==(w=this.mediaSource)?void 0:w.readyState)&&(null==v||!v.live)&&Math.abs(e-((null==v?void 0:v.edge)||0))<1){if(this.ended)return;return this.ended=e||1,void this.hls.trigger($t.MEDIA_ENDED,{stalled:!0})}if(this._reportStall(c),!this.media||!this.hls)return}var _=Yi.bufferInfo(a,e,i.maxBufferHole);this._tryFixBufferStall(_,S,e)}else this.nudgeRetry=0}}}}},{key:"stallResolved",value:function(e){var t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){var r=self.performance.now()-t;this.log("playback not stuck anymore @".concat(e,", after ").concat(Math.round(r),"ms")),this.stallReported=!1,this.waiting=0,this.hls.trigger($t.STALL_RESOLVED,{})}}},{key:"nudgeOnVideoHole",value:function(e,t){var r,n=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&null!=(r=this.buffered.audio)&&r.length&&n&&n.length>1&&e>n.end(0)){var i=Yi.bufferedInfo(Yi.timeRangesToArray(this.buffered.audio),e,0);if(i.len>1&&t>=i.start){var a=Yi.timeRangesToArray(n),o=Yi.bufferedInfo(a,t,0).bufferedIndex;if(o>-1&&o<a.length-1){var s=Yi.bufferedInfo(a,e,0).bufferedIndex,l=a[o].end,u=a[o+1].start;if((-1===s||s>o)&&u-l<1&&e-l<2){var c=new Error("nudging playhead to flush pipeline after video hole. currentTime: ".concat(e," hole: ").concat(l," -> ").concat(u," buffered index: ").concat(s));this.warn(c.message),this.media.currentTime+=1e-6;var f=Ic(e,this.fragmentTracker);f&&"fragment"in f?f=f.fragment:f||(f=void 0);var d=Yi.bufferInfo(this.media,e,0);this.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:c,reason:c.message,frag:f,buffer:d.len,bufferInfo:d})}}}}}},{key:"_tryFixBufferStall",value:function(e,t,r){var n,i,a=this.fragmentTracker,o=this.media,s=null==(n=this.hls)?void 0:n.config;if(o&&a&&s){var l=null==(i=this.hls)?void 0:i.latestLevelDetails,u=Ic(r,a);if(!(u||null!=l&&l.live&&r<l.fragmentStart)||!this._trySkipBufferHole(u)&&this.media){var c=e.buffered,f=this.adjacentTraversal(e,r);(c&&c.length>1&&e.len>s.maxBufferHole||e.nextStart&&(e.nextStart-r<s.maxBufferHole||f))&&(t>1e3*s.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}}}},{key:"adjacentTraversal",value:function(e,t){var r=this.fragmentTracker,n=e.nextStart;if(r&&n){var i=r.getFragAtPos(t,ir),a=r.getFragAtPos(n,ir);if(i&&a)return a.sn-i.sn<2}return!1}},{key:"_reportStall",value:function(e){var t=this.hls,r=this.media,n=this.stallReported,i=this.stalled;if(!n&&null!==i&&r&&t){this.stallReported=!0;var a=new Error("Playback stalling at @".concat(r.currentTime," due to low buffer (").concat(Vn(e),")"));this.warn(a.message),t.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_STALLED_ERROR,fatal:!1,error:a,buffer:e.len,bufferInfo:e,stalled:{start:i}})}}},{key:"_trySkipBufferHole",value:function(e){var t,r=this.fragmentTracker,n=this.media,i=null==(t=this.hls)?void 0:t.config;if(!n||!r||!i)return 0;var a=n.currentTime,o=Yi.bufferInfo(n,a,0),s=a<o.start?o.start:o.nextStart;if(s&&this.hls){var l=o.len<=i.maxBufferHole,u=o.len>0&&o.len<1&&n.readyState<3,c=s-a;if(c>0&&(l||u)){if(c>i.maxBufferHole){var f=!1;if(0===a){var d=r.getAppendedFrag(0,ir);d&&s<d.end&&(f=!0)}if(!f&&e){var h;if(null==(h=this.hls.loadLevelObj)||!h.details)return 0;if(Lc(this.hls.inFlightFragments,s))return 0;for(var p=!1,g=e.end;g<s;){var v=Ic(g,r);if(!v){p=!0;break}g+=v.duration}if(p)return 0}}var y=Math.max(s+.05,a+.1);if(this.warn("skipping hole, adjusting currentTime from ".concat(a," to ").concat(y)),this.moved=!0,n.currentTime=y,null==e||!e.gap){var m=new Error("fragment loaded with buffer holes, seeking from ".concat(a," to ").concat(y)),A={type:Jt.MEDIA_ERROR,details:Zt.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:m,reason:m.message,buffer:o.len,bufferInfo:o};e&&("fragment"in e?A.part=e:A.frag=e),this.hls.trigger($t.ERROR,A)}return y}}return 0}},{key:"_tryNudgeBuffer",value:function(e){var t=this.hls,r=this.media,n=this.nudgeRetry,i=null==t?void 0:t.config;if(!r||!i)return 0;var a=r.currentTime;if(this.nudgeRetry++,n<i.nudgeMaxRetry){var o=a+(n+1)*i.nudgeOffset,s=new Error("Nudging 'currentTime' from ".concat(a," to ").concat(o));this.warn(s.message),r.currentTime=o,t.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_NUDGE_ON_STALL,error:s,fatal:!1,buffer:e.len,bufferInfo:e})}else{var l=new Error("Playhead still not moving while enough data buffered @".concat(a," after ").concat(i.nudgeMaxRetry," nudges"));this.error(l.message),t.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}},{key:"hasBuffered",get:function(){return Object.keys(this.buffered).length>0}}]),r}(Ui);function Lc(e,t){var r=Pc(e.main);if(r&&r.start<=t)return r;var n=Pc(e.audio);return n&&n.start<=t?n:null}function Pc(e){if(!e)return null;switch(e.state){case lo:case so:case vo:case yo:return null}return e.frag}function Ic(e,t){return t.getAppendedFrag(e,ir)||t.getPartialFragment(e)}function Rc(){if("undefined"!=typeof self)return self.VTTCue||self.TextTrackCue}function Cc(e,t,r,n,i){var a=new e(t,r,"");try{a.value=n,i&&(a.type=i)}catch(A){a=new e(t,r,Vn(i?dr({type:i},n):n))}return a}var Dc=function(){var e=Rc();try{e&&new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}(),Oc=function(){function e(t){var r=this;h(this,e),this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=function(){r.hls&&r.hls.trigger($t.EVENT_CUE_ENTER,{})},this.hls=t,this._registerListeners()}return p(e,[{key:"destroy",value:function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}},{key:"_registerListeners",value:function(){var e=this.hls;e&&(e.on($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($t.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}},{key:"_unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off($t.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($t.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}},{key:"onMediaAttaching",value:function(e,t){var r;this.media=t.media,!1===(null==(r=t.overrides)?void 0:r.cueRemoval)&&(this.removeCues=!1)}},{key:"onMediaAttached",value:function(){var e,t=null==(e=this.hls)?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}},{key:"onMediaDetaching",value:function(e,t){this.media=null,t.transferMedia||(this.id3Track&&(this.removeCues&&ou(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}},{key:"onManifestLoading",value:function(){this.dateRangeCuesAppended={}}},{key:"createTrack",value:function(e){var t=this.getID3Track(e.textTracks);return t.mode="hidden",t}},{key:"getID3Track",value:function(e){if(this.media){for(var t=0;t<e.length;t++){var r=e[t];if("metadata"===r.kind&&"id3"===r.label)return iu(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}},{key:"onFragParsingMetadata",value:function(e,t){if(this.media&&this.hls){var r=this.hls.config,n=r.enableEmsgMetadataCues,i=r.enableID3MetadataCues;if(n||i){var a=t.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));var o=Rc();if(o)for(var s=0;s<a.length;s++){var l=a[s].type;if((l!==Wo.emsg||n)&&i){var u=Vo(a[s].data),c=a[s].pts,f=c+a[s].duration;f>Dc&&(f=Dc),f-c<=0&&(f=c+.25);for(var d=0;d<u.length;d++){var h=u[d];if(!Ho(h)){this.updateId3CueEnds(c,l);var p=Cc(o,c,f,h,l);p&&this.id3Track.addCue(p)}}}}}}}},{key:"updateId3CueEnds",value:function(e,t){var r,n=null==(r=this.id3Track)?void 0:r.cues;if(n)for(var i=n.length;i--;){var a=n[i];a.type===t&&a.startTime<e&&a.endTime===Dc&&(a.endTime=e)}}},{key:"onBufferFlushing",value:function(e,t){var r=t.startOffset,n=t.endOffset,i=t.type,a=this.id3Track,o=this.hls;if(o){var s=o.config,l=s.enableEmsgMetadataCues,u=s.enableID3MetadataCues;a&&(l||u)&&su(a,r,n,"audio"===i?function(e){return e.type===Wo.audioId3&&u}:"video"===i?function(e){return e.type===Wo.emsg&&l}:function(e){return e.type===Wo.audioId3&&u||e.type===Wo.emsg&&l})}}},{key:"onLevelUpdated",value:function(e,t){var r=t.details;this.updateDateRangeCues(r,!0)}},{key:"onLevelPtsUpdated",value:function(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}},{key:"updateDateRangeCues",value:function(e,t){var r=this;if(this.hls&&this.media){var n=this.hls.config,i=n.assetPlayerId,a=n.timelineOffset,o=n.enableDateRangeMetadataCues,s=n.interstitialsController;if(o){var l=Rc();if(i&&a&&!s){var u=e.fragmentStart,c=e.fragmentEnd,f=this.assetCue;f?(f.startTime=u,f.endTime=c):l&&(f=this.assetCue=Cc(l,u,c,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"))&&(f.id=i,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(f),f.addEventListener("enter",this.onEventCueEnter))}if(e.hasProgramDateTime){var d,h=this.id3Track,p=e.dateRanges,g=Object.keys(p),v=this.dateRangeCuesAppended;if(h&&t)if(null!=(d=h.cues)&&d.length)for(var y=Object.keys(v).filter((function(e){return!g.includes(e)})),m=function(e){var t=y[e],n=null==(b=v[t])?void 0:b.cues;delete v[t],n&&Object.keys(n).forEach((function(e){var t=n[e];if(t){t.removeEventListener("enter",r.onEventCueEnter);try{h.removeCue(t)}catch(e){}}}))},A=y.length;A--;){var b;m(A)}else v=this.dateRangeCuesAppended={};var E=e.fragments[e.fragments.length-1];if(0!==g.length&&Wt(null==E?void 0:E.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var k,T=function(e){var t=g[e],n=p[t],i=n.startTime,a=v[t],o=(null==a?void 0:a.cues)||{},u=(null==a?void 0:a.durationKnown)||!1,c=Dc,f=n.duration;if(n.endDate&&null!==f)c=i+f,u=!0;else if(n.endOnNext&&!u){var d=g.reduce((function(e,t){if(t!==n.id){var r=p[t];if(r.class===n.class&&r.startDate>n.startDate&&(!e||n.startDate<e.startDate))return r}return e}),null);d&&(c=d.startTime,u=!0)}for(var h=Object.keys(n.attr),y=0;y<h.length;y++){var m=h[y];if("ID"!==(k=m)&&"CLASS"!==k&&"CUE"!==k&&"START-DATE"!==k&&"DURATION"!==k&&"END-DATE"!==k&&"END-ON-NEXT"!==k){var A=o[m];if(A)!u||null!=a&&a.durationKnown?Math.abs(A.startTime-i)>.01&&(A.startTime=i,A.endTime=c):A.endTime=c;else if(l){var b=n.attr[m];Zi(m)&&(b=Sr(b));var E=Cc(l,i,c,{key:m,data:b},Wo.dateRange);E&&(E.id=t,r.id3Track.addCue(E),o[m]=E,s&&("X-ASSET-LIST"!==m&&"X-ASSET-URL"!==m||E.addEventListener("enter",r.onEventCueEnter)))}}}v[t]={cues:o,dateRange:n,durationKnown:u}},S=0;S<g.length;S++)T(S)}}}}}}]),e}(),zc=function(){function e(t){var r=this;h(this,e),this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=function(){var e=r.media,t=r.levelDetails;if(e&&t){r.currentTime=e.currentTime;var n=r.computeLatency();if(null!==n){r._latency=n;var i=r.config,a=i.lowLatencyMode,o=i.maxLiveSyncPlaybackRate;if(a&&1!==o&&t.live){var s=r.targetLatency;if(null!==s){var l=n-s;if(l<Math.min(r.maxLatency,s+t.targetduration)&&l>.05&&r.forwardBufferLength>1){var u=Math.min(2,Math.max(1,o)),c=Math.round(2/(1+Math.exp(-.75*l-r.edgeStalled))*20)/20,f=Math.min(u,Math.max(1,c));r.changeMediaPlaybackRate(e,f)}else 1!==e.playbackRate&&0!==e.playbackRate&&r.changeMediaPlaybackRate(e,1)}}}}},this.hls=t,this.config=t.config,this.registerListeners()}return p(e,[{key:"destroy",value:function(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}},{key:"registerListeners",value:function(){var e=this.hls;e&&(e.on($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.on($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.on($t.ERROR,this.onError,this))}},{key:"unregisterListeners",value:function(){var e=this.hls;e&&(e.off($t.MEDIA_ATTACHED,this.onMediaAttached,this),e.off($t.MEDIA_DETACHING,this.onMediaDetaching,this),e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.LEVEL_UPDATED,this.onLevelUpdated,this),e.off($t.ERROR,this.onError,this))}},{key:"onMediaAttached",value:function(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}},{key:"onMediaDetaching",value:function(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}},{key:"onManifestLoading",value:function(){this._latency=null,this.stallCount=0}},{key:"onLevelUpdated",value:function(e,t){var r=t.details;r.advanced&&this.onTimeupdate(),!r.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}},{key:"onError",value:function(e,t){var r;t.details===Zt.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&null!=(r=this.levelDetails)&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}},{key:"changeMediaPlaybackRate",value:function(e,t){var r,n;e.playbackRate!==t&&(null==(r=this.hls)||r.logger.debug("[latency-controller]: latency=".concat(this.latency.toFixed(3),", targetLatency=").concat(null==(n=this.targetLatency)?void 0:n.toFixed(3),", forwardBufferLength=").concat(this.forwardBufferLength.toFixed(3),": adjusting playback rate from ").concat(e.playbackRate," to ").concat(t)),e.playbackRate=t)}},{key:"estimateLiveEdge",value:function(){var e=this.levelDetails;return null===e?null:e.edge+e.age}},{key:"computeLatency",value:function(){var e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}},{key:"levelDetails",get:function(){var e;return(null==(e=this.hls)?void 0:e.latestLevelDetails)||null}},{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var e=this.config;if(void 0!==e.liveMaxLatencyDuration)return e.liveMaxLatencyDuration;var t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}},{key:"targetLatency",get:function(){var e=this.levelDetails;if(null===e||null===this.hls)return null;var t=e.holdBack,r=e.partHoldBack,n=e.targetduration,i=this.config,a=i.liveSyncDuration,o=i.liveSyncDurationCount,s=i.lowLatencyMode,l=this.hls.userConfig,u=s&&r||t;(this._targetLatencyUpdated||l.liveSyncDuration||l.liveSyncDurationCount||0===u)&&(u=void 0!==a?a:o*n);var c=n;return u+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,c)},set:function(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}},{key:"liveSyncPosition",get:function(){var e=this.estimateLiveEdge(),t=this.targetLatency;if(null===e||null===t)return null;var r=this.levelDetails;if(null===r)return null;var n=r.edge,i=e-t-this.edgeStalled,a=n-r.totalduration,o=n-(this.config.lowLatencyMode&&r.partTarget||r.targetduration);return Math.min(Math.max(a,i),o)}},{key:"drift",get:function(){var e=this.levelDetails;return null===e?1:e.drift}},{key:"edgeStalled",get:function(){var e=this.levelDetails;if(null===e)return 0;var t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}},{key:"forwardBufferLength",get:function(){var e=this.media,t=this.levelDetails;if(!e||!t)return 0;var r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}}]),e}(),Mc=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,e,"level-controller"))._levels=[],i._firstLevel=-1,i._maxAutoLevel=-1,i._startLevel=void 0,i.currentLevel=null,i.currentLevelIndex=-1,i.manualLevelIndex=-1,i.steering=void 0,i.onParsedComplete=void 0,i.steering=n,i._registerListeners(),i}return p(r,[{key:"_registerListeners",value:function(){var e=this.hls;e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.on($t.LEVEL_LOADED,this.onLevelLoaded,this),e.on($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($t.FRAG_BUFFERED,this.onFragBuffered,this),e.on($t.ERROR,this.onError,this)}},{key:"_unregisterListeners",value:function(){var e=this.hls;e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.MANIFEST_LOADED,this.onManifestLoaded,this),e.off($t.LEVEL_LOADED,this.onLevelLoaded,this),e.off($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($t.FRAG_BUFFERED,this.onFragBuffered,this),e.off($t.ERROR,this.onError,this)}},{key:"destroy",value:function(){this._unregisterListeners(),this.steering=null,this.resetLevels(),o(s(r.prototype),"destroy",this).call(this)}},{key:"stopLoad",value:function(){this._levels.forEach((function(e){e.loadError=0,e.fragmentError=0})),o(s(r.prototype),"stopLoad",this).call(this)}},{key:"resetLevels",value:function(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}},{key:"onManifestLoading",value:function(e,t){this.resetLevels()}},{key:"onManifestLoaded",value:function(e,t){var r=this,n=this.hls.config.preferManagedMediaSource,i=[],a={},o={},s=!1,l=!1,u=!1;t.levels.forEach((function(e){var t=e.attrs,c=e.audioCodec,f=e.videoCodec;c&&(e.audioCodec=c=Tn(c,n)||void 0),f&&(f=e.videoCodec=function(e){for(var t=e.split(","),r=0;r<t.length;r++){var n=t[r].split(".");n.length>2&&"avc1"===n[0]&&(t[r]="avc1.".concat(parseInt(n[1]).toString(16)).concat(("000"+parseInt(n[2]).toString(16)).slice(-4)))}return t.join(",")}(f));var d=e.width,h=e.height,p=e.unknownCodecs,g=(null==p?void 0:p.length)||0;if(s||(s=!(!d||!h)),l||(l=!!f),u||(u=!!c),g||c&&!r.isAudioSupported(c)||f&&!r.isVideoSupported(f))r.log('Some or all CODECS not supported "'.concat(t.CODECS,'"'));else{var v=t.CODECS,y=t["FRAME-RATE"],m=t["HDCP-LEVEL"],A=t["PATHWAY-ID"],b=t.RESOLUTION,E=t["VIDEO-RANGE"],k="".concat("".concat(A||".","-"),e.bitrate,"-").concat(b,"-").concat(y,"-").concat(v,"-").concat(E,"-").concat(m);if(a[k])if(a[k].uri===e.url||e.attrs["PATHWAY-ID"])a[k].addGroupId("audio",t.AUDIO),a[k].addGroupId("text",t.SUBTITLES);else{var T=o[k]+=1;e.attrs["PATHWAY-ID"]=new Array(T+1).join(".");var S=r.createLevel(e);a[k]=S,i.push(S)}else{var w=r.createLevel(e);a[k]=w,o[k]=1,i.push(w)}}})),this.filterAndSortMediaOptions(i,t,s,l,u)}},{key:"createLevel",value:function(e){var t=new Gn(e),r=e.supplemental;if(null!=r&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){var n=new Error('SUPPLEMENTAL-CODECS not supported "'.concat(r.videoCodec,'"'));this.log(n.message),t.supportedResult=Cn(n,[])}return t}},{key:"isAudioSupported",value:function(e){return vn(e,"audio",this.hls.config.preferManagedMediaSource)}},{key:"isVideoSupported",value:function(e){return vn(e,"video",this.hls.config.preferManagedMediaSource)}},{key:"filterAndSortMediaOptions",value:function(e,t,r,n,i){var a,o=this,s=[],l=[],u=e,c=(null==(a=t.stats)?void 0:a.parsing)||{};if((r||n)&&i&&(u=u.filter((function(e){var t=e.videoCodec,r=e.videoRange,n=e.width,i=e.height;return(!!t||!(!n||!i))&&function(e){return!!e&&xn.indexOf(e)>-1}(r)}))),0===u.length)return Promise.resolve().then((function(){if(o.hls){var e="no level with compatible codecs found in manifest",r=e;t.levels.length&&(r="one or more CODECS in variant not supported: ".concat(Vn(t.levels.map((function(e){return e.attrs.CODECS})).filter((function(e,t,r){return r.indexOf(e)===t})))),o.warn(r),e+=" (".concat(r,")"));var n=new Error(e);o.hls.trigger($t.ERROR,{type:Jt.MEDIA_ERROR,details:Zt.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:n,reason:r})}})),void(c.end=performance.now());t.audioTracks&&xc(s=t.audioTracks.filter((function(e){return!e.audioCodec||o.isAudioSupported(e.audioCodec)}))),t.subtitles&&xc(l=t.subtitles);var f=u.slice(0);u.sort((function(e,t){if(e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"])return(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&e.height!==t.height)return e.height-t.height;if(e.frameRate!==t.frameRate)return e.frameRate-t.frameRate;if(e.videoRange!==t.videoRange)return xn.indexOf(e.videoRange)-xn.indexOf(t.videoRange);if(e.videoCodec!==t.videoCodec){var n=An(e.videoCodec),i=An(t.videoCodec);if(n!==i)return i-n}if(e.uri===t.uri&&e.codecSet!==t.codecSet){var a=bn(e.codecSet),o=bn(t.codecSet);if(a!==o)return o-a}return e.averageBitrate!==t.averageBitrate?e.averageBitrate-t.averageBitrate:0}));var d=f[0];if(this.steering&&(u=this.steering.filterParsedLevels(u)).length!==f.length)for(var h=0;h<f.length;h++)if(f[h].pathwayId===u[0].pathwayId){d=f[h];break}this._levels=u;for(var p=0;p<u.length;p++)if(u[p]===d){var g;this._firstLevel=p;var v=d.bitrate,y=this.hls.bandwidthEstimate;if(this.log("manifest loaded, ".concat(u.length," level(s) found, first bitrate: ").concat(v)),void 0===(null==(g=this.hls.userConfig)?void 0:g.abrEwmaDefaultEstimate)){var m=Math.min(v,this.hls.config.abrEwmaDefaultEstimateMax);m>y&&y===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=m)}break}var A=i&&!n,b=this.hls.config,E=!(!b.audioStreamController||!b.audioTrackController),k={levels:u,audioTracks:s,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:i,video:n,altAudio:E&&!A&&s.some((function(e){return!!e.url}))};c.end=performance.now(),this.hls.trigger($t.MANIFEST_PARSED,k)}},{key:"onError",value:function(e,t){!t.fatal&&t.context&&t.context.type===tr&&t.context.level===this.level&&this.checkRetry(t)}},{key:"onFragBuffered",value:function(e,t){var r=t.frag;if(void 0!==r&&r.type===ir){var n=r.elementaryStreams;if(!Object.keys(n).some((function(e){return!!n[e]})))return;var i=this._levels[r.level];null!=i&&i.loadError&&(this.log("Resetting level error count of ".concat(i.loadError," on frag buffered")),i.loadError=0)}}},{key:"onLevelLoaded",value:function(e,t){var r,n,i=t.level,a=t.details,o=t.levelInfo;if(!o)return this.warn("Invalid level index ".concat(i)),void(null!=(n=t.deliveryDirectives)&&n.skip&&(a.deltaUpdateFailed=!0));if(o===this.currentLevel||t.withoutMultiVariant){0===o.fragmentError&&(o.loadError=0);var s=o.details;s===t.details&&s.advanced&&(s=void 0),this.playlistLoaded(i,t,s)}else null!=(r=t.deliveryDirectives)&&r.skip&&(a.deltaUpdateFailed=!0)}},{key:"loadPlaylist",value:function(e){o(s(r.prototype),"loadPlaylist",this).call(this),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}},{key:"loadingPlaylist",value:function(e,t){o(s(r.prototype),"loadingPlaylist",this).call(this,e,t);var n=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],l=e.details,u=null==l?void 0:l.age;this.log("Loading level index ".concat(i).concat(void 0!==(null==t?void 0:t.msn)?" at sn "+t.msn+" part "+t.part:"").concat(a?" Pathway "+a:"").concat(u&&l.live?" age "+u.toFixed(1)+(l.type&&" "+l.type||""):""," ").concat(n)),this.hls.trigger($t.LEVEL_LOADING,{url:n,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}},{key:"removeLevel",value:function(e){var t,r=this;if(1!==this._levels.length){var n=this._levels.filter((function(t,n){return n!==e||(r.steering&&r.steering.removeLevel(t),t===r.currentLevel&&(r.currentLevel=null,r.currentLevelIndex=-1,t.details&&t.details.fragments.forEach((function(e){return e.level=-1}))),!1)}));Xa(n),this._levels=n,this.currentLevelIndex>-1&&null!=(t=this.currentLevel)&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);var i=n.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger($t.LEVELS_UPDATED,{levels:n})}}},{key:"onLevelsUpdated",value:function(e,t){var r=t.levels;this._levels=r}},{key:"checkMaxAutoUpdated",value:function(){var e=this.hls,t=e.autoLevelCapping,r=e.maxAutoLevel,n=e.maxHdcpLevel;this._maxAutoLevel!==r&&(this._maxAutoLevel=r,this.hls.trigger($t.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:t,levels:this.levels,maxAutoLevel:r,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:n}))}},{key:"levels",get:function(){return 0===this._levels.length?null:this._levels}},{key:"loadLevelObj",get:function(){return this.currentLevel}},{key:"level",get:function(){return this.currentLevelIndex},set:function(e){var t=this._levels;if(0!==t.length){if(e<0||e>=t.length){var r=new Error("invalid level idx"),n=e<0;if(this.hls.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.LEVEL_SWITCH_ERROR,level:e,fatal:n,error:r,reason:r.message}),n)return;e=Math.min(e,t.length-1)}var i=this.currentLevelIndex,a=this.currentLevel,o=a?a.attrs["PATHWAY-ID"]:void 0,s=t[e],l=s.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=s,i!==e||!a||o!==l){this.log("Switching to level ".concat(e," (").concat(s.height?s.height+"p ":"").concat(s.videoRange?s.videoRange+" ":"").concat(s.codecSet?s.codecSet+" ":"","@").concat(s.bitrate,")").concat(l?" with Pathway "+l:""," from level ").concat(i).concat(o?" with Pathway "+o:""));var u={level:e,attrs:s.attrs,details:s.details,bitrate:s.bitrate,averageBitrate:s.averageBitrate,maxBitrate:s.maxBitrate,realBitrate:s.realBitrate,width:s.width,height:s.height,codecSet:s.codecSet,audioCodec:s.audioCodec,videoCodec:s.videoCodec,audioGroups:s.audioGroups,subtitleGroups:s.subtitleGroups,loaded:s.loaded,loadError:s.loadError,fragmentError:s.fragmentError,name:s.name,id:s.id,uri:s.uri,url:s.url,urlId:0,audioGroupIds:s.audioGroupIds,textGroupIds:s.textGroupIds};this.hls.trigger($t.LEVEL_SWITCHING,u);var c=s.details;if(!c||c.live){var f=this.switchParams(s.uri,null==a?void 0:a.details,c);this.loadPlaylist(f)}}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(e){this._firstLevel=e}},{key:"startLevel",get:function(){if(void 0===this._startLevel){var e=this.hls.config.startLevel;return void 0!==e?e:this.hls.firstAutoLevel}return this._startLevel},set:function(e){this._startLevel=e}},{key:"pathways",get:function(){return this.steering?this.steering.pathways():[]}},{key:"pathwayPriority",get:function(){return this.steering?this.steering.pathwayPriority:null},set:function(e){if(this.steering){var t=this.steering.pathways(),r=e.filter((function(e){return-1!==t.indexOf(e)}));if(e.length<1)return void this.warn("pathwayPriority ".concat(e," should contain at least one pathway from list: ").concat(t));this.steering.pathwayPriority=r}}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}}]),r}(Js);function xc(e){var t={};e.forEach((function(e){var r=e.groupId||"";e.id=t[r]=t[r]||0,t[r]++}))}function Bc(){return self.SourceBuffer||self.WebKitSourceBuffer}function Fc(){if(!br())return!1;var e=Bc();return!e||e.prototype&&"function"==typeof e.prototype.appendBuffer&&"function"==typeof e.prototype.remove}var Nc=function(e){c(r,e);var t=f(r);function r(e,n,i){var a;return h(this,r),(a=t.call(this,e,n,i,"stream-controller",ir)).audioCodecSwap=!1,a.level=-1,a._forceStartLoad=!1,a._hasEnoughToStart=!1,a.altAudio=0,a.audioOnly=!1,a.fragPlaying=null,a.fragLastKbps=0,a.couldBacktrack=!1,a.backtrackFragment=null,a.audioCodecSwitch=!1,a.videoBuffer=null,a.onMediaPlaying=function(){a.tick()},a.onMediaSeeked=function(){var e=a.media,t=e?e.currentTime:null;if(null!==t&&Wt(t)&&(a.log("Media seeked to ".concat(t.toFixed(3))),a.getBufferedFrag(t))){var r=a.getFwdBufferInfoAtPos(e,t,ir,0);null!==r&&0!==r.len?a.tick():a.warn("Main forward buffer length at ".concat(t,' on "seeked" event ').concat(r?r.len:"empty",")"))}},a.registerListeners(),a}return p(r,[{key:"registerListeners",value:function(){o(s(r.prototype),"registerListeners",this).call(this);var e=this.hls;e.on($t.MANIFEST_PARSED,this.onManifestParsed,this),e.on($t.LEVEL_LOADING,this.onLevelLoading,this),e.on($t.LEVEL_LOADED,this.onLevelLoaded,this),e.on($t.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on($t.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on($t.BUFFER_CREATED,this.onBufferCreated,this),e.on($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on($t.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"unregisterListeners",value:function(){o(s(r.prototype),"unregisterListeners",this).call(this);var e=this.hls;e.off($t.MANIFEST_PARSED,this.onManifestParsed,this),e.off($t.LEVEL_LOADED,this.onLevelLoaded,this),e.off($t.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off($t.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off($t.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off($t.BUFFER_CREATED,this.onBufferCreated,this),e.off($t.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off($t.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off($t.FRAG_BUFFERED,this.onFragBuffered,this)}},{key:"onHandlerDestroying",value:function(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),o(s(r.prototype),"onHandlerDestroying",this).call(this)}},{key:"startLoad",value:function(e,t){if(this.levels){var r=this.lastCurrentTime,n=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){var i=n.startLevel;-1===i&&(n.config.testBandwidth&&this.levels.length>1?(i=0,this.bitrateTest=!0):i=n.firstAutoLevel),n.nextLoadLevel=i,this.level=n.loadLevel,this._hasEnoughToStart=!!t}r>0&&-1===e&&!t&&(this.log("Override startPosition with lastCurrentTime @".concat(r.toFixed(3))),e=r),this.state=lo,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=so}},{key:"stopLoad",value:function(){this._forceStartLoad=!1,o(s(r.prototype),"stopLoad",this).call(this)}},{key:"doTick",value:function(){switch(this.state){case Ao:var e=this.levels,t=this.level,r=null==e?void 0:e[t],n=null==r?void 0:r.details;if(n&&(!n.live||this.levelLastLoaded===r&&!this.waitForLive(r))){if(this.waitForCdnTuneIn(n))break;this.state=lo;break}if(this.hls.nextLoadLevel!==this.level){this.state=lo;break}break;case fo:this.checkRetryDate()}this.state===lo&&this.doTickIdle(),this.onTickEnd()}},{key:"onTickEnd",value:function(){var e;o(s(r.prototype),"onTickEnd",this).call(this),null!=(e=this.media)&&e.readyState&&!1===this.media.seeking&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}},{key:"doTickIdle",value:function(){var e=this.hls,t=this.levelLastLoaded,r=this.levels,n=this.media;if(null!==t&&(n||this.primaryPrefetch||!this.startFragRequested&&e.config.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)){var i=this.buffering?e.nextLoadLevel:e.loadLevel;if(null!=r&&r[i]){var a=r[i],o=this.getMainFwdBufferInfo();if(null!==o){var s=this.getLevelDetails();if(s&&this._streamEnded(o,s)){var l={};return 2===this.altAudio&&(l.type="video"),this.hls.trigger($t.BUFFER_EOS,l),void(this.state=vo)}if(this.buffering){e.loadLevel!==i&&-1===e.manualLevel&&this.log("Adapting to level ".concat(i," from level ").concat(this.level)),this.level=e.nextLoadLevel=i;var u=a.details;if(!u||this.state===Ao||this.waitForLive(a))return this.level=i,this.state=Ao,void(this.startFragRequested=!1);var c=o.len,f=this.getMaxBufferLength(a.maxBitrate);if(!(c>=f)){this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);var d=this.backtrackFragment?this.backtrackFragment.start:o.end,h=this.getNextFragment(d,u);if(this.couldBacktrack&&!this.fragPrevious&&h&&Fr(h)&&this.fragmentTracker.getState(h)!==Si){var p,g=(null!=(p=this.backtrackFragment)?p:h).sn-u.startSN,v=u.fragments[g-1];v&&h.cc===v.cc&&(h=v,this.fragmentTracker.removeFragment(v))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(h&&this.isLoopLoading(h,d)){if(!h.gap){var y=this.audioOnly&&!this.altAudio?zr:Mr,m=(y===Mr?this.videoBuffer:this.mediaBuffer)||this.media;m&&this.afterBufferFlushed(m,y,ir)}h=this.getNextFragmentLoopLoading(h,u,o,ir,f)}h&&(!h.initSegment||h.initSegment.data||this.bitrateTest||(h=h.initSegment),this.loadFragment(h,a,d))}}}}}}},{key:"loadFragment",value:function(e,t,n){var i=this.fragmentTracker.getState(e);i===Ei||i===Ti?Fr(e)?this.bitrateTest?(this.log("Fragment ".concat(e.sn," of level ").concat(e.level," is being downloaded to test bitrate and will not be buffered")),this._loadBitrateTestFrag(e,t)):o(s(r.prototype),"loadFragment",this).call(this,e,t,n):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}},{key:"getBufferedFrag",value:function(e){return this.fragmentTracker.getBufferedFrag(e,ir)}},{key:"followingBufferedFrag",value:function(e){return e?this.getBufferedFrag(e.end+.5):null}},{key:"immediateLevelSwitch",value:function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}},{key:"nextLevelSwitch",value:function(){var e=this.levels,t=this.media;if(null!=t&&t.readyState){var r,n=this.getAppendedFrag(t.currentTime);n&&n.start>1&&this.flushMainBuffer(0,n.start-1);var i=this.getLevelDetails();if(null!=i&&i.live){var a=this.getMainFwdBufferInfo();if(!a||a.len<2*i.targetduration)return}if(!t.paused&&e){var o=e[this.hls.nextLoadLevel],s=this.fragLastKbps;r=s&&this.fragCurrent?this.fragCurrent.duration*o.maxBitrate/(1e3*s)+1:0}else r=0;var l=this.getBufferedFrag(t.currentTime+r);if(l){var u=this.followingBufferedFrag(l);if(u){this.abortCurrentFrag();var c=u.maxStartPTS?u.maxStartPTS:u.start,f=u.duration,d=Math.max(l.end,c+Math.min(Math.max(f-this.config.maxFragLookUpTolerance,f*(this.couldBacktrack?.5:.125)),f*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(d,Number.POSITIVE_INFINITY)}}}}},{key:"abortCurrentFrag",value:function(){var e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case uo:case co:case fo:case po:case go:this.state=lo}this.nextLoadPosition=this.getLoadPosition()}},{key:"flushMainBuffer",value:function(e,t){o(s(r.prototype),"flushMainBuffer",this).call(this,e,t,2===this.altAudio?"video":null)}},{key:"onMediaAttached",value:function(e,t){o(s(r.prototype),"onMediaAttached",this).call(this,e,t);var n=t.media;io(n,"playing",this.onMediaPlaying),io(n,"seeked",this.onMediaSeeked)}},{key:"onMediaDetaching",value:function(e,t){var n=this.media;n&&(ao(n,"playing",this.onMediaPlaying),ao(n,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,o(s(r.prototype),"onMediaDetaching",this).call(this,e,t),t.transferMedia||(this._hasEnoughToStart=!1)}},{key:"onManifestLoading",value:function(){o(s(r.prototype),"onManifestLoading",this).call(this),this.log("Trigger BUFFER_RESET"),this.hls.trigger($t.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}},{key:"onManifestParsed",value:function(e,t){for(var r=!1,n=!1,i=0;i<t.levels.length;i++){var a=t.levels[i].audioCodec;a&&(r=r||-1!==a.indexOf("mp4a.40.2"),n=n||-1!==a.indexOf("mp4a.40.5"))}this.audioCodecSwitch=r&&n&&!function(){var e,t=Bc();return"function"==typeof(null==t||null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}},{key:"onLevelLoading",value:function(e,t){if(this.levels&&this.state===lo){var r=t.levelInfo;(!r.details||r.details.live&&(this.levelLastLoaded!==r||r.details.expired)||this.waitForCdnTuneIn(r.details))&&(this.state=Ao)}}},{key:"onLevelLoaded",value:function(e,t){var r,n=this.levels,i=this.startFragRequested,a=t.level,o=t.details,s=o.totalduration;if(n){this.log("Level ".concat(a," loaded [").concat(o.startSN,",").concat(o.endSN,"]").concat(o.lastPartSn?"[part-".concat(o.lastPartSn,"-").concat(o.lastPartIndex,"]"):"",", cc [").concat(o.startCC,", ").concat(o.endCC,"] duration:").concat(s));var l=t.levelInfo,u=this.fragCurrent;!u||this.state!==co&&this.state!==fo||u.level!==t.level&&u.loader&&this.abortCurrentFrag();var c=0;if(o.live||null!=(r=l.details)&&r.live){var f;if(this.checkLiveUpdate(o),o.deltaUpdateFailed)return;c=this.alignPlaylists(o,l.details,null==(f=this.levelLastLoaded)?void 0:f.details)}if(l.details=o,this.levelLastLoaded=l,i||this.setStartPosition(o,c),this.hls.trigger($t.LEVEL_UPDATED,{details:o,level:a}),this.state===Ao){if(this.waitForCdnTuneIn(o))return;this.state=lo}i&&o.live&&this.synchronizeToLiveEdge(o),this.tick()}else this.warn("Levels were reset while loading level ".concat(a))}},{key:"synchronizeToLiveEdge",value:function(e){var t=this.config,r=this.media;if(r){var n=this.hls.liveSyncPosition,i=this.getLoadPosition(),a=e.fragmentStart,o=e.edge,s=i>=a-t.maxFragLookUpTolerance&&i<=o;if(null!==n&&r.duration>n&&(i<n||!s)){var l=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!s&&r.readyState<4||i<o-l)&&(this._hasEnoughToStart||(this.nextLoadPosition=n),r.readyState))if(this.warn("Playback: ".concat(i.toFixed(3)," is located too far from the end of live sliding playlist: ").concat(o,", reset currentTime to : ").concat(n.toFixed(3))),"buffered"===this.config.liveSyncMode){var u,c=Yi.bufferInfo(r,n,0);if(null==(u=c.buffered)||!u.length)return void(r.currentTime=n);if(c.start<=i)return void(r.currentTime=n);var f=Yi.bufferedInfo(c.buffered,i,0).nextStart;f&&(r.currentTime=f)}else r.currentTime=n}}}},{key:"_handleFragmentLoadProgress",value:function(e){var t,r=e.frag,n=e.part,i=e.payload,a=this.levels;if(a){var o=a[r.level];if(o){var s=o.details;if(!s)return this.warn("Dropping fragment ".concat(r.sn," of level ").concat(r.level," after level details were reset")),void this.fragmentTracker.removeFragment(r);var l=o.videoCodec,u=s.PTSKnown||!s.live,c=null==(t=r.initSegment)?void 0:t.data,f=this._getAudioCodec(o),d=this.transmuxer=this.transmuxer||new Xs(this.hls,ir,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),h=n?n.index:-1,p=-1!==h,g=new ji(r.level,r.sn,r.stats.chunkCount,i.byteLength,h,p),v=this.initPTS[r.cc];d.push(i,c,f,l,r,n,s.totalduration,u,g,v)}else this.warn("Level ".concat(r.level," not found on progress"))}else this.warn("Levels were reset while fragment load was in progress. Fragment ".concat(r.sn," of level ").concat(r.level," will not be buffered"))}},{key:"onAudioTrackSwitching",value:function(e,t){var r=this,n=this.hls,i=2===this.altAudio;if(Zn(t.url,n))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i)return this.fragmentTracker.removeAllFragments(),n.once($t.BUFFER_FLUSHED,(function(){r.hls&&r.hls.trigger($t.AUDIO_TRACK_SWITCHED,t)})),void n.trigger($t.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});n.trigger($t.AUDIO_TRACK_SWITCHED,t)}}},{key:"onAudioTrackSwitched",value:function(e,t){var r=Zn(t.url,this.hls);if(r){var n=this.videoBuffer;n&&this.mediaBuffer!==n&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=n)}this.altAudio=r?2:0,this.tick()}},{key:"onBufferCreated",value:function(e,t){var r,n,i=t.tracks,a=!1;for(var o in i){var s=i[o];if("main"===s.id){if(n=o,r=s,"video"===o){var l=i[o];l&&(this.videoBuffer=l.buffer)}}else a=!0}a&&r?(this.log("Alternate track found, use ".concat(n,".buffered to schedule main fragment loading")),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}},{key:"onFragBuffered",value:function(e,t){var r=t.frag,n=t.part,i=r.type===ir;if(i){if(this.fragContextChanged(r))return this.warn("Fragment ".concat(r.sn).concat(n?" p: "+n.index:""," of level ").concat(r.level," finished buffering, but was aborted. state: ").concat(this.state)),void(this.state===go&&(this.state=lo));var a=n?n.stats:r.stats;this.fragLastKbps=Math.round(8*a.total/(a.buffering.end-a.loading.first)),Fr(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,n)}var o=this.media;o&&(!this._hasEnoughToStart&&Yi.getBuffered(o).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),i&&this.tick())}},{key:"onError",value:function(e,t){var r;if(t.fatal)this.state=yo;else switch(t.details){case Zt.FRAG_GAP:case Zt.FRAG_PARSING_ERROR:case Zt.FRAG_DECRYPT_ERROR:case Zt.FRAG_LOAD_ERROR:case Zt.FRAG_LOAD_TIMEOUT:case Zt.KEY_LOAD_ERROR:case Zt.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ir,t);break;case Zt.LEVEL_LOAD_ERROR:case Zt.LEVEL_LOAD_TIMEOUT:case Zt.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ao||(null==(r=t.context)?void 0:r.type)!==tr||(this.state=lo);break;case Zt.BUFFER_ADD_CODEC_ERROR:case Zt.BUFFER_APPEND_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case Zt.BUFFER_FULL_ERROR:if("main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case Zt.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}},{key:"onFragLoadEmergencyAborted",value:function(){this.state=lo,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}},{key:"onBufferFlushed",value:function(e,t){var r=t.type;if(r!==zr||!this.altAudio){var n=(r===Mr?this.videoBuffer:this.mediaBuffer)||this.media;n&&(this.afterBufferFlushed(n,r,ir),this.tick())}}},{key:"onLevelsUpdated",value:function(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,-1===this.level&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}},{key:"swapAudioCodec",value:function(){this.audioCodecSwap=!this.audioCodecSwap}},{key:"seekToStartPos",value:function(){var e=this.media;if(e){var t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking)return void this.log("could not seek to ".concat(r,", already seeking at ").concat(t));var n=this.timelineOffset;n&&r&&(r+=n);var i=this.getLevelDetails(),a=Yi.getBuffered(e),o=a.length?a.start(0):0,s=o-r,l=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||s>0&&(s<l||this.loadingParts&&s<2*((null==i?void 0:i.partTarget)||0)))&&(this.log("adjusting start position by ".concat(s," to match buffer start")),r+=s,this.startPosition=r),t<r&&(this.log("seek to target start position ".concat(r," from current time ").concat(t," buffer start ").concat(o)),e.currentTime=r)}}}},{key:"_getAudioCodec",value:function(e){var t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}},{key:"_loadBitrateTestFrag",value:function(e,t){var r=this;e.bitrateTest=!0,this._doFragLoad(e,t).then((function(e){var n=r.hls,i=null==e?void 0:e.frag;if(i&&!r.fragContextChanged(i)){t.fragmentError=0,r.state=lo,r.startFragRequested=!1,r.bitrateTest=!1;var a=i.stats;a.parsing.start=a.parsing.end=a.buffering.start=a.buffering.end=self.performance.now(),n.trigger($t.FRAG_LOADED,e),i.bitrateTest=!1}})).catch((function(t){r.state!==so&&r.state!==yo&&(r.warn(t),r.resetFragmentLoading(e))}))}},{key:"_handleTransmuxComplete",value:function(e){var t=this.playlistType,r=this.hls,n=e.remuxResult,i=e.chunkMeta,a=this.getCurrentContext(i);if(a){var o=a.frag,s=a.part,l=a.level,u=n.video,c=n.text,f=n.id3,d=n.initSegment,h=l.details,p=this.altAudio?void 0:n.audio;if(this.fragContextChanged(o))this.fragmentTracker.removeFragment(o);else{if(this.state=po,d){var g=d.tracks;if(g){var v=o.initSegment||o;if(this.unhandledEncryptionError(d,o))return;this._bufferInitSegment(l,g,v,i),r.trigger($t.FRAG_PARSING_INIT_SEGMENT,{frag:v,id:t,tracks:g})}var y=d.initPTS,m=d.timescale,A=this.initPTS[o.cc];if(Wt(y)&&(!A||A.baseTime!==y||A.timescale!==m)){var b=d.trackId;this.initPTS[o.cc]={baseTime:y,timescale:m,trackId:b},r.trigger($t.INIT_PTS_FOUND,{frag:o,id:t,initPTS:y,timescale:m,trackId:b})}}if(u&&h){p&&"audiovideo"===u.type&&this.logMuxedErr(o);var E=h.fragments[o.sn-1-h.startSN],k=o.sn===h.startSN,T=!E||o.cc>E.cc;if(!1!==n.independent){var S=u.startPTS,w=u.endPTS,_=u.startDTS,L=u.endDTS;if(s)s.elementaryStreams[u.type]={startPTS:S,endPTS:w,startDTS:_,endDTS:L};else if(u.firstKeyFrame&&u.independent&&1===i.id&&!T&&(this.couldBacktrack=!0),u.dropped&&u.independent){var P=this.getMainFwdBufferInfo(),I=(P?P.end:this.getLoadPosition())+this.config.maxBufferHole,R=u.firstKeyFramePTS?u.firstKeyFramePTS:S;if(!k&&I<R-this.config.maxBufferHole&&!T)return void this.backtrack(o);T&&(o.gap=!0),o.setElementaryStreamInfo(u.type,o.start,w,o.start,L,!0)}else k&&S-(h.appliedTimelineOffset||0)>2&&(o.gap=!0);o.setElementaryStreamInfo(u.type,S,w,_,L),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(u,o,s,i,k||T)}else{if(!k&&!T)return void this.backtrack(o);o.gap=!0}}if(p){var C=p.startPTS,D=p.endPTS,O=p.startDTS,z=p.endDTS;s&&(s.elementaryStreams[zr]={startPTS:C,endPTS:D,startDTS:O,endDTS:z}),o.setElementaryStreamInfo(zr,C,D,O,z),this.bufferFragmentData(p,o,s,i)}if(h&&null!=f&&f.samples.length){var M={id:t,frag:o,details:h,samples:f.samples};r.trigger($t.FRAG_PARSING_METADATA,M)}if(h&&c){var x={id:t,frag:o,details:h,samples:c.samples};r.trigger($t.FRAG_PARSING_USERDATA,x)}}}else this.resetWhenMissingContext(i)}},{key:"logMuxedErr",value:function(e){this.warn("".concat(Fr(e)?"Media":"Init"," segment with muxed audiovideo where only video expected: ").concat(e.url))}},{key:"_bufferInitSegment",value:function(e,t,r,n){var i=this;if(this.state===po){this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));var a=t.audio,o=t.video,s=t.audiovideo;if(a){var l=e.audioCodec,u=Sn(a.codec,l);"mp4a"===u&&(u="mp4a.40.5");var c=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){u&&(u=-1!==u.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5");var f=a.metadata;f&&"channelCount"in f&&1!==(f.channelCount||1)&&-1===c.indexOf("firefox")&&(u="mp4a.40.5")}u&&-1!==u.indexOf("mp4a.40.5")&&-1!==c.indexOf("android")&&"audio/mpeg"!==a.container&&(u="mp4a.40.2",this.log("Android: force audio codec to ".concat(u))),l&&l!==u&&this.log('Swapping manifest audio codec "'.concat(l,'" for "').concat(u,'"')),a.levelCodec=u,a.id=ir,this.log("Init audio buffer, container:".concat(a.container,", codecs[selected/level/parsed]=[").concat(u||"","/").concat(l||"","/").concat(a.codec,"]")),delete t.audiovideo}if(o){o.levelCodec=e.videoCodec,o.id=ir;var d=o.codec;if(4===(null==d?void 0:d.length))switch(d){case"hvc1":case"hev1":o.codec="hvc1.1.6.L120.90";break;case"av01":o.codec="av01.0.04M.08";break;case"avc1":o.codec="avc1.42e01e"}this.log("Init video buffer, container:".concat(o.container,", codecs[level/parsed]=[").concat(e.videoCodec||"","/").concat(d,"]").concat(o.codec!==d?" parsed-corrected="+o.codec:"").concat(o.supplemental?" supplemental="+o.supplemental:"")),delete t.audiovideo}s&&(this.log("Init audiovideo buffer, container:".concat(s.container,", codecs[level/parsed]=[").concat(e.codecs,"/").concat(s.codec,"]")),delete t.video,delete t.audio);var h=Object.keys(t);if(h.length){if(this.hls.trigger($t.BUFFER_CODECS,t),!this.hls)return;h.forEach((function(e){var a=t[e].initSegment;null!=a&&a.byteLength&&i.hls.trigger($t.BUFFER_APPENDING,{type:e,data:a,frag:r,part:null,chunkMeta:n,parent:r.type})}))}this.tickImmediate()}}},{key:"getMainFwdBufferInfo",value:function(){var e=this.mediaBuffer&&2===this.altAudio?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,ir)}},{key:"backtrack",value:function(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=lo}},{key:"checkFragmentChanged",value:function(){var e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){var r=e.currentTime;if(Yi.isBuffered(e,r)?t=this.getAppendedFrag(r):Yi.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;var n=this.fragPlaying,i=t.level;n&&t.sn===n.sn&&n.level===i||(this.fragPlaying=t,this.hls.trigger($t.FRAG_CHANGED,{frag:t}),n&&n.level===i||this.hls.trigger($t.LEVEL_SWITCHED,{level:i}))}}}},{key:"hasEnoughToStart",get:function(){return this._hasEnoughToStart}},{key:"maxBufferLength",get:function(){var e=this.levels,t=this.level,r=null==e?void 0:e[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}},{key:"nextLevel",get:function(){var e=this.nextBufferedFrag;return e?e.level:-1}},{key:"currentFrag",get:function(){var e;if(this.fragPlaying)return this.fragPlaying;var t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;return Wt(t)?this.getAppendedFrag(t):null}},{key:"currentProgramDateTime",get:function(){var e,t=(null==(e=this.media)?void 0:e.currentTime)||this.lastCurrentTime;if(Wt(t)){var r=this.getLevelDetails(),n=this.currentFrag||(r?ei(null,r.fragments,t):null);if(n){var i=n.programDateTime;if(null!==i){var a=i+1e3*(t-n.start);return new Date(a)}}}return null}},{key:"currentLevel",get:function(){var e=this.currentFrag;return e?e.level:-1}},{key:"nextBufferedFrag",get:function(){var e=this.currentFrag;return e?this.followingBufferedFrag(e):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),r}(bo),Uc=function(e){c(r,e);var t=f(r);function r(e,n){var i;return h(this,r),(i=t.call(this,"key-loader",n)).config=void 0,i.keyIdToKeyInfo={},i.emeController=null,i.config=e,i}return p(r,[{key:"abort",value:function(e){for(var t in this.keyIdToKeyInfo){var r=this.keyIdToKeyInfo[t].loader;if(r){var n;if(e&&e!==(null==(n=r.context)?void 0:n.frag.type))return;r.abort()}}}},{key:"detach",value:function(){for(var e in this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}},{key:"destroy",value:function(){for(var e in this.detach(),this.keyIdToKeyInfo){var t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}},{key:"createKeyLoadError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Zt.KEY_LOAD_ERROR,r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0;return new Ni({type:Jt.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:i,error:r,networkDetails:n})}},{key:"loadClear",value:function(e,t,r){var n=this;if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(var i=function(i,a){var o=t[i];if(e.cc<=o.cc&&(!Fr(e)||!Fr(o)||e.sn<o.sn)||!r&&i==a-1)return{v:n.emeController.selectKeySystemFormat(o).then((function(e){if(n.emeController){o.setKeyFormat(e);var t=ga(e);return t?n.emeController.getKeySystemAccess([t]):void 0}}))}},a=0,o=t.length;a<o;a++){var s=i(a,o);if("object"===typeof s)return s.v}if(this.config.requireKeySystemAccessOnStart){var l=ya(this.config);if(l.length)return this.emeController.getKeySystemAccess(l)}}return null}},{key:"load",value:function(e){var t=this;return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then((function(r){return t.loadInternal(e,r)})):this.loadInternal(e)}},{key:"loadInternal",value:function(e,t){var r,n;t&&e.setKeyFormat(t);var i=e.decryptdata;if(!i){var a=new Error(t?"Expected frag.decryptdata to be defined after setting format ".concat(t):"Missing decryption data on fragment in onKeyLoading (emeEnabled with controller: ".concat(this.emeController&&this.config.emeEnabled,")"));return Promise.reject(this.createKeyLoadError(e,Zt.KEY_LOAD_ERROR,a))}var o=i.uri;if(!o)return Promise.reject(this.createKeyLoadError(e,Zt.KEY_LOAD_ERROR,new Error('Invalid key URI: "'.concat(o,'"'))));var s=jc(i),l=this.keyIdToKeyInfo[s];if(null!=(r=l)&&r.decryptdata.key)return i.key=l.decryptdata.key,Promise.resolve({frag:e,keyInfo:l});if(this.emeController&&null!=(n=l)&&n.keyLoadPromise)switch(this.emeController.getKeyStatus(l.decryptdata)){case"usable":case"usable-in-future":return l.keyLoadPromise.then((function(t){var r=t.keyInfo;return i.key=r.decryptdata.key,{frag:e,keyInfo:r}}))}switch(this.log("".concat(this.keyIdToKeyInfo[s]?"Rel":"L","oading").concat(i.keyId?" keyId: "+Tr(i.keyId):""," URI: ").concat(i.uri," from ").concat(e.type," ").concat(e.level)),l=this.keyIdToKeyInfo[s]={decryptdata:i,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},i.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return"identity"===i.keyFormat?this.loadKeyHTTP(l,e):this.loadKeyEME(l,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(l,e);default:return Promise.reject(this.createKeyLoadError(e,Zt.KEY_LOAD_ERROR,new Error('Key supplied with unsupported METHOD: "'.concat(i.method,'"'))))}}},{key:"loadKeyEME",value:function(e,t){var r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){var n;if(!e.decryptdata.keyId&&null!=(n=t.initSegment)&&n.data){var i=function(e){var t=[];return nn(e,(function(e){return t.push(e.subarray(8,24))})),t}(t.initSegment.data);if(i.length){var a=i[0];a.some((function(e){return 0!==e}))&&(this.log("Using keyId found in init segment ".concat(Tr(a))),e.decryptdata.keyId=a,ka.setKeyIdForUri(e.decryptdata.uri,a))}}var o=this.emeController.loadKey(r);return(e.keyLoadPromise=o.then((function(t){return e.mediaKeySessionContext=t,r}))).catch((function(r){throw e.keyLoadPromise=null,"data"in r&&(r.data.frag=t),r}))}return Promise.resolve(r)}},{key:"loadKeyHTTP",value:function(e,t){var r=this,n=this.config,i=new(0,n.loader)(n);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((function(a,o){var s={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},l=n.keyLoadPolicy.default,u={loadPolicy:l,timeout:l.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0},c={onSuccess:function(e,t,n,i){var s=n.frag,l=n.keyInfo,u=jc(l.decryptdata);if(!s.decryptdata||l!==r.keyIdToKeyInfo[u])return o(r.createKeyLoadError(s,Zt.KEY_LOAD_ERROR,new Error("after key load, decryptdata unset or changed"),i));l.decryptdata.key=s.decryptdata.key=new Uint8Array(e.data),s.keyLoader=null,l.loader=null,a({frag:s,keyInfo:l})},onError:function(e,n,i,a){r.resetLoader(n),o(r.createKeyLoadError(t,Zt.KEY_LOAD_ERROR,new Error("HTTP Error ".concat(e.code," loading key ").concat(e.text)),i,dr({url:s.url,data:void 0},e)))},onTimeout:function(e,n,i){r.resetLoader(n),o(r.createKeyLoadError(t,Zt.KEY_LOAD_TIMEOUT,new Error("key loading timed out"),i))},onAbort:function(e,n,i){r.resetLoader(n),o(r.createKeyLoadError(t,Zt.INTERNAL_ABORTED,new Error("key loading aborted"),i))}};i.load(s,u,c)}))}},{key:"resetLoader",value:function(e){var t=e.frag,r=e.keyInfo,n=e.url,i=r.loader;t.keyLoader===i&&(t.keyLoader=null,r.loader=null);var a=jc(r.decryptdata)||n;delete this.keyIdToKeyInfo[a],i&&i.destroy()}}]),r}(hr);function jc(e){if(e.keyFormat!==da){var t=e.keyId;if(t)return Tr(t)}return e.uri}function Gc(e){switch(e.type){case rr:return ar;case nr:return or;default:return ir}}function Yc(e,t){var r=e.url;return void 0!==r&&0!==r.indexOf("data:")||(r=t.url),r}var Vc=function(){function e(t){h(this,e),this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=t,this.registerListeners()}return p(e,[{key:"startLoad",value:function(e){}},{key:"stopLoad",value:function(){this.destroyInternalLoaders()}},{key:"registerListeners",value:function(){var e=this.hls;e.on($t.MANIFEST_LOADING,this.onManifestLoading,this),e.on($t.LEVEL_LOADING,this.onLevelLoading,this),e.on($t.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on($t.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on($t.LEVELS_UPDATED,this.onLevelsUpdated,this)}},{key:"unregisterListeners",value:function(){var e=this.hls;e.off($t.MANIFEST_LOADING,this.onManifestLoading,this),e.off($t.LEVEL_LOADING,this.onLevelLoading,this),e.off($t.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off($t.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off($t.LEVELS_UPDATED,this.onLevelsUpdated,this)}},{key:"createInternalLoader",value:function(e){var t=this.hls.config,r=t.pLoader,n=t.loader,i=new(r||n)(t);return this.loaders[e.type]=i,i}},{key:"getInternalLoader",value:function(e){return this.loaders[e.type]}},{key:"resetInternalLoader",value:function(e){this.loaders[e]&&delete this.loaders[e]}},{key:"destroyInternalLoaders",value:function(){for(var e in this.loaders){var t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}},{key:"destroy",value:function(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}},{key:"onManifestLoading",value:function(e,t){var r=t.url;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:er,url:r,deliveryDirectives:null,levelOrTrack:null})}},{key:"onLevelLoading",value:function(e,t){var r=t.id,n=t.level,i=t.pathwayId,a=t.url,o=t.deliveryDirectives,s=t.levelInfo;this.load({id:r,level:n,pathwayId:i,responseType:"text",type:tr,url:a,deliveryDirectives:o,levelOrTrack:s})}},{key:"onAudioTrackLoading",value:function(e,t){var r=t.id,n=t.groupId,i=t.url,a=t.deliveryDirectives,o=t.track;this.load({id:r,groupId:n,level:null,responseType:"text",type:rr,url:i,deliveryDirectives:a,levelOrTrack:o})}},{key:"onSubtitleTrackLoading",value:function(e,t){var r=t.id,n=t.groupId,i=t.url,a=t.deliveryDirectives,o=t.track;this.load({id:r,groupId:n,level:null,responseType:"text",type:nr,url:i,deliveryDirectives:a,levelOrTrack:o})}},{key:"onLevelsUpdated",value:function(e,t){var r=this.loaders[tr];if(r){var n=r.context;n&&!t.levels.some((function(e){return e===n.levelOrTrack}))&&(r.abort(),delete this.loaders[tr])}}},{key:"load",value:function(e){var t,r,n,i=this,a=this.hls.config,o=this.getInternalLoader(e);if(o){var s=this.hls.logger,l=o.context;if(l&&l.levelOrTrack===e.levelOrTrack&&(l.url===e.url||l.deliveryDirectives&&!e.deliveryDirectives))return void(l.url===e.url?s.log("[playlist-loader]: ignore ".concat(e.url," ongoing request")):s.log("[playlist-loader]: ignore ".concat(e.url," in favor of ").concat(l.url)));s.log("[playlist-loader]: aborting previous loader for type: ".concat(e.type)),o.abort()}if(r=e.type===er?a.manifestLoadPolicy.default:cr({},a.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),o=this.createInternalLoader(e),Wt(null==(t=e.deliveryDirectives)?void 0:t.part)&&(e.type===tr&&null!==e.level?n=this.hls.levels[e.level].details:e.type===rr&&null!==e.id?n=this.hls.audioTracks[e.id].details:e.type===nr&&null!==e.id&&(n=this.hls.subtitleTracks[e.id].details),n)){var u=n.partTarget,c=n.targetduration;if(u&&c){var f=1e3*Math.max(3*u,.8*c);r=cr({},r,{maxTimeToFirstByteMs:Math.min(f,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(f,r.maxTimeToFirstByteMs)})}}var d=r.errorRetry||r.timeoutRetry||{},h={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:d.maxNumRetry||0,retryDelay:d.retryDelayMs||0,maxRetryDelay:d.maxRetryDelayMs||0},p={onSuccess:function(e,t,r,n){var a=i.getInternalLoader(r);i.resetInternalLoader(r.type);var o=e.data;t.parsing.start=performance.now(),Ia.isMediaPlaylist(o)||r.type!==er?i.handleTrackOrLevelPlaylist(e,t,r,n||null,a):i.handleMasterPlaylist(e,t,r,n)},onError:function(e,t,r,n){i.handleNetworkError(t,r,!1,e,n)},onTimeout:function(e,t,r){i.handleNetworkError(t,r,!0,void 0,e)}};o.load(e,h,p)}},{key:"checkAutostartLoad",value:function(){if(this.hls){var e=this.hls,t=e.config,r=t.autoStartLoad,n=t.startPosition,i=e.forceStartLoad;(r||i)&&(this.hls.logger.log("".concat(r?"auto":"force"," startLoad with configured startPosition ").concat(n)),this.hls.startLoad(n))}}},{key:"handleMasterPlaylist",value:function(e,t,r,n){var i=this,a=this.hls,o=e.data,s=Yc(e,r),l=Ia.parseMasterPlaylist(o,s);if(l.playlistParsingError)return t.parsing.end=performance.now(),void this.handleManifestParsingError(e,r,l.playlistParsingError,n,t);var u=l.contentSteering,c=l.levels,f=l.sessionData,d=l.sessionKeys,h=l.startTimeOffset,p=l.variableList;this.variableList=p,c.forEach((function(e){var t=e.unknownCodecs;if(t)for(var r=i.hls.config.preferManagedMediaSource,n=e.audioCodec,a=e.videoCodec,o=t.length;o--;){var s=t[o];vn(s,"audio",r)?(e.audioCodec=n=n?"".concat(n,",").concat(s):s,pn.audio[n.substring(0,4)]=2,t.splice(o,1)):vn(s,"video",r)&&(e.videoCodec=a=a?"".concat(a,",").concat(s):s,pn.video[a.substring(0,4)]=2,t.splice(o,1))}}));var g=Ia.parseMasterPlaylistMedia(o,s,l),v=g.AUDIO,y=void 0===v?[]:v,m=g.SUBTITLES,A=g["CLOSED-CAPTIONS"];y.length&&(y.some((function(e){return!e.url}))||!c[0].audioCodec||c[0].attrs.AUDIO||(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),y.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new Ji({}),bitrate:0,url:""}))),a.trigger($t.MANIFEST_LOADED,{levels:c,audioTracks:y,subtitles:m,captions:A,contentSteering:u,url:s,stats:t,networkDetails:n,sessionData:f,sessionKeys:d,startTimeOffset:h,variableList:p})}},{key:"handleTrackOrLevelPlaylist",value:function(e,t,r,n,i){var a=this.hls,o=r.id,s=r.level,l=r.type,u=Yc(e,r),c=Wt(s)?s:Wt(o)?o:0,f=Gc(r),d=Ia.parseLevelPlaylist(e.data,u,c,f,0,this.variableList);if(l===er){var h={attrs:new Ji({}),bitrate:0,details:d,name:"",url:u};d.requestScheduled=t.loading.start+Ka(d,0),a.trigger($t.MANIFEST_LOADED,{levels:[h],audioTracks:[],url:u,stats:t,networkDetails:n,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=d,this.handlePlaylistLoaded(d,e,t,r,n,i)}},{key:"handleManifestParsingError",value:function(e,t,r,n,i){this.hls.trigger($t.ERROR,{type:Jt.NETWORK_ERROR,details:Zt.MANIFEST_PARSING_ERROR,fatal:t.type===er,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:n,stats:i})}},{key:"handleNetworkError",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a="A network ".concat(r?"timeout":"error"+(n?" (status "+n.code+")":"")," occurred while loading ").concat(e.type);e.type===tr?a+=": ".concat(e.level," id: ").concat(e.id):e.type!==rr&&e.type!==nr||(a+=" id: ".concat(e.id,' group-id: "').concat(e.groupId,'"'));var o=new Error(a);this.hls.logger.warn("[playlist-loader]: ".concat(a));var s=Zt.UNKNOWN,l=!1,u=this.getInternalLoader(e);switch(e.type){case er:s=r?Zt.MANIFEST_LOAD_TIMEOUT:Zt.MANIFEST_LOAD_ERROR,l=!0;break;case tr:s=r?Zt.LEVEL_LOAD_TIMEOUT:Zt.LEVEL_LOAD_ERROR,l=!1;break;case rr:s=r?Zt.AUDIO_TRACK_LOAD_TIMEOUT:Zt.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case nr:s=r?Zt.SUBTITLE_TRACK_LOAD_TIMEOUT:Zt.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);var c={type:Jt.NETWORK_ERROR,details:s,fatal:l,url:e.url,loader:u,context:e,error:o,networkDetails:t,stats:i};if(n){var f=(null==t?void 0:t.url)||e.url;c.response=dr({url:f,data:void 0},n)}this.hls.trigger($t.ERROR,c)}},{key:"handlePlaylistLoaded",value:function(e,t,r,n,i,a){var o=this.hls,s=n.type,l=n.level,u=n.levelOrTrack,c=n.id,f=n.groupId,d=n.deliveryDirectives,h=Yc(t,n),p=Gc(n),g="number"==typeof n.level&&p===ir?l:void 0,v=e.playlistParsingError;if(v){if(this.hls.logger.warn("".concat(v," ").concat(e.url)),!o.config.ignorePlaylistParsingErrors)return void o.trigger($t.ERROR,{type:Jt.NETWORK_ERROR,details:Zt.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:v,reason:v.message,response:t,context:n,level:g,parent:p,networkDetails:i,stats:r});e.playlistParsingError=null}if(e.fragments.length)switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),a.getCacheAge&&!isNaN(e.ageHeader)||(e.ageHeader=0)),s){case er:case tr:if(g)if(u){if(u!==o.levels[g]){var y=o.levels.indexOf(u);y>-1&&(g=y)}}else g=0;o.trigger($t.LEVEL_LOADED,{details:e,levelInfo:u||o.levels[0],level:g||0,id:c||0,stats:r,networkDetails:i,deliveryDirectives:d,withoutMultiVariant:s===er});break;case rr:o.trigger($t.AUDIO_TRACK_LOADED,{details:e,track:u,id:c||0,groupId:f||"",stats:r,networkDetails:i,deliveryDirectives:d});break;case nr:o.trigger($t.SUBTITLE_TRACK_LOADED,{details:e,track:u,id:c||0,groupId:f||"",stats:r,networkDetails:i,deliveryDirectives:d})}else{var m=e.playlistParsingError=new Error("No Segments found in Playlist");o.trigger($t.ERROR,{type:Jt.NETWORK_ERROR,details:Zt.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:n,level:g,parent:p,networkDetails:i,stats:r})}}}]),e}(),Hc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};h(this,e),this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new wo,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;var r=this.logger=function(e,t,r){var n=vr();if("object"==typeof console&&!0===e||"object"==typeof e){var i=["debug","log","info","warn","error"];i.forEach((function(t){n[t]=yr(t,e,r)}));try{n.log('Debug logs enabled for "'.concat("Hls instance",'" in hls.js version 1.6.13'))}catch(e){return vr()}i.forEach((function(t){mr[t]=yr(t,e)}))}else cr(mr,n);return n}(t.debug||!1,0,t.assetPlayerId),n=this.config=function(e,t,r){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');var n=Sc(e),i=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach((function(e){var a="".concat("level"===e?"playlist":e,"LoadPolicy"),o=void 0===t[a],s=[];i.forEach((function(r){var i="".concat(e,"Loading").concat(r),l=t[i];if(void 0!==l&&o){s.push(i);var u=n[a].default;switch(t[a]={default:u},r){case"TimeOut":u.maxLoadTimeMs=l,u.maxTimeToFirstByteMs=l;break;case"MaxRetry":u.errorRetry.maxNumRetry=l,u.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":u.errorRetry.retryDelayMs=l,u.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":u.errorRetry.maxRetryDelayMs=l,u.timeoutRetry.maxRetryDelayMs=l}}})),s.length&&r.warn('hls.js config: "'.concat(s.join('", "'),'" setting(s) are deprecated, use "').concat(a,'": ').concat(Vn(t[a])))})),dr(dr({},n),t)}(e.DefaultConfig,t,r);this.userConfig=t,n.progressive&&wc(n,r);var i=n.abrController,a=n.bufferController,o=n.capLevelController,s=n.errorController,l=n.fpsController,u=new s(this),c=this.abrController=new i(this),f=new wi(this),d=n.interstitialsController,p=d?this.interstitialsController=new d(this,e):null,g=this.bufferController=new a(this,f),v=this.capLevelController=new o(this),y=new l(this),m=new Vc(this),A=n.contentSteeringController,b=A?new A(this):null,E=this.levelController=new Mc(this,b),k=new Oc(this),T=new Uc(this.config,this.logger),S=this.streamController=new Nc(this,f,T),w=this.gapController=new _c(this,f);v.setStreamController(S),y.setStreamController(S);var _=[m,E,S];p&&_.splice(1,0,p),b&&_.splice(1,0,b),this.networkControllers=_;var L=[c,g,w,v,y,k,f];this.audioTrackController=this.createController(n.audioTrackController,_);var P=n.audioStreamController;P&&_.push(this.audioStreamController=new P(this,f,T)),this.subtitleTrackController=this.createController(n.subtitleTrackController,_);var I=n.subtitleStreamController;I&&_.push(this.subtititleStreamController=new I(this,f,T)),this.createController(n.timelineController,L),T.emeController=this.emeController=this.createController(n.emeController,L),this.cmcdController=this.createController(n.cmcdController,L),this.latencyController=this.createController(zc,L),this.coreComponents=L,_.push(u);var R=u.onErrorOut;"function"==typeof R&&this.on($t.ERROR,R,u),this.on($t.MANIFEST_LOADED,m.onManifestLoaded,m)}return p(e,null,[{key:"isMSESupported",value:function(){return Fc()}},{key:"isSupported",value:function(){return function(){if(!Fc())return!1;var e=br();return"function"==typeof(null==e?void 0:e.isTypeSupported)&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some((function(t){return e.isTypeSupported(mn(t,"video"))}))||["mp4a.40.2","fLaC"].some((function(t){return e.isTypeSupported(mn(t,"audio"))})))}()}},{key:"getMediaSource",value:function(){return br()}},{key:"version",get:function(){return _o}},{key:"Events",get:function(){return $t}},{key:"MetadataSchema",get:function(){return Wo}},{key:"ErrorTypes",get:function(){return Jt}},{key:"ErrorDetails",get:function(){return Zt}},{key:"DefaultConfig",get:function(){return e.defaultConfig?e.defaultConfig:Tc},set:function(t){e.defaultConfig=t}}]),p(e,[{key:"createController",value:function(e,t){if(e){var r=new e(this);return t&&t.push(r),r}return null}},{key:"on",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.on(e,t,r)}},{key:"once",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;this._emitter.once(e,t,r)}},{key:"removeAllListeners",value:function(e){this._emitter.removeAllListeners(e)}},{key:"off",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,n=arguments.length>3?arguments[3]:void 0;this._emitter.off(e,t,r,n)}},{key:"listeners",value:function(e){return this._emitter.listeners(e)}},{key:"emit",value:function(e,t,r){return this._emitter.emit(e,t,r)}},{key:"trigger",value:function(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),!this.triggeringException){this.triggeringException=!0;var r=e===$t.ERROR;this.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.INTERNAL_EXCEPTION,fatal:r,event:e,error:t}),this.triggeringException=!1}}return!1}},{key:"listenerCount",value:function(e){return this._emitter.listenerCount(e)}},{key:"destroy",value:function(){this.logger.log("destroy"),this.trigger($t.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach((function(e){return e.destroy()})),this.networkControllers.length=0,this.coreComponents.forEach((function(e){return e.destroy()})),this.coreComponents.length=0;var e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}},{key:"attachMedia",value:function(e){if(!e||"media"in e&&!e.media){var t=new Error("attachMedia failed: invalid argument (".concat(e,")"));this.trigger($t.ERROR,{type:Jt.OTHER_ERROR,details:Zt.ATTACH_MEDIA_ERROR,fatal:!0,error:t})}else{this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());var r="media"in e,n=r?e.media:e,i=r?e:{media:n};this._media=n,this.trigger($t.MEDIA_ATTACHING,i)}}},{key:"detachMedia",value:function(){this.logger.log("detachMedia"),this.trigger($t.MEDIA_DETACHING,{}),this._media=null}},{key:"transferMedia",value:function(){this._media=null;var e=this.bufferController.transferMedia();return this.trigger($t.MEDIA_DETACHING,{transferMedia:e}),e}},{key:"loadSource",value:function(e){this.stopLoad();var t=this.media,r=this._url,n=this._url=Dr.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log("loadSource:".concat(n)),t&&r&&(r!==n||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger($t.MANIFEST_LOADING,{url:e})}},{key:"startLoad",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1?arguments[1]:void 0;this.logger.log("startLoad(".concat(e+(t?", <skip seek to start>":""),")")),this.started=!0,this.resumeBuffering();for(var r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),this.started&&this.networkControllers);r++);}},{key:"stopLoad",value:function(){this.logger.log("stopLoad"),this.started=!1;for(var e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}},{key:"resumeBuffering",value:function(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach((function(e){e.resumeBuffering&&e.resumeBuffering()})))}},{key:"pauseBuffering",value:function(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach((function(e){e.pauseBuffering&&e.pauseBuffering()})))}},{key:"swapAudioCodec",value:function(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}},{key:"recoverMediaError",value:function(){this.logger.log("recoverMediaError");var e=this._media,t=null==e?void 0:e.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}},{key:"removeLevel",value:function(e){this.levelController.removeLevel(e)}},{key:"setAudioOption",value:function(e){var t;return(null==(t=this.audioTrackController)?void 0:t.setAudioOption(e))||null}},{key:"setSubtitleOption",value:function(e){var t;return(null==(t=this.subtitleTrackController)?void 0:t.setSubtitleOption(e))||null}},{key:"getMediaDecodingInfo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.allAudioTracks;return Dn(e,Kn(t),navigator.mediaCapabilities)}},{key:"url",get:function(){return this._url}},{key:"hasEnoughToStart",get:function(){return this.streamController.hasEnoughToStart}},{key:"startPosition",get:function(){return this.streamController.startPositionValue}},{key:"loadingEnabled",get:function(){return this.started}},{key:"bufferingEnabled",get:function(){return this.streamController.bufferingEnabled}},{key:"inFlightFragments",get:function(){var e=d({},ir,this.streamController.inFlightFrag);return this.audioStreamController&&(e[ar]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[or]=this.subtititleStreamController.inFlightFrag),e}},{key:"sessionId",get:function(){var e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch(e){try{var t=URL.createObjectURL(new Blob),r=t.toString();return URL.revokeObjectURL(t),r.slice(r.lastIndexOf("/")+1)}catch(e){var n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=(n+16*Math.random())%16|0;return n=Math.floor(n/16),("x"==e?t:3&t|8).toString(16)}))}}}()),e}},{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"latestLevelDetails",get:function(){return this.streamController.getLevelDetails()||null}},{key:"loadLevelObj",get:function(){return this.levelController.loadLevelObj}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(e){this.logger.log("set currentLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(e){this.logger.log("set nextLevel:".concat(e)),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(e){this.logger.log("set loadLevel:".concat(e)),this.levelController.manualLevel=e}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(e){this.levelController.nextLoadLevel=e}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(e){this.logger.log("set firstLevel:".concat(e)),this.levelController.firstLevel=e}},{key:"startLevel",get:function(){var e=this.levelController.startLevel;return-1===e&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e},set:function(e){this.logger.log("set startLevel:".concat(e)),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(e){var t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(e){this._autoLevelCapping!==e&&(this.logger.log("set autoLevelCapping:".concat(e)),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}},{key:"bandwidthEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimate():NaN},set:function(e){this.abrController.resetEstimator(e)}},{key:"abrEwmaDefaultEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.defaultEstimate:NaN}},{key:"ttfbEstimate",get:function(){var e=this.abrController.bwEstimator;return e?e.getEstimateTTFB():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(e){(function(e){return Mn.indexOf(e)>-1})(e)&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var e=this.levels,t=this.config.minAutoBitrate;if(!e)return 0;for(var r=e.length,n=0;n<r;n++)if(e[n].maxBitrate>=t)return n;return 0}},{key:"maxAutoLevel",get:function(){var e,t=this.levels,r=this.autoLevelCapping,n=this.maxHdcpLevel;if(e=-1===r&&null!=t&&t.length?t.length-1:r,n)for(var i=e;i--;){var a=t[i].attrs["HDCP-LEVEL"];if(a&&a<=n)return i}return e}},{key:"firstAutoLevel",get:function(){return this.abrController.firstAutoLevel}},{key:"nextAutoLevel",get:function(){return this.abrController.nextAutoLevel},set:function(e){this.abrController.nextAutoLevel=e}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"maxBufferLength",get:function(){return this.streamController.maxBufferLength}},{key:"allAudioTracks",get:function(){var e=this.audioTrackController;return e?e.allAudioTracks:[]}},{key:"audioTracks",get:function(){var e=this.audioTrackController;return e?e.audioTracks:[]}},{key:"audioTrack",get:function(){var e=this.audioTrackController;return e?e.audioTrack:-1},set:function(e){var t=this.audioTrackController;t&&(t.audioTrack=e)}},{key:"allSubtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}},{key:"subtitleTracks",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var e=this.subtitleTrackController;return e?e.subtitleTrack:-1},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var e=this.subtitleTrackController;return!!e&&e.subtitleDisplay},set:function(e){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(e){this.config.lowLatencyMode=e}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency},set:function(e){this.latencyController.targetLatency=e}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}},{key:"pathways",get:function(){return this.levelController.pathways}},{key:"pathwayPriority",get:function(){return this.levelController.pathwayPriority},set:function(e){this.levelController.pathwayPriority=e}},{key:"bufferedToEnd",get:function(){var e;return!(null==(e=this.bufferController)||!e.bufferedToEnd)}},{key:"interstitialsManager",get:function(){var e;return(null==(e=this.interstitialsController)?void 0:e.interstitialsManager)||null}}]),e}();function Kc(e){return(Kc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qc(e,t,r){return(Qc="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Wc(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Wc(e){return(Wc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function qc(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Xc(e,t,r){return t&&qc(e.prototype,t),r&&qc(e,r),e}function Jc(e,t){return(Jc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zc(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}Hc.defaultConfig=void 0;var $c={startLevel:-1},ef=function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return n=this,(r=!(i=(e=Wc(t)).call.apply(e,[this].concat(o)))||"object"!==Kc(i)&&"function"!=typeof i?Zc(n):i)._config={hls:ne(r.options,"playback.hls")||$c,recoverMaxRetry:ne(r.options,"playback.hls.recoverMaxRetry")||16},r._recoverRetry=0,r._recoveredMediaError=!1,r._playbackType=ot.VOD,r._onHLSJSError=r._onHLSJSError.bind(Zc(Zc(r))),r._initHls(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Jc(e,t)}(t,Bt),Xc(t,[{key:"name",get:function(){return"hls"}},{key:"tagName",get:function(){return this.isAudioOnly?"audio":"video"}},{key:"levels",get:function(){return this._levels||[]}},{key:"currentLevel",get:function(){return null===this._currentLevel||void 0===this._currentLevel?-1:this._currentLevel},set:function(e){var t=this;this.playPromise&&this.playPromise.then((function(){t._currentLevel=e,t._hls&&(t._hls.currentLevel=t._currentLevel)}))}},{key:"startLevel",set:function(e){var t=this;this.playPromise&&this.playPromise.then((function(){t._startLevel=e,t._hls&&(t._hls.startLevel=t._startLevel)}))},get:function(){return this._startLevel}}],[{key:"canPlay",value:function(e,t){var r=e.split("?")[0].match(/.*\.(.*)$/)||[];return(r.length>1&&"m3u8"===r[1].toLowerCase()||"application/x-mpegURL"===t||"application/vnd.apple.mpegurl"===t)&&Hc.isSupported()}}]),Xc(t,[{key:"stop",value:function(){Qc(Wc(t.prototype),"stop",this).call(this),this._hls.destroy(),delete this._hls}},{key:"isHlsPlayback",value:function(){return!0}},{key:"_initHls",value:function(){var e=this,t=new Hc(this._config.hls);t.on(Hc.Events.MEDIA_ATTACHED,(function(){return t.loadSource(e.options.src)})),t.on(Hc.Events.ERROR,this._onHLSJSError),t.once(Hc.Events.LEVEL_LOADED,this._updatePlaybackType.bind(this)),t.on(Hc.Events.LEVEL_SWITCH,this._onLevelSwitch.bind(this)),t.on(Hc.Events.LEVEL_SWITCHED,this._onLevelSwitched.bind(this)),t.on(Hc.Events.FRAG_LOAD_PROGRESS,this._onFragLoadingProgress.bind(this)),t.on(Hc.Events.FRAG_LOADED,this._onFragLoadedProgress.bind(this)),this.options.resetHlsAfterDiscontinuity&&(this._isFirstCheck=!0,this._lastCC=void 0,this._offsetFragment=this.options.resetHlsOffsetFragment||0,t.on(Hc.Events.LEVEL_LOADED,this._checkResetHls.bind(this))),t.attachMedia(this.el),this._hls=t}},{key:"_resetHls",value:function(){var e=this;this._hls&&(this._hls.destroy(),this._hls=null),O.debug(this.name,"==============_resetHls========="),this._initHls(),this.options.resetHlsAfterDiscontinuity&&this._hls.on(Hc.Events.MANIFEST_PARSED,(function(){O.debug(e.name,"====> PLAYYYYYY"),e.el.play().catch((function(t){O.error(e.name,"Autoplay failed:",t)}))}))}},{key:"_checkResetHls",value:function(e,t){var r=this,n=t.details,i=n.fragments[this._offsetFragment],a=n.fragments[this._offsetFragment+1];if(i.cc<a.cc&&!this._isFirstCheck)return this._resetHlsTimeout&&clearTimeout(this._resetHlsTimeout),void(this._resetHlsTimeout=setTimeout((function(){r._resetHls()}),1e3*(i.duration||0)));this._isFirstCheck&&(this._isFirstCheck=!1)}},{key:"_updatePlaybackType",value:function(e,t){O.debug(this.name,"_updatePlaybackType",t),this._playbackType=t.details.live?ot.LIVE:t.details.startSN>0?ot.LIVE_END:ot.VOD,this.trigger(U.PLAYBACK_DVRSTATECHANGED),this._fillLevels(),O.debug(this.name,"LEVELS",this._levels),this.initLevelFromLocalStorage()}},{key:"_onLevelSwitch",value:function(e,t){O.debug(this.name,"_onLevelSwitch",t)}},{key:"_onLevelSwitched",value:function(e,t){O.debug(this.name,"_onLevelSwitched",t);var r=Ht(this.levels,"index",t.level);this.trigger(U.PLAYBACK_LEVEL_SWITCHED,r)}},{key:"_addingSuffixCharacter",value:function(e){var t=e.toString().toLowerCase();return t.indexOf("p")>-1?t:t+"p"}},{key:"_generateLabel",value:function(e){return e.name||Math.ceil(e.bitrate/1e3)}},{key:"_fillLevels",value:function(){var e=this;te.empty(this._levels)&&(this._levels=this._hls.levels.map((function(t,r){return{index:r,level:t,label:e._addingSuffixCharacter(e._generateLabel(t))}})),this._levels.unshift({index:-1,label:"Auto"}),this.trigger(U.PLAYBACK_LEVELS_AVAILABLE,this._levels))}},{key:"initLevelFromLocalStorage",value:function(){if(te.array(this._levels)&&this.options.quality){var e=Ht(this._levels,"label",this.options.quality);te.object(e)&&te.object(e.level)&&(this.currentLevel=e.index,this.startLevel=e.index)}}},{key:"_recoverMediaError",value:function(e){return this._recoverRetry+=1,this._recoverRetry>this._config.recoverMaxRetry?(O.error(this.name,"could not recover from error after maximum number of attempts",e),this.trigger(U.PLAYBACK_ERROR,e),void this.stop()):(O.warn(this.name,"recovering fatal error (".concat(this._recoverRetry,"/").concat(this._config.recoverMaxRetry,"):"),e),this._recoveredMediaError?(this._hls.swapAudioCodec(),void this._hls.recoverMediaError()):(this._recoveredMediaError=!0,void this._hls.recoverMediaError()))}},{key:"_onError",value:function(){var e=this.el.error;if(e){var t=e.code,r={code:t,description:e.message,raw:e};if(t===e.MEDIA_ERR_DECODE)return this._recoverMediaError(r);this.trigger(U.PLAYBACK_ERROR,r)}else O.warn(this.name,"HTML5 video unknown error")}},{key:"_onHLSJSError",value:function(e,t){if(t.fatal){var r={code:"".concat(t.type,"_").concat(t.details),description:t.reason||(t.response?"status: ".concat(t.response.code,", text: ").concat(t.response.text):"unknown"),raw:t};return t.type===Hc.ErrorTypes.NETWORK_ERROR&&t.response.code<400?(O.debug(this.name,"recovering network error, user may be offline:",r),void this._hls.startLoad()):t.type!==Hc.ErrorTypes.MEDIA_ERROR?(O.error(this.name,"unrecoverable fatal error: ".concat(t.type),r),this.trigger(U.PLAYBACK_ERROR,r),void this.stop()):void this._recoverMediaError(r)}}},{key:"_onTimeUpdate",value:function(){this.el.duration&&this.trigger(U.PLAYBACK_TIMEUPDATE,{current:this.el.currentTime,total:this.el.duration})}},{key:"_onFragLoadingProgress",value:function(e,t){var r=100/t.stats.total*t.stats.loaded;this.trigger(U.PLAYBACK_BUFFERING_CHANGE,r)}},{key:"_onFragLoadedProgress",value:function(){this.trigger(U.PLAYBACK_BUFFERFULL,this.name)}},{key:"getPlaybackType",value:function(){return this._playbackType}}]),t}();function tf(e){return(tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rf(e,t){return!t||"object"!==tf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function nf(e,t,r){return(nf="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=af(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function af(e){return(af=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function of(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function sf(e,t,r){return t&&of(e.prototype,t),r&&of(e,r),e}function lf(e,t){return(lf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var uf=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return(r=rf(this,(e=af(t)).call.apply(e,[this].concat(i))))._ready=!1,r._readyDeferred=_t(),r._isSeeking=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lf(e,t)}(t,ot),sf(t,[{key:"name",get:function(){return"youtube_playback"}},{key:"attributes",get:function(){return{"data-youtube-playback":"",class:"zplayer-youtube-playback",style:"height:100%",id:this.cid}}},{key:"buffering",get:function(){return!1}}],[{key:"canPlay",value:function(e){return this.isYTVideo(e)}},{key:"isYTVideo",value:function(e){return!!e.match(/^(?:https?:\/\/)?(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))((\w|-){11})(?:\S+)?$/)&&RegExp.$1}}]),sf(t,[{key:"ready",value:function(){this._ready=!0,this.$el.hide(),this._readyDeferred.resolve()}},{key:"qualityChange",value:function(){this.trigger(U.PLAYBACK_HIGHDEFINITIONUPDATE)}},{key:"stateChange",value:function(e){switch(e.data){case window.YT.PlayerState.PLAYING:this.$el.show(),this.trigger(U.PLAYBACK_PLAY),this._isSeeking&&(this._isSeeking=!1,this.trigger(U.PLAYBACK_SEEKED));break;case window.YT.PlayerState.PAUSE:this.$el.hide(),this.trigger(U.PLAYBACK_PAUSE);break;case window.YT.PlayerState.ENDED:this.ended(),this.seek(0),this.stop();break;default:this.$el.show()}}},{key:"play",value:function(){var e=this;this._progressTimer=this._progressTimer||setInterval((function(){return e.progress()}),100),this._timeupdateTimer=setInterval((function(){return e.timeupdate()}),100),this.player.playVideo(),this.trigger(U.PLAYBACK_PLAY),this.trigger(U.PLAYBACK_BUFFERFULL)}},{key:"pause",value:function(){this.clearTimer(),this.player&&this.player.pauseVideo(),this.trigger(U.PLAYBACK_PAUSE)}},{key:"seek",value:function(e){this.player&&(this.player.seekTo(e),this._isSeeking=!0,setTimeout((function(){}),100))}},{key:"ended",value:function(){this.trigger(U.PLAYBACK_ENDED)}},{key:"stop",value:function(){this.player.stopVideo(),this.clearTimer()}},{key:"volume",value:function(e){this.player&&(this.player.setVolume(e),e<=0?this.player.mute():this.player.unMute(),this.trigger(U.PLAYBACK_VOLUMEUPDATE,e))}},{key:"isMuted",value:function(){return this.player&&this.player.isMuted()}},{key:"getVolume",value:function(){return this.player&&this.player.getVolume()}},{key:"progress",value:function(){var e=this.player.getDuration()*this.player.getVideoLoadedFraction();this.trigger(U.PLAYBACK_PROGRESS,0,e,this.player.getDuration())}},{key:"timeupdate",value:function(){this.trigger(U.PLAYBACK_TIMEUPDATE,{current:this.player.getCurrentTime(),total:this.player.getDuration()})}},{key:"isPlaying",value:function(){return this.player&&this._timeupdateTimer&&this.player.getPlayerState()==window.YT.PlayerState.PLAYING}},{key:"isReady",value:function(){return this._readyDeferred.promise}},{key:"getDuration",value:function(){var e=0;return this.player&&(e=this.player.getDuration()),parseFloat(e)}},{key:"render",value:function(){var e=this;return this.el.append(Ie("div",{},{id:"yt".concat(this.cid)})),setTimeout((function(){e._setupYoutubePlayer()}),1),this}},{key:"setPlaybackRate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.player.setPlaybackRate(e)}},{key:"_setupYoutubePlayer",value:function(){window.YT&&window.YT.Player?this._embedYoutubePlayer():this._embedYoutubeApiScript()}},{key:"_getVideoId",value:function(e){return void 0!==(e=e.split(/(vi\/|v=|\/v\/|youtu\.be\/|\/embed\/)/))[2]?e[2].split(/[^0-9a-z_\-]/i)[0]:e[0]}},{key:"_embedYoutubeApiScript",value:function(){var e=this,t=document.createElement("script");t.setAttribute("type","text/javascript"),t.setAttribute("async","async"),t.setAttribute("src","https://www.youtube.com/iframe_api"),document.body.appendChild(t),window.onYouTubeIframeAPIReady=function(){return e._embedYoutubePlayer()}}},{key:"_embedYoutubePlayer",value:function(){var e=this,t={controls:0,autoplay:this.options.autoPlay?1:0,disablekb:1,rel:0,enablejsapi:1,iv_load_policy:3,modestbranding:1,showinfo:0,html5:1,playsinline:this.options.playInline?1:0};this.player=new window.YT.Player("yt".concat(this.cid),{videoId:this._getVideoId(this.options.source),playerVars:t,width:"100%",height:"100%",events:{onReady:function(){return e.ready()},onStateChange:function(t){return e.stateChange(t)},onPlaybackQualityChange:function(t){return e.qualityChange(t)}}})}},{key:"getPlaybackType",value:function(){return ot.VOD}},{key:"clearTimer",value:function(){clearInterval(this._timeupdateTimer),clearInterval(this._progressTimer),this._timeupdateTimer=null,this._progressTimer=null}},{key:"destroy",value:function(){this.clearTimer(),nf(af(t.prototype),"destroy",this).call(this),this.stop(),this.player.destroy(),this.player=null}}]),t}();function cf(e){return(cf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ff(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function df(e,t){return!t||"object"!==cf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hf(e){return(hf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pf(e,t){return(pf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(18);var gf=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),df(this,hf(t).apply(this,arguments))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pf(e,t)}(t,ot),r=t,i=[{key:"canPlay",value:function(){return!0}}],(n=[{key:"render",value:function(){var e=Ie("p",{innerHTML:"Your browser does not support the playback of this video. Please try using a different browser."},{"data-no-op-msg":""});return this.el.append(e),this}},{key:"isReady",value:function(){return Promise.resolve()}},{key:"name",get:function(){return"no_op"}},{key:"attributes",get:function(){return{"data-no-op":""}}}])&&ff(r.prototype,n),i&&ff(r,i),t}(),vf=(r(20),"--z--hide"),yf="--z--full-width",mf="--z--bg-transparent",Af={layout:{left:["playpause","volume","time"],right:["settings","fullscreen"],default:["seekbar"]},type:{fullWidth:!1},alwaysShowControl:!1,showOnPauseMobile:!1,disabledAutoHide:!1,hideAnimation:!1,theme:"",disabled:!1},bf="transparent",Ef="gradient",kf={RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"};function Tf(e){return(Tf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wf(e){return(wf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _f(e,t){return(_f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(22);var Lf=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==Tf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,wf(t).call(this,e))).plugin=r,n.bindEvents(),n}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_f(e,t)}(t,Ve),r=t,(n=[{key:"destroy",value:function(){this.remove()}},{key:"handleClick",value:function(){}},{key:"className",get:function(){return["",this.name].join(" ")}},{key:"attributes",get:function(){return{class:this.className}}},{key:"events",get:function(){return{click:"handleClick"}}}])&&Sf(r.prototype,n),t}();function Pf(e){return(Pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function If(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rf(e,t){return!t||"object"!==Pf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Cf(e){return(Cf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Df(e,t){return(Df=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Of=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Rf(this,Cf(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Df(e,t)}(t,Lf),r=t,(n=[{key:"name",get:function(){return"ButtonControl"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return["--z--control --z--btn",this.name].join(" ")}}])&&If(r.prototype,n),t}();function zf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var Mf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r;return t=e,(r=[{key:"initializer",value:function(e,t){this.controls=t}},{key:"onMouseOver",value:function(){wt||this.controls.disableAutoHide()}},{key:"onMouseOut",value:function(){this.controls.enableAutoHide()}},{key:"handleClick",value:function(){}},{key:"events",get:function(){return{click:"handleClick",mouseover:"onMouseOver",mouseout:"onMouseOut"}}}])&&zf(t.prototype,r),e}();function xf(e){return(xf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bf(e){return(Bf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ff(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Nf(e,t){return(Nf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uf(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];var i=function(t){function n(){for(var e,t,i,a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];return function(e,t){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this),i=(e=Bf(n)).call.apply(e,[this].concat(o)),t=!i||"object"!==xf(i)&&"function"!=typeof i?Ff(this):i,r.forEach((function(e){var r;(r=e.prototype.initializer).call.apply(r,[Ff(t)].concat(o))})),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nf(e,t)}(n,e),n}(),a=function(e,t){Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t)).forEach((function(r){r.match(/^(?:constructor|prototype|arguments|caller|name|bind|call|apply|toString|length)$/)||Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))};return r.forEach((function(e){a(i.prototype,e.prototype),a(i,e)})),i}function jf(e){return(jf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gf(e,t){return!t||"object"!==jf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Yf(e){return(Yf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Vf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Hf(e,t,r){return t&&Vf(e.prototype,t),r&&Vf(e,r),e}function Kf(e,t){return(Kf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Qf=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r=Gf(this,(e=Yf(t)).call.apply(e,[this].concat(i)));var o=i[0];return r.config=ae({},Af,ne(o.options,"controls.playPause")||{}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kf(e,t)}(t,Uf(Of,Mf)),Hf(t,[{key:"name",get:function(){return"PlayPauseControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-play"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_ENDED,handler:this.onEnded},{name:U.PLAYER_CLICK,handler:this.toogleIcon},{name:U.PLAYER_PLAY,handler:this.toogleIcon},{name:U.PLAYER_PAUSE,handler:this.toogleIcon}]}}]),Hf(t,[{key:"toogleIcon",value:function(){me(this.iconEl,"pl-ic-refresh");var e=this.player.isPlaying();Ae(this.iconEl,"pl-ic-play_arrow",!e),Ae(this.iconEl,"pl-ic-pause",e),this.setAttribute("title",e?"D\u1eebng":"Ph\xe1t")}},{key:"onEnded",value:function(){me(this.iconEl,"pl-ic-play_arrow"),me(this.iconEl,"pl-ic-pause"),ye(this.iconEl,"pl-ic-refresh"),this.setAttribute("title","Ph\xe1t l\u1ea1i")}},{key:"handleClick",value:function(){this.player.togglePlay(),this.toogleIcon()}},{key:"render",value:function(){return this.iconEl=Ie("span",{},{class:"--z--icon pl-ic-play_arrow"}),this.config.color&&Ee(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),t}();function Wf(e){return(Wf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qf(e){return(qf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xf(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jf(e,t,r){return t&&Xf(e.prototype,t),r&&Xf(e,r),e}function Zf(e,t){return(Zf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(24);var $f=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==Wf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,qf(t).call(this,e,r))).isDragging=!1,n.distance=0,n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Zf(e,t)}(t,Lf),Jf(t,[{key:"name",get:function(){return"SliderControl"}}]),Jf(t,[{key:"onMouseDown",value:function(e){(wt||Be(e))&&(this.isDragging=!0,e&&e.preventDefault(),this.plugin.disableAutoHide(),window.on("mousemove",this.onMouseMove.bind(this)),window.on("mouseup",this.onBodyUnbindMouseMove.bind(this)))}},{key:"onMouseUp",value:function(e){this.isDragging=!1,this.distance=this.calculateDistance(e),this.handleMouseUp(),this.plugin.enableAutoHide()}},{key:"onMouseMove",value:function(e){wt&&!this.isDragging||(this.distance=this.calculateDistance(e),(wt||Be(e))&&(this.isDragging&&this.handleMouseMove(),this.plugin.disableAutoHide()))}},{key:"onBodyUnbindMouseMove",value:function(e){wt&&!this.isDragging||(window.off("mousemove",this.onMouseMove.bind(this)),window.off("mouseup",this.onBodyUnbindMouseMove.bind(this)),this.onMouseUp(e))}},{key:"calculateDistance",value:function(e){var t=this.player.options,r=t.lockRotateFullscreen,n=t.customIosFullscreen,i=!this.player.isLandscapeScreen(),a=this.player.isFullscreen(),o=n&&r&&i&&a,s=xe(this.el,e,o);return o?1-s.y:s.x}},{key:"handleClick",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"handleMouseMove",value:function(){throw new Error("this must be overridden")}},{key:"handleMouseUp",value:function(){throw new Error("this must be overridden")}},{key:"events",get:function(){return{click:"handleClick",touchmove:"onMouseMove",touchstart:"onMouseDown",mousedown:"onMouseDown",touchend:"onMouseUp"}}}]),t}();function ed(e){return(ed="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function td(e,t){return!t||"object"!==ed(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rd(e){return(rd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function id(e,t,r){return t&&nd(e.prototype,t),r&&nd(e,r),e}function ad(e,t){return(ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(26);var od={color:"",bulletColor:""},sd=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=td(this,rd(t).call(this,e))).config=ae({},od,n),r.render(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ad(e,t)}(t,Lf),id(t,[{key:"name",get:function(){return"SliderFillRecentBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-recent"}},{key:"tagName",get:function(){return"span"}}]),id(t,[{key:"update",value:function(e){if(te.number(e)){var t={width:"".concat(e,"%")};Ee(this.el,t)}}},{key:"render",value:function(){return this.config.color&&Ee(this.el,{backgroundColor:this.config.color}),this.bulletEl=Ie("span",{},{class:"--z--bullet"}),this.config.bulletColor&&Ee(this.bulletEl,{backgroundColor:this.config.bulletColor}),this.el.append(this.bulletEl),this}}]),t}();function ld(e){return(ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ud(e){return(ud=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function cd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fd(e,t,r){return t&&cd(e.prototype,t),r&&cd(e,r),e}function dd(e,t){return(dd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var hd=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=ne(e.options,"controls.seekBar.foregroundColor")||"",n=ne(e.options,"controls.seekBar.playHeadColor")||"";return function(e,t){return!t||"object"!==ld(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,ud(t).call(this,e,{color:r,bulletColor:n}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dd(e,t)}(t,sd),fd(t,[{key:"name",get:function(){return"ProgressControl"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate}]}}]),fd(t,[{key:"onTimeUpdate",value:function(e){var t=e.current<0?e.total:e.current;this.currentPositionValue=t,this.currentDurationValue=e.total,this.currentSeekBarPercentage=this.currentPositionValue/this.currentDurationValue*100,this.update(this.currentSeekBarPercentage)}}]),t}();function pd(e){return(pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function gd(e,t){return!t||"object"!==pd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vd(e){return(vd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function yd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function md(e,t,r){return t&&yd(e.prototype,t),r&&yd(e,r),e}function Ad(e,t){return(Ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(28);var bd={color:""},Ed=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=gd(this,vd(t).call(this,e))).config=ae({},bd,n),r.render(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ad(e,t)}(t,Lf),md(t,[{key:"name",get:function(){return"SliderLoadedBar"}},{key:"className",get:function(){return"--z--bar --z--bar-fill-load"}},{key:"tagName",get:function(){return"span"}}]),md(t,[{key:"update",value:function(e){if(te.number(e)){var t={width:"".concat(e,"%")};Ee(this.el,t)}}},{key:"render",value:function(){return this.config.color&&Ee(this.el,{backgroundColor:this.config.color}),this}}]),t}();function kd(e){return(kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Td(e){return(Td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function wd(e,t,r){return t&&Sd(e.prototype,t),r&&Sd(e,r),e}function _d(e,t){return(_d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ld=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=ne(e.options,"controls.seekBar.bufferedColor")||"";return function(e,t){return!t||"object"!==kd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Td(t).call(this,e,{color:r}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_d(e,t)}(t,Ed),wd(t,[{key:"name",get:function(){return"LoadProgressBar"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_PROGRESS,handler:this.onProgressUpdate}]}}]),wd(t,[{key:"onProgressUpdate",value:function(e){var t=e.start/e.total*100,r=e.current/e.total*100;this.processLoaded=r-t,this.update(this.processLoaded)}}]),t}();function Pd(e){return(Pd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Id(e,t){return!t||"object"!==Pd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rd(e){return(Rd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Dd(e,t,r){return t&&Cd(e.prototype,t),r&&Cd(e,r),e}function Od(e,t){return(Od=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(30);var zd={color:""},Md=function(e){function t(e){var r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Id(this,Rd(t).call(this,e))).config=ae({},zd,n),r.render(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Od(e,t)}(t,Lf),Dd(t,[{key:"name",get:function(){return"SliderBackgroundBar"}},{key:"className",get:function(){return"--z--bar --z--bar-bg"}},{key:"tagName",get:function(){return"span"}}]),Dd(t,[{key:"render",value:function(){return this.config.color&&Ee(this.el,{backgroundColor:this.config.color}),this}}]),t}(),xd=function(e){return parseInt(e/60/60%60,10)},Bd=function(e){return parseInt(e/60%60,10)},Fd=function(e){return parseInt(e%60,10)};function Nd(){return(new Date).getTime()/1e3}function Ud(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!te.number(e))return"";var n=function(e){return"0".concat(e).slice(-2)},i=xd(e),a=Bd(e),o=Fd(e);return i=t||i>0?"".concat(i,":"):"","".concat(r&&e>0?"-":"").concat(i).concat(n(a),":").concat(n(o))}function jd(e){return(jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gd(e){return(Gd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Yd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Vd(e,t,r){return t&&Yd(e.prototype,t),r&&Yd(e,r),e}function Hd(e,t){return(Hd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Kd=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==jd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Gd(t).call(this,e))).enabled=!0,r.render(),r.hide(),r.bindEvents(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hd(e,t)}(t,Ve),Vd(t,[{key:"name",get:function(){return"SeekTime"}},{key:"tagName",get:function(){return"span"}},{key:"attributes",get:function(){return{class:"--z--seek-time"}}},{key:"listenEvents",get:function(){return[{name:U.MEDIACONTROL_MOUSEMOVE_SEEKBAR,handler:this.onMouseMoveSeekbar},{name:U.MEDIACONTROL_MOUSELEAVE_SEEKBAR,handler:this.onMouseLeaveSeekbar}]}}]),Vd(t,[{key:"onMouseMoveSeekbar",value:function(e,t){var r=t*this.player.getDuration();Ee(this.el,{left:100*t+"%",marginLeft:-this.el.offsetWidth/2+"px"}),this.el.textContent=Ud(r),this.show()}},{key:"onMouseLeaveSeekbar",value:function(){this.hide()}},{key:"enable",value:function(){this.enabled||(this.bindEvents(),this.show(),this.enabled=!0)}},{key:"disable",value:function(){this.unbindEvents(),this.hide(),this.enabled=!1}},{key:"render",value:function(){return this.el.innerHTML="00:00",this}}]),t}();function Qd(e){return(Qd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wd(e,t){return!t||"object"!==Qd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qd(e,t,r){return(qd="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Xd(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Xd(e){return(Xd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Jd(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zd(e,t,r){return t&&Jd(e.prototype,t),r&&Jd(e,r),e}function $d(e,t){return($d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var eh=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r=Wd(this,(e=Xd(t)).call.apply(e,[this].concat(i)));var o=i[0],s=ne(o.options,"controls.seekBar.backgroundColor")||"";return r.loadProgressBar=new Ld(o),r.progressControl=new hd(o),r.barBackground=new Md(o,{color:s}),r.seekTime=new Kd(o),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$d(e,t)}(t,Uf($f,Mf)),Zd(t,[{key:"name",get:function(){return"SeekBarControl"}},{key:"className",get:function(){return"--z--progress-bar"}},{key:"events",get:function(){return{touchmove:"onMouseMove",mousedown:"onMouseDown",touchstart:"onMouseDown",touchend:"onMouseUp",mouseleave:"onMouseLeave",mouseover:"onMouseOver",mouseout:"onMouseOut",mousemove:"onMouseMove"}}},{key:"listenEvents",get:function(){return[{once:!0,name:U.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),Zd(t,[{key:"onMouseLeave",value:function(e){this.player.trigger(U.MEDIACONTROL_MOUSELEAVE_SEEKBAR,e)}},{key:"onMouseMove",value:function(e){O.debug(this.name,"onMouseMove"),qd(Xd(t.prototype),"onMouseMove",this).call(this,e),this.player.trigger(U.MEDIACONTROL_MOUSEMOVE_SEEKBAR,e,this.distance)}},{key:"onMouseDown",value:function(e){O.debug(this.name,"onMouseDown"),qd(Xd(t.prototype),"onMouseDown",this).call(this,e),this.addClass("active"),this.isPlayingBeforeSeek=this.player.isPlaying(),this.isPlayingBeforeSeek&&this.player.pause()}},{key:"update",value:function(){var e=100*this.distance;this.player.seekPercentage(e),this.currentSeekBarPercentage=e,this.progressControl.update(this.currentSeekBarPercentage)}},{key:"handleMouseMove",value:function(){this.player.mediaControl.draggingSeekBar=!0,this.update()}},{key:"handleMouseUp",value:function(){this.plugin.draggingSeekBar=!1,this.update(),this.removeClass("active"),this.seekTime.hide(),this.isPlayingBeforeSeek&&this.player.play()}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.loadProgressBar.el),this.el.append(this.progressControl.el),this.el.append(this.seekTime.el),this}},{key:"remove",value:function(){[this.loadProgressBar,this.progressControl,this.barBackground,this.seekTime].forEach((function(e){e.remove()})),qd(Xd(t.prototype),"remove",this).call(this)}}]),t}();function th(e){return(th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rh(e){return(rh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function nh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ih(e,t,r){return t&&nh(e.prototype,t),r&&nh(e,r),e}function ah(e,t){return(ah=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(32);var oh={currentTimeColor:"",totalTimeColor:"",delimiterColor:"",delimiter:"/"},sh=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==th(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,rh(t).call(this,e))).config=ae({},oh,ne(e.options,"controls.time")||{}),r.currentTime=0,r.duration=r.player.getDuration(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ah(e,t)}(t,Lf),ih(t,[{key:"name",get:function(){return"TimeControl"}},{key:"className",get:function(){return"--z--control --z--control-time"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{name:U.PLAYER_LOADEDMETADATA,handler:this.onLoadedMetaData},{once:!0,name:U.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}]),ih(t,[{key:"onLoadedMetaData",value:function(){this.duration=this.player.getDuration(),this.update()}},{key:"update",value:function(){this.currentTimeEl&&(this.currentTimeEl.textContent=Ud(this.currentTime)),this.durationEl&&(this.durationEl.textContent=Ud(this.duration))}},{key:"onTimeUpdate",value:function(e){this.el&&(this.currentTime=e.current<0?e.total:e.current,this.duration||(this.duration=this.player.getDuration()),this.update())}},{key:"dvrChanged",value:function(){this.player.isLive()&&this.hide()}},{key:"render",value:function(){return this.currentTimeEl=Ie("span"),this.spaceEl=Ie("span",{innerHTML:this.config.delimiter}),this.durationEl=Ie("span",{innerHTML:Ud(this.duration)}),Ee(this.currentTimeEl,{color:this.config.currentTimeColor}),Ee(this.spaceEl,{color:this.config.delimiterColor}),Ee(this.durationEl,{color:this.config.totalTimeColor}),this.el.append(this.currentTimeEl),this.el.append(this.spaceEl),this.el.append(this.durationEl),this}}]),t}();function lh(e){return(lh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uh(e){return(uh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ch(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function fh(e,t,r){return t&&ch(e.prototype,t),r&&ch(e,r),e}function dh(e,t){return(dh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(34),r(36);var hh={color:""},ph=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==lh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,uh(t).call(this,e))).config=ae({},hh,ne(e.options,"controls.volumeButton")||{}),r.volume=e.options.mute?0:e.options.volume,r.cachedVolume=e.options.volume||100,r.volumeIconClass="",r._chooseVolumeIconInit(),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dh(e,t)}(t,Of),fh(t,[{key:"name",get:function(){return"VolumeButton"}},{key:"className",get:function(){return"--z--control --z--btn --z--volume-icon"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated}]}}]),fh(t,[{key:"_chooseVolumeIconInit",value:function(){0===this.volume?this.volumeIconClass="pl-ic-volume_off":this.volume>=50?this.volumeIconClass="pl-ic-volume_up":this.volume<50&&(this.volumeIconClass="pl-ic-volume_down")}},{key:"handleClick",value:function(){this.player.isMuted()?this.player.setVolume(this.cachedVolume,!0):this.player.setVolume(0,!0)}},{key:"onVolumeUpdated",value:function(e){this.volume=e,e>0&&(this.cachedVolume=e),this.updateIcon(e),this.setAttribute("title",0===e?"B\u1eadt \xe2m thanh":"T\u1eaft ti\u1ebfng")}},{key:"updateIcon",value:function(e){Ae(this.iconEl,"pl-ic-volume_down",e<50),Ae(this.iconEl,"pl-ic-volume_up",e>=50),Ae(this.iconEl,"pl-ic-volume_off",0===e)}},{key:"render",value:function(){return this.iconEl=Ie("span",{},{class:"--z--icon ".concat(this.volumeIconClass)}),this.config.color&&Ee(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}}]),t}();function gh(e){return(gh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t,r){return(vh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=yh(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function yh(e){return(yh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ah(e,t,r){return t&&mh(e.prototype,t),r&&mh(e,r),e}function bh(e,t){return(bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(38);var Eh=function(e){function t(e,r,n){var i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=function(e,t){return!t||"object"!==gh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,yh(t).call(this,e,n))).volume=e.options.mute?0:e.options.volume,i.parent=r;var a=ne(e.options,"controls.volumeBar.foregroundColor")||"",o=ne(e.options,"controls.volumeBar.backgroundColor")||"",s=ne(e.options,"controls.volumeBar.volumeHeadColor")||"";return i.barFill=new sd(e,{color:a,bulletColor:s}),i.barBackground=new Md(e,{color:o}),i.update(),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bh(e,t)}(t,$f),Ah(t,[{key:"name",get:function(){return"VolumeBar"}},{key:"className",get:function(){return"--z--volume-bar"}},{key:"tagName",get:function(){return"span"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:U.PLAYER_READY,handler:this.onPlayerReady},{name:U.PLAYER_FULLSCREEN,handler:this.onPlayerReady}]}}]),Ah(t,[{key:"onPlayerReady",value:function(){this.player.getPlayerSize().width<=400?this.hide():this.show()}},{key:"onVolumeUpdated",value:function(e){this.volume=e,this.update()}},{key:"setVolume",value:function(e){e=Math.min(100,Math.max(e,0)),this.volume=e,this.player.setVolume(e,!0),this.update()}},{key:"update",value:function(){this.barFill&&this.barFill.update(this.volume)}},{key:"onMouseDown",value:function(e){vh(yh(t.prototype),"onMouseDown",this).call(this,e),this.parent.toggleHideAnimation(!1)}},{key:"handleMouseMove",value:function(){this.handleMouse()}},{key:"handleMouseUp",value:function(){this.handleMouse(),this.parent.toggleHideAnimation(!0)}},{key:"handleMouse",value:function(){this.player.mediaControl.draggingVolumeBar=!0,this.setVolume(100*this.distance)}},{key:"render",value:function(){return this.el.append(this.barBackground.el),this.el.append(this.barFill.el),this}}]),t}();function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Th(e,t,r){return(Th="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Sh(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Sh(e){return(Sh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _h(e,t,r){return t&&wh(e.prototype,t),r&&wh(e,r),e}function Lh(e,t){return(Lh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ph(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var Ih=function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];n=this,r=!(i=(e=Sh(t)).call.apply(e,[this].concat(o)))||"object"!==kh(i)&&"function"!=typeof i?Ph(n):i;var l=o[0],u=o[1];r.volumeButton=new ph(l),r.volumeBar=new Eh(l,Ph(Ph(r)),u);var c=ne(l.options,"controls.volumeBarShowOnHover");return te.nullOrUndefined(c)&&(c=!0),r.toggleHideAnimation(c),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Lh(e,t)}(t,Uf(Lf,Mf)),_h(t,[{key:"name",get:function(){return"VolumeControl"}},{key:"className",get:function(){return"--z--control --z--control-volume"}}]),_h(t,[{key:"toggleHideAnimation",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.toggleClass("--z--hide-animation",e)}},{key:"render",value:function(){return this.el.append(this.volumeButton.render().el),this.el.append(this.volumeBar.render().el),this}},{key:"remove",value:function(){[this.volumeButton,this.volumeBar].forEach((function(e){e.remove()})),Th(Sh(t.prototype),"remove",this).call(this)}}]),t}(),Rh=(r(40),{isFullscreenIos:!1,isFullscreen:function(){return!!(document.fullscreenElement||document.webkitFullscreenElement||document.webkitIsFullScreen||document.mozFullScreen||document.msFullscreenElement||this.isFullscreenIos)},requestFullscreen:function(e){e.requestFullscreen?e.requestFullscreen().catch((function(e){O.error("requestFullscreen | ",e)})):e.webkitRequestFullscreen?e.webkitRequestFullscreen().catch((function(e){O.error("webkitRequestFullscreen | ",e)})):e.mozRequestFullScreen?e.mozRequestFullScreen().catch((function(e){O.error("mozRequestFullScreen | ",e)})):e.msRequestFullscreen?e.msRequestFullscreen().catch((function(e){O.error("msRequestFullscreen | ",e)})):e.querySelector&&e.querySelector("video")&&e.querySelector("video").webkitEnterFullScreen?e.querySelector("video").webkitEnterFullScreen().catch((function(e){O.error("webkitEnterFullScreen | ",e)})):e.webkitEnterFullScreen&&e.webkitEnterFullScreen().catch((function(e){O.error("webkitEnterFullScreen | ",e)}))},cancelFullscreen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return e.exitFullscreen?e.exitFullscreen().catch((function(e){O.error("exitFullscreen | ",e)})):e.webkitCancelFullScreen?e.webkitCancelFullScreen().catch((function(e){O.error("webkitCancelFullScreen | ",e)})):e.webkitExitFullscreen?e.webkitExitFullscreen().catch((function(e){O.error("webkitExitFullscreen | ",e)})):e.mozCancelFullScreen?e.mozCancelFullScreen().catch((function(e){O.error("mozCancelFullScreen | ",e)})):e.msExitFullscreen?e.msExitFullscreen().catch((function(e){O.error("msExitFullscreen | ",e)})):void 0},fullscreenEnabled:function(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}});function Ch(e){return(Ch="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dh(e,t){return!t||"object"!==Ch(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oh(e){return(Oh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function zh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Mh(e,t,r){return t&&zh(e.prototype,t),r&&zh(e,r),e}function xh(e,t){return(xh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Bh={color:""},Fh=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r=Dh(this,(e=Oh(t)).call.apply(e,[this].concat(i)));var o=i[0];return r.config=ae({},Bh,ne(o.options,"controls.fullscreen")||{}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xh(e,t)}(t,Uf(Of,Mf)),Mh(t,[{key:"name",get:function(){return"FullScreenControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-full-screen"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_FULLSCREEN,handler:this._onFullScreenChange},{name:U.PLAYER_DBLCLICK,handler:this._onDblClicked}]}}]),Mh(t,[{key:"handleClick",value:function(){this.config.functionFullscreen?this.config.functionFullscreen():this.player.toggleFullscreen()}},{key:"_onDblClicked",value:function(){this.config.dblClickToFullScreen&&this.handleClick()}},{key:"toogleIconFullScreen",value:function(e){Ae(this.iconEl,"pl-ic-fullscreen_exit",e),Ae(this.iconEl,"pl-ic-fullscreen",!e),this.setButtonTooltip(e)}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,r=t?t.on:"To\xe0n m\xe0n h\xecnh",n=t?t.off:"Tho\xe1t ch\u1ebf \u0111\u1ed9 to\xe0n m\xe0n h\xecnh";this.setAttribute("title",e?n:r)}},{key:"render",value:function(){return this.iconEl=Ie("span",{},{class:"--z--icon pl-ic-fullscreen"}),this.setButtonTooltip(this.player.isFullscreen()),this.config.color&&Ee(this.iconEl,{color:this.config.color}),this.el.append(this.iconEl),this}},{key:"_onFullScreenChange",value:function(e){this.toogleIconFullScreen(e)}}]),t}();function Nh(e){return(Nh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uh(e,t,r){return(Uh="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=jh(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function jh(e){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Gh(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Yh(e,t,r){return t&&Gh(e.prototype,t),r&&Gh(e,r),e}function Vh(e,t){return(Vh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Hh(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r(42);var Kh={color:"",labelBgColor:"",labelTextColor:""},Qh=function(e){function t(e,r){var n,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=!(i=jh(t).call(this,e))||"object"!==Nh(i)&&"function"!=typeof i?Hh(this):i).config=ae({},Kh,ne(e.options,"controls.SettingsButton")||{}),n.parent=r,n.label="",window.on("click.".concat(n.name),n.clickOutsideSettingsButton.bind(Hh(Hh(n)))),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Vh(e,t)}(t,Lf),Yh(t,[{key:"name",get:function(){return"SettingsButton"}},{key:"className",get:function(){return"--z--btn --z--btn-settings"}},{key:"tagName",get:function(){return"button"}}]),Yh(t,[{key:"clickOutsideSettingsButton",value:function(e){ve(e.target,"pl-ic-settings")||this.parent.hideSettingsMenu()}},{key:"remove",value:function(){window.off("click.".concat(this.name),this.clickOutsideSettingsButton.bind(this)),Uh(jh(t.prototype),"remove",this).call(this)}},{key:"handleClick",value:function(e){e.stopPropagation(),this.parent.toggleVisibleSettingsMenu()}},{key:"updateBadgeLabel",value:function(e){this.label=e,this.iconLabelEl.textContent=e}},{key:"render",value:function(){return this.iconEl=Ie("span",{},{class:"--z--icon pl-ic-settings"}),this.iconLabelEl=Ie("span",{},{class:"--z--badge"}),this.iconLabelEl.textContent=this.label,this.setAttribute("title","C\xe0i \u0111\u1eb7t"),Ee(this.iconEl,{color:this.config.color}),Ee(this.iconLabelEl,{backgroundColor:this.config.labelBgColor,color:this.config.labelTextColor}),this.el.append(this.iconEl),this.el.append(this.iconLabelEl),this}}]),t}(),Wh={MENU_TYPE:{TOGGLE:"toggle",EXPAND:"expand"},LIST_MENU_TYPE:{CHECKLIST:"checklist",MIXIN:"mixin"}};function qh(e){return(qh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Jh(e,t,r[t])}))}return e}function Jh(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zh(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function $h(e,t){return!t||"object"!==qh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ep(e){return(ep=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function rp(e,t,r){return t&&tp(e.prototype,t),r&&tp(e,r),e}function np(e,t){return(np=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ip=function(){},ap=function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r=$h(this,(e=ep(t)).call.apply(e,[this].concat(i)));var o=i[2];return r.render(),r.parent=o,r.controls=r.parent.controls,r.settingsMenuItems={},r.routeHistory=[],r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&np(e,t)}(t,Uf(Lf,Mf)),rp(t,[{key:"name",get:function(){return"SettingsMenu"}},{key:"className",get:function(){return"--z--zpl-settings-menu"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_READY,handler:this.onPlayerReady},{name:U.PLAYER_MEDIACONTROL_HIDE,handler:this.onHideMediaControl},{name:U.PLAYER_SETTINGS_MENU_HIDE,handler:this.hideMenu},{name:U.PLAYER_PLAY,handler:this.hideMenu},{name:U.PLAYER_PAUSE,handler:this.hideMenu},{name:U.PLAYER_FULLSCREEN,handler:this.hideMenu},{name:U.PLAYER_MEDIACONTROL_CLICK,handler:this.hideMenu},{name:U.PLAYER_VOLUMEUPDATE,handler:this.hideMenu}]}}]),rp(t,[{key:"handleClick",value:function(e){e.stopPropagation()}},{key:"onHideMediaControl",value:function(){this.hideMenu()}},{key:"onPlayerReady",value:function(){var e=oe(this.settingsMenuItems);e.length&&(e=Vt(e,"order")),e.length?(this.createMenu({type:Wh.LIST_MENU_TYPE.MIXIN,config:{itemsList:e}}),this.parent.show(),this.parent.settingsButton.show()):this.parent.hide()}},{key:"registerMenuItem",value:function(e){var t=e.pluginKey,r=void 0===t?"":t,n=e.type,i=void 0===n?Wh.MENU_TYPE.TOGGLE:n,a=e.config,o=void 0===a?{}:a,s=e.order,l=void 0===s?0:s,u=e.callback,c=void 0===u?ip:u,f=e.optionsConfig;if(!r)throw new Error("pluginKey must be required");this.settingsMenuItems[r]={type:i,config:o,order:l,callback:c,optionsConfig:f}}},{key:"asyncRegisterMenuItem",value:function(){this.registerMenuItem.apply(this,arguments),this.onPlayerReady()}},{key:"createToggleItem",value:function(e){var t=this,r=e.title,n=void 0===r?"":r,i=e.checked,a=void 0!==i&&i,o=e.clickCallback,s=void 0===o?ip:o,l=e.itemIndex,u=Ie("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(n,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-toggle-checkbox"></div>\n            </div>\n        ')},{class:"--z--zpl-menu-item","aria-checked":a});return u.on("click",(function(e){te.function(s)&&s(e,u);var r="true"!==Ce(u,"aria-checked");De(u,"aria-checked",r);var n=t.routeHistory.length;if(n){var i=t.routeHistory[n-1];if("mixin"===ne(i,"config.headerConfig.optionsMenu.type")){var a=ne(i,"config.headerConfig.optionsMenu.data");if(te.array(a)&&a.length){var o=a[l],c=ne(o,"config.checked");o&&!te.nullOrUndefined(c)&&(o.config.checked=r)}}}})),u}},{key:"createExpandableItem",value:function(e){var t=this,r=e.title,n=void 0===r?"":r,i=e.activeItemIndex,a=void 0===i?0:i,o=e.clickCallback,s=void 0===o?ip:o,l=e.subMenu,u=e.optionsConfig,c=e.historyData,f=e.itemIndex,d=l.type,h=l.data,p=l.clickCallback,g=l.titleClickCallback,v=h&&te.array(h)&&h[a],y=v&&v.displayName||v&&v.label||"",m=Ie("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                '.concat(n,'\n            </div>\n            <div class="--z--zpl-item-content">\n                <div class="--z--zpl-has-expand">\n                    <span> ').concat(y,' </span>\n                    <i class="pl-ic-keyboard_arrow_right"></i>\n                </div>\n            </div>\n        ')},{class:"--z--zpl-menu-item"});return h.map((function(e,t){return e.checked=a===t,e})),m.data={title:n,activeItemIndex:a,subMenu:l,optionsConfig:u,itemIndex:f},m.on("click",(function(e){if(te.function(s)&&s(e,m),te.nullOrUndefined(c)||te.empty(c)||(t.routeHistory=[].concat(Zh(t.routeHistory),[c])),d===Wh.LIST_MENU_TYPE.CHECKLIST){var r={headerConfig:{title:n,showOptions:!!u,optionText:u&&u.label,optionsClickCallback:u&&u.clickCallback,optionsMenu:u&&u.subMenu,titleClickCallback:g},itemsList:h,clickCallback:p,itemIndex:f};t.createCheckListMenu(r,{type:Wh.LIST_MENU_TYPE.CHECKLIST,config:r})}})),m}},{key:"createCheckableItem",value:function(e){var t=this,r=e.label,n=void 0===r?"":r,i=e.disabled,a=void 0!==i&&i,o=e.checked,s=void 0!==o&&o,l=e.callback,u=void 0===l?ip:l,c=e.itemIndex,f=Ie("div",{innerHTML:'\n            <div class="--z--zpl-item-label">\n                <i class="pl-ic-done"></i>\n                <span class="txt">'.concat(n,"</span>\n            </div>\n        ")},{class:"--z--zpl-menu-item","aria-checked":s,"aria-disabled":a});return f.on("click",(function(e){if(te.function(u)&&u(e,f),a)return!1;for(var r=(f.parentNode||f.parentElement).childNodes,n=r.length,i=0;i<n;i++)De(r[i],"aria-checked",!1);De(f,"aria-checked",!0);var o=t.routeHistory.length,s=t.routeHistory[o-1],l=ne(s,"config.itemsList"),d=l&&te.array(l)&&l[c],h=ne(f.data,"index");if(te.nullOrUndefined(h))throw new Error("Element must be have index property in data",f);if(d&&!te.nullOrUndefined(d.type)){var p=ne(d,"config.activeItemIndex");te.nullOrUndefined(p)||(d.config.activeItemIndex=h)}else{var g=ne(s,"config.headerConfig.optionsMenu");g&&!te.nullOrUndefined(ne(g,"activeItemIndex"))&&(g.activeItemIndex=h)}})),f}},{key:"goBack",value:function(){var e=this.routeHistory.length;if(e){var t=this.routeHistory[e-1];t&&(this.createMenu(t),this.routeHistory.pop())}}},{key:"createMenuHeader",value:function(e){var t=this,r=e.title,n=void 0===r?"":r,i=e.showOptions,a=void 0!==i&&i,o=e.optionText,s=void 0===o?"Options":o,l=e.titleClickCallback,u=void 0===l?ip:l,c=e.optionsClickCallback,f=void 0===c?ip:c,d=e.optionsMenu,h=e.historyData,p=e.itemIndex,g=Ie("div",{},{class:"--z--zpl-panel-header --z--clearfix"}),v=Ie("button",{innerHTML:'<i class="pl-ic-keyboard_arrow_left"></i> '.concat(n)},{class:"--z--panel-title"});if(v.on("click",(function(e){e.stopPropagation(),t.goBack(),te.function(u)&&u(e)})),g.append(v),a){var y=Ie("div",{innerText:s},{class:"--z--zpl-options"});y.on("click",(function(e){e.stopPropagation();var r=t.routeHistory[t.routeHistory.length-1],n=r&&ne(r,"config.itemsList"),i=n&&te.array(n)&&n[p];if(i){var a=ne(i,"config.activeItemIndex");te.nullOrUndefined(a)||(h.config.activeItemIndex=a,ne(h,"config.itemsList")&&h.config.itemsList.map((function(e,t){return e.checked=a===t,e})))}te.nullOrUndefined(h)||te.empty(h)||(t.routeHistory=[].concat(Zh(t.routeHistory),[h])),te.function(f)&&f(e);var o=d.type,l=d.data,u=d.activeItemIndex,c={headerConfig:{title:s},itemsList:l,itemIndex:p};o===Wh.LIST_MENU_TYPE.CHECKLIST?(te.number(u)&&l.map((function(e,t){return e.checked=u===t,e})),t.createCheckListMenu(c,{type:Wh.LIST_MENU_TYPE.CHECKLIST,config:c})):o===Wh.LIST_MENU_TYPE.MIXIN&&t.createMixinMenu(c,{type:Wh.LIST_MENU_TYPE.MIXIN,config:c})})),g.append(y)}return g}},{key:"createMenu",value:function(e){var t=e.type,r=e.config;"checklist"===t?this.createCheckListMenu(Xh({},r),{type:t,config:r}):"mixin"===t&&this.createMixinMenu(Xh({},r),{type:t,config:r})}},{key:"createCheckListMenu",value:function(e,t){var r=e.headerConfig,n=e.itemsList,i=void 0===n?[]:n,a=e.clickCallback,o=void 0===a?ip:a,s=e.itemIndex;if(this.panelEl.innerHTML="",r){var l=this.createMenuHeader(Xh({},r,{historyData:t,itemIndex:s}));this.panelEl.append(l)}for(var u=Ie("div",{},{class:"--z--panel-scroll-wrapper"}),c=Ie("div",{},{class:"--z--zpl-panel-menu"}),f=i.length,d=0;d<f;d++){var h=i[d];if(!te.object(h)||!h.label)return;var p=this.createCheckableItem({label:h.displayName||h.label,checked:!!h.checked,disabled:!!h.disabled,callback:o,itemIndex:s});p.data=h,c.append(p)}u.append(c),this.panelEl.append(u)}},{key:"createMixinMenu",value:function(e,t){var r=e.headerConfig,n=e.itemsList,i=void 0===n?[]:n;if(this.panelEl.innerHTML="",r){var a=this.createMenuHeader(r);this.panelEl.append(a)}for(var o=Ie("div",{},{class:"--z--panel-scroll-wrapper"}),s=Ie("div",{},{class:"--z--zpl-panel-inner"}),l=i.length,u=0;u<l;u++){var c=i[u],f=c.type,d=c.config,h=c.callback,p=c.optionsConfig,g=null;f===Wh.MENU_TYPE.TOGGLE?g=this.createToggleItem(Xh({},d,{itemIndex:u})):f===Wh.MENU_TYPE.EXPAND&&(g=this.createExpandableItem(Xh({},d,{optionsConfig:p,historyData:t,itemIndex:u}))),te.function(h)&&h(g),g&&s.append(g)}o.append(s),this.panelEl.append(o)}},{key:"toggleVisibleMenu",value:function(){Ae(this.el,"--z--show"),this.player.isMenuOpen=!this.player.isMenuOpen}},{key:"hideMenu",value:function(){me(this.el,"--z--show"),this.player.isMenuOpen=!1}},{key:"render",value:function(){this.panelEl=Ie("div",{},{class:"--z--zpl-panel"}),this.el.append(this.panelEl),this.player.el.append(this.el)}}]),t}();function op(e){return(op="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sp(e,t,r){return(sp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lp(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function lp(e){return(lp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function up(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cp(e,t,r){return t&&up(e.prototype,t),r&&up(e,r),e}function fp(e,t){return(fp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dp(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hp(e){return(hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pp(e,t){return!t||"object"!==hp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gp(e){return(gp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function vp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function yp(e,t,r){return t&&vp(e.prototype,t),r&&vp(e,r),e}function mp(e,t){return(mp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ap(e){return(Ap="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ep(e,t){return!t||"object"!==Ap(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kp(e,t,r){return(kp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Tp(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Tp(e){return(Tp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Sp(e,t){return(Sp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var wp={playpause:Qf,seekbar:eh,time:sh,volume:Ih,fullscreen:Fh,settings:function(e){function t(){var e,r,n,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];n=this,r=!(i=(e=lp(t)).call.apply(e,[this].concat(o)))||"object"!==op(i)&&"function"!=typeof i?dp(n):i;var l=o[0],u=o[1];return r.settingsButton=new Qh(l,dp(dp(r))),r.settingsMenu=new ap(l,u,dp(dp(r))),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&fp(e,t)}(t,Uf(Lf,Mf)),cp(t,[{key:"name",get:function(){return"SettingsControl"}},{key:"className",get:function(){return"--z--control --z--control-settings"}}]),cp(t,[{key:"toggleVisibleSettingsMenu",value:function(){this.settingsMenu.toggleVisibleMenu()}},{key:"hideSettingsMenu",value:function(){this.settingsMenu.hideMenu()}},{key:"render",value:function(){return this.el.append(this.settingsButton.render().el),this}},{key:"remove",value:function(){[this.settingsButton,this.settingsMenu].forEach((function(e){e.remove()})),sp(lp(t.prototype),"remove",this).call(this)}}]),t}(),theatermode:function(e){function t(){var e,r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];r=pp(this,(e=gp(t)).call.apply(e,[this].concat(i)));var o=i[0];return r.config=ae({},Af,ne(o.options,"controls.theaterMode")||{}),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mp(e,t)}(t,Uf(Of,Mf)),yp(t,[{key:"name",get:function(){return"TheaterModeControl"}},{key:"className",get:function(){return"--z--control --z--btn --z--control-theater-mode"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_THEATER_MODE_CHANGE,handler:this._onTheaterModeChange}]}}]),yp(t,[{key:"toggleIcon",value:function(e){Ae(this.iconEl,"pl-ic-theater",e),Ae(this.iconEl,"pl-ic-theater-mini",!e),this.setButtonTooltip(e)}},{key:"handleClick",value:function(){this.player.toggleTheaterMode()}},{key:"setButtonTooltip",value:function(e){var t=this.config.buttonTooltip,r=t?t.on:"Ch\u1ebf \u0111\u1ed9 r\u1ea1p chi\u1ebfu",n=t?t.off:"Tho\xe1t ch\u1ebf \u0111\u1ed9 r\u1ea1p chi\u1ebfu";this.setAttribute("title",e?n:r)}},{key:"render",value:function(){var e=this.options.theaterMode,t=e?"pl-ic-theater":"pl-ic-theater-mini";return this.iconEl=Ie("span",{},{class:"--z--icon ".concat(t)}),this.setButtonTooltip(e),this.el.append(this.iconEl),this}},{key:"_onTheaterModeChange",value:function(e){this.toggleIcon(e)}}]),t}()},_p=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ep(this,Tp(t).apply(this,arguments))}var n,i,a;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sp(e,t)}(t,Xe),n=t,a=[{key:"NAME_EVENTS",get:function(){return[{name:U.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:U.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:U.PLAYER_PLAY,handler:this.onPlay},{name:U.PLAYER_PAUSE,handler:this.onPause}]}}],(i=[{key:"setUp",value:function(){this.draggingVolumeBar=!1,this.draggingSeekBar=!1,this.autoHideDisabled=!1,this.setting=ae({},this.pluginOptions),this.setting.layout=ne(this.pluginOptions,"layout"),this.controls=[],this.leftElement=null,this.rightElement=null,this.pluginOptions.disabled||this.onMouseMove()}},{key:"setupTheme",value:function(){var e=this,t=this.setting,n=t.type,i=t.theme;if(n.fullWidth){ye(this.innerEl,yf),ye(this.el,yf);var a=n.fullWidth;switch(a.backgoundType){case bf:ye(this.innerEl,mf);break;case Ef:ye(this.innerEl,mf),ye(this.el,mf)}var o=a.paddingTop;te.number(o)&&o>=0&&Ee(this.innerEl,{paddingTop:String(o).indexOf("px")>-1?o:"".concat(o,"px")}),Ee(this.innerEl,{backgroundImage:a.backgroundImage,backgroundColor:a.backgroundColor}),this.setting.hideAnimation&&(this.hideClass="--z--fadeout")}i&&oe(kf).indexOf(i)>-1&&r(44)("./".concat(i,".scss")).then((function(t){var r=Ie("style",{innerHTML:t.default});e.innerEl.append(r)}))}},{key:"onClicked",value:function(e){e.stopPropagation(),this.player.trigger(U.PLAYER_MEDIACONTROL_CLICK)}},{key:"onDblClicked",value:function(e){e.stopPropagation(),this.player.trigger(U.PLAYER_MEDIACONTROL_DBLCLICK)}},{key:"onMouseLeave",value:function(){this.autoHideDisabled||this.setting.alwaysShowControl||(clearTimeout(this.hideTimeout),this.hide())}},{key:"onMouseMove",value:function(){var e=this;this.autoHideDisabled||this.setting.disabledAutoHide||(clearTimeout(this.hideTimeout),this.show(),this.setting.alwaysShowControl||(this.hideTimeout=setTimeout((function(){return e.onMouseLeave()}),3e3)))}},{key:"onPlay",value:function(){this.enableAutoHide()}},{key:"onPause",value:function(){this.onMouseLeave(),wt?this.setting.showOnPauseMobile&&this.disableAutoHide():this.disableAutoHide()}},{key:"disableAutoHide",value:function(){this.autoHideDisabled=!0,clearTimeout(this.hideTimeout),this.show()}},{key:"enableAutoHide",value:function(){this.setting.disabledAutoHide||this.player.isPlaying()&&(this.autoHideDisabled=!1,this.onMouseMove())}},{key:"disable",value:function(){kp(Tp(t.prototype),"disable",this).call(this),this.player.disableMediaControl()}},{key:"enable",value:function(){kp(Tp(t.prototype),"enable",this).call(this),this.player.enableMediaControl()}},{key:"show",value:function(){O.debug(this.name,"show"),me(this.el,this.hideClass),this.player.showMediaControl()}},{key:"hide",value:function(){this.hideClass||(this.hideClass=vf),O.debug(this.name,"hide",this.hideClass),ye(this.el,this.hideClass),this.player.hideMediaControl()}},{key:"destroy",value:function(){kp(Tp(t.prototype),"destroy",this).call(this),this.controls.forEach((function(e){return e.remove()})),this.remove()}},{key:"getControl",value:function(e){return this.controls&&this.controls.filter((function(t){return t.name===e}))[0]}},{key:"renderControl",value:function(e,t){if(t){var r=wp[t];if(r){var n=new r(this.player,this);e.append(n.render().el),this.controls.push(n)}}}},{key:"render",value:function(){var e=this;if(!this.controls)return this;if(kp(Tp(t.prototype),"render",this).call(this),this.leftElement=Ie("div",{},{class:"--z--control-left"}),this.rightElement=Ie("div",{},{class:"--z--control-right"}),this.innerEl=Ie("div",{},{class:"--z--controls"}),(!this.setting.layout.left||!this.setting.layout.left.length)&&ye(this.rightElement,"--z--only-right-control"),this.setting.layout.default){var r=!0,n=!1,i=void 0;try{for(var a,o=this.setting.layout.default[Symbol.iterator]();!(r=(a=o.next()).done);r=!0){var s=a.value;this.renderControl(this.innerEl,s)}}catch(e){n=!0,i=e}finally{try{r||null==o.return||o.return()}finally{if(n)throw i}}}if(this.setting.layout.left){var l=!0,u=!1,c=void 0;try{for(var f,d=this.setting.layout.left[Symbol.iterator]();!(l=(f=d.next()).done);l=!0){var h=f.value;this.renderControl(this.leftElement,h)}}catch(e){u=!0,c=e}finally{try{l||null==d.return||d.return()}finally{if(u)throw c}}}if(this.setting.layout.right){var p=!0,g=!1,v=void 0;try{for(var y,m=this.setting.layout.right[Symbol.iterator]();!(p=(y=m.next()).done);p=!0){var A=y.value;this.renderControl(this.rightElement,A)}}catch(e){g=!0,v=e}finally{try{p||null==m.return||m.return()}finally{if(g)throw v}}}return this.setupTheme(),this.innerEl.append(this.leftElement),this.innerEl.append(this.rightElement),this.el.append(this.innerEl),this.player.$el.append(this.el),setTimeout((function(){e.player.mediaControlReady()}),0),this}},{key:"name",get:function(){return"ControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--controls-wrapper"}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked"}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_MOUSE_MOVE,handler:this.onMouseMove},{name:U.PLAYER_MOUSE_LEAVE,handler:this.onMouseLeave},{name:U.PLAYER_PLAY,handler:this.onPlay},{name:U.PLAYER_PAUSE,handler:this.onPause}]}},{key:"defaultOptions",get:function(){return Af}}])&&bp(n.prototype,i),a&&bp(n,a),t}();function Lp(e){return(Lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Pp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ip(e,t){return!t||"object"!==Lp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rp(e){return(Rp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Cp(e,t){return(Cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(45);var Dp={poster:"//static-zmp3.zadn.vn/skins/zmp3-v6.1/images/thumb-share.jpg"},Op=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ip(this,Rp(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cp(e,t)}(t,Xe),r=t,(n=[{key:"_onPlayerPlayIntent",value:function(){this.hide()}},{key:"_onPlayerEnded",value:function(){this.player.options.customIosFullscreen||this.show()}},{key:"handleClick",value:function(){return this.player.play(),!1}},{key:"getPosterUrl",value:function(){return this.options.poster||this.pluginOptions.poster}},{key:"render",value:function(){var e=this.getPosterUrl(),t=Ie("div",{},{class:"--z--poster-controls --z--play-wrapper --z--active"});return this.el.setAttribute("style","background-image : url(".concat(e,");")),te.empty(this.pluginOptions.styles)||Ee(this.el,this.pluginOptions.styles),this.$el.append(t),this.player.$el.append(this.el),this}},{key:"name",get:function(){return"PosterPlugin"}},{key:"attributes",get:function(){return{class:"--z--player-poster"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"defaultOptions",get:function(){return Dp}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:U.PLAYER_ENDED,handler:this._onPlayerEnded}]}}])&&Pp(r.prototype,n),t}();function zp(e){return(zp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mp(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xp(e,t){return!t||"object"!==zp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bp(e,t,r){return(Bp="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fp(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Fp(e){return(Fp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Np(e,t){return(Np=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(47);var Up={showLabel:!1},jp=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xp(this,Fp(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Np(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){Bp(Fp(t.prototype),"setUp",this).call(this),this.bufferingPercent=1,this.shouldUpdate=!0}},{key:"onBuffering",value:function(){this.shouldUpdate=!0,this.show()}},{key:"onBufferingChange",value:function(e){te.number(e)&&((e=Math.floor(e))<1?e=1:e>99&&(e=99),this.bufferingPercent=e,this.update())}},{key:"onBufferFull",value:function(){O.debug(this.name,"onBufferFull"),this.bufferingPercent=1,this.update(),this.hide(),this.shouldUpdate=!1}},{key:"onStop",value:function(){O.debug(this.name,"onStop"),this.bufferingPercent=1,this.hide()}},{key:"show",value:function(){var e=this;null===this.showTimeout&&(this.showTimeout=setTimeout((function(){e.player.trigger(U.LOADING_SPINNER_SHOW),e.$el.show()}),300))}},{key:"hide",value:function(){null!==this.showTimeout&&(clearTimeout(this.showTimeout),this.showTimeout=null),this.player.trigger(U.LOADING_SPINNER_HIDE),this.$el.hide()}},{key:"update",value:function(){this.shouldUpdate&&this.pieWrapperEl&&(be(this.pieWrapperEl,"--z--pie-wrapper --z--progress-".concat(this.bufferingPercent)),this.labelEl&&Pe(this.labelEl,"".concat(this.bufferingPercent,"%")))}},{key:"render",value:function(){return this.pieEl=Ie("div",{},{class:"--z--pie-progress-size"}),this.pieWrapperEl=Ie("div",{innerHTML:'\n                <div class="--z--pie">\n                    <div class="--z--left-side --z--half-circle"></div>\n                    <div class="--z--right-side --z--half-circle"></div>\n                </div>\n                <div class="--z--shadow"></div>\n                '},{class:"--z--pie-wrapper"}),this.pluginOptions.showLabel&&(this.labelEl=Ie("div",{innerHTML:"".concat(this.bufferingPercent,"%")},{class:"--z--label"}),this.pieWrapperEl.prepend(this.labelEl)),this.pieEl.append(this.pieWrapperEl),this.$el.append(this.pieEl),this.player.$el.append(this.$el),this.$el.hide(),this.player.buffering&&this.onBuffering(),this}},{key:"_onPlayerPlayIntent",value:function(){this.player.buffering&&this.show()}},{key:"name",get:function(){return"LoadingSpinnerPlugin"}},{key:"attributes",get:function(){return{class:"--z--loading-wrapper"}}},{key:"defaultOptions",get:function(){return Up}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent},{name:U.PLAYER_BUFFERING,handler:this.onBuffering},{name:U.PLAYER_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:U.PLAYER_BUFFERFULL,handler:this.onBufferFull},{name:U.PLAYER_STOP,handler:this.onStop},{name:U.PLAYER_ENDED,handler:this.onStop},{name:U.PLAYER_ERROR,handler:this.onStop}]}}])&&Mp(r.prototype,n),t}();function Gp(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e?e.toString().replace(/{(\d+)}/g,(function(e,t){return r[t].toString()})):e}function Yp(e){var t=document.createElement("div");return t.appendChild(document.createTextNode(e)),t.innerHTML}function Vp(e){var t=document.createDocumentFragment(),r=document.createElement("div");return t.appendChild(r),r.innerHTML=e,t.firstChild.innerText}function Hp(e){return e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function Kp(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return String.prototype.startsWith?e.startsWith(t,r):(r=!r||r<0?0:+r,e.indexOf(t)===r)}function Qp(e,t,r){return String.prototype.endsWith?e.endsWith(t,r):((void 0===r||r>e.length)&&(r=e.length),e.substring(r-t.length,r)===t)}function Wp(e){return"".concat(e,"-").concat(Math.floor(1e4*Math.random()))}function qp(e,t){return 0===e||0===t||Number.isNaN(e)||Number.isNaN(t)?0:(e/t*100).toFixed(2)}function Xp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return e.replace(new RegExp(t.toString().replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1"),"g"),r.toString())}function Jp(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString().replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}))}function Zp(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return e=Xp(e,"-"," "),e=Xp(e,"_"," "),Xp(e=Jp(e)," ","")}function $p(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").toString();return(e=Zp(e)).charAt(0).toLowerCase()+e.slice(1)}function eg(e){var t=document.createDocumentFragment(),r=document.createElement("div");return t.appendChild(r),r.innerHTML=e,t.firstChild.innerText}function tg(e){var t=document.createElement("div");return t.appendChild(e),t.innerHTML}function rg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var ng=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.data=[]}var t,r;return t=e,(r=[{key:"getItem",value:function(e){return this.data[e]}},{key:"setItem",value:function(e,t){this.data[e]=String(t)}},{key:"removeItem",value:function(e){delete this.data[e]}}])&&rg(t.prototype,r),e}();function ig(){try{return"localStorage"in window&&(window.localStorage.setItem("__test__","__test__"),window.localStorage.removeItem("__test__"),!0)}catch(e){return!1}}var ag=ig()?window.localStorage:new ng;function og(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var sg=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"zplayer";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.key=t}var t,r,n;return t=e,n=[{key:"supported",value:function(){return ig()}}],(r=[{key:"get",value:function(e){var t=ag.getItem(this.key);if(te.empty(t))return{};var r=function(e){try{return JSON.parse(e)}catch(e){return{}}}(t);return te.string(e)&&e.length?r[e]:r}},{key:"set",value:function(e){if(te.object(e)){var t=this.get();te.empty(t)&&(t={}),ae(t,e),ag.setItem(this.key,JSON.stringify(t))}}},{key:"clean",value:function(){ag.removeItem(this.key)}}])&&og(t.prototype,r),n&&og(t,n),e}();function lg(e){return(lg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ug(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function cg(e,t){return!t||"object"!==lg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fg(e,t,r){return(fg="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dg(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function dg(e){return(dg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function hg(e,t){return(hg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var pg="zplayer-trk",gg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),cg(this,dg(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&hg(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){this.options.sources!=[{source:"",mimeType:""}]&&(this._isFirstLoad=!0,this._isBuffering=!0,this._trackingApi=this.pluginOptions.trackingApi,this._storage=new sg(Wp(pg)),this._reset(),this._sendLastReports())}},{key:"destroy",value:function(){fg(dg(t.prototype),"destroy",this).call(this),this._stopMonitoring()}},{key:"_now",value:function(){return Date.now()}},{key:"_onPlayIntent",value:function(){this._timeOnStartLoad=this._now(),this._start("startup"),this._startMonitoring()}},{key:"_onBitrate",value:function(e){var t=parseInt(e.label),r=this._now(),n=this._metrics.extra.bitratesHistory.length;if(n>0){var i=this._metrics.extra.bitratesHistory[n-1];i.end=r,i.time=r-i.start}this._metrics.extra.bitratesHistory.push({start:this._now(),bitrate:t}),this._inc("changeLevel")}},{key:"_onFirstPlaying",value:function(){this.listenTo(this.player,U.PLAYER_TIMEUPDATE,this._onContainerUpdateWhilePlaying),this.listenEvents.push({name:U.PLAYER_TIMEUPDATE,handler:this._onContainerUpdateWhilePlaying}),this._start("watch"),this._stop("startup")}},{key:"_onContainerUpdateWhilePlaying",value:function(){this.player.isPlaying()&&(this._stop("watch"),this._start("watch"))}},{key:"_onCanPlayThrough",value:function(e){if(this.player.isPlaying()){var t=e.time;this._isFirstLoad?(this._isFirstLoad=!1,this._timeOnCanPlayFirstLoad=t):(this._timeOnCanPlayThrough=t,this._trackLatencyHistory(this._isBuffering))}}},{key:"_trackLatencyHistory",value:function(e){if(e)if(this._isSeeking)this._seekLatencyHistory.push(this._timeOnCanPlayThrough-this._timeOnSeeking),this._isSeeking=!1;else if(this._isWaiting){var t=this._timeOnCanPlayThrough-this._timeOnWaiting;this._metrics.timers.playLatency+=t,this._isWaiting=!1}}},{key:"_onSeeking",value:function(e){this._isSeeking=!0,this._timeOnSeeking=e.time}},{key:"_onWaiting",value:function(e){this._isSeeking||(this._isWaiting=!0,this._timeOnWaiting=e.time)}},{key:"_onPlayerEnded",value:function(){this._sendReportThenReset(),this.stopListening(),this.bindEvents()}},{key:"_onPlayerError",value:function(e){this._metrics.extra.errorDetail.push("code: ".concat(e.code,", description: ").concat(e.description)),this._inc("error"),this._sendReportThenReset()}},{key:"_startMonitoring",value:function(){var e=this;this._intervalId=setInterval((function(){e._buildReport(),e._sendLastReports()}),5e3),this._buildReport(),O.info(this.name,"started monitoring")}},{key:"_stopMonitoring",value:function(){clearInterval(this._intervalId),O.info(this.name,"stopped monitoring")}},{key:"_sendReportThenReset",value:function(){this._stopMonitoring(),this._buildReport(),this._sendReport(this._storage.get()),this._reset()}},{key:"_reset",value:function(){this._isFirstLoad=!0,this._seekLatencyHistory=[],this._newMetrics(),this._storage.clean()}},{key:"_sendLastReports",value:function(){var e=this;Object.keys(ag).filter(vg).forEach((function(t){var r,n=JSON.parse(ag.getItem(t));e._storage.key===t||(r=n)&&Date.now()-r._updatedAt<5e3||(e._sendReport(n),ag.removeItem(t),O.debug(e.name,"sent report:",t))}))}},{key:"_saveMetrics",value:function(){var e={_updatedAt:this._now(),userAgent:navigator.userAgent,fromUrl:window.location.href,params:JSON.stringify(this._metrics)};this._storage.set(e)}},{key:"_sendReport",value:function(e){O.debug(this.name,"sending report:",e),this._trackingApi.forEach((function(t){(new Image).src=t+"?userAgent="+encodeURIComponent(e.userAgent)+"&fromUrl="+encodeURIComponent(e.fromUrl)+"&params="+encodeURIComponent(e.params)}))}},{key:"onPlay",value:function(){this._inc("play")}},{key:"onPause",value:function(){this._stop("watch"),this._start("pause"),this._inc("pause"),this.listenToOnce(this.player,U.PLAYER_PLAY,this.playAfterPause)}},{key:"playAfterPause",value:function(){this._stop("pause"),this._start("watch")}},{key:"onSeek",value:function(e){this._inc("seek"),this._metrics.extra.watchHistory.push([1e3*e,1e3*e])}},{key:"onFullScreen",value:function(){this._inc("fullscreen")}},{key:"onProgress",value:function(e){this._metrics.extra.buffersize=1e3*e.current}},{key:"onTimeUpdate",value:function(e){var t=1e3*e.current,r=1e3*e.total,n=this._metrics.extra.watchHistory.length;this._metrics.extra.duration=r,this._metrics.extra.currentTime=t,0===n?this._metrics.extra.watchHistory.push([t,t]):this._metrics.extra.watchHistory[n-1][1]=t}},{key:"onBuffering",value:function(){this._isBuffering=!0,this._inc("buffering"),this._start("buffering"),this.listenToOnce(this.player,U.PLAYER_BUFFERFULL,this.onBufferfull)}},{key:"onBufferfull",value:function(){this._isBuffering=!1,this._stop("buffering"),this.listenToOnce(this.player,U.PLAYER_BUFFERING,this.onBuffering)}},{key:"_inc",value:function(e){this._metrics.counters[e]+=1}},{key:"_timerHasStarted",value:function(e){return void 0!==this["_start".concat(e)]}},{key:"_start",value:function(e){this["_start".concat(e)]=this._now()}},{key:"_stop",value:function(e){this._metrics.timers[e]+=this._now()-this["_start".concat(e)]}},{key:"_fetchFPS",value:function(){var e={html5_video:this._html5FetchFPS,hls:this._html5FetchFPS};e[this._playbackName]&&e[this._playbackName].call(this)}},{key:"_calculateBitrates",value:function(){var e=this,t=this._metrics.extra.bitratesHistory.map((function(e){return e.bitrate}));this._metrics.extra.bitrateMean=t.reduce((function(e,t){return e+t}),0)/t.length,this._metrics.extra.bitrateVariance=t.map((function(t){return Math.pow(t-e._metrics.extra.bitrateMean,2)})).reduce((function(e,t){return e+t}),0)/t.length,this._metrics.extra.bitrateStandardDeviation=Math.sqrt(this._metrics.extra.bitrateVariance),this._metrics.extra.bitrateMostUsed=this._metrics.extra.bitratesHistory.sort((function(e,t){return e.time<t.time}))[0]}},{key:"_calculatePercentages",value:function(){this._metrics.extra.duration>0&&(this._metrics.extra.watchedPercentage=this._metrics.timers.watch/this._metrics.extra.duration*100,this._metrics.extra.bufferingPercentage=this._metrics.timers.buffering/this._metrics.extra.duration*100)}},{key:"_calculateStartLatency",value:function(){!this._timeOnCanPlayFirstLoad||this._timeOnCanPlayFirstLoad<=0||(this._metrics.timers.startLatency=this._timeOnCanPlayFirstLoad-this._timeOnStartLoad)}},{key:"_calculateSeekLatency",value:function(){this._metrics.timers.seekLatency=Kt(this._seekLatencyHistory)}},{key:"_newMetrics",value:function(){var e=this;this._metrics={counters:{play:0,pause:0,error:0,buffering:0,decodedFrames:0,droppedFrames:0,fps:0,changeLevel:0,seek:0,fullscreen:0,dvrUsage:0},timers:{startup:0,watch:0,pause:0,buffering:0,session:0,startLatency:0,seekLatency:0,playLatency:0,getSourceLatency:0},extra:{product:"",level:"",playbackName:"",playbackType:"",playbackRedirector:"",playbackSrc:"",mimeType:"",platform:wt?"webm":"webd",zdnServer:"",bitratesHistory:[],bitrateMean:0,bitrateVariance:0,bitrateStandardDeviation:0,bitrateMostUsed:0,buffersize:0,errorDetail:[],watchHistory:[],watchedPercentage:0,bufferingPercentage:0,isOnline:!0}},window.ZA&&te.function(window.ZA.getVisitorID)&&window.ZA.getVisitorID((function(t){O.debug(e.name,"ZA visitor ID:",t),e._metrics.extra.visitorId=t}))}},{key:"_buildReport",value:function(){this._stop("session"),this._start("session"),this._metrics.extra.playbackName=this._playbackName,this._metrics.extra.playbackType=this._playbackType,this._metrics.extra.product=this.options.product,this._calculateBitrates(),this._calculatePercentages(),this._fetchFPS(),this._calculateStartLatency(),this._calculateSeekLatency(),this._metrics.extra.playbackSrc=this.player.isHlsPlayback()?this.player.options.source:this.player.playback.el.src,this._metrics.extra.mimeType=this.player.options.mimeType,this._saveMetrics()}},{key:"_html5FetchFPS",value:function(){var e=this.player.playback.el,t=e.webkitDecodedFrameCount||e.mozDecodedFrames||0,r=e.webkitDroppedFrameCount||e.mozParsedFrames-e.mozDecodedFrames||0,n=t-(this._lastDecodedFramesCount||0);this._metrics.counters.decodedFrames=t,this._metrics.counters.droppedFrames=r,this._metrics.counters.fps=n/5,this._lastDecodedFramesCount=t}},{key:"name",get:function(){return"StatsPlugin"}},{key:"defaultOptions",get:function(){return{trackingApi:["https://zplayer-trk.zdn.vn/track"]}}},{key:"_playbackName",get:function(){return this.player.playback.name}},{key:"_playbackType",get:function(){return this.player.getPlaybackType()}},{key:"listenEvents",get:function(){return[{once:!0,name:U.PLAYER_PLAY_INTENT,handler:this._onPlayIntent},{once:!0,name:U.PLAYER_PLAY,handler:this._onFirstPlaying},{name:U.PLAYER_QUALITY_LEVELS_SELECTED,handler:this._onBitrate},{name:U.PLAYER_CANPLAYTHROUGH,handler:this._onCanPlayThrough},{name:U.PLAYER_PLAY,handler:this.onPlay},{name:U.PLAYER_PAUSE,handler:this.onPause},{once:!0,name:U.PLAYER_ERROR,handler:this._onPlayerError},{name:U.PLAYER_ENDED,handler:this._onPlayerEnded},{name:U.PLAYER_SEEKING,handler:this._onSeeking},{name:U.PLAYER_SEEK,handler:this.onSeek},{name:U.PLAYER_WAITING,handler:this._onWaiting},{name:U.PLAYER_FULLSCREEN,handler:this.onFullScreen},{name:U.PLAYER_PROGRESS,handler:this.onProgress},{name:U.PLAYER_TIMEUPDATE,handler:this.onTimeUpdate},{once:!0,name:U.PLAYER_BUFFERING,handler:this.onBuffering},{once:!0,name:U.PLAYER_BUFFERFULL,handler:this.onBufferfull}]}}])&&ug(r.prototype,n),t}();function vg(e){return e&&0===e.indexOf(pg)}function yg(e){return(yg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ag(e,t){return!t||"object"!==yg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bg(e){return(bg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Eg(e,t){return(Eg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(49);var kg=["PosterPlugin","LoadingSpinnerPlugin","BigPlayButtonPlugin","ClickToPausePlugin","PauseAdPlugin","PlayPauseFaceoutPlugin","HotKeysPlugin"],Tg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ag(this,bg(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Eg(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){var e=this;if(this.defaultOptions.disabled)return this.disable();this.shouldRender=!0,this.interferedPlugins=kg.map((function(t){return e.player.getPlugin(t)}))}},{key:"bindReload",value:function(){this.reloadButton=this.$el.find(".player-error-screen__reload"),this.reloadButton&&this.reloadButton.on("click",this.reload.bind(this))}},{key:"reload",value:function(){var e=this;this.listenToOnce(this.player,U.PLAYER_READY,(function(){return e.player.play()})),this.unbindReload()}},{key:"unbindReload",value:function(){this.reloadButton&&this.reloadButton.off("click")}},{key:"onError",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.err=e,this.player.mediaControl.disable(),this._disableInterferedPlugins(),this.render(),this.show(),this.shouldRender=!1}},{key:"_disableInterferedPlugins",value:function(){this.interferedPlugins.forEach((function(e){return e&&e.disable()}))}},{key:"render",value:function(){if(this.err&&this.shouldRender){var e=Ie("div",{innerHTML:'\n            <div class="player-error-screen__title" data-error-screen>'.concat(this.pluginOptions.message,'.</div>\n            <div class="player-error-screen__code" data-error-screen>Error code: ').concat(this.err.code,"</div>\n            ")},{"data-error-screen":"",class:"player-error-screen__content"});return this.el.append(e),this.player.el.append(this.el),this.bindReload(),this}}},{key:"name",get:function(){return"ErrorScreenPlugin"}},{key:"attributes",get:function(){return{class:"player-error-screen","data-error-screen":""}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_ERROR,handler:this.onError}]}},{key:"defaultOptions",get:function(){return{message:"C\xf3 l\u1ed7i x\u1ea3y ra!"}}}])&&mg(r.prototype,n),t}();function Sg(e){return(Sg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _g(e,t){return!t||"object"!==Sg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lg(e){return(Lg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pg(e,t){return(Pg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ig={disableHotKeys:!1},Rg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),_g(this,Lg(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pg(e,t)}(t,de),r=t,(n=[{key:"playPauseKey",value:function(e){return 32===e.which||179===e.which}},{key:"rewindKey",value:function(e){return 37===e.which||177===e.which}},{key:"forwardKey",value:function(e){return 39===e.which||176===e.which}},{key:"volumeUpKey",value:function(e){return 38===e.which}},{key:"volumeDownKey",value:function(e){return 40===e.which}},{key:"muteKey",value:function(e){return 77===e.which}},{key:"fullscreenKey",value:function(e){return 70===e.which}},{key:"numberKey",value:function(e){return e.which>47&&e.which<59||e.which>95&&e.which<106}},{key:"getNumberKey",value:function(e){var t=48;return e.which>95&&(t=96),e.which-t}},{key:"getKey",value:function(e){return!(e.metaKey||e.ctrlKey||e.altKey)&&(this.playPauseKey(e)?1:this.volumeUpKey(e)?2:this.volumeDownKey(e)?3:this.muteKey(e)?8:this.fullscreenKey(e)?4:this.rewindKey(e)?5:this.forwardKey(e)?6:this.numberKey(e)?9:void 0)}},{key:"_onPlayerKeydown",value:function(e){if(this.player.mediaControl.disabled)return!0;var t=this.getKey(e);if(!t)return!0;e.preventDefault(),e.stopPropagation(),this.player.mediaControl.show();var r=this.player.getCurrentTime(),n=100*this.player.getVolume(),i=this.player.getDuration(),a=this.getNumberKey(e);switch(t){case 1:this.player.togglePlay();break;case 2:this.player.setVolume(n+5,!0);break;case 3:this.player.setVolume(n-5,!0);break;case 8:this.player.isMuted()?this.player.unmute(!0):this.player.mute(!0);break;case 4:this.player.toggleFullscreen();break;case 5:this.player.seek(r-5);break;case 6:this.player.seek(r+5);break;case 9:this.player.seek(i*a*.1)}}},{key:"name",get:function(){return"HotKeysPlugin"}},{key:"defaultOptions",get:function(){return Ig}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_KEYDOWN,handler:this._onPlayerKeydown}]}}])&&wg(r.prototype,n),t}();function Cg(e){return(Cg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Og(e,t){return!t||"object"!==Cg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function zg(e){return(zg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Mg(e,t){return(Mg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var xg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Og(this,zg(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Mg(e,t)}(t,de),r=t,(n=[{key:"setUp",value:function(){this.userInteractive=!1}},{key:"_onPlayerClickEvent",value:function(){this.player.isMenuOpen||(wt?(this.userInteractive&&this.player.togglePlay(),this.userInteractive=!0):this.player.togglePlay())}},{key:"_onHideMediaControl",value:function(){this.userInteractive=!1}},{key:"name",get:function(){return"ClickToPausePlugin"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_CLICK,handler:this._onPlayerClickEvent},{name:U.PLAYER_MEDIACONTROL_HIDE,handler:this._onHideMediaControl}]}}])&&Dg(r.prototype,n),t}();function Bg(e){return(Bg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Ng(e,t){return!t||"object"!==Bg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ug(e){return(Ug=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function jg(e,t){return(jg=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Gg=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ng(this,Ug(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jg(e,t)}(t,de),r=t,(n=[{key:"_onDblClicked",value:function(){this.options.dblClickToFullScreen&&!wt&&this.player.toggleFullscreen()}},{key:"name",get:function(){return"DoubleClickToFullscreen"}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_DBLCLICK,handler:this._onDblClicked}]}}])&&Fg(r.prototype,n),t}(),Yg=r(5),Vg=r(3),Hg=r.n(Vg),Kg=function(){return new Promise((function(e,t){var r=new XMLHttpRequest;r.open("HEAD","//zjs-zcast.zingcdn.me/zplayer/ads.js?ad",!0),r.onreadystatechange=function(){r.readyState===XMLHttpRequest.DONE&&(200===r.status?e():t(new Error("Ad Blocker is enabled")))},r.send()}))};function Qg(){var e=Array.prototype.slice.call(arguments);if(window.fetch)return window.fetch.apply(window,e);function t(e){if("string"!=typeof e&&(e=e.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=e.toString()),e}function n(e){var t=this;this.map={},e instanceof n?e.forEach((function(e,r){r.forEach((function(r){t.append(e,r)}))})):e&&Object.getOwnPropertyNames(e).forEach((function(r){t.append(r,e[r])}))}function i(e){if(e.bodyUsed)return fetch.Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function a(e){return new fetch.Promise((function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}}))}function o(e){var t=new FileReader;return t.readAsArrayBuffer(e),a(t)}n.prototype.append=function(e,n){e=t(e),n=r(n);var i=this.map[e];i||(i=[],this.map[e]=i),i.push(n)},n.prototype.delete=function(e){delete this.map[t(e)]},n.prototype.get=function(e){var r=this.map[t(e)];return r?r[0]:null},n.prototype.getAll=function(e){return this.map[t(e)]||[]},n.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},n.prototype.set=function(e,n){this.map[t(e)]=[r(n)]},n.prototype.forEach=function(e){var t=this;Object.getOwnPropertyNames(this.map).forEach((function(r){e(r,t.map[r])}))};var s={blob:"FileReader"in window&&"Blob"in window&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in window};function l(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,"string"==typeof e)this._bodyText=e;else if(s.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(s.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else{if(e)throw new Error("unsupported BodyInit type");this._bodyText=""}},s.blob?(this.blob=function(){var e=i(this);if(e)return e;if(this._bodyBlob)return fetch.Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return fetch.Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(o)},this.text=function(){var e,t,r=i(this);if(r)return r;if(this._bodyBlob)return e=this._bodyBlob,(t=new FileReader).readAsText(e),a(t);if(this._bodyFormData)throw new Error("could not read FormData body as text");return fetch.Promise.resolve(this._bodyText)}):this.text=function(){return i(this)||fetch.Promise.resolve(this._bodyText)},s.formData&&(this.formData=function(){return this.text().then(f)}),this.json=function(){return this.text().then((function(e){return JSON.parse(e)}))},this}var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function c(e,t){var r,i;if(t=t||{},this.url=e,this.credentials=t.credentials||"omit",this.headers=new n(t.headers),this.method=(i=(r=t.method||"GET").toUpperCase(),u.indexOf(i)>-1?i:r),this.mode=t.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(t.body)}function f(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}})),t}function d(e){var t=new n;return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){var r=e.trim().split(":"),n=r.shift().trim(),i=r.join(":").trim();t.append(n,i)})),t}var h=!("undefined"==typeof window||!window.ActiveXObject||window.XMLHttpRequest&&(new XMLHttpRequest).dispatchEvent);function p(e,t){t||(t={}),this._initBody(e),this.type="default",this.url=null,this.status=t.status,this.ok=this.status>=200&&this.status<300,this.statusText=t.statusText,this.headers=t.headers instanceof n?t.headers:new n(t.headers),this.url=t.url||""}return l.call(c.prototype),l.call(p.prototype),window.Headers=n,window.Request=c,window.Response=p,window.fetch=function(e,t){var r;return r=c.prototype.isPrototypeOf(e)&&!t?e:new c(e,t),new fetch.Promise((function(e,t){var n=function(){return h&&!/^(get|post|head|put|delete|options)$/i.test(this.method)?(this.usingActiveXhr=!0,new window.ActiveXObject("Microsoft.XMLHTTP")):new XMLHttpRequest}.call(this);function i(){if(4===n.readyState){var r=1223===n.status?204:n.status;if(r<100||r>599)t(new TypeError("Network request failed"));else{var i={status:r,statusText:n.statusText,headers:d(n),url:"responseURL"in n?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):void 0},a="response"in n?n.response:n.responseText;e(new p(a,i))}}}"cors"===r.credentials&&(n.withCredentials=!0),n.onreadystatechange=i,this.usingActiveXhr||(n.onload=i,n.onerror=function(){t(new TypeError("Network request failed"))}),n.open(r.method,r.url,!0),"responseType"in n&&s.blob&&(n.responseType="blob"),r.headers.forEach((function(e,t){t.forEach((function(t){n.setRequestHeader(e,t)}))})),n.send(void 0===r._bodyInit?null:r._bodyInit)}))},fetch.Promise=window.Promise,window.fetch.polyfill=!0,window.fetch.apply(window,e)}var Wg=function(e,t){return Promise.resolve().then(Kg).then((function(){return function(e){return"function"==typeof e?e():e}(e)})).then(qg).then((function(e){return function(e,t){var r;O.debug("AdLoader","loading ad from source:",e);var n=Qg(e,{credentials:"include"}).then((function(e){return e.json()})).then((function(e){return clearTimeout(r),e&&e.ads?e.ads.schedule:[]})),i=new Promise((function(e,n){r=setTimeout((function(){return n(new Error("Timeout reached: ".concat(t)))}),t)}));return Promise.race([n,i])}(e,t)}))};function qg(e){if(!e)throw new Error("no ad source");return e}function Xg(e){return(Xg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jg(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Zg(e,t){return!t||"object"!==Xg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $g(e,t,r){return($g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=ev(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function ev(e){return(ev=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function tv(e,t){return(tv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var rv=["PosterPlugin","ClickToPausePlugin","DoubleClickToFullscreen","PauseAdPlugin","HotKeysPlugin"],nv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Zg(this,ev(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tv(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){this.interferedPlugins=[],this.pauseContentRequested=!1,this.interferedPluginNames=rv.slice(0),O.debug(this.name,"initializing"),this._loadSource()}},{key:"addInterferedPlugin",value:function(e){this.interferedPluginNames.push(e)}},{key:"getPluginOptions",value:function(){return ae(this.defaultOptions,ne(this._options,"pluginsOptions.ads")||this.defaultOptions)}},{key:"render",value:function(){$g(ev(t.prototype),"render",this).call(this),this.$el.hide()}},{key:"init",value:function(){throw new Error("this must be overridden")}},{key:"canHandle",value:function(e){throw new Error("this must be overridden")}},{key:"onAdsDataLoaded",value:function(e){throw new Error("this must be overridden")}},{key:"onAdWillStart",value:function(){O.info(this.name,"ad will start"),this.player.trigger(U.PLAYER_AD_WILL_START)}},{key:"onAdStarted",value:function(){O.info(this.name,"ad started"),this.player.trigger(U.PLAYER_AD_STARTED)}},{key:"onAdStopped",value:function(e){O.info(this.name,"ad stopped:",e),this.player.trigger(U.PLAYER_AD_STOPPED,{reason:e})}},{key:"onAdSkipped",value:function(){O.info(this.name,"ad skipped"),this.player.trigger(U.PLAYER_AD_SKIPPED)}},{key:"pauseForAd",value:function(){return this.pauseContentRequested?Hg.a.resolve():(O.debug(this.name,"pauseForAd"),this.pauseContentRequested=!0,this._disableMediaControl(),this._disableInterferedPlugins(),this.$el.show(),this._pausePlayback())}},{key:"resumeAfterAd",value:function(){return O.debug(this.name,"resumeAfterAd"),this.pauseContentRequested?(this.pauseContentRequested=!1,this._enableMediaControl(),this._enableInterferedPlugins(),this.$el.hide(),this._resumePlayback()):Hg.a.resolve()}},{key:"_pausePlayback",value:function(){return this.player.pause()}},{key:"_resumePlayback",value:function(){return this.player.playback.ended?Hg.a.resolve():this.player.play()}},{key:"_disableInterferedPlugins",value:function(){var e=this;this.interferedPlugins=this.interferedPluginNames.map((function(t){return function(e){return e&&e.enabled?{enable:e.enable.bind(e),disable:e.disable.bind(e)}:{enable:function(){},disable:function(){}}}(e.player.getPlugin(t))})),this.interferedPlugins.forEach((function(e){return e.disable()}))}},{key:"_enableInterferedPlugins",value:function(){this.interferedPlugins.forEach((function(e){return e.enable()}))}},{key:"_disableMediaControl",value:function(){this.mediaControlDisabled=this.player.mediaControl.disabled,this.mediaControlDisabled||this.player.mediaControl.disable()}},{key:"_enableMediaControl",value:function(){this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"_loadSource",value:function(){var e=this,t=this.pluginOptions,r=t.source,n=t.loadTimeout,i=void 0===n?3e3:n;(this.pluginOptions.adLoadFn||Wg)(r,i).then((function(t){return e.onAdsDataLoaded(t)}),(function(t){/timeout reached/.test(t.message)&&e.player.trigger(U.PLAYER_AD_LOAD_TIMEOUT),O.error(e.name,"Cannot load ad:",t),e.onAdsDataLoaded(null)}))}},{key:"name",get:function(){return"AdsBase"}},{key:"attributes",get:function(){return{class:this.name}}}])&&Jg(r.prototype,n),t}();function iv(e){return(iv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function av(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ov(e,t){return!t||"object"!==iv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sv(e,t,r){return(sv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=lv(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function lv(e){return(lv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function uv(e,t){return(uv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(51);var cv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ov(this,lv(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&uv(e,t)}(t,nv),r=t,(n=[{key:"setUp",value:function(){O.debug(this.name,"setUp"),sv(lv(t.prototype),"setUp",this).call(this),this.metadataDeferred=_t(),this.runnerDeferred=_t(),this.runnerDeferredPromise=this.runnerDeferred.promise,this.rootPosterConfig=this.pluginOptions.poster,this._onResize=this._onResize.bind(this),window.on("resize.ads",this._onResize,!1),this.player.$el.append(this.$el),this.nonLinearAdContainer=Ie("div",{},{class:"AdsPluginNonLinear"}),this.player.$el.append(this.nonLinearAdContainer),this.runner=null}},{key:"onAdsDataLoaded",value:function(e){var t=this;this._transformAdsData(e).then((function(e){e&&e.length?t._runnerProxy((function(){t.runner.onAdsDataLoaded(e)})):(O.info(t.name,"empty ad data, destroying plugin..."),t.destroy())}))}},{key:"destroy",value:function(){var e=this;sv(lv(t.prototype),"destroy",this).call(this),window.off("resize.ads",this._onResize,!1),Fe(this.nonLinearAdContainer),this._runnerProxy((function(){e.runner.destroy(),e.runner=null})),O.debug(this.name,"destroyed")}},{key:"getPoster",value:function(){var e=this.player.getPlayerSize().width;if(this.pluginOptions.poster=!(e<=400)&&this.rootPosterConfig,!this.pluginOptions.poster)return Promise.resolve();var t=this.player.getPlugin("PosterPlugin");return t?Promise.resolve(t.getPosterUrl()):Promise.resolve()}},{key:"getContentPlayer",value:function(){return this.player.playback.el}},{key:"getContentVolume",value:function(){return this.player.isMuted()?0:100*this.player.getVolume()}},{key:"getContentMetadata",value:function(){return this.metadataDeferred.promise}},{key:"getAdContainers",value:function(){var e=this.player.mediaControl.getControl("SeekBarControl");return{linear:this.el,nonLinear:this.nonLinearAdContainer,notification:this.player.el,adMark:e&&e.el}}},{key:"getLogger",value:function(){return O}},{key:"onAdStarted",value:function(){var e=this;sv(lv(t.prototype),"onAdStarted",this).call(this),!this.player.options.customIosFullscreen&&ht&&Rh.isFullscreen()&&(O.info(this.name,"player in fullscreen mode on iOS, skipping ad..."),this._runnerProxy((function(){e.runner.stopAd()})))}},{key:"_onUserActionEvent",value:function(){var e=this;this._runnerProxy((function(){e.runner.onUserAction()}))}},{key:"_onPlaybackEnded",value:function(){var e=this;this._runnerProxy((function(){e.runner.onContentEnded()})),this.pluginOptions.replayAds&&this._loadSource()}},{key:"_onPlayerError",value:function(){this.destroy()}},{key:"_onTimeUpdate",value:function(e){var t=this;this.player.mediaControl.draggingSeekBar||this._runnerProxy((function(){t.runner.onContentProgress(e)}))}},{key:"_onLoadedMetadata",value:function(e){this.player.getDuration()<this.pluginOptions.minDurationShowAd&&this.destroy(),this.metadataDeferred.resolve(e)}},{key:"_onAdPauseRequest",value:function(){this._pauseAd()}},{key:"_onAdResumeRequest",value:function(){this._resumeAd()}},{key:"_onResize",value:function(e){var t=this,r=arguments,n=this.player.getPlayerSize().width,i=this.rootPosterConfig&&n>400;this._runnerProxy((function(){var n=t.runner;te.nullOrUndefined(n)||(n.showPosterAndPlayIcon(i),"resize"===e.type?n.resize():n.resize.apply(n,r))}))}},{key:"_pauseAd",value:function(){var e=this;this._runnerProxy((function(){e.runner.pauseAd()}))}},{key:"_resumeAd",value:function(){var e=this;this._runnerProxy((function(){e.runner.resumeAd()}))}},{key:"_transformAdsData",value:function(e){var t=this.pluginOptions.transform;return"function"!=typeof t?Promise.resolve(e):(O.debug(this.name,"transforming ad data..."),this.getContentMetadata().then((function(r){return t(e,r)})))}},{key:"_runnerProxy",value:function(e){this.runnerDeferred&&this.runnerDeferredPromise.then(e)}},{key:"_toggleMediaControls",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this._runnerProxy((function(){var r=t?"addClass":"removeClass";e.runner.adUi.countdownToPlay[r]("has_controls_bar"),e.runner.adUi.$uiLoading[r]("has_controls_bar")}))}},{key:"_onPlayerControlShow",value:function(){this._toggleMediaControls()}},{key:"_onPlayerControlHide",value:function(){this._toggleMediaControls(!1)}},{key:"_onPlayerControlReady",value:function(){this.runner||(this.runnerOptions={startTimeout:this.pluginOptions.startTimeout/1e3,skipTimeout:this.pluginOptions.skipTimeout/1e3,countdownPlay:!this.pluginOptions.noCountdownPlay,showSlideBlack:this.pluginOptions.showSlideBlack,removeAdmarkOnError:this.pluginOptions.removeAdmarkOnError,autoPlayAdBreaks:this.pluginOptions.autoPlayAdBreaks,autoPlay:!!this.player.options.autoPlay,mute:!!this.player.options.mute},this.runner=new Yg.Runner(this,this.runnerOptions),this.runnerDeferred.resolve())}},{key:"_onPlayerFullscreen",value:function(){this._onResize("resize")}},{key:"name",get:function(){return"AdsPlugin"}},{key:"defaultOptions",get:function(){return{replayAds:!1,showSlideBlack:!0,removeAdmarkOnError:!0,startTimeout:1e4,skipTimeout:3e3,autoPlayAdBreaks:!0,minDurationShowAd:5}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_PLAY_INTENT,handler:this._onUserActionEvent},{name:U.PLAYER_TIMEUPDATE,handler:this._onTimeUpdate},{once:!0,name:U.PLAYER_LOADEDMETADATA,handler:this._onLoadedMetadata},{once:!this.pluginOptions.replayAds,name:U.PLAYER_ENDED,handler:this._onPlaybackEnded},{name:U.PLAYER_ERROR,handler:this._onPlayerError},{name:U.PLAYER_AD_PAUSE_REQUEST,handler:this._onAdPauseRequest},{name:U.PLAYER_AD_RESUME_REQUEST,handler:this._onAdResumeRequest},{name:U.PLAYER_UPDATE_SIZE,handler:this._onResize},{name:U.PLAYER_MEDIACONTROL_SHOW,handler:this._onPlayerControlShow},{name:U.PLAYER_MEDIACONTROL_HIDE,handler:this._onPlayerControlHide},{once:!0,name:U.PLAYER_MEDIACONTROL_READY,handler:this._onPlayerControlReady},{name:U.PLAYER_FULLSCREEN,handler:this._onPlayerFullscreen}]}}])&&av(r.prototype,n),t}();function fv(e){return(fv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hv(e,t){return!t||"object"!==fv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pv(e){return(pv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function gv(e,t){return(gv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(53);var vv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),hv(this,pv(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gv(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"handleClick",value:function(e){return e.stopPropagation(),this.player.play(),this.player.el.focus(),!1}},{key:"_onPlayerPlay",value:function(){this.hide()}},{key:"_onPlayerPause",value:function(){this.pluginOptions.showOnPauseMobile&&this.show()}},{key:"render",value:function(){var e=Ie("span",{},{class:"--z--icon pl-ic-play_arrow"});return Ee(e,this.pluginOptions.iconStyles),Ee(this.el,this.pluginOptions.buttonStyles),this.setAttribute("title","Ph\xe1t"),this.el.append(e),this.player.el.append(this.el),this}},{key:"name",get:function(){return"BigPlayButtonPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--big-play-button"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_PLAY,handler:this._onPlayerPlay},{name:U.PLAYER_PLAY_INTENT,handler:this._onPlayerPlay},{name:U.PLAYER_PAUSE,handler:this._onPlayerPause}]}},{key:"defaultOptions",get:function(){return{showOnPauseMobile:!0}}}])&&dv(r.prototype,n),t}();function yv(e){return(yv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Av(e,t){return!t||"object"!==yv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bv(e){return(bv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ev(e,t){return(Ev=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(55);var kv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Av(this,bv(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ev(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){this.pluginOptions.disabled||wt?this.disable():(this.bigPlayButtonPlugin=this.player.getPlugin("BigPlayButtonPlugin"),this.isPlaying=!this.player.isPlaying(),this.mediaControlDisabled=this.player.mediaControl.disabled,this.bigPlayButtonEnabled=this.bigPlayButtonPlugin.enabled)}},{key:"_disableInterferedPlugins",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.disable()}},{key:"_onPlayerPlayIntent",value:function(){this._disableInterferedPlugins()}},{key:"_onPlayerClick",value:function(){this.player.isMenuOpen||this._togglePlayPause()}},{key:"_togglePlayPause",value:function(){var e=this;this.isPlaying=!this.isPlaying,Ee(this.el,{display:"flex"}),setTimeout((function(){Ee(e.el,{display:"none"})}),500),Ae(this.iconEl,"pl-ic-play_arrow",this.isPlaying),Ae(this.iconEl,"pl-ic-pause",!this.isPlaying)}},{key:"_onPlayerEnded",value:function(){this.bigPlayButtonEnabled&&this.bigPlayButtonPlugin.enable(),this.mediaControlDisabled||this.player.mediaControl.enable()}},{key:"render",value:function(){return this.iconEl=Ie("span",{},{class:"--z--icon pl-ic-play_arrow"}),Ee(this.iconEl,this.pluginOptions.iconStyles),Ee(this.el,this.pluginOptions.buttonStyles),this.el.append(this.iconEl),this.player.el.append(this.el),this}},{key:"name",get:function(){return"PlayPauseFaceoutPlugin"}},{key:"tagName",get:function(){return"button"}},{key:"className",get:function(){return"--z--playpause-fadeout"}},{key:"attributes",get:function(){return{class:this.className,type:"button"}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_CLICK,handler:this._onPlayerClick},{name:U.PLAYER_ENDED,handler:this._onPlayerEnded},{name:U.PLAYER_PLAY_INTENT,handler:this._onPlayerPlayIntent}]}}])&&mv(r.prototype,n),t}(),Tv=new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"}),Sv=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"});function wv(e){return Object.assign({muted:!1,timeout:250,inline:!1},e)}function _v(e,t){var r=e.muted,n=e.timeout,i=e.inline,a=t(),o=a.element,s=a.source,l=void 0,u=void 0,c=void 0;return o.muted=r,!0===r&&o.setAttribute("muted","muted"),!0===i&&o.setAttribute("playsinline","playsinline"),o.src=s,new Promise((function(e){l=o.play(),u=setTimeout((function(){c(!1,new Error("Timeout "+n+" ms has been reached"))}),n),c=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(u),e({result:t,error:r})},void 0!==l?l.then((function(){return c(!0)})).catch((function(e){return c(!1,e)})):c(!0)}))}var Lv={audio:function(e){return _v(e=wv(e),(function(){return{element:document.createElement("audio"),source:URL.createObjectURL(Tv)}}))},video:function(e){return _v(e=wv(e),(function(){return{element:document.createElement("video"),source:URL.createObjectURL(Sv)}}))}};function Pv(e){return(Pv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Iv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Rv(e,t,r){return(Rv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Cv(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Cv(e){return(Cv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Dv(e,t){return(Dv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(57);var Ov=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=function(e,t){return!t||"object"!==Pv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Cv(t).call(this,e))).pluginOptions=r,n.render(),n.bindEvents(),n}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Dv(e,t)}(t,Ve),r=t,(n=[{key:"render",value:function(){return Rv(Cv(t.prototype),"render",this).call(this),this.el.innerHTML='<button class="--z--btn-unmute" title=\''.concat(this.pluginOptions.boxUnmute.message,'\'>\n                                <i class="--z--icon pl-ic-volume_off"></i>\n                            </button>\n                            <span>').concat(this.pluginOptions.boxUnmute.message,"</span>"),this.player.el.append(this.el),this}},{key:"handleClick",value:function(e){e.stopPropagation(),this.player.unmute(),this.remove()}},{key:"_update",value:function(){this.player.isMuted()||this.remove()}},{key:"attributes",get:function(){return{class:"--z--unmute-box"}}},{key:"listenEvents",get:function(){return[{name:U.PLAYER_VOLUMEUPDATE,handler:this._update}]}},{key:"events",get:function(){return{click:"handleClick",touch:"handleClick"}}}])&&Iv(r.prototype,n),t}();function zv(e){return(zv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Mv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function xv(e,t){return!t||"object"!==zv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bv(e,t,r){return(Bv="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Fv(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function Fv(e){return(Fv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Nv(e,t){return(Nv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Uv=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xv(this,Fv(t).apply(this,arguments))}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nv(e,t)}(t,de),r=t,i=[{key:"NAME_EVENTS",get:function(){return["PLUGIN_AUTOPLAY_MUTE","PLUGIN_AUTOPLAY_DENIED"]}}],(n=[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"setUp",value:function(){var e=this;if(this.options.autoPlay&&this.enabled){var t="";switch(this.player.getPlaybackType()){case ot.VOD:t="video";break;case ot.AOD:t="audio"}t&&Lv[t]({timeout:this.pluginOptions.timeout,inline:!0}).then((function(r){r.result?e.player.play():(e.player.mute(),Lv[t]({timeout:e.pluginOptions.timeout,muted:!0,inline:!0}).then((function(t){var r=t.result,n=t.error;r?(O.info(e.name,"autoplay muted"),e.player.play(),e.trigger(e._nameEvents.PLUGIN_AUTOPLAY_MUTE),e.pluginOptions.showBoxUnmute&&(e.boxUnmute=new Ov(e.player,e.pluginOptions))):(O.warn(e.name,"autoplay failed: ",n),e.player.unmute(),e.trigger(e._nameEvents.PLUGIN_AUTOPLAY_DENIED))})).catch((function(){e.player.unmute(),e.trigger(e._nameEvents.PLUGIN_AUTOPLAY_DENIED)})))})),this.player.getPlayerControl("SettingsControl")&&this.pluginOptions.showInSettingsMenu&&(this.pluginLabel="T\u1ef1 \u0111\u1ed9ng ph\xe1t",this.autoPlayChecked=!!this.options.autoPlay,this.updateSettingsControl())}else this.disable()}},{key:"_toggleAutoPlay",value:function(e){e.stopPropagation(),this.autoPlayChecked=!this.autoPlayChecked,this.updateSettingsControl(!0)}},{key:"updateSettingsControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.getPlayerControl("SettingsControl");t&&t.settingsMenu[e]({pluginKey:this.name,type:Wh.MENU_TYPE.TOGGLE,config:{title:this.pluginLabel,checked:this.autoPlayChecked,clickCallback:this._toggleAutoPlay.bind(this)},order:0,callback:this.registerMenuCallback.bind(this)})}},{key:"destroy",value:function(){Bv(Fv(t.prototype),"destroy",this).call(this),this.boxUnmute&&this.boxUnmute.remove()}},{key:"name",get:function(){return"AutoPlayPlugin"}},{key:"defaultOptions",get:function(){return{showInSettingsMenu:!1,timeout:1e3,showBoxUnmute:!0,boxUnmute:{message:"Nh\u1ea5n \u0111\u1ec3 b\u1eadt ti\u1ebfng"}}}}])&&Mv(r.prototype,n),i&&Mv(r,i),t}();function jv(e,t){if(te.array(e)&&t){var r=Ht(e.filter((function(e){return!e.disabled})),"label",t);if(te.object(r)&&(r.source||r.level))return r}}function Gv(e){return(Gv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Yv(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function Vv(e){return(Vv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Hv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Kv(e,t,r){return t&&Hv(e.prototype,t),r&&Hv(e,r),e}function Qv(e,t){return(Qv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Wv=function(e){function t(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=function(e,t){return!t||"object"!==Gv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,Vv(t).call(this,e))).pluginLabel="Ch\u1ea5t l\u01b0\u1ee3ng",r.currentSourceLevel=null,r.autoEnabled=!0,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qv(e,t)}(t,Xe),Kv(t,[{key:"name",get:function(){return"QualityPlugin"}},{key:"defaultOptions",get:function(){return{autoText:"Auto",autoTextItem:"Auto"}}}]),Kv(t,[{key:"registerMenuCallback",value:function(e){this.menuItemEl=e}},{key:"render",value:function(){if(this.player.isHlsPlayback())return this.listenTo(this.player,U.PLAYER_LEVELS_AVAILABEL,this.onPlayerLevelsAvailabel),void this.listenTo(this.player,U.PLAYER_LEVEL_SWITCHED,this.onPlayerLevelSwitched);if(this.autoEnabled=!1,this.levels=this.player.options.sources||[],this.handleDisplayName(),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):0,this.levels.length<2||-1===this.currentSourceLevel)this.disable();else{this.levels=this.orderLevelsByIndex(this.levels),this.handleDisplayName();var e=this.levels[this.currentSourceLevel];this.settingBadgeLabel=this._generateHdLabel(e.label),this.updateSettingsControl()}}},{key:"updateSettingsControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0]?"asyncRegisterMenuItem":"registerMenuItem",t=this.player.mediaControl.getControl("SettingsControl");t&&(t.settingsButton.updateBadgeLabel(this.settingBadgeLabel),t.settingsMenu[e]({pluginKey:this.name,type:Wh.MENU_TYPE.EXPAND,config:{title:this.pluginLabel,activeItemIndex:this.currentSourceLevel,clickCallback:this.handleExpandQuality.bind(this),subMenu:{type:Wh.LIST_MENU_TYPE.CHECKLIST,clickCallback:this.handleQualitySelected.bind(this),titleClickCallback:this.titleClickCallback.bind(this),data:this.levels}},order:0,callback:this.registerMenuCallback.bind(this)}))}},{key:"handleDisplayName",value:function(){var e=this.pluginOptions,t=e.displayName,r=e.autoTextItem;(t||r)&&this.levels.map((function(e){if(t&&e.label){var n=t[e.label];n&&(e.displayName=n)}return"auto"==e.label.toLowerCase()&&(e.label=r),e}))}},{key:"orderLevelsByIndex",value:function(e){return Vt(e,"index",!1)}},{key:"onPlayerLevelsAvailabel",value:function(e){var t=this.player.options.sources||[];this.levels=this.orderLevelsByIndex([].concat(Yv(e),Yv(t))),this.handleDisplayName();var r=jv(this.levels,this.player.options.quality);r&&(this.player.options.currentSourceLevel=r.index,this.settingBadgeLabel=this._generateHdLabel(r.label),this.offAuto=!0),this.currentSourceLevel=void 0!==this.player.options.currentSourceLevel?this.findIndexFromSourceLevels(this.player.options.currentSourceLevel):this.findIndexFromSourceLevels(-1);var n=this.levels[this.currentSourceLevel];n&&-1!==n.index&&this.handleHLSLevelSelect(n)}},{key:"findIndexFromSourceLevels",value:function(e){return Qt(this.levels,"index",e)}},{key:"_generateHdLabel",value:function(e){var t=parseInt(e);return this.currentLabel=e,t>=720?"HD":""}},{key:"onPlayerLevelSwitched",value:function(e){var t=e.label;this.currentSwitchedLabel=t,clearTimeout(this.playerLevelSwitchedTimeout),!this.offAuto&&(this.settingBadgeLabel=this._generateHdLabel(t)),this.updateSettingsControl(!0);var r=pe()(this.menuItemEl).find(".--z--zpl-has-expand span"),n=this.pluginOptions.autoText;this.autoEnabled&&(r.empty(),r.text(n+" "+this.transformDisplayNameLabel(t)))}},{key:"titleClickCallback",value:function(){var e=pe()(this.menuItemEl).find(".--z--zpl-has-expand span"),t=this.pluginOptions.autoText;this.autoEnabled&&(e.empty(),e.text(t+" "+this.transformDisplayNameLabel(this.currentLabel)))}},{key:"transformDisplayNameLabel",value:function(e){var t=this.pluginOptions.displayName;return t&&t[e]||e}},{key:"handleQualitySelected",value:function(e,t){e.stopPropagation();var r=t.data;if(this.player.trigger(U.PLAYER_QUALITY_LEVELS_SELECTED,r,t),this.player.trigger(U.PLAYER_SETTINGS_MENU_HIDE),r&&!r.disabled){var n=this.findIndexFromSourceLevels(r.index);if(this.currentSourceLevel===n)return!1;this.player.storage.set({quality:r.label}),this.player.isHlsPlayback()?this.handleHLSLevelSelect(r):this.handleMP4QualitySelect(r)}}},{key:"handleMP4QualitySelect",value:function(e){var t=this.player.getCurrentTime(),r=this.player.isPlaying();this.player.stop(),this.player.setupSource(e.source),this.player.setPreload("metadata"),r&&this.listenToOnce(this.player,U.PLAYER_SEEKED,this.onPlayerSeeked),this.player.seek(t),this.currentSourceLevel=this.findIndexFromSourceLevels(e.index),this.settingBadgeLabel=this._generateHdLabel(e.label),this.autoEnabled=!1,this.updateSettingsControl(!0)}},{key:"onPlayerSeeked",value:function(){this.player.play()}},{key:"handleHLSLevelSelect",value:function(e){var t=this,r=e.index,n=-1===r;n&&(this.offAuto=!1),this.currentSourceLevel=this.findIndexFromSourceLevels(r),this.autoEnabled=n,this.player.setCurrentLevel(r),this.player.setStartLevel(r),this.playerLevelSwitchedTimeout=setTimeout((function(){t.onPlayerLevelSwitched({label:t.currentSwitchedLabel})}),1e3)}},{key:"handleExpandQuality",value:function(e){e.stopPropagation()}}]),t}();function qv(e){return(qv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xv(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Jv(e,t){return!t||"object"!==qv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Zv(e){return(Zv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}r(59);var ey=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Jv(this,Zv(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$v(e,t)}(t,Xe),r=t,(n=[{key:"setUp",value:function(){this.pluginOptions.disabled&&this.disable()}},{key:"dvrChanged",value:function(){O.info(this.name,"dvrChanged"),this.addDvrToMediaControls()}},{key:"addDvrToMediaControls",value:function(){if(this.player.isLive()){var e=Ie("button",{innerHTML:'<span class="icon-live"></span><span class="text">LIVE</span>'},{class:"--z--control --z--btn --z--drv-icon"});this.$el.append(e),this.player.mediaControl.leftElement.append(this.el)}}},{key:"name",get:function(){return"DVRControlsPlugin"}},{key:"attributes",get:function(){return{class:"--z--control --z--control-dvr","data-dvr-controls":""}}},{key:"listenEvents",get:function(){return[{once:!0,name:U.PLAYER_DVRSTATECHANGED,handler:this.dvrChanged}]}}])&&Xv(r.prototype,n),t}();function ty(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var ry=function e(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.playbackPlugins=[uf,ef,Yt,gf],this.plugins=[],r&&this.plugins.push(_p);var n=[Op,vv,kv,xg,Gg,Uv,jp,Tg,Rg,cv,ey,Wv];if(this.plugins=[].concat(ty(this.plugins),n),this.plugins.push(gg),!te.empty(t)){var i=!0,a=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var u=s.value;te.function(u)&&this.plugins.push(u)}}catch(e){a=!0,o=e}finally{try{i||null==l.return||l.return()}finally{if(a)throw o}}}};function ny(e){return(ny="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function ay(e,t){return!t||"object"!==ny(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function oy(e){return(oy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function sy(e,t){return(sy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}window.on=document.on=Element.prototype.on=function(e,t,r){this.namespaces||(this.namespaces={}),this.namespaces[e]=t;var n=r||!1;return this.addEventListener(e.split(".")[0],t,n),this},window.off=document.off=Element.prototype.off=function(e){return this.removeEventListener(e.split(".")[0],this.namespaces[e]),delete this.namespaces[e],this};var ly=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ay(this,oy(t).apply(this,arguments))}var r,n;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sy(e,t)}(t,Xe),r=t,(n=[{key:"getControl",value:function(){return null}},{key:"show",value:function(){}},{key:"hide",value:function(){}}])&&iy(r.prototype,n),t}();function uy(e){return(uy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function cy(e,t,r){return(cy="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=fy(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(r):i.value}})(e,t,r||e)}function fy(e){return(fy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function dy(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function hy(e,t,r){return t&&dy(e.prototype,t),r&&dy(e,r),e}function py(e,t){return(py=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gy(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var vy={mute:!1,loop:!1,autoPlay:!1,volume:100,height:360,width:640,preload:"metadata",dblClickToFullScreen:!0,lockRotateFullscreen:!1,setStorageTheaterMode:!0},yy=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n,i=e.storageKey,a=new sg(void 0===i?"zplayer":i);return(r=!(n=fy(t).call(this,null,ae({},vy,e,a.get())))||"object"!==uy(n)&&"function"!=typeof n?gy(this):n)._extendsOptions(r.options),O.debug(r.name,"player initialized with option:",e),r.storage=a,r.plugins=[],r._onFullScreenChanged=r._onFullScreenChanged.bind(gy(gy(r))),r.onWindowBlur=r.onWindowBlur.bind(gy(gy(r))),r._onOrientationChanged=r._onOrientationChanged.bind(gy(gy(r))),r.isMenuOpen=!1,r.theaterMode=!!r.options.theaterMode,r.toggleClass("--theater-mode",r.theaterMode),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&py(e,t)}(t,Ve),hy(t,[{key:"name",get:function(){return"Player"}},{key:"attributes",get:function(){var e=this.options,t=e.width,r=e.height;return{class:e.className||"--z--player","data-player":"",tabindex:1,style:"\n                width: ".concat(t&&te.number(t)?t+"px":t,";\n                height: ").concat(r&&te.number(r)?r+"px":r,"\n            ")}}},{key:"events",get:function(){return{click:"onClicked",dblclick:"onDblClicked",contextmenu:"onContextMenu",keydown:"onKeydown",mousemove:"onMouseMove",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchstart:"onMouseMove",touchleave:"onMouseLeave"}}},{key:"listenEvents",get:function(){return[{name:U.PLAYBACK_BUFFERING,handler:this.onBuffering},{name:U.PLAYBACK_BUFFERING_CHANGE,handler:this.onBufferingChange},{name:U.PLAYBACK_BUFFERFULL,handler:this.onBufferfull},{name:U.PLAYBACK_LOADEDMETADATA,handler:this.onLoadedMetadata},{name:U.PLAYBACK_TIMEUPDATE,handler:this.onTimeUpdated},{name:U.PLAYBACK_PROGRESS,handler:this.onProgress},{name:U.PLAYBACK_SEEKED,handler:this.onSeeked},{name:U.PLAYBACK_SEEKING,handler:this.onSeeking},{name:U.PLAYBACK_ENDED,handler:this.onEnded},{name:U.PLAYBACK_PLAY,handler:this.onPlay},{name:U.PLAYBACK_PAUSE,handler:this.onPaused},{name:U.PLAYBACK_STOP,handler:this.onStopped},{name:U.PLAYBACK_ERROR,handler:this.onError},{name:U.PLAYBACK_VOLUMEUPDATE,handler:this.onVolumeUpdated},{name:U.PLAYBACK_LEVELS_AVAILABLE,handler:this.onLevelsAvailabel},{name:U.PLAYBACK_LEVEL_SWITCHED,handler:this.onLevelSwitched},{name:U.PLAYBACK_FULLSCREEN_IOS,handler:this._onFullScreenIosChanged},{name:U.PLAYBACK_CANPLAYTHROUGH,handler:this.onCanPlayThrough},{name:U.PLAYBACK_WAITING,handler:this.onWaiting},{once:!0,name:U.PLAYBACK_DVRSTATECHANGED,handler:this.onDrvChanged},{once:!0,name:U.PLAYBACK_PLAY,handler:this.onDrvChanged}]}},{key:"buffering",get:function(){return this.playback.buffering}},{key:"loader",set:function(e){this.loader=e},get:function(){return this._loader||(this._loader=new ry(this.options.plugins,this.options.useDefaultControl)),this._loader}},{key:"mediaControl",get:function(){return this.getPlugin("ControlsPlugin")||this.dummyMediaControl}},{key:"dummyMediaControl",get:function(){return this._dummyMediaControl||(this._dummyMediaControl=new ly(this)),this._dummyMediaControl}}]),hy(t,[{key:"bindEvents",value:function(){cy(fy(t.prototype),"bindEvents",this).call(this,this.playback),this._addEventsFullScreen(),window.on("orientationchange",this._onOrientationChanged,!1),window.on("blur",this.onWindowBlur,!1)}},{key:"unbindEvents",value:function(){cy(fy(t.prototype),"unbindEvents",this).call(this,this.playback),this._removeEventsFullScreen(),window.off("orientationchange",this._onOrientationChanged,!1),window.off("blur",this.onWindowBlur,!1)}},{key:"hasPlugin",value:function(e){return!!this.getPlugin(e)}},{key:"getPlugin",value:function(e){return this.plugins.find((function(t){return t.name===e}))}},{key:"removePlugin",value:function(e){this.plugins=this.plugins.filter((function(t){return t.name!==e}))}},{key:"getPlaybackType",value:function(){return this.playback.getPlaybackType()}},{key:"getPlaybackName",value:function(){return this.playback.name}},{key:"appendToParent",value:function(){if(!this.el)return null;this.options.parentElement.appendChild(this.el)}},{key:"render",value:function(){if(!this.el)return null;this.$el.append(this.playback.render().el)}},{key:"destroy",value:function(){this.plugins.forEach((function(e){return e.destroy()})),this.playback.destroy(),this.unbindEvents(),this.remove()}},{key:"attachTo",value:function(e){var t=this;this.options.parentElement=e,this._initPlayback(),this.bindEvents(),this.render(),this._initPlugins(),this.appendToParent(),this.playback.isReady().then((function(){return t._initConfig()})).then((function(){return Promise.all(t.plugins.map((function(e){return e.initialize()})))})).then((function(){O.info(t.name,"IS LIVE",t.isLive()),t.trigger(U.PLAYER_READY,t.name)})).catch((function(e){O.error(t.name,"error while initializing player:",e)})),this.setPlayerFontSizeBase()}},{key:"getDuration",value:function(){return this.playback.getDuration()}},{key:"isPlaying",value:function(){return this.playback.isPlaying()}},{key:"play",value:function(){this.isPlaying()||(this.trigger(U.PLAYER_PLAY_INTENT),this.playback.play())}},{key:"pause",value:function(){this.isPlaying()&&this.playback.pause()}},{key:"togglePlay",value:function(){this.buffering||(this.isPlaying()?this.pause():this.play())}},{key:"stop",value:function(){this.playback.stop()}},{key:"pauseAd",value:function(){this.trigger(U.PLAYER_AD_PAUSE_REQUEST)}},{key:"resumeAd",value:function(){this.trigger(U.PLAYER_AD_RESUME_REQUEST)}},{key:"getVolume",value:function(){return this.playback.getVolume()}},{key:"setVolume",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!te.number(e)||e<0||e>100)O.debug(this.name,"setVolume fail , volume = ",e);else{var r=this.getVolume();this.playback.volume(e),t&&this.storage.set({volume:e,beforeMuteVolume:r})}}},{key:"mute",value:function(e){return this.setVolume(0,e),this}},{key:"unmute",value:function(e){var t=this.storage.get("beforeMuteVolume");return(!te.number(t)||t<=0)&&(t=1),this.setVolume(100*t,e),this}},{key:"isMuted",value:function(){return this.playback.isMuted()}},{key:"seek",value:function(e){this.isLive()||e<0||e>this.getDuration()||(this.trigger(U.PLAYER_SEEK,e,this.name),this.playback.seek(e))}},{key:"isFullscreen",value:function(){return Rh.isFullscreen()}},{key:"isTheaterMode",value:function(){return this.theaterMode}},{key:"setupSource",value:function(e){this.playback.setupSource(e)}},{key:"getSource",value:function(){this.playback.getSource()}},{key:"setCurrentLevel",value:function(e){this.playback.currentLevel=e}},{key:"setStartLevel",value:function(e){this.playback.startLevel=e}},{key:"setPreload",value:function(e){this.playback.setPreload(e)}},{key:"getPlayerControl",value:function(e){return this.mediaControl&&this.mediaControl.getControl(e)}},{key:"setPlaybackRate",value:function(e){this.playback.setPlaybackRate(e)}},{key:"isHlsPlayback",value:function(){return this.playback.isHlsPlayback()}},{key:"isMp4Playback",value:function(){return!this.isHlsPlayback()}},{key:"seekPercentage",value:function(e){var t=this.getDuration();if(e>=0&&e<=100){var r=t*(e/100);this.seek(r)}}},{key:"setPlayerFontSizeBase",value:function(){wt&&Ee(this.el,{fontSize:(this.isFullscreen()?70:60)+"%"})}},{key:"toggleFullscreen",value:function(){var e=this.options,t=e.customIosFullscreen;e.lockRotateFullscreen&&(this.isLandscapeScreen()?ht&&this.removeClass("is-portrait"):(ht&&this.addClass("--z--orient-lock-fullscreen"),ht&&this.addClass("is-portrait"),setTimeout((function(){screen&&screen.orientation.lock("landscape")}),300)),this.isFullscreen()&&(ht&&this.removeClass("--z--orient-lock-fullscreen"),ht&&this.removeClass("is-portrait"),setTimeout((function(){return screen&&screen.orientation.unlock()}),300))),t?this._toggleFullScreenIos():this._toggleFullScreenNative()}},{key:"isLandscapeScreen",value:function(){return window.innerWidth>window.innerHeight}},{key:"getPlayBack",value:function(){return function(e,t,r){var n=null,i=r.mimeType;te.object(t)?(n=t.source.toString(),t.mimeType&&(i=t.mimeType)):n=t.toString(),n.match(/^\/\//)&&(n=window.location.protocol+n);var a=ae({},r,{src:n,mimeType:i}),o=e.filter((function(e){return e.canPlay(t,i)}))[0];return"no_op"===o.name&&r.fallbackSrc&&(o=e.filter((function(e){return e.canPlay(r.fallbackSrc,i)}))[0]),new o(a)}(this.loader.playbackPlugins,this.options.source,this.options)}},{key:"isLive",value:function(){return this.getPlaybackType()===ot.LIVE}},{key:"getCurrentTime",value:function(){return this.playback.el.currentTime}},{key:"getPlayerSize",value:function(){return{width:this.el.offsetWidth,height:this.el.offsetHeight}}},{key:"updateSize",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"px",n={};e&&(n.width=e+r),t&&(n.height=t+r),Ee(this.el,n),this.trigger(U.PLAYER_UPDATE_SIZE,this.el.offsetWidth,this.el.offsetHeight,this.isFullscreen())}},{key:"onClicked",value:function(){O.debug(this.name,"onClicked"),this.trigger(U.PLAYER_CLICK,this,this.name)}},{key:"onDblClicked",value:function(){this.trigger(U.PLAYER_DBLCLICK,this,this.name)}},{key:"onKeydown",value:function(e){this.trigger(U.PLAYER_KEYDOWN,e,this.name)}},{key:"onMouseEnter",value:function(){this.trigger(U.PLAYER_MOUSE_ENTER)}},{key:"onMouseLeave",value:function(){this.trigger(U.PLAYER_MOUSE_LEAVE)}},{key:"onMouseMove",value:function(){this.trigger(U.PLAYER_MOUSE_MOVE)}},{key:"onContextMenu",value:function(e){this.trigger(U.PLAYER_CONTEXTMENU,e,this.name)}},{key:"onBuffering",value:function(){this.trigger(U.PLAYER_BUFFERING,this.name)}},{key:"onBufferingChange",value:function(e){this.trigger(U.PLAYER_BUFFERING_CHANGE,e)}},{key:"onBufferfull",value:function(){this.trigger(U.PLAYER_BUFFERFULL,this.name)}},{key:"onLoadedMetadata",value:function(e){this.trigger(U.PLAYER_LOADEDMETADATA,e)}},{key:"onTimeUpdated",value:function(e){this.currentTime=e.current,this.trigger(U.PLAYER_TIMEUPDATE,e,this.name)}},{key:"onSeeked",value:function(){this.trigger(U.PLAYER_SEEKED,this.name)}},{key:"onSeeking",value:function(e){this.currentTime=e.data.target.currentTime,this.trigger(U.PLAYER_SEEKING,e)}},{key:"onWaiting",value:function(e){this.trigger(U.PLAYER_WAITING,e)}},{key:"onPlay",value:function(){O.debug(this.name,"PLAYER_PLAY"),this.trigger(U.PLAYER_PLAY,this.name)}},{key:"onPaused",value:function(){O.debug(this.name,"PLAYER_PAUSE"),this.trigger(U.PLAYER_PAUSE,this.name)}},{key:"onError",value:function(e){O.error(this.name,"player error:",e),this.trigger(U.PLAYER_ERROR,e,this.name)}},{key:"onStopped",value:function(){this.trigger(U.PLAYER_STOP)}},{key:"onEnded",value:function(){this.trigger(U.PLAYER_ENDED,this.name),this.currentTime=0}},{key:"onVolumeUpdated",value:function(e){this.trigger(U.PLAYER_VOLUMEUPDATE,e)}},{key:"onLevelsAvailabel",value:function(e){this.trigger(U.PLAYER_LEVELS_AVAILABEL,e)}},{key:"onLevelSwitched",value:function(e){this.trigger(U.PLAYER_LEVEL_SWITCHED,e)}},{key:"onCanPlayThrough",value:function(e){this.trigger(U.PLAYER_CANPLAYTHROUGH,e)}},{key:"onProgress",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.trigger.apply(this,[U.PLAYER_PROGRESS].concat(t,[this.name]))}},{key:"onDrvChanged",value:function(){this.trigger(U.PLAYER_DVRSTATECHANGED)}},{key:"onWindowBlur",value:function(){wt&&this.options.pauseOnBlur&&this.pause()}},{key:"_addEventsFullScreen",value:function(){document.on("webkitfullscreenchange",this._onFullScreenChanged,!1),document.on("mozfullscreenchange",this._onFullScreenChanged,!1),document.on("fullscreenchange",this._onFullScreenChanged,!1),document.on("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_removeEventsFullScreen",value:function(){document.off("webkitfullscreenchange",this._onFullScreenChanged,!1),document.off("mozfullscreenchange",this._onFullScreenChanged,!1),document.off("fullscreenchange",this._onFullScreenChanged,!1),document.off("MSFullscreenChange",this._onFullScreenChanged,!1)}},{key:"_onFullScreenIosChanged",value:function(e){O.debug(this.name,"fullscreen status changed on iOS:",e),Rh.isFullscreenIos=e,this._onFullScreenChanged()}},{key:"_onFullScreenChanged",value:function(){O.debug(this.name,"fullscreen status changed:",this.isFullscreen()),this.isFullscreen()?this.$el.addClass("--z--full-screen"):this.$el.removeClass("--z--full-screen"),this.setPlayerFontSizeBase(),this.trigger(U.PLAYER_FULLSCREEN,this.isFullscreen(),this.name)}},{key:"_onOrientationChanged",value:function(){var e=this,t=this.options,r=t.customIosFullscreen,n=t.lockRotateFullscreen;this.setPlayerFontSizeBase(),r&&this.isFullscreen()&&this.backdropEl&&Ee(this.backdropEl,{height:window.innerHeight+"px"}),n&&this.isFullscreen()&&ht&&setTimeout((function(){e.isLandscapeScreen()?(e.removeClass("--z--orient-lock-fullscreen"),e.removeClass("is-portrait")):(e.addClass("is-portrait"),e.addClass("--z--orient-lock-fullscreen"))}),300),this.trigger(U.PLAYER_ORIENTATION_CHANGE,this.isFullscreen())}},{key:"_initPlayback",value:function(){this.playback=this.getPlayBack(),O.debug(this.name,"found playback",this.getPlaybackName()),O.debug(this.name,"found playbacktype",this.getPlaybackType())}},{key:"_initConfig",value:function(){var e=this.options.mute?0:this.options.volume;this.setVolume(e)}},{key:"_initPlugins",value:function(){var e=this;te.empty(this.loader.plugins)||this.loader.plugins.forEach((function(t){e.plugins.push(new t(e))}))}},{key:"_extendsOptions",value:function(e){var t=jv(e.sources,e.quality);t&&(e.source=t.source,e.currentSourceLevel=t.index)}},{key:"_onTouchMove",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"_toggleFullScreenIos",value:function(){this.backdropEl=this.backdropEl||Ie("div",{},{class:"--z--player-backdrop"}),this.isFullscreen()?(this.removeClass("--z--custom-ios-fullscreen"),this.options.parentElement.append(this.el),this.backdropEl.innerHTML="",Ae(this.backdropEl,"--z--show"),Rh.isFullscreenIos=!1,this.scrollTopPos&&window.scrollTo(0,this.scrollTopPos)):(this.scrollTopPos=this.scrollTopPos||window.scrollY,window.scrollTo(0,0),this.addClass("--z--custom-ios-fullscreen"),Ee(this.backdropEl,{height:window.innerHeight+"px"}),this.backdropEl.append(this.el),document.body.append(this.backdropEl),Ae(this.backdropEl,"--z--show"),Rh.isFullscreenIos=!0),this.setPlayerFontSizeBase(),this.trigger(U.PLAYER_FULLSCREEN,this.isFullscreen())}},{key:"_toggleFullScreenNative",value:function(){this.isFullscreen()?Rh.cancelFullscreen():Rh.requestFullscreen(this.el)}},{key:"toggleTheaterMode",value:function(){this.theaterMode=!this.theaterMode,this.toggleClass("--theater-mode",this.theaterMode),this.options.setStorageTheaterMode&&this.storage.set({theaterMode:this.theaterMode}),this.trigger(U.PLAYER_THEATER_MODE_CHANGE,this.theaterMode)}},{key:"mediaControlReady",value:function(){O.debug(this.name,"mediaControlReady"),this.trigger(U.PLAYER_MEDIACONTROL_READY,this.name)}},{key:"disableMediaControl",value:function(){this.trigger(U.PLAYER_MEDIACONTROL_DISABLE,this.name)}},{key:"enableMediaControl",value:function(){this.trigger(U.PLAYER_MEDIACONTROL_ENABLE,this.name)}},{key:"showMediaControl",value:function(){this.trigger(U.PLAYER_MEDIACONTROL_SHOW,this.name)}},{key:"hideMediaControl",value:function(){this.trigger(U.PLAYER_MEDIACONTROL_HIDE,this.name)}}]),t}();function my(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2?arguments[2]:void 0;e.style.opacity||(e.style.opacity=1);var n=null;window.requestAnimationFrame((function i(a){var o=a-(n=n||a),s=parseFloat(1-o/t,2);e.style.opacity=s<0?0:s,o>t?te.function(r)&&r():window.requestAnimationFrame(i)}))}function Ay(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:400,r=arguments.length>2?arguments[2]:void 0;e.style.opacity||(e.style.opacity=0);var n=null;window.requestAnimationFrame((function i(a){var o=a-(n=n||a),s=parseFloat(o/t,2);e.style.opacity=s>1?1:s,o>t?te.function(r)&&r():window.requestAnimationFrame(i)}))}r.d(t,"AdRunner",(function(){return by})),r.d(t,"Constant",(function(){return Ey})),r.d(t,"PromiseUtils",(function(){return A})),r.d(t,"AdUtils",(function(){return T})),r.d(t,"AnimationUtils",(function(){return w})),r.d(t,"ArraysUtils",(function(){return b})),r.d(t,"BaseObject",(function(){return K})),r.d(t,"BasePlugin",(function(){return de})),r.d(t,"BrowserUtils",(function(){return m})),r.d(t,"DomUtils",(function(){return y})),r.d(t,"Events",(function(){return U})),r.d(t,"HttpUtils",(function(){return S})),r.d(t,"IsUtils",(function(){return te})),r.d(t,"Log",(function(){return O})),r.d(t,"ObjectUtils",(function(){return v})),r.d(t,"Player",(function(){return yy})),r.d(t,"Storage",(function(){return sg})),r.d(t,"StringsUtils",(function(){return k})),r.d(t,"TimeUtils",(function(){return E})),r.d(t,"UIObject",(function(){return Ve})),r.d(t,"UIPlugin",(function(){return Xe})),r.d(t,"AdsPlugin",(function(){return cv}));var by=null;by=r(5);var Ey={MediaControlConst:{BG_TYPE_TRANSPARENT:"transparent",BG_TYPE_GRADIENT:"gradient",THEME:{RED:"red",BLUE:"blue",PURPLE:"purple",GREEN:"green",LIGHT_BLUE:"light_blue"},MAP_THEME_COLOR:{RED:"#f00",BLUE:"#2FA1B3",PURPLE:"#721799",GREEN:"#6cd936",LIGHT_BLUE:"#2196F3"}},SettingsMenuConst:Wh};O.setLevel(O.LEVEL_DISABLED)}])}}]);